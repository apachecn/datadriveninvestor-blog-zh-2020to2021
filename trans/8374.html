<html>
<head>
<title>Secure your Private Cloud Server with Fail2Ban</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fail2Ban保护您的私有云服务器</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/secure-your-cloud-server-from-hackers-with-fail2ban-69097a23b92b?source=collection_archive---------5-----------------------#2021-01-09">https://medium.datadriveninvestor.com/secure-your-cloud-server-from-hackers-with-fail2ban-69097a23b92b?source=collection_archive---------5-----------------------#2021-01-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0b11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置你的SSH配置和Fail2Ban自动监禁黑客IP地址。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/d885235addc9137435a84a095cedd2cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jCmpBkXOmGHfOK1D"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@badgerblack?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kaur Kristjan</a> on <a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Video showing all the steps</figcaption></figure><p id="dfc0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在之前的一篇文章中，我讨论了如何在自己的私有服务器上托管一系列云服务。在这篇文章中，我将讨论如何使用Fail2Ban和配置SSH来提高服务器的安全性。</p><p id="59e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与传统的密码验证码不同，SSH在默认情况下不限制您猜测密码的次数。这意味着试图访问您的服务器的黑客可以使用暴力攻击成为根用户。这通常需要运行一个密码破解工具，比如Hydra，使用一系列常用的密码。</p><p id="c775" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将向您展示如何自动禁止IP地址时，他们这样做。如果你想知道更多的细节，你可以看看我上面的视频。</p><h2 id="c123" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">技术细节</h2><div class="ma mb gp gr mc md"><a href="https://github.com/BiasedRiot/SaorTech-cloud-services" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">BiasedRiot/SaorTech-云服务</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">这个项目的目的是建立和配置谷歌，Dropbox等开源替代品...作为…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">github.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ky md"/></div></div></a></div><p id="cf04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Fail2Ban是一种检测IP地址登录失败的次数并在特定时间内禁止它们(将它们关进监狱)的服务。我创建了一个基本的shell脚本，它可以自动安装Fail2Ban并使用SSH禁用rootlogin。你可以在上面显示的GitHub repo中查看我的脚本，或者运行下面的命令。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="f0f0" class="lh li it mt b gy mx my l mz na">git clone <a class="ae le" href="https://github.com/CoogyEoin/SaorTech-cloud-services.git" rel="noopener ugc nofollow" target="_blank">https://github.com/BiasedRiot/SaorTech-cloud-services.git</a><br/>cd SaorTech-cloud-services.git/security<br/>sudo ./setup_ssh_security.sh</span></pre><p id="7755" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置Fail2Ban就是这样。如果你想让你的服务器更加安全，你也应该取消使用用户密码登录的功能。相反，您可以将您的公共SSH密钥添加到授权用户，这样当您通过SSH登录到该用户时，它会自动验证您的身份。它还使访问变得更加简单，因为您不必每次都键入那么长的密码:)</p><p id="10a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先在本地机器上生成一个SSH密钥(如果其他服务没有使用它，我建议创建一个新的)。我在使用旧的SSH公钥时遇到了麻烦)。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="deff" class="lh li it mt b gy mx my l mz na">ssh-keygen</span></pre><p id="26dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来要做的是从本地机器复制SSH密钥。记得更换你的用户和IP地址。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="35cb" class="lh li it mt b gy mx my l mz na">ssh-copy-id &lt;user&gt;@&lt;server ip or domain&gt;</span></pre><p id="0163" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，只需编辑服务器上的sshd配置文件。它应该在/etc/ssh/sshd_config下，并确保它包含以下几行。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="b6ef" class="lh li it mt b gy mx my l mz na">PasswordAuthentication no<br/>PubkeyAuthentication yes</span></pre><p id="8bdf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基本就是这样。只需重新启动服务器上的sshd服务，您就可以开始工作了。现在不仅用户(包括你自己)不可能登录你的服务器，除非他们知道你的SSH私人密钥，而且任何试图登录的人都将被禁止一天。你可以放心，你的服务器会更安全一点，不会被黑客攻击。</p><p id="0ad6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保持快乐，保持隐私。</p><p id="62cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">【https://biasedriot.co】我的网站:<a class="ae le" href="https://biasedriot.co" rel="noopener ugc nofollow" target="_blank"/></p><p id="0931" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">Youtube: </strong><a class="ae le" href="https://www.youtube.com/channel/UCehh50T6qtDpt_kEUF33GJw/" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/channel/UCehh50T6qtDpt_kEUF33GJw/</a></p><p id="935c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">Monero: </strong>84Y4FZiTbLeR5qc1fBrBhB1♠5agKtEdoixq2w1ysXJv486MiBCz3czGT15bqeXDPpdLoNyF93inxY3BCk6g8mrDMNKoArS</p><p id="a685" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Bitcoin: </strong> 1Dmn9jEtWAhdLk1HHWkUVNeDdAaBCwNajm</p></div></div>    
</body>
</html>