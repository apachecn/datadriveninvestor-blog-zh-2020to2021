<html>
<head>
<title>A Noob’s Guide to Naive Bayes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">朴素贝叶斯Noob指南</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/a-noobs-guide-to-naive-bayes-2ef0d8c131a6?source=collection_archive---------2-----------------------#2021-01-23">https://medium.datadriveninvestor.com/a-noobs-guide-to-naive-bayes-2ef0d8c131a6?source=collection_archive---------2-----------------------#2021-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4c3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，我们将学习一种非常“幼稚”的算法，即朴素贝叶斯算法。我们还将讨论它在包含分类值和连续值的数据集上的实现(从头开始)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/afd0abb74904faa4eeb83f981f13f7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2GIyGE5-ezaw6JXd.jpg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Source:analyticsprofile.com</figcaption></figure><h1 id="4e8d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">介绍</h1><p id="5dff" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">朴素贝叶斯是一种用于分类问题的监督学习算法。它来自“概率分类器”家族，并在假设所有特征相互独立的情况下应用贝叶斯定理对对象进行分类。这是使其“幼稚”的假设，因为在现实生活中，很难找到预测值之间没有多重共线性或零相关性的数据集。</p><p id="daff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管有这样的假设，它在分类物体方面做得相当好。</p><p id="29bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在实现我们的朴素贝叶斯算法之前，我们应该先了解一下贝叶斯定理是怎么回事。</p><h1 id="1c82" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">贝叶斯定理</h1><p id="ece2" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">在学习贝叶斯定理之前，我们需要了解条件概率的概念。</p><h2 id="21db" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">条件概率:</h2><blockquote class="mq"><p id="a424" class="mr ms iq bd mt mu mv mw mx my mz kk dk translated">条件概率是指在某种条件为真的情况下，某一事件发生的概率。它被表示为P(事件|条件)。</p></blockquote><p id="b301" class="pw-post-body-paragraph jn jo iq jp b jq na js jt ju nb jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">让我们用一个“非常复杂”的例子来理解它。</p><p id="e80a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设一个人想打一面墙(我不知道为什么，但继续前进)。如果他击打墙壁，受伤的可能性有多大？这里，我们找到概率的事件是“伤手”，条件是“打墙”。</p><p id="f009" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的例子可以表示为P(“受伤的手”|“打一堵墙”)。</p><blockquote class="nf ng nh"><p id="4b9e" class="jn jo ni jp b jq jr js jt ju jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj kk ij bi translated">应该注意的是，</p><p id="7329" class="jn jo ni jp b jq jr js jt ju jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj kk ij bi translated">P("伤手" | "打墙")≠P("打墙" | "伤手")</p><p id="b0c2" class="jn jo ni jp b jq jr js jt ju jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj kk ij bi translated">一个人在打完一面墙之后伤到手的概率和他在手受伤的时候打一面墙的概率是不一样的。(只要读几遍，你就会明白了)</p></blockquote><h2 id="647b" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">回到贝叶斯定理…</h2><p id="63a1" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">这个定理是下面这位先生介绍的:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/5b1b60f05d87d88d864c075cd8f35610.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/0*bEWsMGdHhVcd4Cu0.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Thomas Bayes</figcaption></figure><p id="4e95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它给了我们一种计算条件概率的方法。</p><p id="d2f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数学上这可以描述为，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/2ca37415cc818e212cbecf530f26e560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*B4yufzfUN6pD9Ov6.jpg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Source: iq.opengenus.org</figcaption></figure><p id="2ef2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很多时候，我们并没有得到分母P(B) <em class="ni">(这个术语也被称为证据)</em>的值。我们可以通过下面的等式来计算:</p><p id="8131" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(B)= P(B | A)*P(A)+P(B |非A)* P(非A)</p><p id="5dcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong></p><ul class=""><li id="ffce" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">P(非A) = 1-P(A)</li><li id="713d" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">P(B |非A) = 1-P(非B |非A)</li></ul><p id="eab9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用上面的等式，我们得到了贝叶斯定理的新公式，</p><p id="e498" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(A | B)= P(B | A)*P(A)/(P(B | A)* P(A)+P(B |非A)* P(非A))</p><h1 id="ff55" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用示例实现朴素贝叶斯:</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oc"><img src="../Images/734af12e41b10f2b0b891df11c4df7d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/0*R8_mVmVaq81uShm2"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Train set</figcaption></figure><ul class=""><li id="9b21" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">在我们的响应变量中找到不同的类/组。在我们的例子中，响应变量是“流感？”它分为两类:“是”和“否”。</li><li id="e130" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">对于每个预测变量，我们确定其不同类型的值。例如，对于“发冷”、“发烧”和“流鼻涕”列，它们具有类型值:“是”和“否”；对于“头痛”一栏，它有“轻微”、“没有”和“强烈”。</li><li id="243b" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">对于特定预测中的每种类型的值，我们找出它们被分类到某一类响应变量中的“可能性”。举个例子，</li></ul><blockquote class="nf ng nh"><p id="c82f" class="jn jo ni jp b jq jr js jt ju jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj kk ij bi translated">如果某人患了流感，那么他出现轻微头痛或P(headerships = " mineral " | flu = " yes ")的可能性有多大？</p><p id="06d4" class="jn jo ni jp b jq jr js jt ju jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj kk ij bi translated">具有(头痛=“轻微”)的行的总数是3。在这三行中，我们看到其中的2行被归类为“流感？”中的“是”类专栏。</p><p id="ece0" class="jn jo ni jp b jq jr js jt ju jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj kk ij bi translated">因此，P(头痛=“轻微”)|流感=“是”)= 2/3</p></blockquote><p id="3a3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似地，我们计算其他的如下:</p><h2 id="c2b7" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated"><strong class="ak">假设流感=“是”(可能性):</strong></h2><ul class=""><li id="b648" class="no np iq jp b jq lz ju ma jy od kc oe kg of kk nt nu nv nw bi translated"><em class="ni"> P(头痛= "轻微" |流感= "是")= 2/3，</em></li><li id="a6b6" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(头痛= "否" |流感= "是")= 1/2 </em></li><li id="191b" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">P(头痛= "强烈" |流感= "是")=2/3 </li><li id="e155" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni">P(chills = " yes " | flu = " yes ")= 3/4，P(chills = " no " | flu = " yes ")= 2/4</em></li><li id="a3e8" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(流鼻涕=“是”|flu =“是”)= 4/5，P(流鼻涕=“否”|flu =“是”)= 1/3 </em></li><li id="2b06" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni">P(fever = " yes " | flu = " yes ")= 4/5，P(fever = " no " | flu = " yes ")= 1/3</em></li></ul><h2 id="e891" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated"><strong class="ak">鉴于流感= "否"</strong>(可能性)<strong class="ak"> : </strong></h2><ul class=""><li id="543c" class="no np iq jp b jq lz ju ma jy od kc oe kg of kk nt nu nv nw bi translated"><em class="ni"> P(头痛= "轻微" |流感= "否")</em> <em class="ni"> = 1/3 </em></li><li id="f13e" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(头痛= "否" |流感= "否")</em> <em class="ni"> = 1/2 </em></li><li id="74dd" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">P(头痛= "强烈" |流感= "否")=1/3 </li><li id="cfd4" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni">P(chills = " yes " | flu = " no ")= 1/4</em>和<em class="ni">P(chills = " no " | flu = " no ")</em><em class="ni">= 2/4</em></li><li id="e410" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(流鼻涕= "是" |流感= "否")= 1/5 </em>和<em class="ni"> P(流鼻涕= "否" |流感= "否")= 2/3 </em></li><li id="786c" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni">P(fever = " yes " | flu = " no ")= 1/5</em>和<em class="ni">P(fever = " no " | flu = " no ")= 2/3</em></li></ul><h2 id="589d" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">其他概率:</h2><ul class=""><li id="f8a7" class="no np iq jp b jq lz ju ma jy od kc oe kg of kk nt nu nv nw bi translated"><em class="ni"> P(flu = "yes") = 5/8 </em>和<em class="ni"> P(flu = "no") = 3/8 </em></li><li id="5548" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(冷激=“是”)= 4/8 </em>和<em class="ni"> P(冷激=“否”)= 4/8 </em></li><li id="36cb" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(头痛=“轻度”)= 3/8</em>；<em class="ni"> P(头痛= "强")= 3/8 </em>和<em class="ni"> P(头痛= "否")= 2/8 </em></li><li id="fd1f" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(流鼻涕=“是”)= 5/8 </em>和<em class="ni"> P(流鼻涕=“否”)= 3/8 </em></li><li id="dba4" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(发烧=“是”)= 5/8 </em>和<em class="ni"> P(发烧=“否”)= 3/8 </em></li></ul><h2 id="e22f" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">示例:使用贝叶斯定理找出流鼻涕时患流感的可能性(后)</h2><ul class=""><li id="a4c0" class="no np iq jp b jq lz ju ma jy od kc oe kg of kk nt nu nv nw bi translated">P(flu = " yes " | runny nose = " yes ")=</li></ul><p id="8fdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(流鼻涕:“是”)|flu= "是)*P(流感:“是”)/P(流鼻涕:“是”)</p><p id="4e34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">= ((4/5)*(5/8))/(5/8)=4/5</p><h2 id="8147" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">现在，我们将预测在给定的条件下我们是否会患流感</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi og"><img src="../Images/8d82355fbcd347eaa209bb137a59eff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/0*tQBHzuqv_JmEjrou"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Test case</figcaption></figure><p id="e95b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设上述条件为x，我们需要计算:</p><ul class=""><li id="52fc" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">P(flu = " yes " | X)= P(X | flu = " yes ")* P(flu = " yes ")/P(X)</li><li id="9791" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">P(flu = " no " | X)= P(X | flu = " no ")* P(flu = " no ")/P(X)</li></ul><p id="13e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为P(X)很常见，所以忽略它。</p><p id="f1f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">通过乘以下面给出的值计算P(flu = " yes " | X)= 5/8 *(3/4 * 1/3 * 2/3 * 1/3)= 0.0347:</strong></p><ul class=""><li id="f6e4" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">P(flu = "yes") = 5/8 </li><li id="c3c4" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">P(chills = " yes " | flu = " yes ")= 3/4</li><li id="02ab" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(流鼻涕= "no"|flu = "yes") = 1/3 </em></li><li id="8a1b" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(头痛= "轻微" |流感= "是")= 2/3 </em></li><li id="3055" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(发烧= "否" |流感= "是")= 1/3 </em></li></ul><blockquote class="mq"><p id="321b" class="mr ms iq bd mt mu oh oi oj ok ol kk dk translated">上述值是使用下面的公式计算的:</p><p id="3376" class="mr ms iq bd mt mu mv mw mx my mz kk dk translated">P(X₁、X₂、X₃,…Xₙ|“是”)= p(x₁|"yes")*p(x₂|"yes")*p(x₃|"yes")….*P(Xₙ|"yes”)</p></blockquote><p id="88ab" class="pw-post-body-paragraph jn jo iq jp b jq na js jt ju nb jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">类似地，我们计算流感=“否”，</p><p id="c25c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">计算P(flu = " no " | X)=(3/8)*(1/4)*(2/3)*(1/3)*(2/3)= 0.0138</p><ul class=""><li id="3fb1" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">P(flu = "no") = 3/8 </li><li id="246a" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni">P(chills = " yes " | flu = " no ")= 1/4</em></li><li id="9209" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(流鼻涕= "no"|flu = "no") = 2/3 </em></li><li id="15ef" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni"> P(头痛= "轻微" |flu = "否")</em> <em class="ni"> = 1/3 </em></li><li id="857b" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated"><em class="ni">P(fever = " no " | flu = " no ")= 2/3</em></li></ul><blockquote class="mq"><p id="e830" class="mr ms iq bd mt mu oh oi oj ok ol kk dk translated">由于P(X|flu= "no") &lt; P(X|flu= "yes ")，在给定的一组条件下，一个人极有可能会患流感。</p></blockquote><p id="1eb2" class="pw-post-body-paragraph jn jo iq jp b jq na js jt ju nb jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">哦，那有很多计算。</p><h1 id="2f35" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">高斯朴素贝叶斯</h1><p id="1003" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我们为寻找条件概率所做的所有计算都是针对分类数据的。由于显而易见的原因，上述内容不适用于连续值。这就是我们引入高斯朴素贝叶斯的地方。</p><p id="fe15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们想计算给定条件y =c的点的可能性:</p><ul class=""><li id="2af8" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">首先找出满足y=c的行</li><li id="9e19" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">对于给定的一组行，计算每个特征或列的平均值和标准差。</li><li id="bcbe" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">对于这组行中的每个数据点，将x值(即该数据点的特征值)、该列的平均值和标准偏差代入下面给出的表达式中。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi om"><img src="../Images/5fcac7e0cf49014b5af50f4737fcd282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_MDkD8Bg5VTg0uTL"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Source: <a class="ae on" href="http://www.machinelearningplus.com" rel="noopener ugc nofollow" target="_blank">www.machinelearningplus.com</a></figcaption></figure><ul class=""><li id="1881" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">然后将每一列的这些值相乘，通过应用P(X|Y=c) = P(X₁，X₂，x₃,…xₙ| y = c)= p(x₁|y = c)*p(x₂|y = c)*p(x₃|y = c)找出该数据点的可能性。*P(Xₙ|Y = c)</li></ul><p id="cba2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中，X={X₁、X₂、X₃,…Xₙ}是特征/自变量。</p><h1 id="18ec" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在企鹅数据集上的实现</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oo op l"/></div></figure><ul class=""><li id="a6ee" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">导入numpy、math和seaborn库。</li><li id="60e3" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">我已经使用seaborn.load_dataset(“企鹅”)加载了数据集“企鹅”。</li><li id="585a" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">对于这个数据集，我们的响应变量是“物种”,其余的列是特征值。</li></ul><p id="4bd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在数据集上实现朴素贝叶斯之前，我检查了空值:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/dd9c4424ed48e6d5f52ebec5d2fd41cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*SQ_YhkSIk522NNQNpTH2JA.png"/></div></figure><p id="8dc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一些行有5个值为空，一些行只有“性别”列下的值为空。</p><ul class=""><li id="3f97" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">首先，我找出了“性别”列中的模式值，并用该值替换该列中的空值。在我的例子中，mode是“男性”。</li><li id="1123" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">如果一些行仍然有空值，那么我就删除它。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi or"><img src="../Images/8a8d886a9fb648c0c7f43174713ee969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*biIDlHR38YH9Wjvhjv-04w.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">cnt stores the mode of a column and fillna(cnt) fills the null values.</figcaption></figure><p id="b1c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在将数据集转换为numpy数组后，我将数据集以80:20的比例划分为训练和测试数据集(我只是觉得这样更容易处理) :</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi os"><img src="../Images/c7e6f576dfaef6ec84a4487e4c9c6d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efG4m_es_OCW_0KNTf8-Qg.png"/></div></div></figure><h1 id="a90d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">这些功能</h1><p id="0ae3" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我们发现连续数据的均值、标准差和分类数据的似然性。然后将这些值用于测试数据，以找到预测值。</p><h2 id="0804" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">stats_by_class(x，y):</h2><p id="5e0a" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">将数据集除以响应变量的类类型，然后返回连续数据的平均值、标准差，并计算分类数据的对数似然。</p><p id="708f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自变量:x_train集合和y_train集合。</p><ul class=""><li id="ed72" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">它首先为我们的响应变量找出所有唯一的类类型。</li><li id="51c7" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">用y = <class_name>的所有行初始化每个类类型的字典“组”。</class_name></li><li id="4873" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">“stats”存储每个类的平均值和标准偏差(每列都有)、列索引(标识具有连续值的列)和行数。</li><li id="5ea1" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">“category_prob”存储包含分类数据的列的对数可能性。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/e7d5f2b771761d30938a736fea1bfadf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*5df1AitLep7M6zehdxjvgQ.png"/></div></figure><h2 id="cd28" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">find_stats(x):</h2><p id="2351" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">参数:x是数据集，其对应的响应变量属于特定的类类型。</p><p id="8a8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它检查每一列是否包含字符串类的数据。如果它不是字符串类型，那么我们找到均值和标准差。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/d48d74a0502f454041273a77b6027b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*AduSvZEb0nCOZ8hbTAp2lQ.png"/></div></figure><h2 id="73a5" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">gaussian_prob(x_i，均值，标准差):</h2><p id="cc15" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">使用高斯分布表达式计算x_i的概率，其中，x_i等于x[row][column]，平均值和标准偏差是针对该特定列传递的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ov"><img src="../Images/95500e6932ced06b06a12ab3ac601242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*12uFyvfomsrqp5TET0NM4A.png"/></div></div></figure><h2 id="387d" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">find_category_prob(x，y，cls):</h2><p id="ff06" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">辩君:这里cls是类类型。</p><p id="9172" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">给定响应变量的分类类型，找出所有预测值的对数似然。</p><p id="78b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，我们检查列的数据类型，如果它包含string类的数据，我们会发现:</p><ul class=""><li id="760c" class="no np iq jp b jq jr ju jv jy nq kc nr kg ns kk nt nu nv nw bi translated">该列中的唯一类型。</li><li id="9ac9" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">在y_train[row] = cls的那一列中查找每种类型的行</li><li id="4be8" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">将上述计数除以该列中该类型的总计数。</li><li id="b4d5" class="no np iq jp b jq nx ju ny jy nz kc oa kg ob kk nt nu nv nw bi translated">然后找到它的日志并将其存储在概率字典中，其中键值是列索引。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ow"><img src="../Images/8d38eae91a325ad77628651efe61c5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bIi59n8SHNR4uoZ4GSt2ow.png"/></div></div></figure><h2 id="27ed" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">find_prob_for_class(stats，test_row，category_prob=None):</h2><p id="fb03" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">此函数查找P(Y=cls|X)的后验值，其中X是我们的测试行呈现的条件集。</p><p id="34da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们调用gaussian_prob()来查找连续列的似然性，并找到它的对数值。我们将所有这些对数值与由category_prob字典提供的对数似然值和我们的类概率的对数值相加。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/8ea19f712b71a3896d590a1488c08465.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*tbMTduNYfOywrYDG4D3bvA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">stats[class][0] contains mean for each column, stats[class][1] contains standard deviation for each column, stats[class][2] has column indices, stats[class][3] has number of rows for that class.</figcaption></figure><p id="a380" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们通过将数据集中的stats[cls][3]除以total_rows来找到该类的概率。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oy"><img src="../Images/080216952e6e552f0ae7dc19feee0335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dr9IO9I3y7rTikL0nbWE0A.png"/></div></div></figure><h2 id="2d54" class="me lc iq bd ld mf mg dn lh mh mi dp ll jy mj mk lp kc ml mm lt kg mn mo lx mp bi translated">predict(stats，test_row，category_prob=None):</h2><p id="3271" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">它从find_prob_for_class()函数中获取后验概率的对数值，并返回具有最大后验概率值的类。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oz"><img src="../Images/7ebea766b4dc337761ef220ca735625a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emzUU_C5yZsuI4sqNKp7_g.png"/></div></div></figure><p id="524a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论如何，这结束了我们的博客。我希望它能让你对这个话题有一点了解。感谢您花时间阅读这篇文章！！！</p><p id="ff7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝你愉快😄！！！</p><p id="4d9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">附注:我洗耳恭听所有的更正和建议。如果我做错了什么，请随时指出，并告诉我如何做得更好。</p></div></div>    
</body>
</html>