<html>
<head>
<title>Email Classification Using Natural Language Processing (NLP)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自然语言处理(NLP)的电子邮件分类</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/email-classification-using-natural-language-processing-nlp-ee3573bc79f7?source=collection_archive---------1-----------------------#2021-01-21">https://medium.datadriveninvestor.com/email-classification-using-natural-language-processing-nlp-ee3573bc79f7?source=collection_archive---------1-----------------------#2021-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6471" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Udacity数据科学家计划</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9cc34f989c511a59fe671bad8e4ebbe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JO96Gg1Js7uDwlNw10UN-Q.jpeg"/></div></div></figure><p id="6b67" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">NLP是人工智能的一个子领域，允许机器操纵人类自然语言。自然语言处理已经在许多领域得到了应用。在这篇博客中，我们将使用自然语言处理技术对一封邮件进行分类，看它是不是垃圾邮件。但是首先，让我们从定义我们将在这个博客中尝试解决的问题开始。</p><h1 id="3b7a" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">问题陈述</h1><p id="c7be" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们大多数人都应该熟悉垃圾邮件。Cisco将其定义为大量发送给任意收件人列表的不受欢迎的垃圾邮件。通常，垃圾邮件是出于商业目的发送的。它可以通过僵尸网络，即被感染的计算机网络大量发送。因此，垃圾邮件过滤是Outlook和Gmail等电子邮件服务的基本功能。服务提供商广泛使用机器学习技术来成功地过滤和分类它们。</p><h1 id="1215" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">资料组</h1><p id="6c46" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们正在使用的数据集是一个公共文本数据，它包含两列，包括文本(电子邮件)和垃圾邮件(标签)。垃圾邮件列有两个值(0和1)，如果是垃圾邮件，文本标记为1，否则标记为0。</p><p id="cc47" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">可以从<a class="ae mk" href="https://www.kaggle.com/bagavathypriya/email-spam-dataset" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载。</p><h1 id="b836" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">ETL管道</h1><p id="c7c4" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">在计算中，管道也称为数据管道，是一组串联的数据处理元件，其中一个元件的输出是下一个元件的输入。流水线的元素通常以并行或时间分片的方式执行[ <a class="ae mk" href="https://en.wikipedia.org/wiki/Pipeline_(computing)" rel="noopener ugc nofollow" target="_blank"> 1 </a> ]。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/9bc45d583bc30f73a6c03d8f6fb97ff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fNJsQIt3OxAKhJ71m0GyRg.png"/></div></div></figure><p id="4da4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> ETL(提取、转换和加载)管道</strong>指的是允许我们为机器学习模型准备数据的一系列步骤。<strong class="kt ir">提取</strong>是从数据源下载/收集数据的过程(在我们的例子中是我们Kaggle)。<strong class="kt ir">转换</strong>数据允许我们清理和处理数据，而<strong class="kt ir">加载</strong>数据是我们将数据保存/存储到数据库或文件中以供进一步分析或将其用作构建机器学习模型的输入的步骤。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h1 id="d9d5" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated"><strong class="ak">机器学习管道</strong></h1><p id="fefb" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">在这一步中，我们将构建一个NLP管道，包括:</p><p id="0528" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 1。文本处理</strong></p><p id="a9e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这一步是从<a class="ae mk" href="https://www.udacity.com/course/data-scientist-nanodegree--nd025?utm_source=gsem_brand&amp;utm_medium=ads_r&amp;utm_campaign=8826748925_c&amp;utm_term=87779570854&amp;utm_keyword=udacity%20data%20scientist%20nanodegree_e&amp;gclid=CjwKCAiAxp-ABhALEiwAXm6IyUjsoLsoRiorchoiRVa8Cu1Y7yUpNBbPoHxmbqkh3WJ79_Q1yShzDBoCc_YQAvD_BwE" rel="noopener ugc nofollow" target="_blank"> Udacity数据科学家计划</a>中学到的</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/d2879f6ab833799ae88146f8110c8014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*hLCdodTKv-sDAGxSec637w.jpeg"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Text Processing Summary [<a class="ae mk" href="https://www.udacity.com" rel="noopener ugc nofollow" target="_blank">2</a>]</figcaption></figure><h2 id="82d5" class="mt lo iq bd lp mu mv dn lt mw mx dp lx la my mz lz le na nb mb li nc nd md ne bi translated">标记化</h2><p id="43ea" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">给定一个纯文本，我们首先将它规格化，转换成小写，去掉标点符号，最后将它拆分成单词，这些单词称为分词器。</p><h2 id="f9a8" class="mt lo iq bd lp mu mv dn lt mw mx dp lx la my mz lz le na nb mb li nc nd md ne bi translated">干净的</h2><p id="44cc" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">删除停用词以减少词汇量。</p><h2 id="cf82" class="mt lo iq bd lp mu mv dn lt mw mx dp lx la my mz lz le na nb mb li nc nd md ne bi translated">使标准化</h2><p id="0a7e" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">为了进一步简化我们的文本数据，我们可以在这一步中对其进行词汇化或词干化。<strong class="kt ir">词汇化和词干化</strong>通常是指通过使用词汇和单词的形态分析来正确地做事情，通常旨在只删除屈折词尾，并返回单词的基本形式或词典形式，这被称为词汇[ <a class="ae mk" href="https://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html" rel="noopener ugc nofollow" target="_blank"> 3 </a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/44ac08472bf8520149d506c69598c786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kag16OJS6r3Q-HvIQya6aA.png"/></div></div></figure><p id="d308" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 2。SKLearn管道</strong></p><p id="5a57" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">管道</strong>的目的是在设置不同参数[ <a class="ae mk" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank"> 4 </a> ]时，将几个可以交叉验证的步骤组合在一起。</p><p id="d337" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">sklearn管道的组成部分如下:</p><ol class=""><li id="adb9" class="ng nh iq kt b ku kv kx ky la ni le nj li nk lm nl nm nn no bi translated">在<strong class="kt ir"> CountVectorizer () </strong>中，我们传递我们的tokenize函数来提供<strong class="kt ir"> </strong>词汇表，并使用该词汇表对新文档进行编码</li><li id="7320" class="ng nh iq kt b ku np kx nq la nr le ns li nt lm nl nm nn no bi translated"><strong class="kt ir"> TfidfTransformer() </strong>将计数矩阵转换为标准化的tf或tf-idf表示。Tf表示术语频率，而tf-idf表示术语频率乘以逆文档频率。这是信息检索中常见的术语加权方案，在文档分类中也有很好的用途。</li><li id="2307" class="ng nh iq kt b ku np kx nq la nr le ns li nt lm nl nm nn no bi translated"><strong class="kt ir">机器学习分类器()</strong>在这种情况下，我使用一个简单的机器学习算法'<em class="nu">朴素贝叶斯</em>'，因为它被认为是最好的文本分类器之一</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="b261" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 3。评估</strong></p><p id="aab7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了评估我们的机器学习模型的性能，我使用了以下指标:</p><p id="c004" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">准确性</strong>:模型正确分类的预测比例</p><p id="df66" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">混淆矩阵</strong>:评估一个分类准确性的汇总表，它按每一类分解了正确和错误预测的数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/bd95e94959b8d15a615d952a847367c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sjVLRzMEVNy2hemW19Y5hA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/e9c33fcdd9dd7235b7ba5ac38212bbae.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*ZpnKk2tOBFOXI4Q_jDZt1Q.png"/></div></figure><p id="c48a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以看到我们有0个假阴性和真阴性。而真阳性= 1398，假阳性= 493这还不错。</p><h1 id="12cd" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">结论</h1><p id="f829" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">在这篇文章中，我们建立了一个ETL管道，帮助我们准备数据，以便用它来建立一个分类电子邮件的机器学习模型。</p><p id="5d86" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们实现了一个基本的自然语言处理技术和机器学习。结果并不坏，因为在没有超参数调整也没有添加另一个特征的情况下，该模型的准确度是74%,这是相当可观的，一点也不坏，因为我们有非常小的数据集，并且使用NLP和ML的基本技术。</p><p id="8dba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下一步:我将尝试使用不同的自然语言处理技术来改进模型。</p><h1 id="c4ef" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">参考</h1><p id="26af" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">[1] <a class="ae mk" href="https://en.wikipedia.org/wiki/Extract,_transform,_load" rel="noopener ugc nofollow" target="_blank"> ETL管道</a></p><p id="9206" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">[2] <a class="ae mk" href="https://www.udacity.com/course/data-scientist-nanodegree--nd025" rel="noopener ugc nofollow" target="_blank"> Udacity数据科学家计划</a></p><p id="ecf1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">[3] <a class="ae mk" href="https://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html" rel="noopener ugc nofollow" target="_blank">词干化和词汇化</a></p><p id="3c2f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">[4] <a class="ae mk" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank"> sklearn.pipeline </a></p><p id="0434" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">快乐学习！</p></div></div>    
</body>
</html>