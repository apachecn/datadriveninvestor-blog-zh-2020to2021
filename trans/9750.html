<html>
<head>
<title>Evaluating Classification Model Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估分类模型性能</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/evaluating-classification-model-performance-3bcadfafa1c7?source=collection_archive---------11-----------------------#2021-02-19">https://medium.datadriveninvestor.com/evaluating-classification-model-performance-3bcadfafa1c7?source=collection_archive---------11-----------------------#2021-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="131e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">用简单的英语解释准确度、精确度、召回率和F1分数</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8859f2a1f42d91899370ee752b05d652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*26yjNJIxPXlB_Q9O"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@mbaumi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mika Baumeister</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b7ad" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当谈到分类模型时，用于确定性能的度量标准与用于评估回归模型的度量标准有很大的不同。在我看来，用来描述一个分类模型性能的度量标准<em class="lt">更加</em>直观。当这些指标被用来描述一项确定你是否患病的医学测试时，你可能对其中的一些指标有过体验，例如新冠肺炎测试。如果您正在接受新冠肺炎病毒检测，该检测有四种可能的结果:</p><ul class=""><li id="3a2f" class="lu lv iq kz b la lb ld le lg lw lk lx lo ly ls lz ma mb mc bi translated">真阳性:你感染了病毒，并且病毒检测呈阳性。</li><li id="40be" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">假阳性:您没有感染病毒，但您的病毒检测呈阳性。</li><li id="ed59" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">真阴性:您没有感染病毒，并且病毒检测呈阴性。</li><li id="b78a" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">假阴性:你感染了病毒，但测试结果呈阴性。</li></ul><p id="4291" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">每项测试，包括Covid测试，都必须根据具体情况在假阳性和假阴性之间取得平衡。这四类测试结果将帮助我们计算决定模型性能的评估指标。</p><p id="2e8c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这篇文章中，我将解释四个评估指标的含义——准确度、精确度、召回率和F1——以及在什么情况下每个分数最重要。然后，我将向您展示如何计算每个分数，并使用Python可视化测试结果。阅读后，您应该能够确定在您的分类问题的上下文中哪个指标是最重要的，并且您将能够用简单的英语将这些指标传达给利益相关者。为了简单起见，我们将把重点放在二进制分类问题上。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="f07b" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">准确(性)</h1><p id="269a" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">准确性可能是最容易理解的评估指标之一，但也是最不相关的。准确性衡量分类模型做出的正确预测的总数，包括真阳性和真阴性。您可以使用下面的公式来计算:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/92642acc053272677b4450be78bb34cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*b3zwoGEGGe_bZsFJLM5Flw.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">accuracy formula</figcaption></figure><p id="0079" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用我们的COVID测试示例，这将是总预测的百分比，其中测试正确预测一个人具有Covid <em class="lt">并且</em>正确预测一个人没有COVID；换句话说，真正的积极加上真正的消极。</p><h2 id="315b" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">什么时候准确性最重要？</h2><p id="9f5a" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">如果您有一个平衡的分类问题，其中正案例的数量几乎等于负案例的数量，则准确性可能是衡量整体模型性能的有用度量。然而，在不平衡的类的情况下，准确性可能是一个非常没有意义的度量。</p><p id="4e21" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，假设样本的90%是真阴性，而10%是真阳性。如果模型只是简单地预测所有负面因素，它将达到90%的准确率，这使得模型看起来比实际情况好得多。这给我们带来了下一个评估指标的有用性。</p><h1 id="fe9c" class="mp mq iq bd mr ms nz mu mv mw oa my mz jw ob jx nb jz oc ka nd kc od kd nf ng bi translated">精确</h1><p id="41d9" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">Precision测量所有预测阳性中真正阳性的数量。保守模型通常具有非常高的精度分数，因为预测阳性的阈值很高。其计算方法如下:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/fb6b20fb31965797f1f425cadd7b1403.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*ywMK1wsBSLK2SBm_ZbyIZA.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">precision calculation</figcaption></figure><p id="036c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">就我们的Covid示例而言，精确度将被计算为所有阳性检测结果中某个病毒检测为阳性的次数。</p><h2 id="9d46" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">什么时候精度最重要？</h2><p id="69fe" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">在预测阳性的阈值较高的情况下，精确度可能是非常有用的度量。例如，在垃圾邮件过滤的情况下，将某些东西分类为垃圾邮件的阈值较低可能会导致重要的电子邮件被垃圾邮件过滤器捕获。在这种情况下，我们希望我们的精度高，这样我们就不会有太多的预测阳性被我们的垃圾邮件过滤器捕获。然而，在医学案例中，高精度值并不总是最优先考虑的。</p><h1 id="1268" class="mp mq iq bd mr ms nz mu mv mw oa my mz jw ob jx nb jz oc ka nd kc od kd nf ng bi translated">回忆</h1><p id="2877" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">召回衡量所有实际总阳性数中的真阳性数(真阳性加上假阴性)。你也可能听说过被称为<em class="lt">真实阳性率的回忆。</em>这可以计算为:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi of"><img src="../Images/711ce6fe4d46a5641c8420fb780bbf41.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*Lm8VgHRsCFAZg70d08bwhg.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">recall calculation</figcaption></figure><p id="181f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">回想一下我们的Covid测试，它回答了这样一个问题:在一个被测试的人实际上携带病毒的所有次数中，我们的测试有多少次正确地预测了这个人是阳性的？</p><h2 id="4b95" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">什么时候回忆最重要？</h2><p id="4f23" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">在我们的Covid测试示例中，召回率是我们最应该关注的指标，它是大多数医疗案例的主要指标。当某人接受Covid测试时，两种不正确的结果是，一个没有感染病毒的人被告知他们感染了，一个感染了病毒的人被告知他们没有感染。虽然假阳性并不理想，但有人不必要的隔离是一个比有人传播疾病更好的社会结果，因为他们不认为自己有疾病。这是精确召回权衡的一个很好的例子。Covid测试需要达到一定的召回水平，因为假阴性的结果比假阳性的结果更差。因此，我们会用更多的假阳性来换取更少的假阴性，并且预测阳性的门槛更低。真阳性率和假阳性率之间的权衡可以在模型的接收器操作特征(ROC)曲线中可视化。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi og"><img src="../Images/50c68f46f2cd27ed8d00faf80a13dcbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pnn0N7WFComW2lSmOS8EA.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">ROC Curve Example</figcaption></figure><h1 id="c4ca" class="mp mq iq bd mr ms nz mu mv mw oa my mz jw ob jx nb jz oc ka nd kc od kd nf ng bi translated">F1分数</h1><p id="1bc0" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">F1得分是精确度和召回率的调和平均值，或者是这两个指标的加权平均值。F1分数可以计算为:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/bf14da46caa9b15e24909245c4664450.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*EdMec46122zcY04i-AiR5g.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">F1 score calculation</figcaption></figure><p id="537d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">基本上，F1分数会惩罚过于偏向精度或召回的模型，使其成为衡量整体模型性能的良好指标。</p><h2 id="0e7f" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">F1成绩什么时候重要？</h2><p id="fc71" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">尽管在我们的Covid示例中，召回比精度更重要，但是具有一定程度的精度仍然很重要，否则我们的测试将毫无用处。f1分数考虑了这两个指标。</p><p id="8946" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在您已经从概念上理解了这些指标，让我们看看如何用Python来计算这些指标。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="75a0" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">可视化和计算评估指标</h1><h2 id="0131" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">分类报告</h2><p id="9225" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">一次获得所有这些指标的简单方法是打印scikit-learn内置的分类报告。参见下面的示例代码:</p><pre class="kh ki kj kk gt oi oj ok ol aw om bi"><span id="03b5" class="nn mq iq oj b gy on oo l op oq">from sklearn.metrics import classification_report</span><span id="a5f0" class="nn mq iq oj b gy or oo l op oq">print(classification_report(y_test, y_hat_test))</span></pre><p id="52ed" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">和输出:</p><pre class="kh ki kj kk gt oi oj ok ol aw om bi"><span id="5fce" class="nn mq iq oj b gy on oo l op oq">              precision    recall  f1-score   support<br/><br/>           0       0.83      0.73      0.77        33<br/>           1       0.81      0.88      0.84        43<br/><br/>    accuracy                           0.82        76<br/>   macro avg       0.82      0.81      0.81        76<br/>weighted avg       0.82      0.82      0.81        76</span></pre><p id="6ea4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，您可以在一个报告中轻松找到模型的精确度、召回率、F1分数和准确性。</p><h2 id="183a" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">混淆矩阵</h2><p id="63f5" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">可视化分类模型性能的一种简单方法是创建混淆矩阵。幸运的是，scikit-learn还有一个内置的<em class="lt"> plot_confusion_matrix </em>函数，可以自动输出美观的矩阵。参见下面的代码和输出示例:</p><pre class="kh ki kj kk gt oi oj ok ol aw om bi"><span id="2ce0" class="nn mq iq oj b gy on oo l op oq">sns.set(font_scale=1.5)<br/>fig, ax = plt.subplots(figsize=(10, 6))<br/>ax.set_title('Confusion Matrix')<br/>disp = plot_confusion_matrix(logreg, X_test, y_test, ax = ax,<br/>                             normalize=None)<br/>plt.grid(False)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9ea8cccc8fa317f799c8a503d9ae0afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*DeTxhM33ydLYap43UMqGOg.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">confusion matrix output</figcaption></figure><p id="2816" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">决策矩阵的每个象限代表我们前面提到的四个潜在结果之一。将矩阵中的0视为阴性，1视为阳性，例如，真实标签:0和预测标签:0相交的方框表示真实阴性的数量，而真实标签:1和预测标签:0表示假阴性的数量。</p><p id="894e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">知道了我们现在对每个指标的计算的了解，您可以从这个混淆矩阵中的值计算出所有4个指标！</p><ul class=""><li id="1a32" class="lu lv iq kz b la lb ld le lg lw lk lx lo ly ls lz ma mb mc bi translated"><em class="lt">准确率=(真阳性+真阴性)/总观测值=(38+24)/(24+9+5+38)= 62/76 = . 82</em></li><li id="e2e8" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated"><em class="lt">精度=真阳性/预测阳性= 38 / (38+9) = 38/47 = .81 </em></li><li id="61a0" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated"><em class="lt">召回=真阳性/实际阳性= 38 / (38+5) = 38/43 = .88 </em></li></ul><p id="0d27" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">既然我们已经计算了精度和召回率，我们还可以计算F1:</p><ul class=""><li id="2580" class="lu lv iq kz b la lb ld le lg lw lk lx lo ly ls lz ma mb mc bi translated"><em class="lt"> F1得分= 2*(召回率*精度)/(召回率+精度)= 2 *(0.81 * . 88)/(. 81+. 88)= 2 *(0.71/1.69)= . 84</em></li></ul><h2 id="a8b5" class="nn mq iq bd mr no np dn mv nq nr dp mz lg ns nt nb lk nu nv nd lo nw nx nf ny bi translated">sci kit-学习内置函数</h2><p id="5a86" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">尽管理解这些指标背后的概念很重要，但有更简单的方法来自动计算这些值。如果您想快速检查这些指标中的一个，而不打印完整的报告或可视化，scikit-learn也有内置的功能。参见下面的代码和输出示例:</p><pre class="kh ki kj kk gt oi oj ok ol aw om bi"><span id="32d4" class="nn mq iq oj b gy on oo l op oq">from sklearn.metrics import precision_score, recall_score, accuracy_score, f1_score</span><span id="28f9" class="nn mq iq oj b gy or oo l op oq">print(f'Accuracy is {round(accuracy_score(y_test, y_hat_test),2)}')<br/>print(f'Precision is {round(precision_score(y_test, y_hat_test),2)}')<br/>print(f'Recall is {round(recall_score(y_test, y_hat_test),2)}')<br/>print(f'F1 Score is {round(f1_score(y_test, y_hat_test),2)}')</span><span id="c1ae" class="nn mq iq oj b gy or oo l op oq">Accuracy is 0.82 <br/>Precision is 0.81<br/>Recall is 0.88<br/>F1 Score is 0.84</span></pre><p id="f7dd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在您拥有了快速而正确地解释分类模型性能的工具！如果有疑问，值得计算这些评估指标，从多个角度检查您的模型的表现。就新冠肺炎测试而言，这些概念是非常有趣的——参见下面一些讨论实际测试结果的资源:</p><div class="os ot gp gr ou ov"><a href="https://www.fda.gov/medical-devices/letters-health-care-providers/potential-false-positive-results-antigen-tests-rapid-detection-sars-cov-2-letter-clinical-laboratory" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd ir gy z fp pa fr fs pb fu fw ip bi translated">新型冠状病毒抗原检测可能出现假阳性结果</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">美国美国食品药品监督管理局(FDA)警告临床实验室工作人员和卫生保健提供者，虚假…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">www.fda.gov</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj kq ov"/></div></div></a></div><div class="os ot gp gr ou ov"><a href="https://medical.mit.edu/covid-19-updates/2020/06/how-accurate-diagnostic-tests-covid-19" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd ir gy z fp pa fr fs pb fu fw ip bi translated">用于诊断新冠肺炎的实验室测试有多准确？麻省理工学院医学院</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">4月29日:麻省理工医学院回答你的新冠肺炎问题。有关于新冠肺炎的问题吗？发送到CovidQ@mit.edu给我们…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">medical.mit.edu</p></div></div></div></a></div><p id="0a45" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>