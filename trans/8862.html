<html>
<head>
<title>Options trading data analysis — Part 3-The openings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">期权交易数据分析—第3部分—开盘</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/options-trading-data-analysis-part-3-the-openings-73c2129d2fd2?source=collection_archive---------11-----------------------#2021-01-24">https://medium.datadriveninvestor.com/options-trading-data-analysis-part-3-the-openings-73c2129d2fd2?source=collection_archive---------11-----------------------#2021-01-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8441" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这一部分的兴趣在于查看开盘交易，并从我们可用的交易数据中提取信息。从这些信息中，我们将尝试收集交易行为，并可能讲述一个简短的故事。账户持有人采用什么交易策略？影响开仓交易的因素有哪些？交易一般是赊账还是借记？行为是否一致？这些是我们可以尝试找出的一些问题。</p><p id="b8f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们从<a class="ae ko" href="https://phandinhlan.medium.com/options-trading-data-analysis-part-1-an-introduction-c6dcdc5d9a2f" rel="noopener">第1部分</a>和<a class="ae ko" href="https://medium.com/analytics-vidhya/options-trading-data-analysis-part-2-visuals-36e659233f" rel="noopener">第2部分</a>开始，使用前面提到的技术将交易数据加载到<code class="fe kp kq kr ks b">transactionDf</code> Pandas数据帧中。我们进一步过滤数据，以放大特定于期权的交易。这可以通过过滤<code class="fe kp kq kr ks b">TRADE</code>的<code class="fe kp kq kr ks b">type</code>和<code class="fe kp kq kr ks b">OPTION</code>的<code class="fe kp kq kr ks b">transactionItem_instrument_assetType</code>来实现。这将给我们带来活跃的期权交易。我们还将通过在<code class="fe kp kq kr ks b">description</code>字段中过滤<code class="fe kp kq kr ks b">REMOVAL OF OPTION</code>来包含与非活动期权相关的交易。无效期权交易是行使或转让的结果。由于我们对开放交易感兴趣，我们将进一步过滤<code class="fe kp kq kr ks b">OPENING</code>。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/db79ea3eb8ede626faf692c9e7d45891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nrcw7cLMj30WhsPCKJDaLw.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Filter for opening option transactions</figcaption></figure><p id="dbed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们做一些提炼，提取以下感兴趣的项目:</p><ul class=""><li id="bd19" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">creditsPerTransaction</li><li id="a621" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">信贷资本</li><li id="b125" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">信贷本金</li><li id="a084" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">天数到期</li></ul><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lx"><img src="../Images/2fa7e6f11a9fb72a33c790d5be687d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5x-dSR7nEr_-TLgnXp-qw.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Refining</figcaption></figure><p id="0b67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将信用总额合并为<code class="fe kp kq kr ks b">transactionItem_credits</code>作为合同数量(<code class="fe kp kq kr ks b">transactionItem_amount</code>)和每份合同价格(<code class="fe kp kq kr ks b">transactionItem_price</code>)的乘积。我们还将<code class="fe kp kq kr ks b">transactionItem_price</code>更名为<code class="fe kp kq kr ks b">creditsPerContract</code>，将<code class="fe kp kq kr ks b">transactionItem_amount</code>更名为<code class="fe kp kq kr ks b">contracts</code>以适应我们的会话环境。我们将<code class="fe kp kq kr ks b">transactionItem_instrument_optionExpirationDate</code>转换，与<code class="fe kp kq kr ks b">transactionDate</code>相减，得到<code class="fe kp kq kr ks b">daysToExpiration</code>。其他的都很容易计算。只需注意，我们需要将信用额乘以100，便可获得实际的美元金额。使用<code class="fe kp kq kr ks b">describe</code>方法可以为我们提供一些基本的统计信息。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ly"><img src="../Images/36c0e796396c6abb280f7e46ed05a4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCSfmTkwds5TKx7MWKFV5g.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Using describe() on opens</figcaption></figure><p id="71b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一些有用的信息来讲述一个关于开放贸易行为的简单故事。首先，我们注意到平均信用是正的，这表明空缺由空头头寸组成。我们可以通过<code class="fe kp kq kr ks b">transactionItem_instruction</code>字段来确认。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/e646d7e3fa3d12a0d5234da477237dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*mcFm1QlC-_w5hg7FMpPo2A.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Count the number of sells and buy transactions</figcaption></figure><p id="17b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请注意，这里的类型选择是任意的，因为我们只想得到买卖数量的计数。我们可以看到，短裤比长开口多得多。</p><p id="e4f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每笔交易的平均信用额度(<code class="fe kp kq kr ks b">transactionItem_credits</code>)约为每份合同平均信用额度的1.94倍，这可能表明我们每笔交易的平均信用额度约为2份。我们可以推断，空缺通常由两份合同组成。考虑到我们的买入卖出比率，我们很可能会考虑交叉或交叉。</p><p id="89a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到期日统计数据表明，交易策略倾向于在到期日之后30至60天之间进行平仓交易，大多数平仓发生在到期前45天左右。</p><p id="1738" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">平均信贷占资本的百分比可以给我们一些头寸规模的线索，大约是0.45%。但是，如果没有额外的信息，比如在任何给定的时间周期内未平仓的头寸数量，我们就不能很好地了解规模策略。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><p id="8ecb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们可以探索某个时期的数据，看看它能为我们提供什么信息。让我们首先提取每周一次的以下项目:</p><ul class=""><li id="ed06" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">交易数量</li><li id="35ee" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">合同数量</li><li id="34bd" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">信贷总额</li><li id="36d1" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">每个合同的平均信用额</li><li id="a208" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">平均到期天数</li><li id="0525" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">平均资本</li><li id="1d8f" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">平均本金</li></ul><p id="2c95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以通过重采样将它们连接成一个新的数据帧。使用<code class="fe kp kq kr ks b">count()</code>方法检索事务的数量。合同数量和总信用是该时间段的总和，而其余是平均值。此外，由于数据的性质，我们可能会在重采样后对某些字段使用NaN。对于资本和本金，我们将执行向前填充。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mh"><img src="../Images/c492e5bd473c30dbfa0e967d2d3a538e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WX3bjOWIKFB7II9UmWCD8w.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">openedStats snippet</figcaption></figure><p id="688e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将计算每笔交易的信用和每笔交易的合同。请注意，这些是针对每个时间段的。信贷占资本和本金的百分比也是为该期间计算的。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mi"><img src="../Images/42040b9ee2a263a6b037ce050351bc7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Gt6HEMoq_jk8GsmL4kqgw.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">openedStats table</figcaption></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mj"><img src="../Images/65b53720bfc9b9bc14c1d0b2d6ded125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQsqvtOMn5e80eqQ6rd8RQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">openedStats.describe()</figcaption></figure><p id="bf7b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在可以使用<code class="fe kp kq kr ks b">describe()</code>类似地分析每周信息。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><p id="723a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">鉴于我们这里的数据，如果不尝试获得一些视觉效果，我会觉得不完整。我们可以使用<a class="ae ko" href="https://medium.com/analytics-vidhya/options-trading-data-analysis-part-2-visuals-36e659233f" rel="noopener">第二部分</a>中讨论的一些技术，并获得一些视觉效果。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mk"><img src="../Images/f4456c840c127a9a5b887405dcce6da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AeBnXeW7tGGrE0518bdLBA.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">openedStats plot 1 snippet</figcaption></figure><p id="d08b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意这里我使用了<code class="fe kp kq kr ks b">transform_fold</code>方法。这是为了达到与使用第2部分中描述的<code class="fe kp kq kr ks b">melt</code>方法相似的效果。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ml"><img src="../Images/2b6a7930b334a7511bafa49c639da308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxc8rpyU34US4mbRSHqS5Q.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">openedStats plot 1</figcaption></figure><p id="4242" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe kp kq kr ks b">plot 1</code>,我们可以看到每周的合同数量、信用额度、到期天数和交易量。现在可以更容易地看到开盘交易行为的一些细节。</p><ul class=""><li id="3904" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">有些星期根本没有开业活动。</li><li id="1cb5" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">低开盘价或0开盘价的周数似乎遵循从到期日算起30天的趋势。</li><li id="63c3" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">从10月11日这一周开始，有5周时间几乎没有开业活动。一些假设可能表明普遍避免收益报告，因为这是2020年的数据，也许是在美国总统大选期间避免。</li><li id="1a48" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">从11月15日那一周开始，开盘后立即回升，总信贷、合约和交易量在11月22日那一周创下历史新高。如果我们做一个回溯，这个时间框架也对应着一些主要事件的注入，提供更多的交易资金。</li><li id="24f9" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">开盘交易的扩张和收缩模式似乎与到期日高度相关。</li></ul><p id="84cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每笔交易的合同数、每笔合同的信用数和每笔交易的信用数的图表讲述了一个类似的故事。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mm"><img src="../Images/3debb8a144abcec8b3a7fd02a19116f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tMBI_pLpzvRZ0DjGEP06pQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">openedStats plot 2</figcaption></figure><p id="f42c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们所看到的，通过一些基本的数据提炼和可视化技术，我们可以开始清除基于交易数据的期权交易行为的迷雾，并建立事件之间的相关性。在本系列的后半部分，我们将着眼于分析平仓交易，看看如何揭开更多的故事。</p><p id="add3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">免责声明，请不要使用这里的任何信息作为财务建议。感谢阅读。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><p id="0385" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://medium.com/datadriveninvestor/options-trading-data-analysis-part-4-the-closings-d31e6051f8b3" rel="noopener">第4部分——关闭</a></p></div></div>    
</body>
</html>