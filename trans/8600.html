<html>
<head>
<title>Confusion Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混淆矩阵</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/confusion-matrix-27e480d2663e?source=collection_archive---------10-----------------------#2021-01-15">https://medium.datadriveninvestor.com/confusion-matrix-27e480d2663e?source=collection_archive---------10-----------------------#2021-01-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c0a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">混淆矩阵是用于评估模型性能的度量。此指标用于分类问题。混淆矩阵是一个N×N矩阵，其中N是目标类的数量。混淆矩阵给出了分类模型的性能以及它正在产生何种错误的总体视图。</p><p id="38b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于二元分类，混淆矩阵是2×2矩阵。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/c9a495dd71be0acb97f9780d6c279e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*4BUuMi_xF3aAllPxbl25Wg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Google Image</figcaption></figure><p id="76a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据混淆矩阵，有两个目标变量，即<strong class="jp ir">正</strong>和<strong class="jp ir">负。</strong>行代表预测值。列表示目标变量的实际值。混淆矩阵提供了大量信息，矩阵的每个单元都用于某种度量计算。下面是混淆矩阵中每个单元格的含义。</p><h2 id="d656" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">真阳性(TP)</h2><p id="dce6" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">该值表示实际值为正且预测值也为正的实例数。</p><h2 id="b336" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">假阳性</h2><p id="f370" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">该值表示实际值为负但预测值为正的实例的数量。这也被称为<strong class="jp ir">I型错误。</strong></p><h2 id="e834" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">假阴性(FN)</h2><p id="846b" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">该值表示实际值为正值而预测值为负值的实例数。这也被称为<strong class="jp ir">类型II错误。</strong></p><h2 id="d56a" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">真阴性(TN)</h2><p id="87d5" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">该值表示实际值和预测值都为负的情况的数量。</p><p id="74dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们借助一个例子来理解这一点…</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="b2cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述代码的输出如下</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/022f8d6add4013bb633bb34e05534070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*cGUF2ibrnl4ZPU3Or3WgoA.png"/></div></figure><p id="37d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述混淆矩阵的不同值说明了以下问题:</p><ol class=""><li id="e874" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated">真阳性= 65，表示有65个案例实际上是阳性的，并且它们的预测值也是阳性的，这些被模型正确分类。</li><li id="e549" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">假阳性= 7，表示有7个病例被错误地分类为阳性。</li><li id="a7de" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">假阴性= 4，表示有4种情况应该是阳性的，但它们被模型预测为阴性。</li><li id="b46d" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">真阴性= 38，表示有38个病例为阴性，并被正确预测为阴性。</li></ol><p id="0bd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看可以从混淆矩阵中得到的更精确的度量。</p><h2 id="8760" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">准确(性)</h2><p id="2de5" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这一术语说明了模型的表现如何，它从预测总数中正确预测了多少个实例。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/81ce2da689ace82fe8e13087b26c9d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*xiqLh2ytqOTvPuDgwE74DA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Google Image</figcaption></figure><p id="c36d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从数学上来说，精确度被定义为总正和总负的总和除以总预测的总和。<br/>在这种情况下，精度将为<strong class="jp ir"> 0.90 </strong></p><h2 id="6c89" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">精确</h2><p id="6b6c" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这个术语告诉我们有多少预测的阳性病例实际上是阳性的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/6c991604b6e33699abc281dc727ed991.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*c8iFno0ErX4DlptWr28IZw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Google Image</figcaption></figure><p id="8de5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，精度将为<strong class="jp ir"> 0.90 </strong></p><h2 id="e7da" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">回忆</h2><p id="56d5" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">召回被称为<strong class="jp ir">灵敏度</strong>或<strong class="jp ir">真阳性率</strong>。这一术语表示在实际的阳性病例中，模型正确预测了多少病例。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/51c14525423b3931eba62dd48d4ddbf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*Vo-UMX5qTY_XB9rL2yp6uw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Google Image</figcaption></figure><p id="f33e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，召回将是<strong class="jp ir"> 0.94 </strong></p><p id="d70e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些指标都有它们自己的重要性，对于某些问题，召回优于精确，在某些情况下，精确优于召回。</p><p id="6e70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">召回是首选，在那些假阴性可能有害的情况下，如在医疗中，<strong class="jp ir">假阴性</strong>可能被证明是危险的，在医疗情况下，<strong class="jp ir">实际阳性</strong>不应未被发现。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/c66193ec51cb1f5bf0c30f3bfad4d2db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZ3FQtqpcC15GjPubqGdKA.jpeg"/></div></div></figure><h2 id="4a98" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">出错率</h2><p id="44c3" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这个术语表示在分类总数中有多少个案例被错误分类。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b8d8e1a298c6f49c56c355dea6ec9183.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*oGyJ-52glbZtR13mjoX3jQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Google Image</figcaption></figure><p id="f0bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，错误率将是<strong class="jp ir"> 0.09 </strong></p><h2 id="3218" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">f值(F1值)</h2><p id="72e6" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">当我们不知道在召回率和准确率之间应该优先选择什么的时候。然后结合这两个指标。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e40afb618614d6efe582a87a35652040.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*IVJ4o65X52vVlzcooaipyA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Google Image</figcaption></figure><p id="96f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是召回率和精确度之间的权衡。它的<strong class="jp ir">谐音表示</strong>的召回和精确。当精度等于召回率时，它是最大的。<br/>在我们的例子中，F1分数将是<strong class="jp ir"> 0.92 </strong></p><h1 id="f63d" class="mw lc iq bd ld mx my mz lg na nb nc lj nd ne nf lm ng nh ni lp nj nk nl ls nm bi translated">结论</h1><p id="bd66" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">有许多度量来评估分类模型的性能。但是根据模型选择正确的度量是重要的一步。通常我们使用<strong class="jp ir">准确性</strong>作为通用指标，但是正如我们所看到的<strong class="jp ir">精确度</strong>、<strong class="jp ir">召回</strong>和<strong class="jp ir"> F1分数</strong>也是重要的指标，可以更好地理解模型并产生更好的结果。</p><p id="6fea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢并欣赏这本书，👏👏鼓掌，分享。</p><p id="942b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里找到 的代号<a class="ae nn" href="https://github.com/pranavkriya/statistics/blob/main/confusion_matrix.ipynb" rel="noopener ugc nofollow" target="_blank">。<br/>可以在</a><a class="ae nn" href="https://www.linkedin.com/in/pranavgarg1506/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Linkedin</strong></a><strong class="jp ir">上联系我。</strong></p></div></div>    
</body>
</html>