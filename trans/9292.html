<html>
<head>
<title>How to Transform Machine Learning Models into Native Code with Zero Dependencies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将机器学习模型转换成零依赖的本机代码</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-transform-machine-learning-models-into-native-code-with-zero-dependencies-597d01684a9f?source=collection_archive---------21-----------------------#2021-02-05">https://medium.datadriveninvestor.com/how-to-transform-machine-learning-models-into-native-code-with-zero-dependencies-597d01684a9f?source=collection_archive---------21-----------------------#2021-02-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c1f9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将训练好的ML模型转换成你选择的编程语言。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/372c3f7bf66fa48881c1386d9c76372b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHTElPtndtY_rR2za9vQ6Q.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image by <a class="ae kv" href="https://pixabay.com/users/monsterkoi-65294/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2817950" rel="noopener ugc nofollow" target="_blank">Monsterkoi</a> from <a class="ae kv" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2817950" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="e704" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大多数训练好的机器学习模型都保存为<a class="ae kv" href="https://machinelearningmastery.com/save-load-machine-learning-models-python-scikit-learn/" rel="noopener ugc nofollow" target="_blank"> pickle文件</a>。这种文件类型是Python中序列化和反序列化对象的标准方式。</p><p id="b0da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了进行预测，您需要加载已保存的定型模型，然后根据提供的输入执行预测。</p><p id="3a22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，您将学习如何使用<strong class="ky ir"> m2cgen </strong> Python库将训练好的机器学习模型转换成零依赖的本机代码(例如Python、PHP或JavaScript)。然后你会根据它做出预测。</p><h1 id="941f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是m2cgen Python库？</h1><p id="f261" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">m2cgen (Model 2 Code Generator)是一个简单的Python库，可以将经过训练的机器学习模型转换成不同的编程语言。</p><p id="97bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，您可以从Scikit-learn库中训练您的机器学习模型，然后将其转换为您选择的编程语言。</p><p id="f9a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果要将模型部署到无法安装Python堆栈来支持模型预测的环境中，这个库非常有用。</p><h1 id="1138" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">m2cgen库支持的语言</h1><p id="97cb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/BayesWitnesses/m2cgen" rel="noopener ugc nofollow" target="_blank"> M2cgen </a>支持14种不同的编程语言:</p><ul class=""><li id="b759" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">C</li><li id="3b9d" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">C#</li><li id="7095" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">镖</li><li id="0656" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">F#</li><li id="c0a7" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">去</li><li id="b2ef" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">哈斯克尔</li><li id="e342" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Java 语言(一种计算机语言，尤用于创建网站)</li><li id="b7ac" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Java Script语言</li><li id="1767" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">服务器端编程语言（Professional Hypertext Preprocessor的缩写）</li><li id="33cb" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">PowerShell</li><li id="52a2" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">计算机编程语言</li><li id="8901" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">稀有</li><li id="5abc" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">红宝石</li><li id="25fe" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Visual Basic(与VBA兼容)</li></ul><h1 id="86d8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">m2cgen库支持的模型</h1><p id="78f9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该库支持来自Scikit-learn的不同回归和分类模型，以及不同的梯度增强框架，如XGBoost和LightGBM(轻梯度增强机器)。</p><p id="6e83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想了解其他受支持的型号，请点击这里:<a class="ae kv" href="https://github.com/BayesWitnesses/m2cgen#supported-models" rel="noopener ugc nofollow" target="_blank">https://github.com/BayesWitnesses/m2cgen#supported-models</a>。</p><h1 id="40b6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何安装m2cgen Python库</h1><p id="0721" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要安装m2cgen，请在终端中运行以下命令:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="2b65" class="ni lt iq ne b gy nj nk l nl nm">pip install m2cgen</span></pre><p id="1772" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，Python版本&gt; = <strong class="ky ir"> 3.6 </strong>支持m2cgen <strong class="ky ir"> </strong>。</p><h1 id="c473" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何使用m2cgen Python库</h1><p id="bf56" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在以下示例中，我们将使用贷款数据集，通过LogisticRegression算法创建一个简单的机器学习模型。该算法将能够预测客户是否有资格获得贷款金额。</p><p id="da85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们将使用m2cgen库将训练好的模型转换成Python、PHP和JavaScript。你可以在这里下载数据集<a class="ae kv" href="https://github.com/Davisy/Convert-Trained-ML-Models-To-Native-Code/tree/main/data" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8dad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们开始吧！🚀</p><p id="c3ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此用例导入以下重要包:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="13b2" class="ni lt iq ne b gy nj nk l nl nm">import pandas as pd<br/>import numpy as np                     <br/>from sklearn.preprocessing import StandardScaler, LabelEncoder<br/>from sklearn.model_selection import train_test_split <br/>from sklearn.linear_model import LogisticRegression<br/>import m2cgen as m2c <br/>import warnings                        # To ignore any warnings<br/>warnings.filterwarnings("ignore")</span></pre><p id="02fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过以下命令使用Pandas加载贷款数据集:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="b15f" class="ni lt iq ne b gy nj nk l nl nm">data = pd.read_csv("data/loans_data.csv")</span></pre><p id="0822" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后显示数据集中所有列的列表:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="2d1d" class="ni lt iq ne b gy nj nk l nl nm">list(data.columns)</span></pre><p id="6ed3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些是我们感兴趣的列:</p><p id="9230" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Loan_ID <br/>性别<br/>已婚<br/>家眷<br/>学历<br/>个体户<br/>申请人收入<br/>共同申请人收入<br/>贷款金额<br/>贷款_金额_期限<br/>信用_历史<br/>房产_面积<br/>贷款_状态</p><p id="b45a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们有12个独立的特性和一个目标(<strong class="ky ir"> Loan_Status) </strong>。您可以在此处阅读每个功能的描述:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/507a0ab948afb873428b853da043358b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/0*oGNWDHj_omjQDcMM.png"/></div></figure><p id="731b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是数据集中的前5行:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="10fd" class="ni lt iq ne b gy nj nk l nl nm">#show the first 5 rows of the dataset<br/>data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/3d27c5766324079521ce59c774b77617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Za1YbuI8GKO2gNcX.PNG"/></div></div></figure><p id="1e93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，数据集有一些缺失数据和分类特征需要转换为数值。下面是一个简单的Python函数，它将帮助我们处理缺失数据和特征工程。然后它将返回处理过的特征和目标。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="e684" class="ni lt iq ne b gy nj nk l nl nm"># preprocessing the dataset.</span><span id="47be" class="ni lt iq ne b gy np nk l nl nm">def preprocessing(data):</span><span id="2376" class="ni lt iq ne b gy np nk l nl nm">    # replace with numerical values<br/>    data['Dependents'].replace('3+', 3,inplace=True)<br/>    data['Loan_Status'].replace('N', 0,inplace=True)<br/>    data['Loan_Status'].replace('Y', 1,inplace=True)</span><span id="8c8a" class="ni lt iq ne b gy np nk l nl nm">    # handle missing data <br/>    data['Gender'].fillna(data['Gender'].mode()[0], inplace=True)<br/>    data['Married'].fillna(data['Married'].mode()[0], inplace=True)<br/>    data['Dependents'].fillna(data['Dependents'].mode()[0], inplace=True)<br/>    data['Self_Employed'].fillna(data['Self_Employed'].mode()[0], inplace=True)<br/>    data['Credit_History'].fillna(data['Credit_History'].mode()[0], inplace=True)<br/>    data['Loan_Amount_Term'].fillna(data['Loan_Amount_Term'].mode()[0], inplace=True)<br/>    data['LoanAmount'].fillna(data['LoanAmount'].median(), inplace=True)</span><span id="352f" class="ni lt iq ne b gy np nk l nl nm">    # drop ID column<br/>    data = data.drop('Loan_ID',axis=1)<br/>    <br/>    #split features and target <br/>    X = data.drop('Loan_Status',axis=1)<br/>    y = data.Loan_Status.values</span><span id="f662" class="ni lt iq ne b gy np nk l nl nm">    #scale the  features <br/>    X  = pd.get_dummies(X,columns=["Gender","Married","Education","Self_Employed","Property_Area"])<br/>    X = StandardScaler().fit_transform(X)<br/>    </span><span id="dca8" class="ni lt iq ne b gy np nk l nl nm">    return X,y</span></pre><p id="5083" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们对贷款数据集进行预处理。它将返回已处理的要素和目标。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="52e9" class="ni lt iq ne b gy nj nk l nl nm">X,y = preprocessing(data)</span></pre><p id="ed52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们使用Scikit-learn的<code class="fe nq nr ns ne b">train_test_split</code>函数将处理后的数据分成训练和测试数据集。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="a146" class="ni lt iq ne b gy nj nk l nl nm"># split into train and test set <br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1)</span></pre><p id="050e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们创建LogisticRegression模型并将其训练到我们的训练集中。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="fe93" class="ni lt iq ne b gy nj nk l nl nm"># create and train the classifier </span><span id="bc0b" class="ni lt iq ne b gy np nk l nl nm">classifier = LogisticRegression()</span><span id="9611" class="ni lt iq ne b gy np nk l nl nm">classifier.fit(X_train,y_train)</span></pre><h1 id="3d26" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何将训练好的模型转换成Python代码</h1><p id="0312" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">m2cgen库提供了将训练好的模型转换成上述任何一种支持的语言的方法。在这个例子中，我们将通过使用来自m2cgen的<code class="fe nq nr ns ne b">export_to_python()</code>方法将训练好的模型转换成Python。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="74bc" class="ni lt iq ne b gy nj nk l nl nm"># convert model to pure python code  <br/>model_to_python = m2c.export_to_python(classifier)</span></pre><p id="791c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是用Python代码表示的训练模型:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="d570" class="ni lt iq ne b gy nj nk l nl nm">#pure python code </span><span id="a7e4" class="ni lt iq ne b gy np nk l nl nm">def score(input):<br/>    <br/>    return (((((((((((((((((0.7929123964945446) + ((input[0]) * (0.07801862594632314))) + ((input[1]) * (-0.014853900985478468))) + ((input[2]) * (-0.15783041201914427))) + ((input[3]) * (-0.05222073553791883))) + ((input[4]) * (-0.0787403404504791))) + ((input[5]) * (1.3714807410150505))) + ((input[6]) * (0.015077765348160292))) + ((input[7]) * (-0.015077765348160353))) + ((input[8]) * (-0.12161041350915254))) + ((input[9]) * (0.12161041350915253))) + ((input[10]) * (0.09387440269562626))) + ((input[11]) * (-0.09387440269562626))) + ((input[12]) * (-0.0047109053878701835))) + ((input[13]) * (0.004710905387870008))) + ((input[14]) * (-0.14569247529698154))) + ((input[15]) * (0.19858601990225683))) + ((input[16]) * (-0.06417592734444703))</span></pre><p id="9125" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它生成的Python函数代码将接收输入数据，然后执行预测。现在让我们测试生成的Python代码。</p><p id="a44a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将首先根据实际训练的模型进行预测。以下是我们将从测试集中使用的样本测试数据:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="f90d" class="ni lt iq ne b gy nj nk l nl nm">test_data = X_test[6]<br/>print(test_data)</span></pre><p id="d41b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数组([ 1.24474546，1.9817189，-0.55448733，3.02536229，0.2732313，0.41173269，-0.47234264，0.47234264，-0.72881553，0.72881553，0.52836225，-0.525。</p><p id="5b32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们用实际训练好的模型进行预测。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="18f9" class="ni lt iq ne b gy nj nk l nl nm">pred = classifier.predict(test_data.reshape(1,-1))  <br/>print("prediction result: {}".format(pred))</span></pre><p id="7da0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">预测结果:[1]</p><p id="0b9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">模型预测为<strong class="ky ir"> 1 </strong>，表示客户有资格获得贷款金额。</p><p id="1868" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用相同的测试数据在生成的纯Python代码中执行预测，并评估它是否会给出相同的预测。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="8a6f" class="ni lt iq ne b gy nj nk l nl nm"># test prediction in pure python code <br/>input = [ 1.24474546,  1.9817189 , -0.55448733,  3.02536229,  0.2732313 ,<br/>        0.41173269, -0.47234264,  0.47234264, -0.72881553,  0.72881553,<br/>        0.52836225, -0.52836225, -2.54711697,  2.54711697,  1.55889948,<br/>       -0.7820157 , -0.70020801]</span><span id="c95d" class="ni lt iq ne b gy np nk l nl nm">pred = score(input) <br/>print("prediction result: {}".format(int(pred)))</span></pre><p id="fe88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">预测结果:1</p><p id="9321" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">纯Python代码也提供了相同的预测结果。</p><h1 id="a3bb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何将训练好的模型转换成PHP代码</h1><p id="d3d3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将使用来自m2cgen的<code class="fe nq nr ns ne b">export_to_php()</code>方法将训练好的模型转换成纯PHP代码。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="5ab6" class="ni lt iq ne b gy nj nk l nl nm"># convert model to pure PHP code  <br/>model_to_php = m2c.export_to_php(classifier)</span></pre><p id="dbbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是用PHP代码表示的经过训练的模型:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="e80c" class="ni lt iq ne b gy nj nk l nl nm">function score(array $input)<br/>{<br/>    return (((((((((((((((((0.8166973302490392) + (($input[0]) * (0.035269518507829584))) + (($input[1]) * (0.05203333118549156))) + (($input[2]) * (-0.13217178253938103))) + (($input[3]) * (-0.13136526173536608))) + (($input[4]) * (-0.024875019809902837))) + (($input[5]) * (1.2864103414352563))) + (($input[6]) * (-0.005259373701309709))) + (($input[7]) * (0.005259373701309715))) + (($input[8]) * (-0.11512289603368371))) + (($input[9]) * (0.11512289603368378))) + (($input[10]) * (0.06905305123713898))) + (($input[11]) * (-0.06905305123713898))) + (($input[12]) * (0.021080906307735767))) + (($input[13]) * (-0.02108090630773594))) + (($input[14]) * (-0.14491490189610398))) + (($input[15]) * (0.2189862115713242))) + (($input[16]) * (-0.08599736364921017));<br/>}</span></pre><p id="c24e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用相同的测试数据在生成的纯PHP代码中执行预测，并评估它是否会给出相同的预测:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="d0ab" class="ni lt iq ne b gy nj nk l nl nm"># test prediction in pure PHP code<br/>$input = [1.24474546, 1.9817189, -0.55448733, 3.02536229, 0.2732313,<br/>    0.41173269, -0.47234264, 0.47234264, -0.72881553, 0.72881553,<br/>    0.52836225, -0.52836225, -2.54711697, 2.54711697, 1.55889948,<br/>    -0.7820157, -0.70020801];</span><span id="f4cf" class="ni lt iq ne b gy np nk l nl nm">// perform predition with pure php code<br/>$pred = score($input);<br/></span><span id="0f41" class="ni lt iq ne b gy np nk l nl nm">echo "Predicton result: ". round($pred);</span></pre><p id="183d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">预测结果:1</p><p id="569c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">纯PHP代码也提供了相同的预测结果。</p><h1 id="81a4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何将训练好的模型转换成JavaScript代码</h1><p id="6884" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在我们的最后一个例子中，我们将使用m2cgen的<code class="fe nq nr ns ne b">export_to_javascript()</code>方法将训练好的模型转换成纯JavaScript代码。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="7895" class="ni lt iq ne b gy nj nk l nl nm"># convert model to pure Javascript code  <br/>model_to_javascript = m2c.export_to_javascript(classifier)</span></pre><p id="b68e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是用JavaScript代码表示的经过训练的模型:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="cffb" class="ni lt iq ne b gy nj nk l nl nm">function score(input)<br/>{<br/>    return (((((((((((((((((0.8166973302490392) + ((input[0]) * (0.035269518507829584))) + ((input[1]) * (0.05203333118549156))) + ((input[2]) * (-0.13217178253938103))) + ((input[3]) * (-0.13136526173536608))) + ((input[4]) * (-0.024875019809902837))) + ((input[5]) * (1.2864103414352563))) + ((input[6]) * (-0.005259373701309709))) + ((input[7]) * (0.005259373701309715))) + ((input[8]) * (-0.11512289603368371))) + ((input[9]) * (0.11512289603368378))) + ((input[10]) * (0.06905305123713898))) + ((input[11]) * (-0.06905305123713898))) + ((input[12]) * (0.021080906307735767))) + ((input[13]) * (-0.02108090630773594))) + ((input[14]) * (-0.14491490189610398))) + ((input[15]) * (0.2189862115713242))) + ((input[16]) * (-0.08599736364921017));<br/>}</span></pre><p id="f679" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用相同的测试数据在生成的纯JavaScript代码中执行预测，并评估它是否会给我们相同的预测。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="1de6" class="ni lt iq ne b gy nj nk l nl nm">// perform predition with pure Javascript code<br/>let input =  [1.24474546, 1.9817189, -0.55448733, 3.02536229, 0.2732313,<br/>    0.41173269, -0.47234264, 0.47234264, -0.72881553, 0.72881553,<br/>    0.52836225, -0.52836225, -2.54711697, 2.54711697, 1.55889948,<br/>    -0.7820157, -0.70020801];</span><span id="757e" class="ni lt iq ne b gy np nk l nl nm">let pred = score(input);</span><span id="fbbd" class="ni lt iq ne b gy np nk l nl nm">console.log("Prediction results:",Math.round(pred));</span></pre><p id="2337" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">"预测结果:"，1</p><p id="aa38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">纯JavaScript代码也提供了相同的预测结果。</p><h1 id="888a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">包扎</h1><p id="84e0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">有时，与原始的Python训练的ML模型相比，由m2cgen库生成的本机代码可以提供不同的结果。以下是该库开发者的简要解释:</p><blockquote class="nt nu nv"><p id="dd23" class="kw kx nw ky b kz la jr lb lc ld ju le nx lg lh li ny lk ll lm nz lo lp lq lr ij bi translated"><em class="iq">"一些模型在其原生Python库中的预测阶段强制输入数据为特定类型。目前，m2cgen只能处理</em> <code class="fe nq nr ns ne b"><em class="iq">float64</em></code> <em class="iq"> ( </em> <code class="fe nq nr ns ne b"><em class="iq">double</em></code> <em class="iq">)数据类型。您可以尝试手动将输入数据转换为另一种类型，然后再次检查结果。此外，由于目标语言中浮点运算的具体实现，可能会出现一些小的差异。”(</em> <a class="ae kv" href="https://github.com/BayesWitnesses/m2cgen" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="iq">来源:Github资源库</em> </strong> </a> <em class="iq"> ) </em></p></blockquote><p id="29f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面提到的例子中，我使用<code class="fe nq nr ns ne b">int()</code>代表<strong class="ky ir"> Python </strong>，使用<code class="fe nq nr ns ne b">round()</code>代表<strong class="ky ir"> PHP </strong>，使用<code class="fe nq nr ns ne b">Math.round()</code>代表<strong class="ky ir"> JavaScript </strong>，将预测结果从<em class="nw"> float </em>数据类型转换为<em class="nw"> integer </em>数据类型。</p><p id="3255" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">恭喜你，你已经完成了这篇文章的结尾！</p><p id="a526" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在这里下载本文中使用的数据集、笔记本和脚本文件:<a class="ae kv" href="https://github.com/Davisy/Convert-Trained-ML-Models-To-Native-Code" rel="noopener ugc nofollow" target="_blank">https://github . com/Davisy/Convert-Trained-ML-Models-To-Native-Code</a></p><p id="ee82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你学到了新的东西或者喜欢阅读这篇文章，请分享给其他人看。在那之前，下期帖子再见！也可以通过Twitter <a class="ae kv" href="https://twitter.com/Davis_McDavid" rel="noopener ugc nofollow" target="_blank"> @Davis_McDavid </a>联系到我。</p><p id="4c5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文首发于f <a class="ae kv" href="https://www.freecodecamp.org/news/transform-machine-learning-models-into-native-code-with-zero-dependencies/" rel="noopener ugc nofollow" target="_blank"> reecodecamp </a>。</p><p id="abd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="nw">最后一件事:</em> </strong> <em class="nw">在下面的链接里多看看类似这样的文章。</em></p><div class="oa ob gp gr oc od"><a href="https://towardsdatascience.com/how-to-detect-and-translate-languages-for-nlp-project-dfd52af0c3b5" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">如何为NLP项目检测和翻译语言</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">从具有多种语言的文本数据到单一语言</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="on l oo op oq om or kp od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://towardsdatascience.com/how-to-deploy-machine-learning-model-in-laravel-application-5e021494d316" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">如何在Laravel应用中部署机器学习模型</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">从Algorithmia调用模型API并在Laravel中预测</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="os l oo op oq om or kp od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://medium.com/datadriveninvestor/how-to-deploy-your-nlp-model-to-production-as-an-api-with-algorithmia-e4081854d524" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">如何使用Algorithmia将您的NLP模型作为API部署到生产中</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">一种在无服务器产品上逐步部署NLP模型的简单方法。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="ot l oo op oq om or kp od"/></div></div></a></div></div></div>    
</body>
</html>