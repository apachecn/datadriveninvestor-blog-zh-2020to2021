<html>
<head>
<title>How To Get Stock Quotes from Indexes With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python从指数中获取股票报价</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-get-stock-quotes-from-indexes-with-python-4818a5954642?source=collection_archive---------6-----------------------#2021-01-24">https://medium.datadriveninvestor.com/how-to-get-stock-quotes-from-indexes-with-python-4818a5954642?source=collection_archive---------6-----------------------#2021-01-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9e9c9520dc87d92e5d33d29d6504c331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*20VPhdtKUH1St-YGz5sLqQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://www.pexels.com/@n-voitkevich?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Nataliya Vaitkevich</a> from <a class="ae kf" href="https://www.pexels.com/photo/magnifying-glass-on-white-paper-6120207/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="9897" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你是一个对日交易和股票投资感兴趣的投资者，那么你肯定也在寻找有效的方法来自动进行股票分析，甚至开发定制交易或投资策略的工具。</p><p id="47b4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以我的软件工程背景，我也不例外！</p><p id="1ebe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如今，准确的数据是金融市场参与者最宝贵的资产。因此，它不便宜。</p><p id="ec39" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">雅虎财经和谷歌财经不再允许开发者访问他们的全部API。因此，现在在处理金融参考数据时，很大一部分努力是获得股票指数的像样的成分数据。例如，就我的目的而言，我再也不能轻易地找出以下美国指数的股票代码列表了:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi le"><img src="../Images/8913079c9bcf3347ac580e01a3f3ecf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xsQgS3CPAa754DHB75WARw.png"/></div></div></figure><p id="38d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你定期或不时进行日间交易，或者使用更高级的衍生品交易策略，你就会明白每天筛选市场和查看主要股票指数中的公司列表进行分析是多么重要。</p><p id="83fb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我的例子中，<strong class="ki iu">我需要美国股票的代码/符号来实现我的股票筛选程序。</strong>这将允许我为即将到来的盘中交易选择最好的股票。现有解决方案的问题是:</p><p id="4e65" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">‣:它们通常很贵(每月95美元起)</p><p id="373e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">‣:他们有很多我的策略不需要的数据</p><p id="9fbe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不幸的是，免费的实时数据提供商所剩无几。尽管如此，Alpha Vantage是数据提供商之一，它允许在升级之前每天通过他们的API发送500个请求，这足以让我实现我需要的工具。</p><p id="f2db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想了解更多关于我将为我的投资和交易策略实施或购买什么样的工具，你可以<a class="ae kf" href="https://ilonacodes.com/financial-tips-for-freeing-extra-money-for-investment/" rel="noopener ugc nofollow" target="_blank">加入我的定期简讯(+奖金:每月释放更多现金的15大技巧)。</a></p><p id="f801" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我的股票筛选程序是一个可以根据特定标准筛选股票的程序。为了遍历所有股票，我需要获取大多数美国股票代码的列表。</p><p id="17df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有几种方法可以从金融网站获取这些数据，将其硬编码为列表，或者直接从维基百科或其他索引网站请求索引数据。在从web页面获取数据之前，我检查了数据在HTML标记中的位置，以找到其中包含的表标记。尽管如此，我决定让它变得更简单，只是下载了<strong class="ki iu">。S &amp; P500，纳斯达克等的html </strong>页面。，将股票符号放入表格中:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="8a5a" class="lo lp it lk b gy lq lr l ls lt">import pandas as pd</span><span id="207a" class="lo lp it lk b gy lu lr l ls lt">sp_table = pd.read_html(‘sp500.html’)<br/>sp = sp_table[0]<br/>sp.to_csv(‘sp500-symbols.csv’, columns=[‘Symbol’])</span><span id="bbba" class="lo lp it lk b gy lu lr l ls lt">sp = pd.read_csv(‘sp500-symbols.csv’)<br/>sp_symbols = sp[‘Symbol’].to_list()<br/>print(sp_symbols)</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lv"><img src="../Images/3c51dc0ce29eaa5bfbf7f617f8c67b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUOjk7VmfVR_3nmqucJd6w.png"/></div></div></figure><p id="205d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> read_html </strong>函数正在抓取存储的与S &amp; P500数据相关的网页，并返回DataFrame对象的列表。在我的例子中，我只愿意从“Symbol”列获取数据:索引为0的DataFrame对象。然后，我使用<strong class="ki iu"> to_csv </strong>函数将结果表提取到我的项目目录中。接下来，<strong class="ki iu"> to_list </strong>函数将表格的数据转换成列表类型。</p><p id="ed90" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对纳斯达克的股票列表做同样的事情:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="8c94" class="lo lp it lk b gy lq lr l ls lt">nasdaq_table = pd.read_html(‘nasdaq.html’)<br/>nasdaq = nasdaq_table[0]<br/>nasdaq.to_csv(‘nasdaq-symbols.csv’, columns=[‘Symbol’])</span><span id="1966" class="lo lp it lk b gy lu lr l ls lt">nasdaq = pd.read_csv(‘nasdaq-symbols.csv’)<br/>nasdaq_symbols = nasdaq[‘Symbol’].to_list()<br/>print(nasdaq_symbols)</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lw"><img src="../Images/bda06c60ea7063e3a00544c9525c77d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NGA9UEj0IdmLgxXdVC0kQ.png"/></div></div></figure><p id="3ed6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以继续从存储的网页中提取不同股票指数的符号。最后一步是将股票符号连接成一个列表:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="8b82" class="lo lp it lk b gy lq lr l ls lt">all_symbols = sp_symbols + nasdaq_symbols<br/>print(all_symbols)</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/64e9f900a3f9855c6569b7354966a1a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-K4dEYFHX1L_WhZ_PTTJg.png"/></div></div></figure><p id="cc13" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个代码应该能够抓取股票指数中大多数符号的细节。</p><p id="b734" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">连接的数据可以保存为CSV或JSON文件。您也可以将数据连接到MySQL数据库，而不是将数据写入任何文件。</p><p id="3b48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你在交易、投资和金融领域，你可能应该关注各种股票市场上的成千上万只股票。有时候，获得<em class="ly">“ABC公司的股票代码”</em>并不是你唯一需要的，大多数API都允许你免费这样做。</p><p id="59bc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下一篇文章中，我将向您展示如何将从指数中提取的股票符号应用到我实现的工具中，为我的一个交易策略找到明确定义的进场点和出场点。</p><p id="f599" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi">___</p><p id="b90c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ly">免责声明:作者的观点仅代表其个人观点，不以任何方式构成财务建议。作者发布的任何内容都不构成投资建议，作者发布的任何数据或内容也不应作为任何投资活动的依据。</em></p></div></div>    
</body>
</html>