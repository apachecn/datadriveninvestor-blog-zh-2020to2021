<html>
<head>
<title>Digit Classification with MNIST Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于MNIST数据集的数字分类</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-i-learned-to-code-an-ai-in-a-week-81430939d799?source=collection_archive---------14-----------------------#2021-01-20">https://medium.datadriveninvestor.com/how-i-learned-to-code-an-ai-in-a-week-81430939d799?source=collection_archive---------14-----------------------#2021-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ad12982cbf1d240ba4d01ab6e91ec847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7v03tp3jiGDlaAt9.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://www.surveycto.com/blog/how-artificial-intelligence-is-changing-development/" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="9603" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们都经历过——害怕失败，因为自我怀疑而停滞不前，等待难以捉摸或正确的时机来唤醒我们麻痹的大脑。事实是，永远没有“正确”的时机。<em class="lb">只管去做，不要多想。</em></p><p id="6c37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">寒假期间，我设定了一个目标，要完成一门人工智能课程，并编写一个人工智能程序。哈哈，但是我有吗？没有。虽然我在寒假期间很有效率，但我几乎做了所有的事情，除了编写一个人工智能！我花了几个小时浏览关于人工智能的文章和研究论文，但从未真正动手，因为我觉得自己还没有“准备好”，而且我的编码技能<strong class="kf ir">几乎不存在……</strong></p><h2 id="7e4a" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">我的方法是什么？</h2><ul class=""><li id="4cc7" class="lv lw iq kf b kg lx kk ly ko lz ks ma kw mb la mc md me mf bi translated">首先，我通过这门<a class="ae kc" href="https://www.udemy.com/course/python-for-data-science-and-machine-learning-bootcamp/" rel="noopener ugc nofollow" target="_blank">课程</a>学习了python的基础知识</li><li id="7226" class="lv lw iq kf b kg mg kk mh ko mi ks mj kw mk la mc md me mf bi translated">我上了几堂课，然后看了/读了一堆代码</li><li id="9251" class="lv lw iq kf b kg mg kk mh ko mi ks mj kw mk la mc md me mf bi translated">还看了一堆教程比如<a class="ae kc" href="https://www.youtube.com/watch?v=iqQgED9vV7k" rel="noopener ugc nofollow" target="_blank">手写数字的神经网络</a>，<a class="ae kc" href="https://www.youtube.com/watch?v=rml9oBQT8rw" rel="noopener ugc nofollow" target="_blank">用TensorFlow识别数字</a></li></ul><p id="280d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">令人惊讶的是，我确实理解了神经网络是如何工作的！！我去开始复制:)</p><h2 id="af3c" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">基于张量流的MNIST数字分类</h2><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/693652d011ccad5c56c710cd3b6b3ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/0*Y54WcXdHRK48Edkx.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Image by <a class="ae kc" href="https://en.wikipedia.org/wiki/MNIST_database#/media/File:MnistExamples.png" rel="noopener ugc nofollow" target="_blank">Josef Steppan</a></figcaption></figure><p id="2c56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我只是很高兴我的模型可以在我的GPU上运行，否则它可能会花费我更长的时间，但本质上，创建这个神经网络的目的是训练它，以便它可以将图像与它们相应的标签(包括数字0-9)匹配。MNIST数据集由数字介于0和9之间的28 x 28像素灰度图像组成。它有60，000个训练集和10，000个测试集。它总共有70，000张图片，这使它成为训练我的神经网络的一个很好的数据集。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/4b61450e8326b885d2a1cd2252a1eb4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*ZyQnr8R7GHDCHON73PRv0g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://ip.cadence.com/applications/cnn" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><pre class="mm mn mo mp gt mr ms mt mu aw mv bi"><span id="ca2d" class="lc ld iq ms b gy mw mx l my mz">import tensorflow as tf<br/>from tensorflow import keras<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>import numpy as np<br/>mnist = tf.keras.datasets.mnist</span></pre><p id="4e03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我开始导入所有需要的库，以及导入MNIST数据集(它已经包含在Kera的数据集中)。在建立模型之前，我们应该将数据标准化。每个像素是8位，因此每个像素的范围是2⁸ = 256种可能性(不包括零)。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/1119981a94b78142fa776958ddc00c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*0_8XsoIB4PFhDdGKHdRGdQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://hacktildawn.com/2017/05/02/reconstructing-artistic-style/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><pre class="mm mn mo mp gt mr ms mt mu aw mv bi"><span id="fc56" class="lc ld iq ms b gy mw mx l my mz">(training_data, training_labels), (test_data, test_labels) = mnist.load_data()</span><span id="dbcd" class="lc ld iq ms b gy nb mx l my mz">training_data, test_dtat = training_data/255, test_data/255</span></pre><p id="a31d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除以255，我们可以将0–255数据范围表示为0.0–1.0之间的数字。</p><pre class="mm mn mo mp gt mr ms mt mu aw mv bi"><span id="a6b3" class="lc ld iq ms b gy mw mx l my mz">model = tf.keras.Sequential ([</span><span id="5605" class="lc ld iq ms b gy nb mx l my mz"><strong class="ms ir">tf.keras.layers.Flatten(input_shape=(28,28)),</strong></span><span id="4399" class="lc ld iq ms b gy nb mx l my mz"><strong class="ms ir">tf.keras.layers.Dense(128, activation=tf.nn.relu),</strong></span><span id="da2f" class="lc ld iq ms b gy nb mx l my mz"><strong class="ms ir">tf.keras.layers.Dense(128, activation=tf.nn.relu),</strong></span><span id="5b04" class="lc ld iq ms b gy nb mx l my mz"><strong class="ms ir">tf.keras.layers.Dense(10, activation=tf.nn.softmax)</strong></span><span id="1b75" class="lc ld iq ms b gy nb mx l my mz">])</span></pre><p id="a8be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该部分是我们开始构建神经网络的时候——基于具有密集层的顺序模型。网络的第一层由784个节点组成。这是因为它采用28乘28的图像，并将其“展平”。本质上，展平过程将二维矩阵转换为向量。28 = 784.所以第一层有784个节点。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/cc77c5504b03a8e596043e9cc94318b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ObtuVY31HlWkSshA"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://towardsdatascience.com/a-simple-guide-to-convolutional-neural-networks-751789e7bd88" rel="noopener" target="_blank">Source</a></figcaption></figure><p id="b852" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">加粗的第二和第三行/层是具有128个节点的隐藏层。最后，输出层有10个节点，每个节点对应0到9之间的一个数字。</p><pre class="mm mn mo mp gt mr ms mt mu aw mv bi"><span id="3a73" class="lc ld iq ms b gy mw mx l my mz">model.compile(optimizer= tf.optimizers.Adam(),</span><span id="a269" class="lc ld iq ms b gy nb mx l my mz">loss='sparse_categorical_crossentropy',</span><span id="e881" class="lc ld iq ms b gy nb mx l my mz">metrics=['accuracy'])</span></pre><p id="a72f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型从随机权重开始，这可能导致不准确的结果，因此实现了优化器。优化器是将神经网络的特征改变为权重/学习速率以减少损失的算法/方法。</p><pre class="mm mn mo mp gt mr ms mt mu aw mv bi"><span id="ff36" class="lc ld iq ms b gy mw mx l my mz">model.fit(training_data, training_labels, epochs=10)<br/>y=model.evaluate(test_data, test_labels)</span></pre><p id="2b28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以使用数据集来训练模型。历元数是我们希望模型经历的时间量。请记住，如果将epochs设置得很高，可能会导致过度拟合，因为模型会变得过于适合这个特定的数据集。这就是为什么数据集被分为训练和测试，以便我们可以看到模型在新数据下的表现。就是这样！这里是完整的<a class="ae kc" href="https://colab.research.google.com/drive/1UXMzleTlKwQiWD8PlmG4X36oenCGJ8fj?usp=sharing" rel="noopener ugc nofollow" target="_blank">代码</a>。</p><h2 id="cda6" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">形象化</h2><p id="e3a0" class="pw-post-body-paragraph kd ke iq kf b kg lx ki kj kk ly km kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">让我们做一些运行，但一些可视化！</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/17e3e69f3741dd30ad0f669aac195e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*Hc3lrIAOhyGdM7BiyIZV4Q.png"/></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d04f02d4b46cf043e7bc491584ff6316.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*RR9CK8STDHjKmfuuLG8itg.png"/></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/c2fd722e0edc884a079e02b09d4056fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/1*3VQbj53C02eDULGANSd1Rg.png"/></div></figure><p id="3dfd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而且模特猜对了！本来是7:)毕竟模型准确率97.7%。虽然这是一个相对简单的项目，但我真的很喜欢这样做！</p><p id="e3a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢这篇文章，给它一个👏并在medium上关注我:)另外，请随时在<a class="ae kc" href="https://www.linkedin.com/in/bernice-lien-b40b9014b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上与我联系。</p></div></div>    
</body>
</html>