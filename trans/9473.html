<html>
<head>
<title>Hierarchical Clustering Algorithm Example in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的层次聚类算法示例</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/hierarchical-clustering-algorithm-example-in-python-b1de1e21a04a?source=collection_archive---------4-----------------------#2021-02-11">https://medium.datadriveninvestor.com/hierarchical-clustering-algorithm-example-in-python-b1de1e21a04a?source=collection_archive---------4-----------------------#2021-02-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7ec9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分层聚类使用在数据中查找组的方法，使得实例彼此之间比不同组中的事例更相似。这种相似性度量通常是数据点之间的欧几里得距离，但是也可以使用花旗块距离和测地线距离。</p><p id="e865" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">数据以分层的方式被分解成簇。簇的数量在顶部是0，在底部是最大值。从这个层次结构中选择最佳的集群数量。</p><p id="0b0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有两种主要类型的分层聚类算法:</p><ul class=""><li id="d6a1" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated"><strong class="js iu">凝聚:</strong>自下而上的方法。从许多小集群开始，合并它们以创建更重要的集群。</li><li id="2369" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated"><strong class="js iu">分裂的</strong>——自上而下的方法。从单个集群开始，然后将其分解成更小的集群。</li></ul><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/4db552735d6a764499e51dfaefd887a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/0*_pSsgLU48DwWUOZK.png"/></div></figure><h2 id="212f" class="lk ll it bd lm ln lo dn lp lq lr dp ls kb lt lu lv kf lw lx ly kj lz ma mb mc bi translated">层次聚类的一些利弊<br/>利弊:</h2><ul class=""><li id="374a" class="ko kp it js b jt md jx me kb mf kf mg kj mh kn kt ku kv kw bi translated">不假设特定数量的聚类(即k均值)</li><li id="808a" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">它可能对应于有意义的分类法。</li></ul><h2 id="91c4" class="lk ll it bd lm ln lo dn lp lq lr dp ls kb lt lu lv kf lw lx ly kj lz ma mb mc bi translated">缺点:</h2><ul class=""><li id="1a35" class="ko kp it js b jt md jx me kb mf kf mg kj mh kn kt ku kv kw bi translated">一旦做出整合两个集群的选择，就无法撤销。</li><li id="8abd" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">对于大型数据集太慢，O(𝑛2 log(𝑛))</li></ul><h1 id="eb35" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">它是如何工作的</h1><ol class=""><li id="0b63" class="ko kp it js b jt md jx me kb mf kf mg kj mh kn mz ku kv kw bi translated">使每个数据点成为一个群集。</li></ol><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/6ca92c2b3d9b3e2e2720f9e350e6a470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZrRvjFiearA3LmVG.png"/></div></div></figure><p id="4800" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.取两个最近的聚类，并使它们成为一个聚类。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/eb0df2939a35a30d5f8f072a9ca431f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EG9Tj7sYSwW_5Av0.png"/></div></div></figure><p id="4628" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.重复步骤2，直到只剩下一个集群</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/47505aaadc0425307465c579ba1bba7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xr4oV_qhHMy4dtMq.png"/></div></div></figure><h1 id="978e" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">系统树图</h1><p id="55f1" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">我们可以使用树状图来可视化聚类的历史，并计算出最佳的聚类数。<br/>确定不与任何其他聚类相交的最大垂直距离<br/>在两端画一条水平线<br/>聚类的最佳数量等于穿过水平线的垂直线的数量。<br/>例如，在下面的例子中，聚类数的最佳选择将是4。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ni"><img src="../Images/5d24da4bbc06d1d99e768737d597d2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X4_TpllhA8WLU2px.png"/></div></div></figure><h1 id="fa1b" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">链接标准</h1><p id="8653" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">类似于梯度下降，您可以调整特定的参数，以获得截然不同的结果。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nj"><img src="../Images/ee003c2ca4a6539586ba4e2fdb7c59b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h6f0kOdRHJltf8ro.png"/></div></div></figure><p id="0365" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">链接标准指的是如何计算聚类之间的距离。</p><h1 id="2ab2" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">单键</h1><p id="0701" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">两个聚类之间的距离是每个聚类中两点之间的最小距离。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nk"><img src="../Images/dc5d066d51c90fa0503e5b67a97e26d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*igv0WX5bWwUXg7h1.png"/></div></div></figure><h1 id="73ab" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">完全连锁</h1><p id="8bdc" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">两个聚类之间的距离是每个聚类中两点之间的最大距离。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nl"><img src="../Images/d0cc2996206635eba3950b544ece191d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C7LhhZyXuTWjIHFj.png"/></div></div></figure><h1 id="ebbb" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">平均连锁</h1><p id="5da9" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">聚类之间的距离是一个聚类中的每个点到另一个聚类中的每个特定点之间的平均距离。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nm"><img src="../Images/e93b29a726e76bb0bccd21ab200ea9bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5U1BuGLblSAyMBBk.png"/></div></div></figure><h1 id="1c67" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">病房联动</h1><p id="93fb" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">聚类之间的距离是所有聚类内的平方差之和。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/bd61f0627f2bddc6e5d19097d3bf2094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/0*ZCT6YFHd31IP207p.png"/></div></figure><h1 id="3b31" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">距离度量</h1><p id="2a69" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">您用来计算数据点之间距离的方法将影响最终结果。</p><h1 id="1417" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">欧几里得距离</h1><p id="8da2" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">两点之间的最小距离。例如，如果x=(a，b)且y=(c，d)，则x和y之间的欧几里德距离为√(a c)+(b d)</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2b5b12d9e1fd09de9f7ba757303bbb9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/0*8SqizLe1QuUJaoMG.png"/></div></figure><h1 id="4f9f" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">曼哈顿距离</h1><p id="e293" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">假设你在一个大城市的市中心，想要从A点到b点，你将无法穿过建筑物。相反，你必须在不同的街道上行走。例如，如果x=(a，b)且y=(c，d)，则x和y之间的曼哈顿距离为| a c |+| b d |</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi np"><img src="../Images/8ac21271b8b64a1eb1143e4b88e4b6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Xwm--fuk9RuQLLjY.png"/></div></div></figure><h1 id="4859" class="mi ll it bd lm mj mk ml lp mm mn mo ls mp mq mr lv ms mt mu ly mv mw mx mb my bi translated">python中的示例</h1><p id="edb3" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">让我们看一个真实的例子，看看我们如何使用层次凝聚聚类算法来标注数据。</p><p id="ac40" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我们使用CSV文件，其中包含一个客户列表，包括他们的性别、年龄、年收入和支出分数。</p><p id="6500" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想跟进，你可以从<em class="nq">超级数据科学</em>网站获得数据集。</p><div class="nr ns gp gr nt nu"><a href="https://www.superdatascience.com/machine-learning/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">机器学习A-Z:下载实践数据集-超级数据科学页面-大数据|分析…</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">欢迎来到由基里尔·叶列缅科和哈德琳·德·庞特维斯教授的机器学习课程的数据仓库。数据集…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.superdatascience.com</p></div></div><div class="od l"><div class="oe l of og oh od oi li nu"/></div></div></a></div><p id="6d02" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了稍后在图表上显示我们的数据，我们只能取两个变量(年收入和支出分数)。</p><p id="c5cb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查看树状图，不与任何集群相交的最高垂直距离是中间的绿色。假设有5条垂直线穿过阈值，则最佳聚类数是5。</p><p id="85c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们创建了一个<code class="fe oj ok ol om b">AgglomerativeClustering</code>的实例，使用欧几里德距离作为点之间距离的度量，并使用ward链接来计算聚类的接近度。</p><p id="9e81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">属性返回一个整数数组，其中的值对应于不同的类别。</p><p id="8278" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以使用简写符号将属于某一类别的所有样本显示为特定的颜色。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi op"><img src="../Images/b4b567b3fe79b3bbced6212fa23ee694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vj7WsQhrSPA9hPb4.png"/></div></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/c03d1fa86eb43c50b2066a0cf83a2bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V1MC-ZqqrwM2ZMuJ.png"/></div></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi oq"><img src="../Images/1982012f2742b666e22bf74e677ac56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gD0zGMum5F_V3xJN.png"/></div></div></figure></div></div>    
</body>
</html>