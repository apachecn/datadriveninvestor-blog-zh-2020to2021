# åŸºäº MNIST æ•°æ®é›†çš„æ•°å­—åˆ†ç±»

> åŸæ–‡ï¼š<https://medium.datadriveninvestor.com/how-i-learned-to-code-an-ai-in-a-week-81430939d799?source=collection_archive---------14----------------------->

![](img/ad12982cbf1d240ba4d01ab6e91ec847.png)

[source](https://www.surveycto.com/blog/how-artificial-intelligence-is-changing-development/)

æˆ‘ä»¬éƒ½ç»å†è¿‡â€”â€”å®³æ€•å¤±è´¥ï¼Œå› ä¸ºè‡ªæˆ‘æ€€ç–‘è€Œåœæ»ä¸å‰ï¼Œç­‰å¾…éš¾ä»¥æ‰æ‘¸æˆ–æ­£ç¡®çš„æ—¶æœºæ¥å”¤é†’æˆ‘ä»¬éº»ç—¹çš„å¤§è„‘ã€‚äº‹å®æ˜¯ï¼Œæ°¸è¿œæ²¡æœ‰â€œæ­£ç¡®â€çš„æ—¶æœºã€‚*åªç®¡å»åšï¼Œä¸è¦å¤šæƒ³ã€‚*

å¯’å‡æœŸé—´ï¼Œæˆ‘è®¾å®šäº†ä¸€ä¸ªç›®æ ‡ï¼Œè¦å®Œæˆä¸€é—¨äººå·¥æ™ºèƒ½è¯¾ç¨‹ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªäººå·¥æ™ºèƒ½ç¨‹åºã€‚å“ˆå“ˆï¼Œä½†æ˜¯æˆ‘æœ‰å—ï¼Ÿæ²¡æœ‰ã€‚è™½ç„¶æˆ‘åœ¨å¯’å‡æœŸé—´å¾ˆæœ‰æ•ˆç‡ï¼Œä½†æˆ‘å‡ ä¹åšäº†æ‰€æœ‰çš„äº‹æƒ…ï¼Œé™¤äº†ç¼–å†™ä¸€ä¸ªäººå·¥æ™ºèƒ½ï¼æˆ‘èŠ±äº†å‡ ä¸ªå°æ—¶æµè§ˆå…³äºäººå·¥æ™ºèƒ½çš„æ–‡ç« å’Œç ”ç©¶è®ºæ–‡ï¼Œä½†ä»æœªçœŸæ­£åŠ¨æ‰‹ï¼Œå› ä¸ºæˆ‘è§‰å¾—è‡ªå·±è¿˜æ²¡æœ‰â€œå‡†å¤‡å¥½â€ï¼Œè€Œä¸”æˆ‘çš„ç¼–ç æŠ€èƒ½**å‡ ä¹ä¸å­˜åœ¨â€¦â€¦**

## æˆ‘çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ

*   é¦–å…ˆï¼Œæˆ‘é€šè¿‡è¿™é—¨[è¯¾ç¨‹](https://www.udemy.com/course/python-for-data-science-and-machine-learning-bootcamp/)å­¦ä¹ äº† python çš„åŸºç¡€çŸ¥è¯†
*   æˆ‘ä¸Šäº†å‡ å ‚è¯¾ï¼Œç„¶åçœ‹äº†/è¯»äº†ä¸€å †ä»£ç 
*   è¿˜çœ‹äº†ä¸€å †æ•™ç¨‹æ¯”å¦‚[æ‰‹å†™æ•°å­—çš„ç¥ç»ç½‘ç»œ](https://www.youtube.com/watch?v=iqQgED9vV7k)ï¼Œ[ç”¨ TensorFlow è¯†åˆ«æ•°å­—](https://www.youtube.com/watch?v=rml9oBQT8rw)

ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œæˆ‘ç¡®å®ç†è§£äº†ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ï¼æˆ‘å»å¼€å§‹å¤åˆ¶:)

## åŸºäºå¼ é‡æµçš„ MNIST æ•°å­—åˆ†ç±»

![](img/693652d011ccad5c56c710cd3b6b3ba9.png)

Image by [Josef Steppan](https://en.wikipedia.org/wiki/MNIST_database#/media/File:MnistExamples.png)

æˆ‘åªæ˜¯å¾ˆé«˜å…´æˆ‘çš„æ¨¡å‹å¯ä»¥åœ¨æˆ‘çš„ GPU ä¸Šè¿è¡Œï¼Œå¦åˆ™å®ƒå¯èƒ½ä¼šèŠ±è´¹æˆ‘æ›´é•¿çš„æ—¶é—´ï¼Œä½†æœ¬è´¨ä¸Šï¼Œåˆ›å»ºè¿™ä¸ªç¥ç»ç½‘ç»œçš„ç›®çš„æ˜¯è®­ç»ƒå®ƒï¼Œä»¥ä¾¿å®ƒå¯ä»¥å°†å›¾åƒä¸å®ƒä»¬ç›¸åº”çš„æ ‡ç­¾(åŒ…æ‹¬æ•°å­— 0-9)åŒ¹é…ã€‚MNIST æ•°æ®é›†ç”±æ•°å­—ä»‹äº 0 å’Œ 9 ä¹‹é—´çš„ 28 x 28 åƒç´ ç°åº¦å›¾åƒç»„æˆã€‚å®ƒæœ‰ 60ï¼Œ000 ä¸ªè®­ç»ƒé›†å’Œ 10ï¼Œ000 ä¸ªæµ‹è¯•é›†ã€‚å®ƒæ€»å…±æœ‰ 70ï¼Œ000 å¼ å›¾ç‰‡ï¼Œè¿™ä½¿å®ƒæˆä¸ºè®­ç»ƒæˆ‘çš„ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªå¾ˆå¥½çš„æ•°æ®é›†ã€‚

![](img/4b61450e8326b885d2a1cd2252a1eb4c.png)

[Source](https://ip.cadence.com/applications/cnn)

```
import tensorflow as tf
from tensorflow import keras
import matplotlib.pyplot as plt
%matplotlib inline
import numpy as np
mnist = tf.keras.datasets.mnist
```

é¦–å…ˆï¼Œæˆ‘å¼€å§‹å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“ï¼Œä»¥åŠå¯¼å…¥ MNIST æ•°æ®é›†(å®ƒå·²ç»åŒ…å«åœ¨ Kera çš„æ•°æ®é›†ä¸­)ã€‚åœ¨å»ºç«‹æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥å°†æ•°æ®æ ‡å‡†åŒ–ã€‚æ¯ä¸ªåƒç´ æ˜¯ 8 ä½ï¼Œå› æ­¤æ¯ä¸ªåƒç´ çš„èŒƒå›´æ˜¯ 2â¸ = 256 ç§å¯èƒ½æ€§(ä¸åŒ…æ‹¬é›¶)ã€‚

![](img/1119981a94b78142fa776958ddc00c45.png)

[Source](https://hacktildawn.com/2017/05/02/reconstructing-artistic-style/)

```
(training_data, training_labels), (test_data, test_labels) = mnist.load_data()training_data, test_dtat = training_data/255, test_data/255
```

é™¤ä»¥ 255ï¼Œæˆ‘ä»¬å¯ä»¥å°† 0â€“255 æ•°æ®èŒƒå›´è¡¨ç¤ºä¸º 0.0â€“1.0 ä¹‹é—´çš„æ•°å­—ã€‚

```
model = tf.keras.Sequential ([**tf.keras.layers.Flatten(input_shape=(28,28)),****tf.keras.layers.Dense(128, activation=tf.nn.relu),****tf.keras.layers.Dense(128, activation=tf.nn.relu),****tf.keras.layers.Dense(10, activation=tf.nn.softmax)**])
```

è¯¥éƒ¨åˆ†æ˜¯æˆ‘ä»¬å¼€å§‹æ„å»ºç¥ç»ç½‘ç»œçš„æ—¶å€™â€”â€”åŸºäºå…·æœ‰å¯†é›†å±‚çš„é¡ºåºæ¨¡å‹ã€‚ç½‘ç»œçš„ç¬¬ä¸€å±‚ç”± 784 ä¸ªèŠ‚ç‚¹ç»„æˆã€‚è¿™æ˜¯å› ä¸ºå®ƒé‡‡ç”¨ 28 ä¹˜ 28 çš„å›¾åƒï¼Œå¹¶å°†å…¶â€œå±•å¹³â€ã€‚æœ¬è´¨ä¸Šï¼Œå±•å¹³è¿‡ç¨‹å°†äºŒç»´çŸ©é˜µè½¬æ¢ä¸ºå‘é‡ã€‚28 = 784.æ‰€ä»¥ç¬¬ä¸€å±‚æœ‰ 784 ä¸ªèŠ‚ç‚¹ã€‚

![](img/cc77c5504b03a8e596043e9cc94318b9.png)

[Source](https://towardsdatascience.com/a-simple-guide-to-convolutional-neural-networks-751789e7bd88)

åŠ ç²—çš„ç¬¬äºŒå’Œç¬¬ä¸‰è¡Œ/å±‚æ˜¯å…·æœ‰ 128 ä¸ªèŠ‚ç‚¹çš„éšè—å±‚ã€‚æœ€åï¼Œè¾“å‡ºå±‚æœ‰ 10 ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯¹åº” 0 åˆ° 9 ä¹‹é—´çš„ä¸€ä¸ªæ•°å­—ã€‚

```
model.compile(optimizer= tf.optimizers.Adam(),loss='sparse_categorical_crossentropy',metrics=['accuracy'])
```

è¯¥æ¨¡å‹ä»éšæœºæƒé‡å¼€å§‹ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸å‡†ç¡®çš„ç»“æœï¼Œå› æ­¤å®ç°äº†ä¼˜åŒ–å™¨ã€‚ä¼˜åŒ–å™¨æ˜¯å°†ç¥ç»ç½‘ç»œçš„ç‰¹å¾æ”¹å˜ä¸ºæƒé‡/å­¦ä¹ é€Ÿç‡ä»¥å‡å°‘æŸå¤±çš„ç®—æ³•/æ–¹æ³•ã€‚

```
model.fit(training_data, training_labels, epochs=10)
y=model.evaluate(test_data, test_labels)
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®é›†æ¥è®­ç»ƒæ¨¡å‹ã€‚å†å…ƒæ•°æ˜¯æˆ‘ä»¬å¸Œæœ›æ¨¡å‹ç»å†çš„æ—¶é—´é‡ã€‚è¯·è®°ä½ï¼Œå¦‚æœå°† epochs è®¾ç½®å¾—å¾ˆé«˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿‡åº¦æ‹Ÿåˆï¼Œå› ä¸ºæ¨¡å‹ä¼šå˜å¾—è¿‡äºé€‚åˆè¿™ä¸ªç‰¹å®šçš„æ•°æ®é›†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ•°æ®é›†è¢«åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¨¡å‹åœ¨æ–°æ•°æ®ä¸‹çš„è¡¨ç°ã€‚å°±æ˜¯è¿™æ ·ï¼è¿™é‡Œæ˜¯å®Œæ•´çš„[ä»£ç ](https://colab.research.google.com/drive/1UXMzleTlKwQiWD8PlmG4X36oenCGJ8fj?usp=sharing)ã€‚

## å½¢è±¡åŒ–

è®©æˆ‘ä»¬åšä¸€äº›è¿è¡Œï¼Œä½†ä¸€äº›å¯è§†åŒ–ï¼

![](img/17e3e69f3741dd30ad0f669aac195e12.png)![](img/d04f02d4b46cf043e7bc491584ff6316.png)![](img/c2fd722e0edc884a079e02b09d4056fb.png)

è€Œä¸”æ¨¡ç‰¹çŒœå¯¹äº†ï¼æœ¬æ¥æ˜¯ 7:)æ¯•ç«Ÿæ¨¡å‹å‡†ç¡®ç‡ 97.7%ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„é¡¹ç›®ï¼Œä½†æˆ‘çœŸçš„å¾ˆå–œæ¬¢è¿™æ ·åšï¼

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œç»™å®ƒä¸€ä¸ªğŸ‘å¹¶åœ¨ medium ä¸Šå…³æ³¨æˆ‘:)å¦å¤–ï¼Œè¯·éšæ—¶åœ¨ [LinkedIn](https://www.linkedin.com/in/bernice-lien-b40b9014b/) ä¸Šä¸æˆ‘è”ç³»ã€‚