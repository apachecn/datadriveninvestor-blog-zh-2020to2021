# AI 支持双 11 期间 90.4%的前端模块自动生成

> 原文：<https://medium.datadriveninvestor.com/ai-supports-automatic-generation-of-90-4-of-frontend-modules-during-double-11-411b89385b7e?source=collection_archive---------30----------------------->

![](img/53fb8baec9ce970d0c537592dd283657.png)

*由苏传来，来自* [*阿里巴巴 F(x)团队*](https://community.alibabacloud.com/users/5285991169880843)

# 背景

2017 年，一篇名为 [pix2code:从图形用户界面截图生成代码](https://arxiv.org/abs/1705.07962)的论文引起了公众的关注。本文介绍了深度学习技术在 UI 中的应用。利用深度学习技术，可以识别 UI 截图，生成 UI 结构描述，并将描述转换成 HTML 代码。有人认为 UI 截图直接生成代码意义不大。AI 和草图软件使用数据结构来保存设计文件的结构描述。因此，不需要机器学习来获得结构描述。此外，无法确保生成代码的确定性。其他人同意这种想法，认为深度学习模型能够进行 UI 特征学习和 UI 智能设计。

论文发布后，基于 pix2code 的项目 [Screenshot2Code](https://github.com/emilwallner/Screenshot-to-code) ，在 Github 榜单上排名第一。该项目可以自动将 UI 截图转换成 HTML 代码。它的开发者声称，人工智能将在三年内彻底改变前端开发。这也引起了用户的怀疑，他们不相信单靠 HTML 代码就能满足复杂前端技术和各种框架的需求。

2018 年，微软 AI Lab 开源了草图转代码工具 [Sketch2Code](https://github.com/Microsoft/ailab/tree/master/Sketch2Code) 。一些人认为生成的代码不令人满意，并且不适用于生产环境。其他人认为代码的自动生成仍处于起步阶段，有着更广阔的发展前景。

2019 年，阿里巴巴向公众开放了其智能代码生成平台 [imgcook](https://www.imgcook.com/) 。它允许通过识别草图、PSD 和 image 等设计草案，智能生成不同类型的代码，如 React、Vue、Flutter 和 Mini 程序。支持了 2019 双 11 全球购物节期间 79.34%的前端代码自动生成。这表明代码的智能生成不再是一个离线实验，以及它如何创造价值。

每次这些新的自动代码生成产品发布，网上总会有讨论和担忧。比如，*“AI 会取代前端吗？”**“大量前端程序员将失业”*司空见惯。

对于前一个问题，AI 暂时不会取代前端，但会带来改变。一方面，前端智能探索者会经历变化。他们可以成为 Node.js 服务器工程师和机器学习工程师，创造更多的价值和成就。另一方面，享受前端智能成果的开发者也会受到影响。他们的 R&D 之路将会更新。比如代码智能生成、推荐、纠错、UI 自动化测试，可以帮助他们完成海量的简单重复的工作。因此，他们可以专注于更有价值的事情。

本文讨论了我们在前端领域中关于 AI 的想法，以及实现代码智能生成的努力。作为前端智能领域的探索者，我们淘宝 F(X)团队对前端领域 AI 的未来发展有想法。我们也努力推动 AI 在 [imgcook](https://www.imgcook.com/) 的实现和迭代。由此，2020 年双 11 全球购物节期间，AI-支持了 90.4%新模块的代码智能生成。编码效率提高了 68%。

![](img/95993d27d119b10e6aaf00764d6e3397.png)

# 成就

[imgcook](https://www.alibabacloud.com/blog/www.imgcook.com) 官网月均 PV 和 UV 在 2020 年分别为 6519 和 3059，比 2019 年增长了 2.5 倍。

imgcook 用户 18305 人，其中 77%为社区用户，23%为阿里巴巴集团内部用户。共有 56，406 个 imgcook 模块，其中 68%为外部模块，32%为内部模块。2020 年用户数和模块数比 2019 年分别增长了 2.7 倍和 2.1 倍。

至少有 150 家公司参与到该社区中，集团涵盖了十多个业务部门(BU)。双 11 新模块 90.4%被覆盖。79.26%无需人工辅助的智能生成代码被保留到发布，编码效率(模块复杂度与 R&D 时间之比)提高了 68%。

相比 2019 年，用户感官体验提升了 14%。与无 D2C 操作相比，在固定工作量和单位时间内模块需求的吞吐量增加了约 1.5 倍。此外，与传统的 R&D 模型相比，imgcook 的编码效率提高了约 68%。

![](img/42c44f0abdcee84d97e9e1335ec47b02.png)

*An Overview of Imgcook R&D Performance*

# 技术产品系统的升级

## 技术原理介绍

首先是 imgcook 的代码智能生成原理。Imgcook 主要从可视化草稿中识别信息，并将信息转化为代码，自动生成代码。

本质上，imgcook 使用设计工具的插件从设计草稿中提取 JSON 描述性信息。然后，它通过智能恢复技术处理和转换信息，如规则系统、计算机视觉和机器学习。通过这样做，生成了一个符合代码结构和语义的 JSON 文件，并用 DSL 转换器将其转换为前端代码。作为一个 JS 函数，DSL 转换器将 JSON 转换成必要的代码。例如，React DSL 的输出是符合 React 开发规范的 React 代码。

![](img/b4d13f5a2eb162d8657a2a42b3cf715a.png)

*Process of D2C Code Intelligent Generation*

核心部分是从 JSON 到 JSON 的转换。设计稿只有元数据，比如图片和文字，以绝对坐标为位置。而且设计稿里的风格和网页上的风格不一样。例如，不透明度属性不会影响草图中的子节点，但会影响网页上的子节点。但是，手动编写的代码包含一些信息，比如布局类型、可维护的 DOM 结构、数据语义、组件和循环。

智能恢复定制为智能生成代码，就像手动生成的代码一样。D2C 的智能复原已经分层，每一层的输入输出都是 JSON 格式。智能恢复的本质是 JSON 逐层转换。要修改 JSON 文件，可以使用 imgcook 编辑器进行可视化干预。然后，编辑器将符合代码结构和语义的 JSON 文件转换成 DSL 层的代码。

![](img/32a2e6adf124e44878cf2120d0007fc9.png)

*D2C Intelligent Restoration Technology Hierarchy*

智能修复的核心程序构成了 D2C 的核心技术体系，通过测量系统测量核心修复能力和 R&D 效率。下层提供基于算法工程系统的核心技术体系中的智能能力，包括 Samplecook、算法工程服务、前端算法工程框架 Pipcook。上层通过 D2C R&D 系统进行智能恢复的后处理。该层还通过启用视觉干预来满足用户对第二次迭代的需求。此外，工程过程内置于 imgcook 中，以支持一体化开发、调试、预览和发布，从而提高整体工程效率。此外，开放系统是基于高度可扩展的定制能力形成的，例如定制的 DSL 和开发材料。系统和上层一起构成了 D2C 体系结构。因此，D2C 架构支持各种业务场景，包括阿里巴巴的内部客户、迷你程序、中间平台、后端和外部社区。

![](img/6f5908f6f6a8430cfc751fc7637164ec.png)

*D2C Technical Architecture Diagram*

通过智能前端，今年，D2C 技术系统的整个流程得到了智能增强。提供了 Pipcook 和 Samplecook。前者允许前端工程师是机器学习工程师。后者解决了样本收集问题。营销模块的 R&D 程序也进行了优化，以提高整体 R&D 效率。

# 智能能力升级

## 智能能力层次的定义

*车辆驾驶自动化分类法*将驾驶自动化分为 6 个等级，从 0 到 5。该分类法基于驾驶自动化系统能够执行动态驾驶任务的程度以及执行动态驾驶任务时的角色分配和限制。在高级自动驾驶中，驾驶员变成了乘客。该分类法设定了明确的标准，指导各种企业进行更有针对性的研发和技术部署工作。

![](img/287abc2815149814347ad4a98d687739.png)

*Autonomous Driving Taxonomy*

参照分类法，我们考虑了 D2C 系统能够自动生成代码的程度，并明确了代码的作用以及人工干预和验证的要求。在这些工作的基础上，定义了 D2C 系统交付的类似分类法，以帮助理解 D2C 系统的当前水平和下一步的发展方向。

![](img/18ae5e7040a2eb3c37757565026ff818.png)

*D2C System Delivery Taxonomy*

目前，imgcook 位于 D2C 的 L3。在验证和发布之前，智能生成的代码仍然需要视觉干预或人工开发。需要拆分 UI 信息架构，并从 UI 信息中细分代码自动生成的智能能力，以进入 L4。

![](img/fcb2917d102969fc147562d797db28b7.png)

*UI Information Architecture Splitting*

一个应用程序由多个页面组成。每个页面按照 UI 粒度分为模块或块、原子模块或块、业务和基本组件以及元素。需要定义 UI 的布局结构和每个粒度的语义。因此，模块化、组件化和语义化的代码可以在手工编写时生成。

通过拆分 UI 信息架构并将其与 imgcook 的技术系统相结合，我们将智能能力划分为 I0 到 I5 的不同粒度。 *I* 是*智能的简称。*

![](img/45900e84d045db11e535a313414f0e88.png)

*D2C Intelligent Capability Classification*

彩色部分指的是现有的能力。Imgcook 的智能功能目前位于 I3 和 I4，在生产环境中与 I2 的功能协同工作。I3 的智能能力需要不断优化和迭代模型。当真实在线场景的准确率达到 75%，或者模型能够自我迭代时，能力进入 I4。根据 *D2C 系统交付分类，如果能力进入 I5，D2C 系统交付可以进入 L4。*生成的代码无需人工干预和验证即可发布。

但是，我们可能很长一段时间还停留在 L4，也就是人机协同编程。该分类法旨在促进情报能力的实施，帮助提高 D2C 的情报能力，并加深对 D2C 情报的了解。

生成代码的可用性作为总体技术指标。单个技术指标和对代码可用性的影响权重是根据代码生成过程的技术级别定义的。生成代码的理论精度是每个阶段的精度和权重的乘积之和。代码可用性等于 imgcook 生成的代码与最终发布的代码的比例。

![](img/3e5c5a17ace175e784be9e0b921c5d36.png)

*Technical Indicator and Weight Definition of Each Level*

D2C 的情报能力分布在修复程序的各个阶段。整个程序的智能能力已经升级，以提高代码的可用性。此外，技术方案细化到以下几个方面:

1.  如何才能提高各个阶段模型的识别准确率？
2.  我们如何将识别结果应用于智能恢复过程以生成代码？
3.  如何实现包括样本采集、模型训练、模型部署、模型应用在内的全过程自动化、持续的自我迭代和优化？

智能能力的应用也需要工程程序的支持。该过程包括模型识别结果的应用、在线用户的行为回忆以及前端开发组件对 UI 组件识别结果的接受。此外，整个 D2C 技术系统也需要同步升级。

![](img/c5d4d9a95e5a25bffccc895fac7f975e.png)

*D2C Technical System Upgrade*

## 智能能力升级

**图层解析阶段**

Imgcook 通过解析设计草图的层次信息，利用规则系统和智能技术识别并生成代码。然而，在设计领域和 R&D 领域之间在表达、结构和规范上存在差异。因此，设计草稿的层次结构对生成代码的合理性有很大影响。一些不合格的设计稿需要通过 imgcook“组”和“图片合并”协议进行调整。

经常会开发出不符合规范的代码，比如额外的 consoles.log，没有注释，重复的变量声明。提供 ESLint 和 JSLint 等工具是为了保证代码规范的一致性。

在设计领域，还开发了称为 Design Lint (DLint)的智能检查工具来保证设计规格。这些工具还可以智能地审阅设计草稿，提示错误，并协助修改。

![](img/982143578b6dbfa0a292eee126d9daad.png)

*Design Specification Check*

**材料识别阶段**

UI 材料可以分为模块/块、组件和元素。直接从 Sketch/PSD 中提取的信息只是关于文字、图片、位置。直接生成的代码由 div、img 和 span 组成。组件化和语义化的代码对于实际开发是必不可少的。智能技术，如 NLP 和深度学习，适合从设计草案中提取组件和语义信息。

去年，在部件、图像和文本的识别方面进行了探索和实践。识别结果最终应用于语义和字段绑定。但识别效果受技术方案影响较大。因此，今年进行了以下改进:

**元件识别**

目标检测解决方案用于识别 UI 组件，这需要正确识别组件类别和位置。对于完整的视觉图像，复杂的背景可能会被错误地识别。此外，由于识别位置有偏差，很难将图像安装到正确的节点，导致在线应用中模型识别结果的准确性较低。

与原方案相比，imgcook 可以从可视化草图中获取各层的位置信息。因此，图像分类是优选的，并且识别结果可以在线应用。这依赖于智能材料系统，该系统具有可配置、可识别、可渲染、可干预并可生成代码的组件。有关详细的实现解决方案，请参见下面关于组件检查的文章。

![](img/253f7998500b91111d0a45a26d9c77a0.png)

*Component Recognition Application Procedure*

下面列出了在线应用组件识别的演示:

组件识别可识别可视草稿中的视频信息，并使用 rax-video 接受和生成组件粒度的代码。您必须配置自定义组件(组件库设置)和组件识别模型服务(模型服务设置)。)视频组件渲染的画布资源(编辑器配置>画布资源)，组件识别结果的业务逻辑点(业务逻辑库设置)也是需要的。

*组件识别流程演示*
[https://P3-Jue Jin . byte img . com/tos-cn-I-k 3u 1 FB pfcp/c45b 9a 36156047 da 953 b 8119 DC 88d 90 c ~ tplv-k 3u 1 FB pfcp-zoom-1 . gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c45b9a36156047da953b8119dc88d90c~tplv-k3u1fbpfcp-zoom-1.gif)

[](https://www.datadriveninvestor.com/2020/11/19/how-machine-learning-and-artificial-intelligence-changing-the-face-of-ecommerce/) [## 机器学习和人工智能如何改变电子商务的面貌？|数据驱动…

### 电子商务开发公司，现在，整合先进的客户体验到一个新的水平…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2020/11/19/how-machine-learning-and-artificial-intelligence-changing-the-face-of-ecommerce/) 

**图标识别**

图标识别是关于图像分类的，应用了图像分类解决方案。为自动收集模型、数据处理以及自动模型训练和发布设计了闭环程序，以实现模型泛化的自我增强。通过这样做，模型可以自我迭代和优化。

![](img/51e0767bb6f5cac68bcbd200aa3d611d.png)

*Closed-Loop Procedure of Icon Recognition Model*

自推出图标识别模型以来，新训练集的数量已达到 2，729 个，平均每月返回 909 个有效数据。在几次自迭代之后，测试集的准确率从 80%提高到了 83%。

**图像/文本语义识别**

imgcook 智能系统的一个关键部分是如何将语义信息与 UI 元素绑定。以前的解决方案是基于图像和文本分类模型来识别语义，这是有局限性的。它只对文本进行分类，没有考虑整个 UI 中的上下文语义，导致模型效果很差。

例如，对于字段$200，文本分类模型不能识别它的语义，因为它的含义在不同的场景中是不同的，例如活动价格、原始价格和优惠券。语义分析要参照字段和 UI 界面之间的关系(唯一样式)来进行。

因此，为语义识别引入了另一种解决方案，它在 UI 中结合了上下文语义。采用图像元素选择和文本分类的解决方案解决界面元素语义问题。首先，基于强化学习，通过样式“过滤”界面元素，识别带有样式的非纯文本。然后，对明文进行进一步分类。具体框架如下图所示:

![](img/74dfbc7d1d7c5664d142fed5ef706085.png)

*Reinforcement Learning + Text Classification*

模型算法训练结果如下所示。

![](img/0f884af1e4e915af609925ebec6837be.png)

*Context-Based Semantic Analysis*

**布局修复阶段**

布局显示代码中节点之间的关系。就粒度而言，该关系包括页面上的模块/块之间、模块/块中的原子模块/块之间以及原子模块/块中的组件/元素之间的关系。

如今，imgcook 能够进行循环识别和多态识别。它识别设计草稿中的循环体以生成循环代码，并识别多态节点以生成多态 UI 代码。它还定义了布局可维护性的测量，以测量恢复阶段的准确性。

![](img/0bd885e1c079baca36b6b68f03459966.png)

*Improved Recognition Capability in Layout Restoration*

**逻辑生成阶段**

在业务逻辑生成阶段，优化原始配置过程。因此，业务逻辑库与算法工程过程分离，并且所有识别结果的应用和表达都被接受。材料识别阶段只关注 UI 中的材料，而不是识别结果如何用于生成代码。版图恢复阶段的循环识别和多态识别也是如此。这种方式实现了识别结果表达的定制，并允许用户感知智能识别结果并选择是否使用它们。

此外，逻辑代码可以部分地从需求草稿、代码片段建议或智能代码建议(也称为代码到代码或 C2C)中生成。)

![](img/d0d918771811db05f7456805b11830f6.png)

*Configuration of General Business Logic Library*

# 算法工程系统的升级

## 样品烹饪

算法工程服务提供基于 UI 特征识别的模型训练产品。这些产品为那些愿意使用业务组件识别的人提供了一种采用机器学习的方式。Samplecook 是为解决算法工程服务的主要问题而开发的。它是一个新的衍生产品，为前端 UI 识别模型提供了一个样本生成的捷径。

## 前端算法工程框架

有些人可能担心前端工程师很难通过机器学习解决前端领域的问题。开发前端算法工程框架 Pipcook 就是为了降低门槛。它允许前端工程师通过 JavaScript 完成机器学习任务。

Node.js 可以把前端工程师变成服务器端工程师，Pipcook 可以把前端工程师变成机器学习工程师。

![](img/6eb1ce217f5e41a36801d5e4e2a9611b.png)

*Frontend and Machine Learning*

# R&D 程序升级

## 模块 R&D 程序

淘宝营销重在模块开发。完整的模块开发流程如下所示:

1.  在模块管理平台上创建一个模块
2.  进入 imgcook 平台进行代码智能生成和可视化 R&D
3.  进入 IDE 调试和预览
4.  在工程平台上发布

整个 R&D 过程需要在多个平台之间进行切换，因此需要提高开发流程体验和工程效率。

第二阶段，如果能在 imgcook 平台上进行开发、调试、预览、发布，那就更方便了。一站式 D2C R&D 模式是提升 R&D 整体效率和体验的好选择。

因此，针对市场营销的 imgcook 可视化编辑器定制了可视化和源代码模式。它支持智能代码生成和可视化模式下的可视化 R&D。生成的代码可以在源代码模式下一键同步到 WebIDE。WebIDE 支持基于界面的调试、预览和发布。

![](img/ccc531f316f7aad2abfb750b565648b5.png)

*The Imgcook Visual R&D Process for Taobao Modules*

与传统模式相比，imgcook 视觉 R&D 模式的编码效率(复杂度与 R&D 时间之比)高出 68%。

## 智能用户界面的 R&D 过程

智能 UI 是通过分析用户的特征，为用户提供个性化 UI 的解决方案。所以需要开发大量的 UI 界面。在淘宝的京密平台最初的开发流程中，imgcook 模块是在可视化草稿上传、素材解析后批量创建的。然而，在相应的 imgcook 可视化界面中，每种材料都需要独立的开发、存储和发布。此外，无法看到最终智能 UI 的整体视觉效果。这样一来，智能 UI 所需的材料开发成本，以及业务接入智能 UI 的成本都会非常高。

![](img/97efc753505b59a1edc2d45a555fbd39.png)

*The Imgcook Visual R&D Process for Smart UI*

在此期间，智能用户界面 R&D 程序得到更新，D2C 视觉 R&D 程序接受智能用户界面的大规模生产。上传设计稿解析 UI 素材后，创建 imgcook 模块批量生成素材 UI 代码。还建立了代码仓库和 imgcook 模块之间的关系。而且创建的素材可以批量导入 imgcook，生成不同类型的 UI 解决方案。在生成的 UI 解决方案中，可以对物料进行集中开发。此外，还支持材料的批量发布。整个过程更加集中和高效。

# 实施结果

今年，前端智能促成了前端 R&D 模式的升级。几个总线联合构建了前端设计稿识别的数据集和算法模型，在双 11 期间得到了广泛应用。

D2C 模式的全面技术系统升级影响了营销模块的 R&D 流程。这些升级包括 UI 多状态识别、视频直播组件、循环智能识别增强等诸多方面。双 11 期间新模块 90.4%的代码已经智能生成，高于去年。设计草案的智能审查能力也得到了提升。据统计，智能生成代码(无需人工辅助)占发布量的 79.26%。

与传统的模块开发模式相比，D2C 模式将编码效率(模块复杂度与 R&D 时间之比)提高了 68%。在单位时间内，固定工作量下模块需求的吞吐量提高了约 1.5 倍。

目前，出于以下原因，需要手动修改代码:

1.  无法识别的循环
2.  条件显示的逻辑代码自动生成失败
3.  对字段绑定的错误猜测(字段标准化较差)
4.  将形象问题与商业特征结合起来

这些问题需要以后逐步解决。

![](img/465a23bf339fed8645e19c599de4c443.png)

*User Modifications in D2C Mode*

同时，imgcook 支持天猫主会场和行业会场智能 UI 量产，提升生产效率。

![](img/729e627bdec4ace7d711f5a355d2bff1.png)

*Smart UI Mass Production*

# 未来前景

无论是使用计算机视觉还是深度学习技术，准确性问题对于智能一代来说都是不可避免的。在在线环境中，低准确度可能是不可接受的。需要利用在线用户使用的数据建立算法工程产品的闭环，以提高模型在线识别的准确性。在 imgcook 系统中，图标识别已经形成了从样本采集到模型识别结果应用的完整流程闭环。因此，开发人员不需要在模型优化上花费太多时间。未来，其他模型也将能够自我迭代。

智能 D2C 模式的另一个困难是如何应用模型识别结果来生成代码。例如，组件识别模型可以识别组件的类别。但是不清楚涉及到哪个组件库，代码生成时如何识别 UI 中组件的属性值。imgcook 平台的智能恢复技术的功能和分层架构可以解决上面列出的问题。未来将有更多智能解决方案可用于生产环境。

未来，imgcook 的 D2C 情报能力将进一步分散。将探索更智能的解决方案，并优化现有的模型功能。而且还会构建一个能够自我迭代的算法工程闭环机制。通过不断提高模型泛化能力和在线识别准确率，可以生成可维护性更高、语义更强的前端代码。

# 原始来源:

[](https://www.alibabacloud.com/blog/ai-supports-automatic-generation-of-90-4%25-of-frontend-modules-during-double-11_597087) [## AI 支持双 11 期间 90.4%的前端模块自动生成

### 阿里巴巴 Clouder 年 12 月 31 日 240 作者苏川，来自阿里巴巴 F(x)团队 2017 年一篇名为 pix2code 的论文…

www.alibabacloud.com](https://www.alibabacloud.com/blog/ai-supports-automatic-generation-of-90-4%25-of-frontend-modules-during-double-11_597087) 

进入专家视图— [**订阅 DDI 英特尔**](https://datadriveninvestor.com/ddi-intel)