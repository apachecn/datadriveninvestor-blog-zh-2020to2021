<html>
<head>
<title>Automate Your Scripts In 3 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过3个步骤自动化您的脚本</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/automate-your-python-scripts-in-3-steps-mac-and-windows-3c6fb0fb5bc2?source=collection_archive---------5-----------------------#2021-01-21">https://medium.datadriveninvestor.com/automate-your-python-scripts-in-3-steps-mac-and-windows-3c6fb0fb5bc2?source=collection_archive---------5-----------------------#2021-01-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a5d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">厌倦了重复的任务？自动化您的脚本并节省大量宝贵的时间。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a60b3be338648aa3a13cef5d6b6377e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MR-3VhnCsrLm2Bsr"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@alisonpang?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alison Pang</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ac43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数工作都充满了无聊和重复的任务，不会给任何职业增加价值。这些任务迟早会占用大量时间，并停止您的工作流程；结果，你可能会变得效率更低。</p><p id="8238" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是不用担心！在本文中，我将通过3个简单的步骤向您展示如何在特定的时间在Mac和Windows上运行Python脚本，这样您可以更好地利用您的时间。</p><h1 id="5712" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">苹果个人计算机</h1><p id="3f8b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用一个名为<code class="fe ms mt mu mv b">example.py </code>的Python脚本，它需要每分钟、每小时或每天执行一次。</p><h2 id="2332" class="mw lw it bd lx mx my dn mb mz na dp mf li nb nc mh lm nd ne mj lq nf ng ml nh bi translated">步骤1:使您的Python文件可执行</h2><p id="4c4c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">将<code class="fe ms mt mu mv b">.py </code>分机转换成<code class="fe ms mt mu mv b">.exe</code>有不同的方法。对于这个例子，我将使用“PyInstaller ”,因为它很简单。</p><p id="e3ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PyInstaller读取您编写的Python脚本，并找到脚本执行所需的模块和库。然后，它收集所有这些文件的副本，并将它们放在一个可执行文件中。</p><ul class=""><li id="ae22" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">打开终端，运行<code class="fe ms mt mu mv b">pip install pyinstaller</code></li><li id="249d" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">现在让脚本可执行写<code class="fe ms mt mu mv b">pyinstaller --onefile example.py </code>在你的脚本所在的目录</li></ul><p id="2dd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，应该创建一个名为“dist”的文件夹。文件夹中是独立的可执行文件！</p><h2 id="6fee" class="mw lw it bd lx mx my dn mb mz na dp mf li nb nc mh lm nd ne mj lq nf ng ml nh bi translated">步骤2:打开终端并运行crontab -e</h2><p id="b6d1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在macOS上，你可以用<em class="nw"> crontab </em>安排作业。如果你以前从未听说过<em class="nw"> crontab </em>，就按照这些步骤开始吧！</p><p id="25bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开终端，运行<code class="fe ms mt mu mv b">crontab -e</code>。现在你的终端应该看起来像下面的图片。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/c6c853271a7bfdc8aabaddad1a7cd43d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uIzAQvk7RIAOgQHQtip5g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Image by author</figcaption></figure><p id="09eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里你可以列出你的cron工作。每个工作都有自己的一行。cron作业需要以下格式。</p><pre class="kj kk kl km gt ny mv nz oa aw ob bi"><span id="08f9" class="mw lw it mv b gy oc od l oe of">* * * * * command_to_execute</span><span id="0ce4" class="mw lw it mv b gy og od l oe of">* - minute (0-59)<br/>* - hour (0-23)<br/>* - day of the month (1-31)<br/>* - month (1-12)<br/>* - day of the week (0-6, Sunday to Saturday)</span></pre><p id="5164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管格式看起来很简单，但我强烈建议使用<a class="ae ky" href="https://crontab.guru/" rel="noopener ugc nofollow" target="_blank"> crontab.guru </a>来生成正确格式的cron表达式。</p><h2 id="7afd" class="mw lw it bd lx mx my dn mb mz na dp mf li nb nc mh lm nd ne mj lq nf ng ml nh bi translated">步骤3:使用Crontab调度作业</h2><p id="947a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们必须创建cron作业。</p><ul class=""><li id="8d94" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">点击<code class="fe ms mt mu mv b">i</code>激活<code class="fe ms mt mu mv b">INSERT</code>模式</li><li id="d51d" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">用正确的格式写cron表达式。在本例中，我创建了<code class="fe ms mt mu mv b">35 23 19 1 * path_of_executable. </code>，这意味着“<em class="nw">在1月19日的23:35运行文件</em> a <em class="nw"/>(你可以在<a class="ae ky" href="https://crontab.guru/" rel="noopener ugc nofollow" target="_blank"> crontab.guru </a>上验证这个)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/23e8c57e997d3042219fb8d566ed506e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yuFbIb4PJ-6rVmmhjz9OsA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Image by author</figcaption></figure><ul class=""><li id="0361" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">打出后，按<code class="fe ms mt mu mv b">esc</code>然后按<code class="fe ms mt mu mv b">:wq</code>保存(<code class="fe ms mt mu mv b">w</code> -写入)并退出(<code class="fe ms mt mu mv b">q</code> -退出)文件。</li></ul><p id="1b20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按下回车键后，会出现以下窗口(至少在macOS Catalina 10.15上)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/22fdbb60fa967407412c63a84c284ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*YP0OQ0nVocVB527MaYJFfQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Image by author</figcaption></figure><p id="7f24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只需点击“确定”即可授予访问权限。就是这样！如果您遵循了所有的步骤，您应该有一个新的crontab。</p><p id="b520" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要验证crontab是否已创建，只需运行<code class="fe ms mt mu mv b">crontab -e or crontab -l</code>命令。新的crontab应该在那里。如果你想删除它，写下<code class="fe ms mt mu mv b">crontab -r.</code></p><p id="2060" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">注意:如果没有弹出任何内容，但是您仍然有权限问题，那么您可能需要手动授予访问权限。如果有，就进入系统偏好- &gt;安全和隐私- &gt;隐私- &gt;全磁盘访问。</em></p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h1 id="881c" class="lv lw it bd lx ly oq ma mb mc or me mf jz os ka mh kc ot kd mj kf ou kg ml mm bi translated">Windows操作系统</h1><p id="3a32" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">正如我们之前为Mac所做的那样，我们将使用一个名为<code class="fe ms mt mu mv b">example.py </code>的Python脚本，它需要每分钟、每小时或每天执行一次。</p><h2 id="cf11" class="mw lw it bd lx mx my dn mb mz na dp mf li nb nc mh lm nd ne mj lq nf ng ml nh bi translated">步骤1:创建一个Python可执行文件(bat文件)</h2><p id="68e6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">批处理文件通常用于帮助加载程序，一次运行多个进程，以及执行常见或重复的任务。</p><p id="3dab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">bat文件将是可执行文件。我们将我们的脚本存储在一个文件中，然后单击bat文件，在命令提示符下执行命令来运行Python脚本。</p><ul class=""><li id="9a39" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">创建一个记事本。我给我的<code class="fe ms mt mu mv b">note</code>打电话</li><li id="6a51" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">在记事本内写下以下内容<code class="fe ms mt mu mv b"><strong class="lb iu">&lt;Your Python.exe Location&gt; &lt;Your python Scripts Location&gt; .</strong></code>你的记事本应该是这样的:</li></ul><pre class="kj kk kl km gt ny mv nz oa aw ob bi"><span id="7c0c" class="mw lw it mv b gy oc od l oe of">"C:/User/python.exe" "C:/Scripts/example.py"</span></pre><ul class=""><li id="21f5" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">保存记事本，将扩展名从<code class="fe ms mt mu mv b">.txt</code>更改为<code class="fe ms mt mu mv b">.bat</code></li></ul><h2 id="2ef6" class="mw lw it bd lx mx my dn mb mz na dp mf li nb nc mh lm nd ne mj lq nf ng ml nh bi translated">步骤2:在Windows任务计划程序中配置任务</h2><p id="6501" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">windows任务调度器<strong class="lb iu"> </strong>是默认的Windows应用程序，用于管理任务以响应基于事件或基于时间的触发。</p><p id="fc6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，我们将按照以下步骤安排<code class="fe ms mt mu mv b">example.py </code>脚本:</p><ul class=""><li id="e609" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">单击开始窗口并搜索任务计划程序。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/78ba63f9e32e8c55e6344e1624e09d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bfVnhk_OwzHzac8ZSBwonQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Task Scheduler</figcaption></figure><ul class=""><li id="ba31" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">点击右侧窗口中的“创建基本任务”</li></ul><p id="9577" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将弹出一个窗口，显示以下选项:</p><ol class=""><li id="048b" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu ow no np nq bi translated"><strong class="lb iu">创建一个基本任务:</strong>写下您的任务名称和描述(例如，这个脚本将在每天下午6点运行)</li><li id="cf29" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu ow no np nq bi translated"><strong class="lb iu">触发时间:</strong>选择新任务的触发和动作。可以选择每日、每周、每月等。在本例中，我将选择“每月”</li><li id="d2e2" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu ow no np nq bi translated"><strong class="lb iu">选择上一次选择的确切时间:</strong>由于我之前选择了“每月”，现在我必须选择重复该任务的月份(例如，一月、二月和三月)</li><li id="b2b9" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu ow no np nq bi translated"><strong class="lb iu">操作:</strong>选择“启动程序”并点击“下一步”按钮。然后，浏览任务应该运行的程序。在这种情况下，我将选择我们之前创建的bat文件。</li><li id="7505" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu ow no np nq bi translated">最后，点击<strong class="lb iu">完成</strong>按钮。</li></ol><p id="9524" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！您的新任务应该出现在任务计划程序的首页。</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h1 id="d729" class="lv lw it bd lx ly oq ma mb mc or me mf jz os ka mh kc ot kd mj kf ou kg ml mm bi translated">结论</h1><p id="07ab" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在您知道了一种自动化Python脚本的简单方法！我们在Windows上使用任务调度程序，在Mac上使用Crontab。最重要的是，现在我们可以停止在无意义的任务上浪费时间，专注于更重要的事情。</p><p id="07a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">希望这对你有用！</em></p></div></div>    
</body>
</html>