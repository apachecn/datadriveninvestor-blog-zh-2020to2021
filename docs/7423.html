<html>
<head>
<title>How I built a neural network to predict stock prices with free behavioral, fundamental, and technical data from Robinhood</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何建立一个神经网络，用Robinhood的免费行为、基本面和技术数据来预测股票价格</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-i-built-a-neural-network-to-predict-stock-prices-with-free-behavioral-fundamental-and-d64ab03db3d?source=collection_archive---------3-----------------------#2020-12-08">https://medium.datadriveninvestor.com/how-i-built-a-neural-network-to-predict-stock-prices-with-free-behavioral-fundamental-and-d64ab03db3d?source=collection_archive---------3-----------------------#2020-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/eb45ef6d631fdb73124afba26581de9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*-fZWVzFVDqS4-Ii90Sw1lQ.gif"/></div></figure><p id="1376" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这疯狂的一年开始时，我决定回到活跃的交易中。作为一名黑天鹅信徒，我以前接受过被动投资，并选择将我的认知能量投入到看似不那么混乱的领域。</p><p id="7b29" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然而这一次(不是我第一次尝试这样做)。我决定探索市场波动的行为方面。我看到了基本面和市值之间的明显脱钩，罗宾汉投资者的出现进一步混淆了长期以来被摒弃的理性行为者的概念。</p><p id="a8c8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当我探索公开可用的Fintech APIs时，我甚至购买了像Intrinio上的宏观经济事件API这样的廉价API(下图为每月5美元)。我决定只使用来自我实际经纪公司的免费数据……罗宾汉(是的，我是那些无可救药的非理性投资者之一，因此有这个动机)。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ks"><img src="../Images/0c34ecbf95f12247e5a331737f68416a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*USh0mhPe2H0KVxwVC1S50w.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Intrinio has a great collection of reasonably priced financial APIs</figcaption></figure><p id="6ad5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，我只使用开源库和公开可用的SaaS产品，后者都附带(或以前附带)了大量的免费层:</p><ul class=""><li id="9bad" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><a class="ae lo" href="http://www.robin-stocks.com/" rel="noopener ugc nofollow" target="_blank"> robin-stocks </a> —用于与Robinhood API交互</li><li id="cdd0" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">AWS理解—用于情感分析和主题提取</li><li id="044b" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">diff bot——用于人工智能支持的文章和元数据提取</li></ul><p id="fda4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因为缺乏包括我所寻求的广泛行为数据的历史数据集。我知道我唯一的选择是建造它，这注定要花一点时间。以下是对数据集以及我如何收集它的描述。</p><h1 id="39d0" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">数据和数据库结构</h1><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="48a9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我用4个表保持了简单的数据库结构(在SQLAlchemy中用4个类表示):</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/63d5141a6f7322960cb9ccc707bba246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*TeiC0LbDLyST-dZC7D21cQ.png"/></div></figure><p id="e04a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">收集的数据可分为4类:</p><ol class=""><li id="48da" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr mv ll lm ln bi translated">行为的</li><li id="ac54" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr mv ll lm ln bi translated">基本要素</li><li id="e07c" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr mv ll lm ln bi translated">技术的</li><li id="dfd1" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr mv ll lm ln bi translated">宏观经济</li></ol><p id="f3d2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以下分类将集中在前3个类别(因为宏观经济数据主要是从Intrinio收集的，而不是具体的股票)。我还列出了用于检索每个指标的函数和步骤摘要。</p><h1 id="7ed6" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">行为数据</h1><ul class=""><li id="414c" class="lf lg iq jw b jx mw kb mx kf my kj mz kn na kr lk ll lm ln bi translated"><strong class="jw ir">为Robinhood用户开立股票头寸。</strong>通过下面的get popularity方法获得(<a class="ae lo" href="https://fortune.com/2020/08/10/robinhood-popularity-data-robintrack-stock-market-trading-tracker/" rel="noopener ugc nofollow" target="_blank">robin hood API不再返回这个指标</a>)。</li></ul><p id="2caf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">self.robin.sdk.stocks.get_popularity(symbol)</code></p><ul class=""><li id="2929" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><strong class="jw ir">可用于库存的商品数量。</strong> <em class="nf">假设:</em>对一只股票感兴趣程度的信号。</li></ul><p id="701d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">self.robin.sdk.stocks.get_news(symbol</code>)</p><ul class=""><li id="0f25" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><strong class="jw ir">关于一只股票的文章被点击的总次数</strong>(从用于拉文章的同一个调用中提取)。<em class="nf">假设:</em>对一只股票感兴趣程度的信号。</li></ul><p id="2acc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">self.robin.sdk.stocks.get_news(symbol)</code></p><ul class=""><li id="f53d" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><strong class="jw ir">当日某股票消息的平均情绪</strong> <em class="nf">。</em>这一步包括几个步骤:</li></ul><ol class=""><li id="0c33" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr mv ll lm ln bi translated">使用get_news()获取当天某只股票的所有文章</li></ol><p id="29d8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">2.循环遍历每篇文章，并使用Diffbot提取其文本。如果达到Diffbot自由层限制，我将默认使用Robinhood返回的文章摘要:</p><p id="0756" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b"><a class="ae lo" href="http://api.diffbot.com/v3/article" rel="noopener ugc nofollow" target="_blank">api.diffbot.com/v3/article</a></code></p><p id="7f90" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">3.使用Amazon understand处理文本或摘要</p><p id="6ecc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">4.发布每只股票的过程和平均结果，并将情绪和NLP分析数据保存在数据库中</p><ul class=""><li id="afb0" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><strong class="jw ir">每天对每只股票的分析师评级(买入、卖出和持有评级的计数)</strong>。<em class="nf">假设:</em>专业分析师对股票前景的集体共识。</li></ul><p id="3f51" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">self.robin.get_ratings(symbol)['summary']</code></p><ul class=""><li id="28b2" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><strong class="jw ir">股票上市以来的时间——秒</strong>。<em class="nf">假设:</em>允许模型学习任何与时间和可用性偏差相关的模式(例如:新品牌或首次公开募股比旧品牌表现更好)</li></ul><p id="b5e3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">r.get_instruments_by_symbols(symbol)</code></p><ul class=""><li id="293b" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated"><strong class="jw ir">到下一个收益日的时间——以秒为单位</strong></li></ul><p id="5ca3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">r.stocks.get_earnings(symbol, info=None)</code></p><h1 id="6b1e" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">收益和基本面</h1><p id="f60e" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">大多数被跟踪的基本面由<code class="fe nb nc nd ne b">self.robin.get_fundamentals(symbol)</code>返回，它们包括:</p><ul class=""><li id="8c01" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated">股息收益率</li><li id="be01" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">市值</li><li id="4b8a" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">员工总数</li><li id="8b6d" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">市盈率</li><li id="764a" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">铅比率</li><li id="efba" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">每股收益估计</li><li id="018a" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">上次实际每股收益</li><li id="4eef" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">上次每股收益估计</li></ul><p id="ae06" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当前和最近的估计和实际每股收益可以通过以下方式获得:</p><p id="38c4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">r.stocks.get_earnings(symbol, info=None)</code></p><h1 id="2c27" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">技术数据</h1><p id="c609" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">我使用的大多数技术数据都是通过以下函数获得的:</p><p id="72c0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe nb nc nd ne b">r.stocks.get_earnings(symbol, info=None)</code></p><ul class=""><li id="1f9f" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated">当前价格</li><li id="cb05" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">历史最低点</li><li id="729f" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">空前的高</li><li id="c420" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">52周高点</li><li id="a3fc" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">52周低点</li><li id="99c4" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">第2周</li><li id="00b1" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated">第52周</li></ul><h1 id="a3bc" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><strong class="ak">简单用户界面</strong></h1><p id="2bac" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">我使用Retool(一个创建内部应用程序的流行平台)为我的数据库创建了一个简单的UI。UI允许我查看和排序在特定日期收集的针对特定股票的指标。我可以运行一个查询来查看在某一天负面情绪最高的股票。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nj"><img src="../Images/a014ee6e843000f1a6e8a7002a0beb09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPgeMq4z_WU3fV1dTJBoHQ.png"/></div></div></figure><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/721fd08eca1ff67896137c3f882aa111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0CeZbqOIw87Lzn0yl9iXKA.png"/></div></div></figure><h1 id="6411" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">工作流程(汇总)</h1><p id="ab2d" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">我的流由一系列每日CRON作业组成，这些作业在每个交易日的延长交易时间结束时自动触发。这个过程始于从Robinhood中提取我所追踪的股票，并将其与我的数据库同步。然后，它收集上面详述的所有指标，包括提取文章和分析情感。它最终将所有提取的信息存储在我的数据库中。</p><p id="c5bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以下是该过程的步骤和组成部分的摘要:</p><ul class=""><li id="ebab" class="lf lg iq jw b jx jy kb kc kf lh kj li kn lj kr lk ll lm ln bi translated">数据收集服务器:一个简单的AWS Lightsail实例就足够了</li><li id="48c7" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated"><strong class="jw ir"> DB: </strong>类似地，我在AWS Lightsail上创建了一个Postgres DB实例</li><li id="c1e1" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated"><strong class="jw ir">股票世界:</strong>在Robinhood上创建了一个列表来存放我的股票世界。我每天都给它添加股票，直到我达到250只股票。</li><li id="147c" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated"><strong class="jw ir">自动化&amp;过程:</strong>这些包括保持我的数据库与我的Robinhood列表同步的脚本，在每个交易日为我的世界收集所需数据的过程，分析和后处理数据的程序，以及执行持续学习和自动化实验的程序。</li><li id="1971" class="lf lg iq jw b jx lp kb lq kf lr kj ls kn lt kr lk ll lm ln bi translated"><strong class="jw ir"> UI: </strong>一个简单的UI，允许我浏览收集的数据并轻松导出。</li></ul><p id="7ba2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当我今年早些时候从事这个项目时，robin-stocks库无法从Robinhood中提取新的列表(这需要对库进行简单的添加):</p><pre class="kt ku kv kw gt nl ne nm nn aw no bi"><span id="59c1" class="np lv iq ne b gy nq nr l ns nt">def get_list_by_id(self, lid):<br/>        url = "https://api.robinhood.com/midlands/lists/items/?list_id=%s" % lid<br/>        data = self.sdk.helper.request_get(url)<br/>        print(len(data['results']))<br/>        return data</span></pre><p id="4d70" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">除了几个小问题，这个过程自今年3月以来的每个交易日都在忠实运行。</p><h1 id="b685" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">制定学习问题</h1><p id="29f7" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">从纯卷积到递归，从单点到序列预测。有无数种方法来阐明学习问题。另一个架构决策是为整个宇宙创建一个模型，为每个行业创建一个带有子模型的集合，还是为每个股票创建一个模型。我后来的实验证明，创建一个模型的辅助学习，和一个系综的共识力量几乎总是胜过后者(为每只股票创建一个模型)。对于这个例子，为了简单起见，我将向你展示如何为每只股票训练一个循环模型，一个GRU(门控循环单元)。</p><p id="3224" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个例子中，我将学习问题公式化为5x23到P的n+1。您使用一个5天的序列，每个包含23个变量(总共115个点)，来预测一个值(第二天收盘时的价格)。本例的输入数据包括买入、持有和卖出评级。股票的未平仓头寸和成交量。价格以及今年和未来52周的最高价和最低价。积极、消极和中性情绪得分。市盈率和股息率。市值、上市以来的时间、下一次盈利前的时间、上一次每股收益估计值和上一次实际每股收益。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/4c54807091219c9bcfe1a4be5b09bd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3iTknxaFxhhCFu_wbg2FQ.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Input sequence (5x23) to predict a single point (P at n+1)</figcaption></figure><h2 id="ec45" class="np lv iq bd lw nv nw dn ma nx ny dp me kf nz oa mi kj ob oc mm kn od oe mq of bi translated">数据预处理</h2><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7115b131dd7ea31147c68e17a9dab074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Ia4QbsEsvwXIBeKLCRmneQ.gif"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Constructing the training sequences by walking forward and looking back</figcaption></figure><p id="004c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">该过程简单地一天一天地往前走，每天回头看看是否存在形成序列的<strong class="jw ir"> n </strong>个点，当满足条件时，该序列被添加到数据集。</p><p id="ef32" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过将每个指标除以其数据库最大值，得到一个介于0和1之间的值，从而对每个指标进行标准化。下面的示例图片还显示了向每个序列添加一个变换的股票符号，这是创建一个模型的最简单方法之一，该模型为每个类学习不同的模式。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/0e21b557f20617648c9948f433aece60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PsN0TIxJyoG7wW8Ssi8Yg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">normalizing data and including the transformed symbol in the input</figcaption></figure><h1 id="3156" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">模特培训</h1><p id="cebe" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">模型代码极其简单(下图)，每层都由相同数量的节点组成。使用平均绝对误差损失。尽管是PyTorch的狂热爱好者。我在这个例子中使用Keras和TF只是因为它的流行和它的直接RNN实现。我选择的建筑是一个门控循环单元(GRU)。GRU是相对较新的RNN架构，是神经网络的子集，非常适合处理基于时间和序列的数据。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/625971401dbe701dec95592a17d996ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Y62JzbzGPkXSFKezdgWzQ.png"/></div></div></figure><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/99d85ee08d8a6b398f6c0fabed6bf48d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_qbuJfGEaO3gaVfb_6wuA.png"/></div></div></figure><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/a7bbfbd7f05c742da7e50478f15d050e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*3yNSa2CyH4coE1ATSoQuLQ.gif"/></div></figure><p id="6b5d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">呼唤你的模特</strong></p><p id="1672" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦你的模特完成训练。你可以简单地通过构造一个相同格式的序列来调用它们，预测明天的价格。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/7c6b63c24738e22e92579c432ba8b933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbrnAoBQpV3lNs18u7a8iA.png"/></div></div></figure><h1 id="0daf" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">接下来呢？</h1><p id="5aad" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">在以后的文章中，我将描述我是如何制定学习问题来帮助我有效地交易短期期权的。我将重点介绍最成功的实验和达到的错误率，你可以构建学习问题的几种方法，以及我为每种方法推荐的模型设计。</p><h1 id="b98f" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">你如何改善这一点？</h1><p id="2bfd" class="pw-post-body-paragraph ju jv iq jw b jx mw jz ka kb mx kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">尝试您可以添加的任何数据。监控Twilio和Snowflake等专注于开发人员的公司的公共Github数据。增加秘密市场或监控商品价格，以检测<em class="nf">逃向安全</em>信号或原材料成本波动。</p><p id="4626" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">内扎雷·查夫尼</p><p id="6a39" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">CTO @ Trueface.ai</p><div class="ol om gp gr on oo"><a href="https://chafni.com" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd ir gy z fp ot fr fs ou fu fw ip bi translated">内扎雷·查夫尼</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">企业家、软件工程师和狂热的制造者。</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">chafni.com</p></div></div></div></a></div></div></div>    
</body>
</html>