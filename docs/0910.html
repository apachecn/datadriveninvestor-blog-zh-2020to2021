<html>
<head>
<title>Detection and Classification of Apple Tree Disease based on Deep Learning Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于深度学习算法的苹果树病害检测与分类</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/detection-and-classification-of-apple-tree-disease-based-on-deep-learning-algorithm-d8c29940ed02?source=collection_archive---------1-----------------------#2020-02-22">https://medium.datadriveninvestor.com/detection-and-classification-of-apple-tree-disease-based-on-deep-learning-algorithm-d8c29940ed02?source=collection_archive---------1-----------------------#2020-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d63cbbbddab74ae26eadf3bce6d0c5bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEsoyrW7B0WnX50DNzl8jQ.jpeg"/></div></div></figure><p id="6568" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们必须非常感激，世界上数字技术的发展最近被证明在生活的几乎所有方面都非常有用。人工智能技术的发展也相当迅速。可以利用的事情之一是通过使用机器学习或深度学习来制作植物疾病诊断系统。在生物学中，通过植物的形态特征可以知道它的状况是否健康。其中一个可以作为参考的是叶子表面的形态。受某些植物病害影响的植物会在叶子表面表现出异常。因此这些植物的叶子通常与健康植物的叶子不同。这为我们利用机器学习算法，基于叶片图像建立植物病害自动诊断系统提供了参考。</p><div class="kw kx gp gr ky kz"><a href="https://www.datadriveninvestor.com/2019/03/22/the-seductive-business-logic-of-algorithms/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">算法诱人的商业逻辑</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">某些机器行为总是让我感到惊讶。我对他们从自己的成就中学习的能力感到惊讶…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><p id="315c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了创建植物疾病检测系统，我们可以使用深度学习模型之一，卷积神经网络(CNN)。CNN是深度学习模型之一，经常用于对图像进行分类。jpeg格式。CNN有不同的架构设计，根据需要搭建CNN模型。有几个CNN建筑设计的例子已经建成并被批准用于表演。例如VGGNet-16、AlexNet、LeNet、残差网络(ResNet)等等。我们可以基于现有架构构建CNN模型，甚至可以构建我们自己的CNN架构！但是如果你自己做架构，当然需要时间和更深入的研究。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lo"><img src="../Images/048efa1ac822c4e307503cb7b45d2a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HRpR3YcffW_WEYEZ5RSHw.jpeg"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">The dataset contains photos of apple leaves</figcaption></figure><p id="d0e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了建立这个诊断系统，我们需要一个植物叶片图像数据集。为了得到这个数据集，我们可以在Kaggle下载。之后，我们可以开始在Jupyter笔记本或Google Collaboratory上构建CNN模型。我会用Google Collaboratory让它变得更简单，不用在我的PC上安装Jupyter Notebook和Python。实际上有2种方法可以制作CNN模型，那就是使用一个库或者从头开始创建一个CNN。实际上是一样的，只是如果你使用这个库，我们只需要调用要构建的函数，并改变每个函数中的参数。所以在建立这个CNN模型的时候会更快。如果从零开始(scratch)，它会使每个功能一个接一个。每种都有优点和缺点，但是在本文中，我们将考虑到它的有效性，单独使用硬库来构建CNN。</p><p id="05b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">苹果植物中至少有3种疾病，包括:苹果黑星病、黑腐病和雪松苹果锈病。因此，我们使用的数据集必须涵盖这3种疾病，并添加健康苹果叶片照片的数据。稍后，该数据集将根据每种疾病的图像进行分类。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/cd0afd1b591a0d73b65b69ed4591c241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pNDQ1q22Qi7Z3S5f_nnmuA.jpeg"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Photograph of apple tree leaves with several types of diseases</figcaption></figure><p id="f740" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们能够利用机器学习创建一个苹果植物病害类型自动分类系统，这将对苹果水果生产链中的许多人产生积极的影响。至少这将有助于苹果种植者采取更早的行动来治疗受疾病侵袭的苹果植株。</p><h2 id="e2b7" class="ly lz iq bd ma mb mc dn md me mf dp mg kj mh mi mj kn mk ml mm kr mn mo mp mq bi translated">错误预测的后果</h2><p id="5c9d" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">每一台自动化机器都不是完美的，一定会有机器出错的时候。如果苹果植株的病害类型分类出现错误，将对苹果生产链产生负面影响。至少当他们种植的苹果树没有最佳结果甚至死亡时，果农会遭受损失。因此，重要的是建立一个高性能的CNN模型来避免这些错误。在图像分类模型中，有几种方法可用于识别模型性能。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a59edc34db913a612481f6a60e6340d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*g5zpskPaxO8uSl0OWT4NTQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Confusion Matrix</figcaption></figure><p id="8484" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据混淆矩阵，可以计算机器学习模型的性能，从准确度、精确度、灵敏度到特异性开始。现在从这个性能将确定一个卷积神经网络模型的特征，这已经作出。</p><h1 id="db07" class="mx lz iq bd ma my mz na md nb nc nd mg ne nf ng mj nh ni nj mm nk nl nm mp nn bi translated">构建卷积神经网络架构</h1><p id="e58e" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">将为苹果叶中的疾病分类而构建的卷积神经网络架构基本上由3种类型的层组成。即卷积层、汇集层和全连接层。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/a60a564f182baf8d76a675d9e84b014b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h2OFy43gJlfgqQgfcaN4Kw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Illustration of Convolutional Neural Network Architecture</figcaption></figure><h2 id="3c3e" class="ly lz iq bd ma mb mc dn md me mf dp mg kj mh mi mj kn mk ml mm kr mn mo mp mq bi translated">卷积层</h2><p id="60ed" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">卷积层用于过滤CNN模型中的图像。在这一层，将为每个输入的爱提取独特的特征。例如垂直线、水平线、gambaar角等等。卷积层可用于处理前一层，即初始输入图像或前一特征图。卷积层的大小可以变化，但通常只使用3x3、5x5或7x7滤镜。还有一个1x1大小的过滤器，但该过滤器更专用于减少层中的通道数量。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ba2db66fd0057128646346ae486d1420.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*m6ZjwzvnF_sMTrs_pLhceQ.jpeg"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Image Convolution Process</figcaption></figure><h2 id="dc3e" class="ly lz iq bd ma mb mc dn md me mf dp mg kj mh mi mj kn mk ml mm kr mn mo mp mq bi translated">汇集层</h2><p id="c9a5" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">池层的工作原理是将突出的参数作为原始图像的解释。常用的有两种类型，即最大池层和平均池层。顾名思义，Max-Pool Layer通过在一个矩阵区域中取最大参数来工作。虽然平均池层以同样的方式工作，但是取的是参数的平均值。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/a492925baf87c542eb87ea00101b3f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*KC5yC1XaVwek7HJgl_k7WQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Maximum Pooling dan Average pooing</figcaption></figure><h2 id="381a" class="ly lz iq bd ma mb mc dn md me mf dp mg kj mh mi mj kn mk ml mm kr mn mo mp mq bi translated"><strong class="ak">展平</strong></h2><p id="1e4a" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">在进入全连通层之前，先进行展平层处理。非常简单，即将每一列排成一行。接着是第二个，第三个，等等。所以最终它只会变成一个一维矩阵。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/cf2226fffbfe90a8320203e63a1da2eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GMaYx9UJSRTmRj9LSdymEQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Flattening Process</figcaption></figure><h2 id="8768" class="ly lz iq bd ma mb mc dn md me mf dp mg kj mh mi mj kn mk ml mm kr mn mo mp mq bi translated">全连接层</h2><p id="a907" class="pw-post-body-paragraph jy jz iq ka b kb mr kd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv ij bi translated">全连接层用于CNN架构的最后一层。全连接层1维矩阵，就像一系列长长的数字排列在一起。全连接层像任何其他神经元一样工作，并且具有隐藏层、激活函数、输出层和损失函数。作为CNN架构的输出门。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/91e1dbe1d2f2b728b1798d70c38c4cf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1dtjvdej34ZZc4szM7COMw.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Fully Connected Layer hingga Output</figcaption></figure><p id="6b97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我利用Keras库构建了这个卷积神经网络架构。如下所示:</p><pre class="lp lq lr ls gt nt nu nv nw aw nx bi"><span id="1701" class="ly lz iq nu b gy ny nz l oa ob"># Build CNN Architecture</span><span id="b194" class="ly lz iq nu b gy oc nz l oa ob">model = Sequential()</span><span id="8b2f" class="ly lz iq nu b gy oc nz l oa ob">model.add(Conv2D(32, (5, 5), input_shape=input_shape,activation='relu'))</span><span id="b30d" class="ly lz iq nu b gy oc nz l oa ob">model.add(MaxPooling2D(pool_size=(3, 3)))<br/>model.add(Conv2D(32, (3, 3),activation='relu'))<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Conv2D(64, (3, 3),activation='relu'))<br/>model.add(MaxPooling2D(pool_size=(2, 2)))</span><span id="cb7e" class="ly lz iq nu b gy oc nz l oa ob">model.add(Flatten())</span><span id="50bc" class="ly lz iq nu b gy oc nz l oa ob">model.add(Dense(512,activation='relu'))<br/>model.add(Dropout(0.25))<br/>model.add(Dense(128,activation='relu'))<br/>model.add(Dense(num_classes,activation='softmax'))</span><span id="b94c" class="ly lz iq nu b gy oc nz l oa ob">model.summary()</span></pre><p id="1a5b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">构建的卷积神经网络架构由3个卷积层组成，详细信息如下:</p><p id="4b46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">卷积层1 = 5x5带32个滤镜<br/>卷积层2 = 3x3带32个滤镜<br/>卷积层3 = 3x3带64个滤镜</p><p id="c3fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用的激活函数是输出层上的ReLu和Softmax。执行培训流程后，已创建的培训模型的结果将显示:</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/07bc6b047ff18d3f090540cfad98a91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QsJwTtDcLfhGCeDiepmrFw.jpeg"/></div></div></figure><p id="ca0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">具有上述结构的卷积神经网络模型如果用于基于苹果树叶片的照片检测苹果树中的疾病类型，将产生高达91.16%的准确度测试。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/7d047099c37dadd4b97fb37ccd3595cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*wL0a6O2jOFpUoN2f8jj4sg.jpeg"/></div></figure><p id="8588" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下图显示了训练模型过程中的准确性和损失值。从该图中，我们可以分析早先构建的卷积神经网络架构的特征。</p><div class="lp lq lr ls gt ab cb"><figure class="of jr og oh oi oj ok paragraph-image"><img src="../Images/8672dbc1164c28aeff3ca97ed8b740b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*8BIl29qEggwSFaM2ZLwiRg.png"/></figure><figure class="of jr ol oh oi oj ok paragraph-image"><img src="../Images/6dde9120f2c143219f7ebfd66b1b65c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*lwOk4SBiDkQoIRVkKkdZjQ.png"/></figure></div><p id="4449" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于卷积神经网络架构的完整程序，可以从GitHub下载:</p><div class="kw kx gp gr ky kz"><a href="https://github.com/mmasdar/Apple-Disease-Classification/blob/master/Apple_Disease_Classification.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">苹果疾病分类</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">permalink dissolve GitHub使上下文切换变得容易。阅读渲染文档，查看历史记录…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="om l lk ll lm li ln jw kz"/></div></div></a></div><blockquote class="on"><p id="36b5" class="oo op iq bd oq or os ot ou ov ow kv dk translated"><em class="ox">欢迎提问、评论和投稿。随时和我讨论任何事情。</em></p></blockquote><p id="c339" class="pw-post-body-paragraph jy jz iq ka b kb oy kd ke kf oz kh ki kj pa kl km kn pb kp kq kr pc kt ku kv ij bi translated">在<a class="ae pd" href="https://www.linkedin.com/in/muhammad-masdar-mahasin-66914378/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上与我联系</p><p id="fe9b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在推特<a class="ae pd" href="https://twitter.com/mmasadar" rel="noopener ugc nofollow" target="_blank">上与我联系</a></p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="ab gu cl pe"><img src="../Images/bb46d946a8672375ef8f32aff0d7431f.png" data-original-src="https://miro.medium.com/v2/0*G89OAWjO44d00Y3O"/></div></figure><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="pf pg l"/></div></figure></div></div>    
</body>
</html>