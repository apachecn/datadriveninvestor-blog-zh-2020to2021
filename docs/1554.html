<html>
<head>
<title>Evaluating ANN Model Using K-Fold Cross Validation With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的K-Fold交叉验证评估ANN模型</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/evaluating-ann-model-using-k-fold-cross-validation-with-python-cd4844351371?source=collection_archive---------1-----------------------#2020-03-23">https://medium.datadriveninvestor.com/evaluating-ann-model-using-k-fold-cross-validation-with-python-cd4844351371?source=collection_archive---------1-----------------------#2020-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a051" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用人工神经网络进行预测建模，作者:基里尔·叶列缅科</h2></div><p id="894a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大家好，又回来了:)，我已经很久没有发布由基里尔·叶列缅科创建的人工神经网络预测模型的最后一部分了。</p><p id="cc9d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我将指导如何评估我们的人工神经网络预测模型，但是在我们开始写代码之前，为什么我们需要评估人工神经网络模型？要查看细节，让我们先运行我们的ANN预测建模，你可以在这里下载代码<a class="ae lb" href="https://github.com/bayysp/PredictiveModelANN" rel="noopener ugc nofollow" target="_blank"><em class="lc"/></a>，或者你可以在这里阅读第1部分教程<a class="ae lb" href="https://medium.com/analytics-vidhya/predictive-modelling-using-ann-with-python-ab701f3199dc" rel="noopener"><em class="lc"/></a><em class="lc">。</em></p><p id="d98e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们第一次运行代码</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/c22c410cb28743a5e4441e973107877c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*-szIRZzhmS-kLAVl3pnEoA.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Accuracy 83.47%</figcaption></figure><p id="9a78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，如果我们第二次逃跑呢？</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lp"><img src="../Images/aa12ac29d9810af299309c943e41c041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*8ycBFt9tOgnSNPYR-utHPw.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Accuracy 86.33%</figcaption></figure><p id="14de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看看结果，第一次我们得到了83%的准确性，但第二次是86%，这是可能发生的，因为有所谓的方差，这将使我们的ML成为一个问题。如果我们得到高方差，有4种方差可能发生在我们的ML建模中:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lu"><img src="../Images/6ef7c08e27294bd13f32439139d95685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLWO21bubrqABU4GNQtn6w.png"/></div></div></figure><p id="ae95" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，发生在我们建模中的问题在右上方<em class="lc">(高偏差高方差)</em>，我们应该使我们的建模在左下方<em class="lc">(低偏差低方差)</em>。</p><div class="lv lw gp gr lx ly"><a href="https://www.datadriveninvestor.com/2019/01/23/deep-learning-explained-in-7-steps/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">深度学习用7个步骤解释-更新|数据驱动的投资者</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">在深度学习的帮助下，自动驾驶汽车、Alexa、医学成像-小工具正在我们周围变得超级智能…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm lj ly"/></div></div></a></div><p id="60f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一种称为K-Fold交叉验证的技术，K-Fold交叉验证是一种用于评估机器学习模型技能的统计方法，它与K分开工作，例如，如果我们设置k = 10，我们有1000行训练集，这1000行将被分成100行x 10，每个折叠都将是测试折叠，如下图所示</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mn"><img src="../Images/489003d72ad1b269ea0d4341c553ca91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QkxMI1ORuCb7zQGE8He6TQ.png"/></div></div></figure><p id="27d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们训练10倍的训练集之后，然后我们找到平均精度，让我们使用K倍交叉验证训练我们的建模两次来看结果。</p><p id="c2b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在我的github <a class="ae lb" href="https://github.com/bayysp/PredictiveModelANN/blob/master/ann_evaluation.py" rel="noopener ugc nofollow" target="_blank"> <em class="lc">这里下载/查看代码</em> </a> <em class="lc">，</em>如果你想实现K-Fold交叉验证，你需要先构建ANN，并编写下面的代码</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mo"><img src="../Images/26c76dd0636d22fc84e153d9e8b73c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_a0sY0dQC3YKJ8ffNM8fKQ.png"/></div></div></figure><p id="40f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在第79行看到，它是你使用的<em class="lc"> </em>的<em class="lc">折叠</em>的总和，这里我们使用10个折叠，写完代码后，你可以运行所有的操作，只需等待片刻。</p><p id="30b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想让训练过程更快，你可以在cross_val_score()上添加更多的参数，它是n _ jobs =-1，-1意味着训练过程将使用你计算机的所有GPU，但在使用它之前，你需要安装tensorflow GPU与write<strong class="kh ir"><em class="lc">pip install tensor flow-GPU</em></strong>，教程你可以在我的github上看到。</p><p id="a3d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，我们已经写完了代码，让我们第一次运行它。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/408c5b3899eee4a095d049b224cc00d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*Eef5r6yEfeOpWU3IT7gERw.png"/></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/259045d73e786f14ade50eb5c1627960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*Mg2aMuAIPKE6Xa36KxB1ig.png"/></div></figure><p id="d02c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看，我们得到的平均准确率是79.6%，变异1%，如果我们第二次运行这个程序会怎么样？</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/b001988890c3961a5517db2b708dbc53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*F-J1QYiMzf9WtA4NTPUQlw.png"/></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mr"><img src="../Images/43f949c9ddf0efd74dbcadeb64c2b1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*NMrXTjkqTL3P3tGBgq4twA.png"/></div></div></figure><p id="ccbf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看，第一轮和第二轮之间的范围值很小，这使得我们的ML具有低偏差和低方差</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/dd3354f5e77105636c77f611325108ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*bE6htDUpj6G92UwISPa-4w.png"/></div></figure><p id="2fc9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以大家:)这就是今天如何对我们的人工神经网络模型进行评估的全部教程，非常感谢你已经阅读了我的所有文章，如果我的代码或其他代码中有错误，我很抱歉，下次教程再见:D</p><p id="81d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是这个URL中的代码:</p><p id="2b58" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">【github.com/bayysp/PredictiveModelANN T4】</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div></div>    
</body>
</html>