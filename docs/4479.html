<html>
<head>
<title>Shapley Value — or why is Benny a weak player to have in your coalition at the TV show “Survivor”?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">沙普利价值——或者为什么本尼在电视节目《幸存者》中是一个弱势选手？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/coalitions-in-israeli-survivor-or-why-is-benny-a-weak-player-to-have-in-your-coalition-477e70d19e4e?source=collection_archive---------2-----------------------#2020-08-10">https://medium.datadriveninvestor.com/coalitions-in-israeli-survivor-or-why-is-benny-a-weak-player-to-have-in-your-coalition-477e70d19e4e?source=collection_archive---------2-----------------------#2020-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="396b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过电视节目“幸存者”了解沙普利价值、联盟和机器学习SHAP的重要性</h2></div><p id="0903" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，你将了解联盟的博弈，尤其是沙普利值。沙普利价值是以劳埃德·沙普利的名字命名的，他因此获得了2012年诺贝尔经济学奖。Shapley值很重要，不仅用于联盟，也用于任何合作博弈。此外，它可以用作ML模型的可解释性工具，指出特征的重要性。</p><p id="d456" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了理解Shapley value，我们将使用<strong class="kh ir">以色列幸存者</strong> <strong class="kh ir">贵宾</strong>(简化)的例子来浏览一个有趣的例子。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/458603d9e17685c0e78e4b47d9f32eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/0*7w7lo2OkShacmyZj.jpg"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Picture From Amazon.com</figcaption></figure><h1 id="399b" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated"><strong class="ak">幸存者游戏作为联盟游戏</strong></h1><p id="5e94" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">对于那些不熟悉幸存者的人，规则如下。玩家的目标是成为<em class="mk">【最后的幸存者】</em>并留在游戏中。在每次迭代中，我们都有一个<em class="mk">“部落Council״ </em>和一个<em class="mk">“豁免”</em>挑战。在每个<em class="mk">“部落Council״ </em>中，得票最多的玩家将被踢出游戏。在<em class="mk">“部落council״</em>,<em class="mk">“豁免”</em>挑战赛的获胜者不能被投票出局，而失败者将已经有一票反对他。</p><p id="2a18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中，我们有五个幸存者(这不是剧透，我不知道会发生什么):</p><blockquote class="ml mm mn"><p id="2959" class="kf kg mk kh b ki kj jr kk kl km ju kn mo kp kq kr mp kt ku kv mq kx ky kz la ij bi translated">{Yarden，Idan，Benny，Ella，Assi} = {Y，I，B，E，A}</p></blockquote><p id="919d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设雅登有豁免权，本尼输掉了挑战，有一票反对他。此外，简单来说，如果你有3票或更多反对你的票，就相当于有一个超过3票的联盟，你就退出游戏。每个继续下一次迭代的安全玩家的值为1，不安全玩家的值为0。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/b86da6ce4d0d2b07c6cf4df53f110e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJu4E82WZvPzkRthwlneUw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">from רשת 13 Yarden</figcaption></figure><p id="4501" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在可以形式化这个问题:</p><p id="1f7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">V{I} = V{B} = V{E} = V{A} =0(联盟中只有玩家会出局)<br/> V{Y} = 1(因为雅登有豁免权，所以即使在一人联盟中，她也会留在游戏中)</p><p id="f02d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">V{i，j} =2对于每一个I，j除了B(因为在这种情况下，该集团将投票B and B出局！V{i，B} =1(联盟将会失败，因此只有一个成员会幸存)</p><p id="67cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个I，j，k，V{i，j，k} =3(因为我们有多数票)</p><p id="6858" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个I，j，k，l，m，V{i，j，k，l} =4(因为我们有多数票)</p><h1 id="a80d" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated"><strong class="ak">联盟定义</strong></h1><ol class=""><li id="538a" class="mw mx iq kh b ki mf kl mg ko my ks mz kw na la nb nc nd ne bi translated">如果两个玩家总是向其他代理人的每个联盟贡献相同的金额，我们称他们为<em class="mk"> i </em>和<em class="mk">j</em>T28】T29】可互换T31】。</li></ol><blockquote class="ml mm mn"><p id="b5c5" class="kf kg mk kh b ki kj jr kk kl km ju kn mo kp kq kr mp kt ku kv mq kx ky kz la ij bi translated">对于所有既不含I也不含j的S，v(S ∨{ I })= v(S ∨{ j })。</p></blockquote><p id="6eb1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中，Benny是不可互换的。因为如果S = {I}，V{I，B}！= V{I，E} <br/>除了雅登，不可互换。既然是S = {}，V{Y}！= V{I} <br/>其他球员:埃拉、艾丹、阿西可以互换。</p><p id="fb4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mk">对称公理</em>声明可互换的代理人应该收到相同的报酬。</p><p id="bbd8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2。虚拟玩家:<em class="mk"/></strong><em class="mk">I I</em>s a<strong class="kh ir"><em class="mk">虚拟玩家</em> </strong>如果我对任何联盟贡献的金额正好是我一个人能够实现的金额。</p><blockquote class="ml mm mn"><p id="bedd" class="kf kg mk kh b ki kj jr kk kl km ju kn mo kp kq kr mp kt ku kv mq kx ky kz la ij bi translated">对于所有s，使得i ̸∈ S，v(s ∨{ I })—v(s)= v({ I })。</p></blockquote><p id="e373" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中，我们没有虚拟玩家。请注意，雅登是<em class="mk">而不是</em>虚拟玩家，尽管她有豁免权，但她可以帮助她的朋友，并使她的联盟价值更大。V{Y，I} — V{I} &gt; V{Y}</p><p id="e432" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mk">虚拟玩家公理</em>声明虚拟玩家应该获得与他们自己完成的数量完全相等的报酬。</p><p id="0af7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3。可加性公理:</strong>可加性公理声明，如果我们将设置重新建模为一个单一的博弈，其中每个联盟S实现了v1(S) + v2(S)的收益，那么每个联盟中的代理人的支付应该是他们在两个单独的博弈下为该联盟实现的支付的总和</p><p id="5692" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中，幸存者是一个满足可加性公理的游戏。</p><h1 id="fa3a" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated"><strong class="ak">沙普利值</strong></h1><blockquote class="ml mm mn"><p id="5a89" class="kf kg mk kh b ki kj jr kk kl km ju kn mo kp kq kr mp kt ku kv mq kx ky kz la ij bi translated"><em class="iq"> Shapley理论:给定一个联盟博弈(N，v)，存在一个唯一的收益分割x(v) = φ(N，v)分割大联盟的全部收益，并且满足对称、哑元玩家和可加性公理。</em></p></blockquote><p id="f658" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个余数除法叫做<em class="mk"> </em> <strong class="kh ir"> <em class="mk">沙普利值。</em> </strong>沙普利值是这样计算的:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nf"><img src="../Images/e6f587fbd0bafcb508acdcc97d69f281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyiKjeK7DIsLcusy9wdMEA.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Shapley Value</figcaption></figure><p id="2bd6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mk"> </em> Shapley值捕捉玩家的边际贡献。</p><p id="20d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中:</p><p id="759b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">雅登的沙普利值:1.33 <br/>本尼的沙普利值:0.66 <br/>其他球员(伊丹/埃拉/阿西)沙普利值:1</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ng"><img src="../Images/6e65849d4268d7639f460a1ab95b7ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1IZAUbN0pScTmlxlJLMuxw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">from רשת 13 Benny</figcaption></figure><p id="79a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于亚登有豁免权，她的边际贡献更大，因为她不需要其他玩家留在游戏中。自从Benny输掉豁免赛后，他在联盟中就成了弱势玩家，他的边际贡献就更小了。不出所料，雅登这样的强势选手比本尼这样的弱势选手有更大的沙普利值。</p><h1 id="71b5" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">ML模型可解释性的Shapley值</h1><p id="84bc" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">如果我们将每个特征视为一个参与者，将每个值视为子特征模型的性能，我们可以很容易地使用Shapley值来表示特征的重要性。这个想法很简单，特征将大的绝对Shapley值对于模型的预测很重要。请注意，在计算Shapley值时，有和没有特征(玩家)的两个子模型之间的差异将是我们总结的项，这正是我们在特征重要性中想要的。</p><p id="d527" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">实际上，检查所有排列的计算成本很高，这就是SHAP(Shapley Additive explaints)开源库针对不同模型进行优化的地方。SHAP是一个很好的解释工具，有很强的理论背景，但是它仍然被认为是一个很慢的框架。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nh"><img src="../Images/f05c8d8270d52aaa629dc9139dc646f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SgG9gcwyES-7SGfs8lPJjQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">SHAP — from <a class="ae ni" href="https://github.com/slundberg/shap" rel="noopener ugc nofollow" target="_blank">https://github.com/slundberg/shap</a></figcaption></figure><h1 id="8ad2" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">结论</h1><p id="eb52" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">Shapley值有助于模拟大联盟的预期收益。该值指示玩家的边际贡献，并且可以用作解释机器学习模型特征重要性的工具。</p><p id="6a98" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我知道你是否喜欢这篇文章，谁是你最喜欢的幸存者！一旦我们有了最终的三个，我们就可以讨论联盟中另一个有趣的主题，即<strong class="kh ir"> <em class="mk">核心价值</em> </strong>，以了解谁应该赢得这场游戏。</p><p id="5af2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="mk">“在这个游戏中，火代表你的生命，当你的火熄灭时，你也一样。”</em> </strong></p><p id="bf9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">诺阿。</p></div></div>    
</body>
</html>