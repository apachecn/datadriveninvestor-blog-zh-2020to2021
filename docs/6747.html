<html>
<head>
<title>Django REST API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django REST API</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/django-rest-api-1ab821e40733?source=collection_archive---------4-----------------------#2020-11-09">https://medium.datadriveninvestor.com/django-rest-api-1ab821e40733?source=collection_archive---------4-----------------------#2020-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="57ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上周我们讨论了用Django 创建<a class="ae ko" href="https://medium.com/datadriveninvestor/basic-application-with-django-3afab115bb9a" rel="noopener">基本应用。今天让我们试着用Django设计一个RESTful API。</a></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/cc9ebe8a7fb564d6ef23c6a2db32a32b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*N5Iep1wJY1iXgMzpHxzE8w.png"/></div></figure><p id="cd38" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">先决条件</strong></p><p id="4617" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们开始之前，让我们安装额外的库，这将有助于我们设计API:</p><pre class="kq kr ks kt gt kx ky kz la aw lb bi"><span id="eda2" class="lc ld it ky b gy le lf l lg lh"><em class="li">pip install djangorestframework</em></span><span id="8945" class="lc ld it ky b gy lj lf l lg lh"><em class="li">pip install markdown</em></span><span id="7f3b" class="lc ld it ky b gy lj lf l lg lh"><em class="li">pip install django-filter</em></span></pre><p id="df3a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">项目设置</strong></p><p id="fb76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们确保REST框架库的所有移动部分都在它们的位置上。</p><p id="22fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在项目文件夹中，我们有文件<strong class="js iu"> settings.py </strong>。其中有一个数组<strong class="js iu"> INSTALLED_APPS </strong>。向该数组中再添加一个元素，<strong class="js iu"> 'rest_framework' </strong>，<strong class="js iu">，</strong>。我们还需要将这个字典添加到这个文件中:</p><pre class="kq kr ks kt gt kx ky kz la aw lb bi"><span id="315b" class="lc ld it ky b gy le lf l lg lh"><em class="li">REST_FRAMEWORK = {</em></span><span id="baef" class="lc ld it ky b gy lj lf l lg lh"><em class="li">‘DEFAULT_PAGINATION_CLASS’: ‘rest_framework.pagination.PageNumberPagination’,</em></span><span id="4fc1" class="lc ld it ky b gy lj lf l lg lh"><em class="li">‘PAGE_SIZE’: 10</em></span><span id="6c29" class="lc ld it ky b gy lj lf l lg lh"><em class="li">}</em></span></pre><p id="d6c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在之前的帖子中，我们没有与数据库同步。我们可以通过运行迁移来实现:</p><pre class="kq kr ks kt gt kx ky kz la aw lb bi"><span id="f965" class="lc ld it ky b gy le lf l lg lh"><em class="li">python manage.py migrate</em></span></pre><p id="5dc9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另外，让我们创建超级用户:</p><pre class="kq kr ks kt gt kx ky kz la aw lb bi"><span id="fcd4" class="lc ld it ky b gy le lf l lg lh"><em class="li">python manage.py createsuperuser — email admin@example.com — username admin</em></span></pre><p id="ad4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们的初始数据库和管理员用户准备好了，我们可以开始开发API。</p><p id="a6e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">串行器</strong></p><p id="3a81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">序列化是将数据转换成可读格式的过程。在我们的例子中，我们将使用来自<strong class="js iu"> <em class="li"> django rest框架</em> </strong> <em class="li"> </em>库中的序列化程序。让我们将<strong class="js iu"> cd </strong>到app目录并创建文件<strong class="js iu">serializer . py</strong>。在这个文件中，我们将导入用户<strong class="js iu"> </strong>模型，导入序列化程序，并创建我们要发送出去的过滤器数据。这是<strong class="js iu">串行器</strong>的样子:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/5f871af237c49cc404b9716949005472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*fQJVcq5K7Eif4I22LMO9Rw.png"/></div></figure><p id="5dc3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">观点</strong></p><p id="2823" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们需要创建一个视图，其中将使用用户序列化程序。这里我们将查询数据库并对记录进行排序:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/813d1122b58a38cc918c3d3de02928d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*ciDbZWnf36iesyTxmuSg5A.png"/></div></figure><p id="dd19" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以看到我们没有声明个人观点。相反，我们使用<strong class="js iu">视图集。我们把常见的行为分成几类。</strong></p><p id="7fdb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">网址</strong></p><p id="64ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们需要为我们的API编写一些路由。让我们<strong class="js iu"> cd </strong>到项目(不是app)目录，打开<strong class="js iu"> urls.py </strong>。使用视图集允许通过使用路由器类注册的视图集自动生成每个URL配置:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lm"><img src="../Images/122f49f38af0116dee6c2e83ec45e9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPiUVk6gfhz5ZC7b9xeODQ.png"/></div></div></figure><p id="1947" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们全新的API已经可以使用了。</p><p id="b9ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> API积垢</strong></p><p id="78cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们运行服务器，看看我们得到了什么:</p><pre class="kq kr ks kt gt kx ky kz la aw lb bi"><span id="802c" class="lc ld it ky b gy le lf l lg lh"><em class="li">python manage.py runserver</em></span></pre><p id="0619" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们打开localhost，将会有所有声明的路由，在我们的例子中只有一个，因为只有用户被创建。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lr"><img src="../Images/dc67a754b20891ea73e8c4a558a163e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GbNo6awa6cl_CHaH5Ywgrg.png"/></div></div></figure><p id="45c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们单击用户路由，我们将看到来自用户表的序列化数据。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi ls"><img src="../Images/d2ec350b8184e06daf1781b20bd94d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_C3wr9HLkqKm54RpCfisDw.png"/></div></div></figure><p id="5dcc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那就是读操作，剩下的呢？轻松点。在页面底部，我们可以找到一个发送POST请求的界面，这将在用户表中创建新记录。创建新用户后，我们可以遵循RESTful惯例，转到URL <strong class="js iu"> users/:id </strong>(在我们的例子中，id将是2)并查看关于这个特定用户的所有详细信息，我们有更新和删除操作的接口。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lt"><img src="../Images/6344f3caf762476401b3f383b2723ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBg4WDCHSOfgUQvm_r8u3A.png"/></div></div></figure><p id="673c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">CRUD完成了！</p><p id="5550" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">结论</strong></p><p id="7bfd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Django是一个非常强大的框架，通过额外的库，它允许我们非常快速地创建全功能的API。</p><p id="b28c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不断学习，不断成长！</p><p id="4537" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们上<a class="ae ko" href="https://www.linkedin.com/in/pavel-ilin/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>连线吧！</p></div></div>    
</body>
</html>