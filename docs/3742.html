<html>
<head>
<title>Indian Dance Forms (Hacker Earth)— Image Classification using Transfer Learning and Tuning with Pytorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">印度舞蹈形式(黑客地球)-使用迁移学习和Pytorch调谐的图像分类</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/indian-dance-forms-hacker-earth-image-classification-using-transfer-learning-and-tuning-with-b6cbe7a0fc78?source=collection_archive---------5-----------------------#2020-07-05">https://medium.datadriveninvestor.com/indian-dance-forms-hacker-earth-image-classification-using-transfer-learning-and-tuning-with-b6cbe7a0fc78?source=collection_archive---------5-----------------------#2020-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="b840" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个故事将解释如何使用pytorch以较少的数据量提高图像分类。</p><p id="203b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想解释一下我是如何在由<a class="ko kp ep" href="https://medium.com/u/32ad5f537fbc?source=post_page-----b6cbe7a0fc78--------------------------------" rel="noopener" target="_blank">hackere earth</a>主办的比赛中一步步登上排行榜榜首的。我要感谢他们的数据集和比赛。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/dbc38c9fc9da00eaf378fb507ee054e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r1bozL4yZQDQedqCazk-_g.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Hacker Earth — <a class="ae lg" href="https://www.hackerearth.com/challenges/competitive/hackerearth-deep-learning-challenge-identify-dance-form/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="4849" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我是先看排行榜开始比赛的。令人惊讶的是，我看到了100/100分的人。我的第一个结论是数据集将会非常小。人们想出了弊端，或者可能正在为自己创建一个适当的验证数据(后来我使用了同样的技术)。</p><h2 id="cc86" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">问题陈述:</h2><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/1cc851cd02bb0414ae49893da7dccb23.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*AqrEdprZJpTPLFyxkr2ILQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Hacker Earth — <a class="ae lg" href="https://www.hackerearth.com/challenges/competitive/hackerearth-deep-learning-challenge-identify-dance-form/machine-learning/identify-the-dance-form-deea77f8/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="8446" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">火车目录中有一组不同的<code class="fe mb mc md me b">Indian Dance forms</code>的<code class="fe mb mc md me b">364 images</code>，并附有一个包含图像id和图像标签的<code class="fe mb mc md me b">.csv </code>文件。测试目录中还有<code class="fe mb mc md me b">157 images</code>和一个csv文件。我们的提交文件应该和<code class="fe mb mc md me b">imageid</code>和他们的<code class="fe mb mc md me b">labels</code>在一起。这些类别描述如下。</p><div class="mf mg gp gr mh mi"><a href="https://www.datadriveninvestor.com/2020/05/04/could-machine-learning-and-nlp-have-predicted-oils-crash-the-answer-is-yes/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">机器学习和NLP能预测石油的崩溃吗？答案是肯定的。|数据驱动…</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">2020年4月20日，WTI原油期货(美国原油基准)历史上首次达到负…</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw la mi"/></div></div></a></div><h2 id="f92c" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">第一想法:</h2><ol class=""><li id="dc2c" class="mx my it js b jt mz jx na kb nb kf nc kj nd kn ne nf ng nh bi translated">图像分类问题的少量数据。</li><li id="e73d" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated">我不得不在这么小的范围内使用迁移学习。(寻找最佳预训练模型)</li><li id="25c7" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated">必须使用数据增强技术。</li><li id="36f3" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated">可以尝试各种提高精度的方法。</li></ol><p id="5f17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们来看一下我最后一个笔记本的每一步，我会试着解释我是如何一步一步地到达那里的。</p><blockquote class="nn"><p id="0b76" class="no np it bd nq nr ns nt nu nv nw kn dk translated">如果你想跳过这个博客看笔记本，就去查看我的Github。</p></blockquote><h2 id="5a83" class="lh li it bd lj lk nx dn lm ln ny dp lp kb nz lr ls kf oa lu lv kj ob lx ly lz bi translated">加载数据</h2><p id="c8c6" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb oc kd ke kf od kh ki kj oe kl km kn im bi translated">在这里，图像可以在一个名为train的文件夹中找到，它的标签和图像名称一起放在一个csv文件中。我已经提到过你的数据扩充。因此，当加载数据集用于训练或测试或任何处理(如比较图像、查看增强图像等)时，可以通过使用<code class="fe mb mc md me b">Pytorch</code>创建自定义数据集来调用。</p><p id="837e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面我将向你展示它是如何做到的？</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/91fd77aedf8eb70ef50de4944e0d3cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*MkUHHyBkN6SqUNSv0Ejcng.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="572b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们通过扩展Pytorch数据集类来定义一个自定义数据集。让我们看看如何使用Pytorch数据集类。</p><p id="d155" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Pytorch数据集中，你必须覆盖两个子类函数。</p><ul class=""><li id="ed97" class="mx my it js b jt ju jx jy kb og kf oh kj oi kn oj nf ng nh bi translated"><code class="fe mb mc md me b">__len__</code>:函数返回数据集的大小。</li><li id="8052" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated"><code class="fe mb mc md me b">__getitem__</code>:函数返回给定索引的数据，我们也可以添加转换(动态数据扩充，这样每当通过类加载每个图像时，它将转换它并返回。</li></ul><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ok"><img src="../Images/c391ea83663c3b1c041271aeb7e9e1f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4FXB1CYqNJzLs7enmurWA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="586e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们得到一个输出<code class="fe mb mc md me b">364 156</code>。它表示训练和测试数据的计数。这里我们描述pytorch中不同的转换技术，这些技术可以用作数据扩充。例如<code class="fe mb mc md me b">RandomHorizontalFlip()</code>将水平翻转图像。您可以查看各种转换并选择最适合您的转换。在处检查<a class="ae lg" href="https://pytorch.org/docs/stable/torchvision/transforms.html" rel="noopener ugc nofollow" target="_blank">转换</a>和<a class="ae lg" href="https://pytorch.org/docs/stable/torchvision/transforms.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8b5a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在<code class="fe mb mc md me b">train_ds</code>和<code class="fe mb mc md me b">valid_ds</code>可以用来调用我们的数据集。我们有了数据集，现在我们需要为我前面提到的每个案例批量加载数据。对训练、测试、预处理、比较等。为此我们使用<code class="fe mb mc md me b">Dataloader</code>类。在Dataloader类中，我们可以指定<code class="fe mb mc md me b">batch size, shuffle, workers etc.</code>作为参数。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ol"><img src="../Images/5584bb7d63d8efba1e19da9a2f84a48a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBLYJmhQMiLf7ZqI47SWFg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/60ee252b0acede2ba1f3622675601cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*3CS_urMsGVmTLyPDCkylUA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="a9ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我还使用了一个<code class="fe mb mc md me b">show_batch</code>函数来显示转换后的图片，这样我就可以更容易地比较各种转换。</p><blockquote class="on oo op"><p id="859b" class="jq jr oq js b jt ju jv jw jx jy jz ka or kc kd ke os kg kh ki ot kk kl km kn im bi translated">创建了数据集，创建了数据加载器，接下来呢？</p></blockquote><p id="28ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要创建模型。</p><p id="19a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是在创建模型之前，让我们编写一些用于训练和验证的函数。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ou"><img src="../Images/ae45b962a871bbbeb317a706db7c7f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4u1herQAqx6iqsYYhnnMgA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="5858" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们通过nn.Module创建了一个名为<code class="fe mb mc md me b">MulticlassClassifierBase</code>的类。</p><ul class=""><li id="0cd9" class="mx my it js b jt ju jx jy kb og kf oh kj oi kn oj nf ng nh bi translated"><code class="fe mb mc md me b">training_step</code>:此取一批图像和标签- &gt;用模型预测- &gt;用给定的损失函数计算损失- &gt;求精度- &gt;返回acc和loss。</li><li id="d5ec" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated"><code class="fe mb mc md me b">validation_step</code>:同上。</li><li id="1869" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated"><code class="fe mb mc md me b">validation_epoch_ends</code>和<code class="fe mb mc md me b">epoch_end</code>用于计算和叠加每批和每个时期后的损失和精度。</li></ul><p id="41e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们可以创建一个模型。</p><p id="70b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们通过扩展<code class="fe mb mc md me b">MulticlassClassifierBase</code>类来创建一个模型。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/236d31fdf021349fa2bc37fddbcd97ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*K4FWRXegJe-gVSog2R5LdA.png"/></div></figure><p id="7227" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，您可以看到有4个函数是准确的，并且该类是从MuliclassClassifierBase派生的。我用<code class="fe mb mc md me b">wide_resnet50_2.</code>创建了迁移学习模型，当我阅读博客时，我总是怀疑人们如何知道从哪个预先训练的模型中选择。我能说的是了解每个型号，例如Resnet是<code class="fe mb mc md me b">residual networks</code>，它们很小。对于较小的数据集，这可能不会过拟合。除此之外，我尝试了几乎所有的预训练模型，并最终在这里得出结论。我<code class="fe mb mc md me b">removed</code>最后一层加了一个<code class="fe mb mc md me b">sequential layer</code>。有<code class="fe mb mc md me b">Linear</code>、<code class="fe mb mc md me b">Dropout</code>和<code class="fe mb mc md me b">LogSoftmax</code>三层。这有利于多类图像分类器。然后是<code class="fe mb mc md me b">forward</code>函数，当我们对模型进行处理时，它会将每批数据发送到网络并返回输出。</p><p id="7e35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后是<code class="fe mb mc md me b">freeze</code>和<code class="fe mb mc md me b">unfreeze</code>功能，用于冻结除最后一个连续层(微调)之外的所有层进行训练。解冻使所有层可训练(但这在我的例子中太多了)。</p><p id="54d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我们创建了我们的模型。现在，如果你想使用GPU，你可以加载你的数据和模型到GPU。在我的<code class="fe mb mc md me b">notebook</code>中有描述，但我不打算在这里描述。</p><blockquote class="nn"><p id="0cdd" class="no np it bd nq nr ns nt nu nv nw kn dk translated">就像我之前说的，因为数据集很小，所以我也做了些手脚。我为提交数据创建了准确的测试标签，并使用它进行验证，并使用整个训练数据进行训练。这其实对我帮助很大。</p></blockquote><p id="5da9" class="pw-post-body-paragraph jq jr it js b jt ow jv jw jx ox jz ka kb oy kd ke kf oz kh ki kj pa kl km kn im bi translated">我们都做了些什么？</p><ul class=""><li id="00d0" class="mx my it js b jt ju jx jy kb og kf oh kj oi kn oj nf ng nh bi translated">我们使用数据集类创建了数据集</li><li id="1944" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">使用torch Dataloader加载了数据以及增强数据</li><li id="7807" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">创建了带有训练和验证步骤的分类器类。</li><li id="281f" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">已创建模型。</li></ul><p id="af77" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们需要拟合和评估，并可视化的结果。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/9a3fb099d35ebecac06175db58c546ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*vLxFvwSv3DiTyC6LgaeX4w.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="e6a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们创建evaluate函数，将模型置于评估模式，并将模型和valid_loader作为输入，并调用<code class="fe mb mc md me b">validation_epoch_ends</code>函数返回一批数据的损失和准确性。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi pc"><img src="../Images/df729811c5031053dc7dd40f4835a9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4t82i96EUGwPq_8M52Mdrw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="eca6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上图显示了给出定义变量的模型拟合函数。使用具有定义的学习率和权重衰减的优化器函数。和学习速率调度器(后来我删除了它，因为它对我的情况没有太大用处)。然后，我们以训练加载器作为输入开始每个时期，并将模型置于训练模式。使用<code class="fe mb mc md me b">training_step</code>我们得到模型预测的精度和损失，使用<code class="fe mb mc md me b">loss.backward</code>我们得到梯度。我们使用optimizer针对给定的损失优化模型的权重。</p><p id="bcf7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，如果你想你也可以使用调度学习率，这有助于更大的方式有时。它所做的就像这里提到的<code class="fe mb mc md me b">ReduceLROnPlateau</code>一样，当分数没有变化时，它减少<code class="fe mb mc md me b">lr</code>。结果是更多的优化。这里我还使用了防止爆炸和渐变消失的<code class="fe mb mc md me b">gradient_clipping</code>。这导致每个梯度具有大于阈值的范数。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/6e338d5d430a8e719fb3a0fbeed8b691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*tf_2phLek2x8XNMdfoBvpQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="a836" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是模型拟合功能的延续。这里我使用了3种技术。</p><ul class=""><li id="0a55" class="mx my it js b jt ju jx jy kb og kf oh kj oi kn oj nf ng nh bi translated">因为我已经将提交数据集作为我的验证数据集。我将准确性作为一个标准，每次都以最佳准确性保存模型。</li><li id="5b65" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">每当验证损失较少时，我也使用相同的技术来保存模型。从而只保存最一般化的数据。</li><li id="7458" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">提前停车。如果作为参数提及的周期数没有改善。它会停止训练。</li></ul><p id="ee76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">优点:我可以给我喜欢的纪元大小。如果没有改进，它将停止运行，只保存好的模型。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi pe"><img src="../Images/511e1c460c70fb7773afd2754f856b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fuGPuWi0iQRYcIsUkOV3oQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="df69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里没什么东西。我定义参数并开始训练，然后等待它结束。</p><h2 id="e72f" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated"><code class="fe mb mc md me b">Visualizing Training</code></h2><div class="kr ks kt ku gt ab cb"><figure class="pf kv pg ph pi pj pk paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/a2639c0b1a39de2588ac45fa83a08cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*kdfQn2mOWYO9MbuMEn14oA.png"/></div></figure><figure class="pf kv pl ph pi pj pk paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/4372cba757c877c73ba28cbe41f56a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*v612Z6Erpp_dXtAQi4cteQ.png"/></div></figure><figure class="pf kv pm ph pi pj pk paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/2b2f3f7de341fc0468a6cd59b03f685b.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*5_Tb5MQDs4Cuph--DdEhmg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk pn di po pp">Generated By Author</figcaption></figure></div><p id="199e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这让你知道你的训练时间。因为我没有使用<code class="fe mb mc md me b">learning rate scheduler</code>，否则你可能已经看到了lr的变化。</p><p id="cc7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在怎么办？</p><h2 id="7fad" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">预测和提交</h2><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi pq"><img src="../Images/ea046121744c7d4793ea507fbb50afb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91p3D55rvMKOk5AuB-vzfg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="5287" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，我们做同样的事情，创建测试数据集、测试数据加载器、预测并将其转换为所需的csv格式。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/ec5f5b788fb7a9666546e36be0d3bb76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*yCz8Fx8mjhuCek7e6H4kVw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Generated By Author</figcaption></figure><p id="1877" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mb mc md me b">Point to Note</code>:为了获得预期的准确性，您必须对验证数据集和测试数据集进行任何转换或数据扩充。</p><p id="7afc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何提高准确率？</p><ul class=""><li id="320c" class="mx my it js b jt ju jx jy kb og kf oh kj oi kn oj nf ng nh bi translated">我尝试了不同的预训练模型。如果你找到了最好的一个与适当的图像处理，你会得到很好的准确性。</li><li id="ac52" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">我选择的预训练模型来自ImageNet竞赛。所以我选择了这样的标准化。(你可以在数据扩充部分看到)。</li><li id="4756" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">适当的数据建议</li><li id="13fe" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">学习率调度程序</li><li id="5179" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">渐变剪辑</li><li id="372f" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">提前停止</li><li id="c1ca" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">保存验证损失分数最低的最佳一般化模型。</li><li id="b9c9" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">获取适当的验证集。</li><li id="6a63" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">添加更多数据</li><li id="a0b8" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">选择正确的优化器。</li><li id="5bb6" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">选择正确的损失函数。</li><li id="9b86" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">其他超参数。</li><li id="cc4d" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">冻结和解冻模型。</li><li id="6932" class="mx my it js b jt ni jx nj kb nk kf nl kj nm kn oj nf ng nh bi translated">选择正确的激活层，辍学和正规化。</li></ul><p id="2973" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还有更多..</p><p id="d388" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lg" href="https://github.com/raoofnaushad/IndianDanceForms" rel="noopener ugc nofollow" target="_blank">此处为代码检查</a>。</p></div><div class="ab cl ps pt hx pu" role="separator"><span class="pv bw bk pw px py"/><span class="pv bw bk pw px py"/><span class="pv bw bk pw px"/></div><div class="im in io ip iq"><blockquote class="nn"><p id="3d43" class="no np it bd nq nr ns nt nu nv nw kn dk translated">如果我犯了错误请纠正我，如果内容对你有帮助请鼓掌感谢我。非常感谢你的时间。事业有成，生活美满。</p></blockquote><figure class="qa qb qc qd qe kv gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/e3e9fadb9424d25febb1b2b3ebf7c9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/0*4BQA_fGzKxnExpHJ.jpeg"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Follow me to read tech simplified contents</figcaption></figure><blockquote class="on oo op"><p id="1df9" class="jq jr oq js b jt ju jv jw jx jy jz ka or kc kd ke os kg kh ki ot kk kl km kn im bi translated"><em class="it">帮我接通</em><a class="ae lg" href="https://www.linkedin.com/in/raoof-naushad-378432106/" rel="noopener ugc nofollow" target="_blank"><em class="it">linkedIn</em></a><em class="it">|</em><a class="ae lg" href="https://github.com/raoofnaushad" rel="noopener ugc nofollow" target="_blank"><em class="it">Github</em></a><em class="it">。让我知道评论</em></p></blockquote></div><div class="ab cl ps pt hx pu" role="separator"><span class="pv bw bk pw px py"/><span class="pv bw bk pw px py"/><span class="pv bw bk pw px"/></div><div class="im in io ip iq"><p id="30b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">访问专家视图— </strong> <a class="ae lg" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>