<html>
<head>
<title>A secret weapon to automate SAP — Your time, Stop losing it</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化SAP的秘密武器——您的时间，别浪费了</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/automating-sap-extractions-with-excel-a-step-by-step-guide-ef5d0f8e4717?source=collection_archive---------0-----------------------#2020-11-16">https://medium.datadriveninvestor.com/automating-sap-extractions-with-excel-a-step-by-step-guide-ef5d0f8e4717?source=collection_archive---------0-----------------------#2020-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/bc178daa4abcada670c15031e7ffa82c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zXzMLjbVHHnqi_RN"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/@arturtumasjan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artur Tumasjan</a> on <a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="86f0" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">如果您仍然手动使用SAP进行日常分析，那么您将会浪费大量时间，而且您可以自行实现自动化！</h2></div><p id="2af8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">SAP是最常用的企业资源规划系统(ERP)之一，它是一种管理和集成公司所有部门的活动和数据的软件，如财务、供应链、运营、报告等。</p><p id="c902" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我没错的话，每天你或你团队中的某个人都必须登录SAP，从五个、十个甚至更多不同的SAP事务中提取大量信息，对它们进行分析，并在最后返回进行你的计算显示为必要的更改，对吗？</p><p id="2813" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么，如果你不浪费时间手动提取它，你可以让它做所有需要的提取，而你和你的队友喝咖啡？</p><p id="edd0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">或者如果你不需要在一天结束的时候做所有的改变？为什么不两者都要呢？</p><p id="f161" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">看起来我试图出售一个非常复杂的开发解决方案，它将花费你每天使用的相同数量的交易，但转换成一袋袋的黄金，但它恰恰相反。</p><p id="d124" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你所需要的就是<strong class="kx jh"> Excel </strong>！</p><p id="bcc2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在你可能正看着屏幕，头垂向左边，问“我到底要怎么让Excel做所有这些事情？”，对吧？</p><p id="c5ef" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">答案就是<strong class="kx jh"> Visual Basic应用程序(VBA) </strong>和<strong class="kx jh"> SAP脚本</strong>的强大组合。</p><p id="53a9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我想你可能从Excel的宏中知道VBA，那正是我正在谈论的家伙。</p><p id="a1d1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这背后隐藏着一个难以理解的魔力，那就是Excel有一个记录宏按钮，可以记录用户在Excel中的每个动作和行为，SAP也有一个。</p><p id="ae45" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基本上，你需要做的唯一的事情就是你已经做了的，但是记录下来并修改一些代码行，这样它就可以在以后单独做了。</p><h1 id="2f22" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">预配置</h1><p id="a7f4" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">首先，SAP必须被设置为接受或能够与VBA交互。</p><p id="6cdb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，请转到自定义本地布局&gt;选项。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/20535aac9170a58a44da234e0c1e45dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNBe3PmX-x716ExwUOMjDw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="d9e2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一个新的窗口将会打开，进入辅助功能&amp;脚本&gt;脚本，找到标签用户设置并标记“启用脚本”选项。</p><p id="cdd6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在你可以用VBA来做你工作中无聊的部分了。</p><p id="5cae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另一件重要的事情是:不要选中“启用脚本”下面的两个复选框，因为当它们被标记并且你运行你的代码时，会出现一个弹出窗口，等待你的批准让代码连接到SAP。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/fcd0a722fb73ebe6360988ee6dff3d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRavlKw2YjwZAArAtXy5UQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="da59" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们已经完成了预配置！</p><h1 id="9824" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">SAP记录</h1><p id="5fe8" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">下一步是做你已经做过的过程，但是这次要记录下每一步。</p><p id="2239" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要在SAP上记录您的操作，请单击Customize Local Layout &gt; Script Recording and Playback选项，如下图所示。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/bfaa9d3031e90c04c5a5d0e941d4520c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fh_zXWZGp6D6v5rSBSyhw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="01d6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，会出现一个带有4个按钮的小窗口:</p><ul class=""><li id="63b8" class="mu mv jg kx b ky kz lb lc le mw li mx lm my lq mz na nb nc bi translated">回放脚本(绿色)</li><li id="1a01" class="mu mv jg kx b ky nd lb ne le nf li ng lm nh lq mz na nb nc bi translated">记录脚本(红色)</li><li id="df27" class="mu mv jg kx b ky nd lb ne le nf li ng lm nh lq mz na nb nc bi translated">停止录制(灰色)</li><li id="eb22" class="mu mv jg kx b ky nd lb ne le nf li ng lm nh lq mz na nb nc bi translated">更多(黄色)</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/85a11db23a09dfbf41366f25b34988a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLOqMX7GPcgB_0iPxXxLpw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="26ba" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您点击“更多”按钮，窗口将展开两个新字段，您可以在其中定义保存设置。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/afebdef94865c1009e3799f2ffa73c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ObwdELLg0UAzYauUd3tbLw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/c9138dffdc46de7b5f831f7ce9baf87e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEycWRpP75oSEbhfiBOGMw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="1865" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">定义好一切(文件名和保存脚本的文件夹)，只需点击record按钮即可开始。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/4329ec602623dcba84d1309b0c9b9522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0xPZBhzO0zLt4iyB1zqHg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="0792" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果灰色的停止按钮变成黄色，播放和录制按钮变成灰色，您就可以知道它是否正在录制。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/53719635afa81702887e11c53cf3388f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCR7VvaHbI9X5HKpuazaXw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="3f29" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，您将执行您的日常流程。</p><p id="0015" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">举个简单的例子，我的任务是“提取一些采购文件信息”</p><p id="eba1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，首先要访问ME2N事务。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/068700f1612b4f37f6dd99dee760f3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4oCo0p8fU4tx-BMvf0ORow.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="f52e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦加载了事务，我必须执行两个操作:</p><ul class=""><li id="1a0e" class="mu mv jg kx b ky kz lb lc le mw li mx lm my lq mz na nb nc bi translated">插入我想获取数据的采购文件</li><li id="13e8" class="mu mv jg kx b ky nd lb ne le nf li ng lm nh lq mz na nb nc bi translated">删除选择参数</li></ul><p id="7361" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我从插入文档开始，在Excel上我有三个采购文档，我从那里复制它们，并在SAP上点击采购文档的多个选择。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/c4af6cd82cd14dd6ca7218ed5b3538ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEcp38fj_w0TTw2XkBeoUg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="5f32" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在新窗口中，我单击剪贴板上的上传，粘贴我刚刚复制的文档。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/d1801bb7791a82d646212436d7df6c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arxdC2-uMwopWwgbyKse_g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="c4c7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，只需点击时钟按钮来执行条目。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/f13dca71bc887918413587fcdfb5f76e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPQyRV877scGVF-nhvrycg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="7c39" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要检查多个输入是否已注册，请检查采购文件的多选按钮是否变为绿色。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/45b0025da1413ba24898c40665069943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJoXx6RDfxrEU55sGOWkwQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="9c89" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于选择参数，我只需点击文本框并清除所有内容。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/a38dca1049c56b9cd78eaacce55fc4c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4LKehFqF9GC05QayBG-eIg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="e406" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我已经配置好了一切，让我们开始执行吧！</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/18c5a66e75802fbcbbf44ac0365946eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbJQ96-PeZ5gttf_HHrh0g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="96a8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很好，正如你所看到的，SAP已经将我文档中的数据返回给我，下一步是下载/导出它。所以我点击了一个导出本地文件的图标。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/c4aa0534138a6de26423cccc52a04a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLUi__VB8iPqe-zo6ZBPYQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="f25b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我选择了用制表符导出文本选项，这是我的个人偏好，因为用Excel效果更好。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/70b7089f4461ac0452321419e085252d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9myGDPejg7kW28OFDwaWvQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="d13e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我定义了所需的目录和文件名。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/2833562ad5af62ed1738396519b99ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyeNj1FjmhZtxP5zKLPV4A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="6739" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我查看了SAP底部的消息，以检查导出是否已完成。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/354a75af967237b7f2cac3173a11a42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIBvRtksJtWC717g43KAWw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="af1a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我点击黄色按钮停止了记录。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/f86cd48b8b3fe98bb73fa8ef3f60e055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OrgYV8NY1kFsdtdvIYG2w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="c0ea" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">哒哒！您刚刚完成了您的第一个SAP记录！很简单，不是吗？</p><h1 id="b91e" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">记录结果</h1><p id="33a6" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">要查看记录的输出，只需转到您在流程开始时定义的文件夹并打开文件。</p><p id="cf9e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">乍一看，它似乎有很多代码行，你可能不明白他们在告诉你什么，没关系，保持冷静，因为我们将在下面的一些截图上工作。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nl"><img src="../Images/a071509f9589a6ba570f97278a3d2d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TVKVYqiGUY5fNx18QfH6gQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><h1 id="d422" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">在Excel上启用开发人员选项卡</h1><p id="6c34" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我们即将进入神奇的一步，但是在我们做任何事情之前，我们需要启用Excel上的Developer选项卡。如果您已经启用了它，请跳到下一个主题。</p><p id="33f3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击文件。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nm"><img src="../Images/93421b1de5bfbbd277b521c24829edbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpqU8jayU15Bv6U1gVUO_w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="6af4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击选项。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/99ca7d805345ebf38432a097077c59c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hDog7EGFQg_LOg5_1ChccA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="7e34" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将出现一个新窗口，然后单击自定义功能区。</p><p id="03d7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您将看到两个列表，在左边的一个列表中，您将找到几个复选框，其中一个是开发者，只需选中它，然后单击左下角的OK按钮即可应用更改。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nn"><img src="../Images/b50fa4ce1312c7025edde7935573e750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qoYuvszrOq0fHGiD2Qn3kA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><h1 id="06c0" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">创建子程序</h1><p id="693a" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在“开发人员”选项卡上，单击Visual Basic按钮。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nm"><img src="../Images/367524ace8b9878009a5d23dc424e429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3flDaWwIkD-ejSyXAz6oww.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="20be" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要开始修改SAP记录，我们需要创建一个模块，所以继续插入&gt;模块</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/aa35d3a1f44c8154dc67b1169545b0f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-hZVCmguoDJkfwH9uPlSEQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="adc5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">创建的模块将出现在你左边的项目窗口中，如果它没有自己打开，双击模块即可。</p><p id="7474" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">打开模块，创建一个子程序，我称之为“测试”，现在粘贴SAP记录中的代码。</p><p id="09d2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一个技巧，VBA认为“应用”这个词是一个保留字，这意味着这个词在VBA有一个特殊的应用，如果不按照它的设计用途使用，就会导致错误。</p><p id="0771" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">解释完之后，我们需要将出现在代码开头的四个“应用程序”更改为任何可用的变量名。我一般用“APP”来代替。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/23c7109339ac3f20955ca0042996b13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZQj_8DDZMwlNGOCcFFGgg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="0a14" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了让您更好地了解Excel和SAP之间的匹配，我在C列和D列中添加了SAP文件导出所需的目录和文件名。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi no"><img src="../Images/ab21e2f4c41539011bda51670ab51ef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3TH44ohbqw8d5rQheTcpw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="4933" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">记住这个布局，我们可以继续编辑我们的子程序。</p><p id="34f2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我在下面的截图中突出显示了代码的三个部分。</p><p id="74e3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，<strong class="kx jh">绿色的一个</strong>，在这里我创建了一个“是否存在一个要提取的文档？”检查。为了做到这一点，我有一个名为last_rows的变量，其中存储了第一行的值/不为空，从A列的最后一行开始向上。</p><p id="006d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我的布局I在A列有一个标题，我知道如果我至少有一个文档，它应该从第二行开始，所以我添加了一个if语句来检查它，这样当A列没有文档时我就不会执行代码。</p><p id="541e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">黄色高亮</strong>只是为了显示被替换的应用程序。</p><p id="cbfe" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">红色高亮</strong>显示了一件重要的事情。SAP记录器，顾名思义，只记录SAP上发生的事情。</p><p id="9a67" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">还记得我不得不从纸上复制采购文件，然后粘贴吗？记录器不会记住它，因为它发生在Excel上，所以如果你在记录器输出时执行它，你应该会有一个错误，因为代码会试图粘贴它没有复制的东西。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/0626907b353904f30ba9a545475ebf3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*setFlJTAzWvsfOLIlWNIgw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="f0f1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于下一个截图，记得我删除了选择参数字段上的内容吗？在绿色突出显示的<strong class="kx jh">中可以看到这种变化。SAP将其解释为一个空字符串的输入。</strong></p><p id="388d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，如果您想将选择参数更改为另一个参数而不是删除它，您只需将<strong class="kx jh"/>更改为<strong class="kx jh">【您的参数】</strong>。</p><p id="cd52" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">除了编写字符串代码，你还可以做的另一件事是<strong class="kx jh">从Excel单元格</strong>中获取一个值，这就是发生在<strong class="kx jh">紫色</strong>和<strong class="kx jh">灰色高亮</strong>上的事情。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/d330336e3630bb618c4f69d74360e560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qb6Cec05N5J3R3eOS1HUHQ.png"/></div></div></figure><h1 id="0839" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">将宏添加到按钮</h1><p id="c7ec" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">为了完成并使它变得更容易，你可以添加一个按钮来开始执行你的例程。</p><p id="96b7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，你需要进入插入&gt;插图&gt;形状，然后选择你最喜欢的形状。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/9fc02b0266ecc29fbd0b027e0205d2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8bdskNu3dhEsU44LsGaqQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="a35e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，你可以添加一些文本到你的按钮上，左键点击并选择“分配宏”选项</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nm"><img src="../Images/268d421ce8ac59dce67a3a70acdd8e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HiAv7relI3oqOq8kZOnnA.png"/></div></div></figure><p id="65f2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">新窗口将显示您在此工作簿中的所有可用子程序，在我们的示例中，我们只有“测试”子程序。</p><p id="2107" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击它，然后依次点击确定</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b8b3f4ce14f494ed79f9dcde1cdb2041.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*pHhjJg29xYC21aavunHWjg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: Writer</figcaption></figure><p id="fa35" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，您只需将文件保存为. xlsm或. xlsb格式，这样它就能保存您的VBA代码。</p><p id="2582" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我更喜欢。xlsb，因为它的工作原理与。xlsm，但大小只有它的一半。</p><h1 id="3440" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">这就是了！</h1><p id="944b" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">有了这个，我想你可以开始创建你自己的SAP自动化了！</p><p id="78ae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">希望这篇文章对你有帮助！</p><p id="4bc4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在这里看到这个项目的代码:</p><div class="ip iq gp gr ir nq"><a href="https://github.com/rfpcordeiro/vba-sap-automation-example" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jh gy z fp nv fr fs nw fu fw jf bi translated">rfpcordeiro/VBA-sap-自动化-示例</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">一个简单的例子，展示了使用Excel和VBA自动化SAP交易是多么容易。GitHub是超过50个…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">github.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ix nq"/></div></div></a></div><blockquote class="of og oh"><p id="f86c" class="kv kw oi kx b ky kz kh la lb lc kk ld oj lf lg lh ok lj lk ll ol ln lo lp lq ij bi translated">特别感谢Samanta Tomaz帮助我为你选择了一个好榜样！</p></blockquote></div></div>    
</body>
</html>