<html>
<head>
<title>SAP Automation of Orders Creation for Retail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SAP零售订单创建自动化</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/sap-automation-for-retail-using-vb-and-python-part-3-po-creation-36ae2d1baedb?source=collection_archive---------1-----------------------#2020-07-29">https://medium.datadriveninvestor.com/sap-automation-for-retail-using-vb-and-python-part-3-po-creation-36ae2d1baedb?source=collection_archive---------1-----------------------#2020-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9d05" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Visual Basic通过SAP GUI脚本工具在SAP中自动创建采购订单</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/ee7b5dcfbf0125d08ff4cc0ad548846b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*i7aSJtJ1JixL_AGeEAKaag.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Orders Creation Automation with SAP for Retail Using VB — (Image by Author)</figcaption></figure><p id="91f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文是关于面向零售业的SAP GUI自动化系列文章的一部分。(可以找到第一部: <a class="ae lo" href="https://medium.com/@s.saci95/sap-automation-for-retail-using-vb-and-python-part-1-intro-to-sap-gui-scripting-2b065e122c6f?source=friends_link&amp;sk=8a2708ffb63c2c9fa1ad61055bcab346" rel="noopener"> <em class="ln">第一部</em> </a> <em class="ln"> ) </em></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="de33" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">I .在SAP系统中创建采购订单</h1><h2 id="2800" class="mo lx iq bd ly mp mq dn mc mr ms dp mg la mt mu mi le mv mw mk li mx my mm mz bi translated">1.什么是采购订单？</h2><p id="9e99" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">在SAP Retail中，采购订单是一份商业文件，表明产品或服务的类型、数量、商定价格和交付信息(地点、时间)。</p><p id="01fc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">场景</strong></p><p id="9c31" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">作为一名商店经理，你想以<strong class="kt ir">约定价格200美元</strong>订购<strong class="kt ir"> 10件商品</strong> <em class="ln"> (SAP代码:145654789 ) </em>，由<strong class="kt ir">供应商XXX-XXX </strong>(供应商代码:15487)于<strong class="kt ir"> WH01 </strong>于2020年9月20日<strong class="kt ir">交货。</strong></p><p id="6de8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你的商店隶属于零售公司(代码:RTCP)的采购组织(代码:PORG)，有一个专门的采购经理(代码:PRGP)。</p><blockquote class="nf ng nh"><p id="a886" class="kr ks ln kt b ku kv jr kw kx ky ju kz ni lb lc ld nj lf lg lh nk lj lk ll lm ij bi translated">编辑:你可以在下面的链接中找到这篇文章的Youtube版本和动画。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="4f2a" class="mo lx iq bd ly mp mq dn mc mr ms dp mg la mt mu mi le mv mw mk li mx my mm mz bi translated">2.如何在SAP中创建采购订单？</h2><p id="936c" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">ME21N事务可用于操作采购订单创建</p><ol class=""><li id="fb9d" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ns nt nu nv bi translated">启动交易ME21N</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/ab34737bc3944f516caaa1fa22b792e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-eXIGWD405JucqrFdtqcA.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">SAP Transaction ME21N for Purchase Order Creation — (Image by Author)</figcaption></figure><p id="2fe0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要创建采购订单，我们需要填写</p><ul class=""><li id="1ae0" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ob nt nu nv bi translated"><strong class="kt ir">供应商代码:</strong> 15487</li><li id="0410" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">采购组织:</strong> PORG</li><li id="70f6" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">采购组:</strong> PRGP</li><li id="3978" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">公司代码:</strong> RTCP</li><li id="ce91" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">材质:</strong> 145654789</li><li id="dea1" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">采购订单数量:</strong> 10</li><li id="80e7" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">工厂:</strong> WH01</li><li id="f510" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated">交货日期:2020年9月20日</li></ul><p id="cd0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2.验证和保存</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/627c7add7d1debc1e2615a5caa99288c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dWGaJwzyTD4La3nApuUn3A.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">SAP Transaction ME21N for Purchase Order Creation (Step 2) — (Image by Author)</figcaption></figure><p id="9656" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">按下回车键后，SAP从采购信息记录、链接到SAP代码和采购组织的主数据中加载缺失的PO信息。然后，我们可以在系统中保存带有采购订单编号的采购订单。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oi"><img src="../Images/5a288b9bb89127adac3130a7bf684e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S1s-6bBIeWXbyWPXJ_tMog.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">SAP Transaction ME21N for Purchase Order Creation (Step 2) — (Image by Author)</figcaption></figure><p id="2934" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">3.入住ME23N</p><p id="509d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建采购订单后，我们可以检查ME23N采购订单是否已创建，并提取记录的采购订单编号。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/4083e6a6c9ba08e6c8675178a0460d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*763gwpo02FcOzU4lCTnUtg.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">SAP Transaction ME21N for Purchase Order Creation (Step 3) — (Image by Author)</figcaption></figure><p id="2c74" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">4.手动子任务</p><p id="7f09" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要执行此PO创建，您需要操作一组手动子任务。我将这些任务分成两类:</p><ul class=""><li id="ffd6" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ob nt nu nv bi translated"><strong class="kt ir"> 1。手动数据输入:</strong>填写表格、点击按钮、上传数据以及任何其他从用户到SAP GUI的信息传输动作</li><li id="af96" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir"> 2。手动数据提取:</strong>检查结果、下载报告、导出表格或从SAP GUI向用户传输信息的任何其他动作</li></ul><p id="ef4b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于当前示例，事务表单填写任务可以放在类别1中，而PO编号提取可以放在类别2中。</p><h2 id="fcb7" class="mo lx iq bd ly mp mq dn mc mr ms dp mg la mt mu mi le mv mw mk li mx my mm mz bi translated">3.如何使用SAP GUI脚本自动创建采购订单？</h2><p id="1a9b" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">目标是用Excel文件中的Visual Basic脚本完全自动化该过程，其中输入数据将被提取，输出数据将被记录。</p><ol class=""><li id="b0e3" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ns nt nu nv bi translated"><strong class="kt ir">目标=全自动机器人</strong></li></ol><p id="74c7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Excel电子表格中包含各工厂的文章列表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oj"><img src="../Images/e5b90163cf4422095d6562b61e829151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mMrAHKoDIU6AZIXAi0sz3Q.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Excel Input File with PO Creation Parameters — (Image by Author)</figcaption></figure><ul class=""><li id="2549" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ob nt nu nv bi translated"><strong class="kt ir">A栏/../H: </strong>工厂、采购组、供应商代码、物料代码、条形码、数量、采购组织将被键入采购订单创建表单<strong class="kt ir">【1】</strong></li><li id="da4a" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">E列:</strong>从创建报告ME23N<strong class="kt ir">【2】</strong>中提取的采购订单编号</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/f6a8f355133d7fc69939d978f12d3482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*yok0IkzywT009AJLwdqrrg.gif"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Automation Bot performing Purchase Order Creation — (Image by Author)</figcaption></figure><p id="1c4c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 2。Excel VBA脚本</strong></p><p id="b713" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">查看第1部分中的两个简单示例，我们知道我们的VBA代码需要包括三个部分:</p><ol class=""><li id="171a" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ns nt nu nv bi translated"><strong class="kt ir">设置与SAP GUI的连接:</strong>过程Create_SAP_Session</li><li id="740e" class="nn no iq kt b ku oc kx od la oe le of li og lm ns nt nu nv bi translated"><strong class="kt ir">执行活动的脚本:</strong>名为PO_Function的函数执行PO创建</li><li id="7653" class="nn no iq kt b ku oc kx od la oe le of li og lm ns nt nu nv bi translated"><strong class="kt ir">在Excel文件中循环:</strong>名为PO_Process的过程循环所有行以创建所有列出的PO</li></ol><blockquote class="nf ng nh"><p id="f17c" class="kr ks ln kt b ku kv jr kw kx ky ju kz ni lb lc ld nj lf lg lh nk lj lk ll lm ij bi translated">你可以在这个Github资源库中找到完整的代码:<a class="ae lo" href="https://github.com/samirsaci/sap-automation-po" rel="noopener ugc nofollow" target="_blank">链接</a>。<br/>我与其他项目的投资组合:<a class="ae lo" href="https://samirsaci.com/" rel="noopener ugc nofollow" target="_blank">萨米尔萨奇</a></p></blockquote><p id="c3f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="ln">声明公共变量</em> </strong></p><pre class="kg kh ki kj gt ol om on oo aw op bi"><span id="0ad9" class="mo lx iq om b gy oq or l os ot">Option Explicit</span><span id="8e0c" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'Variables for SAP GUI Tool</strong><br/>Public SapGuiAuto, WScript, msgcol<br/>Public objGui  As GuiApplication<br/>Public objConn As GuiConnection<br/>Public session As GuiSession<br/>Public objSBar As GuiStatusbar<br/>Public objSheet As Worksheet</span><span id="f3b4" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'Variables for Functions</strong><br/>Public Plant, SAP_CODE, Listing_Procedure As String<br/>Dim W_System<br/>Dim iCtr As Integer</span></pre><blockquote class="nf ng nh"><p id="c6c1" class="kr ks ln kt b ku kv jr kw kx ky ju kz ni lb lc ld nj lf lg lh nk lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">设置与SAP GUI的连接</em> </strong></p></blockquote></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ov"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd ir gy z fp pa fr fs pb fu fw ip bi translated">萨米尔·萨奇</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">数据科学博客，专注于仓储，运输，数据可视化和机器人流程自动化…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">samirsaci.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj kl ov"/></div></div></a></div></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt ol om on oo aw op bi"><span id="f9f4" class="mo lx iq om b gy oq or l os ot">Function Create_SAP_Session() As Boolean<br/><strong class="om ir">'Function to Connect with SAP GUI Sessions</strong></span><span id="5deb" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(1) Variables for Session Creation</strong><br/>Dim il, it<br/>Dim W_conn, W_Sess, tcode, Transac, Info_System<br/>Dim N_Gui As Integer<br/>Dim A1, A2 As String<br/>tcode = Sheets(1).Range("B3") 'Get Transaction Code</span><span id="56ed" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(2) Get System Name in Cell(2,1) of Sheet1</strong><br/>If mysystem = "" Then<br/>    W_System = Sheets(1).Cells(2, 2)<br/>Else<br/>    W_System = mysystem<br/>End If</span><span id="c14d" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(3) If we are already connected to a Session we exit this function</strong><br/>If W_System = "" Then<br/>   Create_SAP_Session = False<br/>   Exit Function<br/>End If</span><span id="bf60" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(4) If Object Session is not null and the system is matching with the one we target: we use this object</strong><br/>If Not session Is Nothing Then<br/>    If session.Info.SystemName &amp; session.Info.Client = W_System Then<br/>        Create_SAP_Session = True<br/>        Exit Function<br/>    End If<br/>End If</span><span id="d785" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(5) If we are not connected to anything and GUI Object is Nothing we create one</strong><br/>If objGui Is Nothing Then<br/>   Set SapGuiAuto = GetObject("SAPGUI")<br/>   Set objGui = SapGuiAuto.GetScriptingEngine<br/>End If</span><span id="50a2" class="mo lx iq om b gy ou or l os ot">'(6) Loop through all SAP GUI Sessions to find the one with the right transaction<br/>For il = 0 To objGui.Children.Count - 1<br/>    Set W_conn = objGui.Children(il + 0)<br/>    <br/>    For it = 0 To W_conn.Children.Count - 1<br/>        Set W_Sess = W_conn.Children(it + 0)<br/>        Transac = W_Sess.Info.Transaction<br/>        Info_System = W_Sess.Info.SystemName &amp; W_Sess.Info.Client<br/>        <br/>        'Check if Session Name and Transaction Code are matching then connect to it<br/>        If W_Sess.Info.SystemName &amp; W_Sess.Info.Client = W_System Then<br/>        'If W_Sess.Info.SystemName &amp; W_Sess.Info.Client = W_System And W_Sess.Info.Transaction = tcode Then<br/>            Set objConn = objGui.Children(il + 0)<br/>            Set session = objConn.Children(it + 0)<br/>            Exit For<br/>        End If<br/>        <br/>    Next<br/>    <br/>Next</span><span id="8712" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(7) If we can't find Session with the right System Name and Transaction Code: display error message</strong><br/>If session Is Nothing Then<br/>   MsgBox "There is no active session found for " + W_System + " with transaction " + tcode + ".", vbCritical + vbOKOnly<br/>   Create_SAP_Session = False<br/>   Exit Function<br/>End If</span><span id="b5e5" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(8) Turn on scripting mode</strong><br/>If IsObject(WScript) Then<br/>   WScript.ConnectObject session, "on"<br/>   WScript.ConnectObject objGui, "on"<br/>End If</span><span id="78c3" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(9) Confirm connection to a session</strong><br/>Create_SAP_Session = True</span><span id="a50d" class="mo lx iq om b gy ou or l os ot">End Function</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi pk"><img src="../Images/2ea114493e4b021902b7267a210d273c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tlBiCDs8idqiUImR6v1Mw.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">System Code: T01220 — (Image by Author)</figcaption></figure><p id="2afa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建链接到系统和交易代码的SAP GUI对象</p><ul class=""><li id="f468" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ob nt nu nv bi translated"><strong class="kt ir">第1步至第4步:</strong>使用GUI窗口中的系统名称连接SAP(如上图)</li><li id="c465" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">步骤5: </strong>创建SAP GUI对象</li><li id="e30e" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">步骤6: </strong>遍历所有SAP窗口，并将GUI对象链接到与事务tcode连接的对象</li><li id="69df" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">步骤7: </strong>脚本模式“开”像在SAP GUI记录工具中输出</li></ul><blockquote class="nf ng nh"><p id="12bc" class="kr ks ln kt b ku kv jr kw kx ky ju kz ni lb lc ld nj lf lg lh nk lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">脚本执行动作</em> </strong></p></blockquote><p id="cc43" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过工厂代码、SAP_Code和列表程序填写表格:</p><ul class=""><li id="3558" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ob nt nu nv bi translated"><strong class="kt ir">步骤1到2: </strong>连接到ME21N交易</li><li id="5e61" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">步骤3到8: </strong>填写表单并验证</li><li id="1fae" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">第九步:</strong>保存采购订单</li><li id="4bce" class="nn no iq kt b ku oc kx od la oe le of li og lm ob nt nu nv bi translated"><strong class="kt ir">步骤10至12: </strong>转到ME23N查看PO，获取PO#并粘贴到Excel文件中</li></ul><pre class="kg kh ki kj gt ol om on oo aw op bi"><span id="a2e6" class="mo lx iq om b gy oq or l os ot">Function PO_Function()</span><span id="681a" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(1) Declare Variables</strong><br/>Dim W_BPNumber, W_SearchTerm, PON<br/>Dim lineitems As Long<br/>Dim Sht_Name As String<br/>Dim N_Lines As Integer<br/>Dim t As Integer<br/>Sht_Name = "PO"</span><span id="8e6b" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(2) Launch_Transaction</strong><br/>session.findById("wnd[0]").Maximize<br/>session.findById("wnd[0]/tbar[0]/okcd").Text = "me21n"<br/>session.findById("wnd[0]").sendVKey 0<br/>Application.Wait (Now + TimeValue("0:00:1"))</span><span id="448a" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(3) Fill Vendor Code</strong><br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB0:SAPLMEGUI:0030/subSUB1:SAPLMEGUI:1105/ctxtMEPO_TOPLINE-SUPERFIELD").Text = Sheets(Sht_Name).Cells(2, 3)</span><span id="1df8" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(4) PurchOrg Code</strong><br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB1:SAPLMEVIEWS:1100/subSUB2:SAPLMEVIEWS:1200/subSUB1:SAPLMEGUI:1102/tabsHEADER_DETAIL/tabpTABHDT9/ssubTABSTRIPCONTROL2SUB:SAPLMEGUI:1221/ctxtMEPO1222-EKORG").Text = Sheets(Sht_Name).Cells(2, 7)</span><span id="33d9" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(5) Purch Group</strong><br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB1:SAPLMEVIEWS:1100/subSUB2:SAPLMEVIEWS:1200/subSUB1:SAPLMEGUI:1102/tabsHEADER_DETAIL/tabpTABHDT9/ssubTABSTRIPCONTROL2SUB:SAPLMEGUI:1221/ctxtMEPO1222-EKGRP").Text = Sheets(Sht_Name).Cells(2, 8)<br/>session.findById("wnd[0]").sendVKey 0</span><span id="c3c3" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(6) Loop for SAP Code</strong><br/>For t = 0 To N_Lines - 3<br/>    session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB2:SAPLMEVIEWS:1100/subSUB2:SAPLMEVIEWS:1200/subSUB1:SAPLMEGUI:1211/tblSAPLMEGUITC_1211/ctxtMEPO1211-EMATN[4," &amp; t &amp; "]").Text = Sheets(Sht_Name).Cells(t + 2, 4)<br/>Next t</span><span id="6192" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(7) Loop for Quantities</strong><br/>For t = 0 To N_Lines - 3<br/>    session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB2:SAPLMEVIEWS:1100/subSUB2:SAPLMEVIEWS:1200/subSUB1:SAPLMEGUI:1211/tblSAPLMEGUITC_1211/txtMEPO1211-MENGE[" &amp; "6," &amp; t &amp; "]").Text = Sheets(Sht_Name).Cells(t + 2, 6)<br/>Next t</span><span id="3bb9" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(8) Loop for  Plants</strong><br/>For t = 0 To N_Lines - 3<br/>    session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB2:SAPLMEVIEWS:1100/subSUB2:SAPLMEVIEWS:1200/subSUB1:SAPLMEGUI:1211/tblSAPLMEGUITC_1211/ctxtMEPO1211-NAME1[15," &amp; t &amp; "]").Text = Sheets(Sht_Name).Cells(t + 2, 1)<br/>Next t</span><span id="09c6" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(9) Click Save Button</strong><br/>session.findById("wnd[0]/tbar[0]/btn[11]").press<br/>session.findById("wnd[1]/usr/btnSPOP-VAROPTION1").press<br/>session.findById("wnd[0]/sbar").DoubleClick</span><span id="b9a1" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(10) Leave and go to Me23n</strong><br/>session.findById("wnd[0]/tbar[0]/btn[3]").press<br/>session.findById("wnd[0]/tbar[0]/okcd").Text = "me23n"<br/>session.findById("wnd[0]").sendVKey 0<br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0020/subSUB3:SAPLMEVIEWS:1100/subSUB1:SAPLMEVIEWS:4002/btnDYN_4000-BUTTON").press<br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB0:SAPLMEGUI:0030/subSUB1:SAPLMEGUI:1105/txtMEPO_TOPLINE-EBELN").SetFocus<br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB0:SAPLMEGUI:0030/subSUB1:SAPLMEGUI:1105/txtMEPO_TOPLINE-EBELN").caretPosition = 1</span><span id="a917" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(11) Copy PO# and paste it in Excel File</strong><br/>session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB0:SAPLMEGUI:0030/subSUB1:SAPLMEGUI:1105/txtMEPO_TOPLINE-EBELN").SetFocus<br/>PON = session.findById("wnd[0]/usr/subSUB0:SAPLMEGUI:0013/subSUB0:SAPLMEGUI:0030/subSUB1:SAPLMEGUI:1105/txtMEPO_TOPLINE-EBELN").Text<br/>N_Lines = 1<br/>While Not (Sheets(Sht_Name).Cells(N_Lines, 1) = "")<br/>    N_Lines = N_Lines + 1<br/>    Sheets(Sht_Name).Cells(N_Lines, 9) = PON<br/>Wend</span><span id="62a6" class="mo lx iq om b gy ou or l os ot"><strong class="om ir">'(12) Leave Ready to go back to Menu</strong><br/>session.findById("wnd[0]/tbar[0]/btn[3]").press</span><span id="976a" class="mo lx iq om b gy ou or l os ot">End Function</span></pre></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="2a1d" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">二。结论和下一步措施</h1><p id="6fc6" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated"><em class="ln">关注我的medium，了解更多与供应链数据科学相关的见解。</em></p><p id="be71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个例子是一个自动化PO创建过程的简单解决方案，稍加定制，它还可以用来修改已经创建的PO。</p><p id="83f6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在下一部分，我们将了解如何:</p><ul class=""><li id="8b52" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ob nt nu nv bi translated"><strong class="kt ir"> 3。货物转移订单提取:</strong>货物转移允许您在一次数据输入交易中映射系统中的转移交货</li></ul></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="e056" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">参考</h1><p id="fe65" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">[1] <a class="pl pm ep" href="https://medium.com/u/bb0f26d52754?source=post_page-----36ae2d1baedb--------------------------------" rel="noopener" target="_blank"> Samir Saci </a>，使用VB的SAP零售自动化</p><div class="pn po gp gr pp ov"><a href="https://www.samirsaci.com/sap-automation-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd ir gy z fp pa fr fs pb fu fw ip bi translated">面向零售业的SAP自动化</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">自动化和报告设计RPA解决方案使用通过SAP GUI脚本工具构建的Visual Basic脚本设计RPA…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">www.samirsaci.com</p></div></div><div class="pe l"><div class="pq l pg ph pi pe pj kl ov"/></div></div></a></div><p id="2f94" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">[2] <a class="pl pm ep" href="https://medium.com/u/bb0f26d52754?source=post_page-----36ae2d1baedb--------------------------------" rel="noopener" target="_blank"> Samir Saci </a>，使用VB实现SAP零售产品列表自动化</p><div class="pn po gp gr pp ov"><a href="https://www.samirsaci.com/sap-automation-of-product-listing-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd ir gy z fp pa fr fs pb fu fw ip bi translated">SAP零售产品列表自动化| Samir Saci</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">自动化和报告使用Visual Basic自动化产品，通过SAP GUI脚本工具在SAP中自动列出产品…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">www.samirsaci.com</p></div></div><div class="pe l"><div class="pr l pg ph pi pe pj kl ov"/></div></div></a></div></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="61d2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你对供应链分析感兴趣，可以看看我的网站</p><div class="pn po gp gr pp ov"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd ir gy z fp pa fr fs pb fu fw ip bi translated">萨米尔·萨奇</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">数据科学博客，专注于仓储，运输，数据可视化和机器人流程自动化…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">samirsaci.com</p></div></div><div class="pe l"><div class="ps l pg ph pi pe pj kl ov"/></div></div></a></div></div></div>    
</body>
</html>