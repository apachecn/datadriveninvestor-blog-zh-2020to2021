<html>
<head>
<title>Retrieve Financial Ratios with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python检索财务比率</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/retrieve-financial-ratios-with-python-e1dc4aba1f92?source=collection_archive---------5-----------------------#2020-01-24">https://medium.datadriveninvestor.com/retrieve-financial-ratios-with-python-e1dc4aba1f92?source=collection_archive---------5-----------------------#2020-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6e79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">原载于2020年1月24日https://codingandfun.com</em><a class="ae km" href="https://codingandfun.com/retrieve-financial-ratios-with-python/" rel="noopener ugc nofollow" target="_blank"><em class="kl"/></a><em class="kl">。</em></p><p id="6095" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">财务比率是检验上市公司吸引力的非常有用的工具。它帮助投资者在决定是否购买一家公司的股票之前回答关键问题。</p><p id="5d20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有<strong class="jp ir">种不同类型的财务比率</strong>。在最常用的类别中，我们发现<em class="kl">营运</em>、<em class="kl">流动性</em>、<em class="kl">偿付能力</em>、<em class="kl">盈利能力</em>和<em class="kl">估值</em>比率。每个比率类别都有助于投资者、债权人等。回答不同公司的不同问题。偿付能力和流动性比率将让我们知道一个公司是否有能力履行短期和长期义务。盈利率显示了公司的盈利能力等。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/88342959ffe1c03d041570c9c5df9480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jFt5_oAt94qQMwX8"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Financial Ratios with Python</figcaption></figure><blockquote class="ld le lf"><p id="2386" class="jn jo kl jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated">除非我们用财务比率来比较一个行业内的公司，否则财务比率并不能给我们太多的洞察力。</p></blockquote><p id="20b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获取计算财务比率的数据并不困难。我们只需要去任何一家公司的公开财务报表，就可以得到想要的数据。然而，由于我们需要提取大量数据，这可能是一项耗时的工作。最重要的是，理想情况下，我们需要一些公司的数据来进行适当的比较。</p><p id="97d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">好消息，也是我想在这篇文章中与你分享的，就是我们可以使用Python </strong>和免费的<a class="ae km" href="https://financialmodelingprep.com/" rel="noopener ugc nofollow" target="_blank">Financialmodelingprep</a>API来获取数据，从而完全自动化财务比率的计算。正如你现在看到的，这是非常容易和快捷的。</p><p id="3791" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，我在Youtube上也有一个视频教程，一步一步地解释代码在做什么。我建议您浏览视频，理解剧本中使用的每一句台词:</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="lj lk l"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Python for Finance</figcaption></figure><p id="d8b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">开始编码吧</strong>。首先，我们导入所有需要的模块，并开始向<a class="ae km" href="https://financialmodelingprep.com/developer/docs/" rel="noopener ugc nofollow" target="_blank"><em class="kl">FinancialModellingPrep</em></a>API发出API请求，以检索我们传递给<em class="kl">财务比率</em>函数的任何公司的所有财务比率。我们将使用<em class="kl"> Pandas </em>、<em class="kl"> Requests </em>和J <em class="kl"> son </em>库来处理数据。</p><pre class="ko kp kq kr gt ll lm ln lo aw lp bi"><span id="6754" class="lq lr iq lm b gy ls lt l lu lv">import pandas as pd <br/>import requests <br/>import json</span><span id="9ea2" class="lq lr iq lm b gy lw lt l lu lv">def financialratios(quote):</span><span id="cf99" class="lq lr iq lm b gy lw lt l lu lv">fr =  requests.get(f"<a class="ae km" href="https://financialmodelingprep.com/api/v3/financial-ratios/%7Bquote" rel="noopener ugc nofollow" target="_blank">https://financialmodelingprep.com/api/v3/financial- ratios/{quote</a>}")</span><span id="81a5" class="lq lr iq lm b gy lw lt l lu lv">fr = fr.json()</span></pre><p id="cafb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将API响应存储在一个变量调用<em class="kl"> fr </em>中，该变量调用将被转换为json，以便我们可以在Python中使用它。</p><p id="d599" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们存储从API端点返回的列表的第一个元素。注意，我们只保留数组的第一个元素，因为它包含最新的可用数据。然后，我们将每个财务比率类别存储在一个变量中，以便稍后将其转换为Pandas数据框架:</p><pre class="ko kp kq kr gt ll lm ln lo aw lp bi"><span id="7c4e" class="lq lr iq lm b gy ls lt l lu lv">valuation = fr['ratios'][0]['investmentValuationRatios']</span><span id="ee3c" class="lq lr iq lm b gy lw lt l lu lv">profitability = fr['ratios'][0]['profitabilityIndicatorRatios']</span><span id="a83d" class="lq lr iq lm b gy lw lt l lu lv">operating = fr['ratios'][0]['operatingPerformanceRatios']</span><span id="9428" class="lq lr iq lm b gy lw lt l lu lv">liquidity = fr['ratios'][0]['liquidityMeasurementRatios']</span><span id="15a3" class="lq lr iq lm b gy lw lt l lu lv">debt = fr['ratios'][0]['debtRatios']</span><span id="ec95" class="lq lr iq lm b gy lw lt l lu lv">valuation = pd.DataFrame(list(valuation.items()),columns=['Ratio', quote])</span><span id="c037" class="lq lr iq lm b gy lw lt l lu lv">profitability = pd.DataFrame(list(profitability.items()),columns=['Ratio', quote])</span><span id="42f4" class="lq lr iq lm b gy lw lt l lu lv">operating = pd.DataFrame(list(operating.items()),columns=['Ratio', quote])</span><span id="7b2c" class="lq lr iq lm b gy lw lt l lu lv">liquidity = pd.DataFrame(list(liquidity.items()),columns=['Ratio', quote])</span><span id="d304" class="lq lr iq lm b gy lw lt l lu lv">debt = pd.DataFrame(list(debt.items()),columns=['Ratio', quote])</span></pre><p id="9d2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果，我们有五个熊猫数据框。每个财务比率类别一个熊猫数据框架。例如，在变量<em class="kl">债务</em>中，我们有传递给我们函数的任何公司的所有债务财务比率。当我们经过“AAPL”(即苹果公司的股票代码)时，请参见下面的债务内容示例:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/e2f6a23c030b01860c8e9cd6392c85de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/0*RuvNhRflWH1lvZ4a"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Debt Ratios Python</figcaption></figure><p id="c6af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步，让我们将所有财务比率类别连接成一个单一的Pandas数据框架。我们可以首先创建一个包含每个熊猫数据帧的列表，通过使用<em class="kl"> pd.concat </em>函数，我们将它们合并成一个数据帧，存储在一个名为<em class="kl"> result </em>的变量中。然后，作为我们函数的一部分，我们返回连接的<em class="kl">结果</em> <strong class="jp ir">，这是我们合并的熊猫数据帧</strong>。</p><pre class="ko kp kq kr gt ll lm ln lo aw lp bi"><span id="6d0d" class="lq lr iq lm b gy ls lt l lu lv">frames = [valuation,profitability,operating,liquidity,debt]</span><span id="52bd" class="lq lr iq lm b gy lw lt l lu lv">result = pd.concat(frames)</span><span id="eefa" class="lq lr iq lm b gy lw lt l lu lv">return result</span></pre><p id="16e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很好，现在我们把所有的比率都放在一个熊猫数据框里了。但是，如前所述，我们不能通过查看单个公司的比率来得出任何结论。我们需要在同一个行业的不同公司之间进行比较。</p><p id="1750" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们要比较<em class="kl">脸书</em>、<em class="kl">苹果</em>和<em class="kl">微软</em>，我们可以只对每家公司运行三次我们的代码，然后一个比一个比地进行比较。但是，有一种更好、更有效的方法可以做到这一点。</p><p id="ba42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们将不同公司的所有财务比率放在一个数据框架中，以便更好地进行比较。我们可以简单地通过循环遍历我们的股票列表，并将列表中的每家公司合并到初始的Pandas数据框架中。这就是我们在下面几行代码中所做的。请随意添加您感兴趣的任何其他公司！</p><pre class="ko kp kq kr gt ll lm ln lo aw lp bi"><span id="160d" class="lq lr iq lm b gy ls lt l lu lv">listofstocks = ['AAPL','MSFT','FB','TSLA']</span><span id="3e04" class="lq lr iq lm b gy lw lt l lu lv">x = financialratios('GOOGL')</span><span id="9b12" class="lq lr iq lm b gy lw lt l lu lv">for item in listofstocks: y = financialratios(item)</span><span id="99d7" class="lq lr iq lm b gy lw lt l lu lv">x = x.merge(y,on='Ratio')</span></pre><p id="4011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在我们的x变量中，我们有一个包含5个不同公司的财务比率的熊猫数据框架。现在，我们可以开始寻找并对这些公司做出一些好的结论。</p><p id="e442" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这个脚本对您的分析有用！</p><h2 id="9103" class="lq lr iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">查看下图我们的财务比率熊猫数据框。非常有用的脚本来比较不同公司的财务比率。</h2><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/1538ed8ce0c6817c704286a860524d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lNLSoAlJA3mRplOb"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Financial Ratios by company with Python</figcaption></figure><p id="36c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果有不清楚的地方，我推荐你看上面的Youtube视频，视频中所有代码都是逐行解释的！</p></div></div>    
</body>
</html>