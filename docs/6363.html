<html>
<head>
<title>A Guide To Creating An Automatic Mail Sending System With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python创建自动邮件发送系统的指南</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/a-guide-to-creating-an-automatic-mail-sending-system-with-python-c39ffbc5f7f3?source=collection_archive---------5-----------------------#2020-10-22">https://medium.datadriveninvestor.com/a-guide-to-creating-an-automatic-mail-sending-system-with-python-c39ffbc5f7f3?source=collection_archive---------5-----------------------#2020-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="27e9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">适用于每个人的实用指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/16c4d3f7f72ff26f9bb135d56dd52d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*egHDCVRRhWo-mUlu"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Brett Jordan</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3b71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">T</span>Python语言有许多优势，让日常生活变得更容易。它为我们的日常工作提供了巨大的好处，这可以通过自动化过程手动完成。在本文中，我们将通过python创建一个自动电子邮件发送系统，我们将分别讨论该系统的所有代码片段。为此，我们将遵循以下步骤。</p><ul class=""><li id="9c21" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">用‘cmd’创建文件</strong></li><li id="84ac" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><strong class="lb iu">蟒蛇基本操作</strong></li><li id="db29" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><strong class="lb iu">连接电子邮件服务器</strong></li><li id="67d9" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><strong class="lb iu">发邮件</strong></li><li id="f472" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><strong class="lb iu">针对错误发生采取的措施</strong></li></ul><blockquote class="ms"><p id="fa84" class="mt mu it bd mv mw mx my mz na nb lu dk translated"><strong class="ak">如果你准备好了，我们开始！</strong></p></blockquote></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h1 id="df9d" class="nj nk it bd nl nm nn no np nq nr ns nt jz nu ka nv kc nw kd nx kf ny kg nz oa bi translated">1.步骤:<strong class="ak">用“cmd”创建文件</strong></h1><ul class=""><li id="f800" class="me mf it lb b lc ob lf oc li od lm oe lq of lu mj mk ml mm bi translated">有了cmd，我们将首先在桌面上创建一个文件。为此，我们用下面一行来访问文件。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="32cf" class="ol nk it oh b gy om on l oo op">C:Users\User\Desktop</span></pre><ul class=""><li id="5a39" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">我们通过键入<strong class="lb iu">‘mkdirsendmail’</strong>来创建第一个文件</li><li id="db12" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">通过<strong class="lb iu">“CD SendMail”</strong>我们可以进入这个文件夹。我们现在在我们刚刚创建的文件夹中，如下所示。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="7545" class="ol nk it oh b gy om on l oo op">C:Users\User\Desktop\SendMail</span></pre><ul class=""><li id="e8cd" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">然后我们编写<strong class="lb iu">“拷贝nul app . py”</strong>,并将python文件写入一个空应用程序的文件夹中。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="5c83" class="ol nk it oh b gy om on l oo op">C:Users\User\Desktop\SendMail &gt; copy nul app.py<br/>                 1 file(s)copied</span></pre><ul class=""><li id="9ea6" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">现在我们带着<strong class="lb iu">“CD ..”回到桌面</strong>命令。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="656c" class="ol nk it oh b gy om on l oo op">C:Users\User\Desktop\SendMail&gt; cd ..</span></pre><ul class=""><li id="c294" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">现在我们正自动尝试在VisualStudio中打开代码就绪文件。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="f02a" class="ol nk it oh b gy om on l oo op">C:Users\User\Desktop\code SendMail</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/6b510bb181c8815afcd09583ce57091a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-0SFa0hBpteNukMsZE_LA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Our file is automatically opened to write our codes</figcaption></figure><h1 id="123e" class="nj nk it bd nl nm or no np nq os ns nt jz ot ka nv kc ou kd nx kf ov kg nz oa bi translated">2.步骤:Python中的基本操作</h1><ul class=""><li id="ba68" class="me mf it lb b lc ob lf oc li od lm oe lq of lu mj mk ml mm bi translated"><strong class="lb iu"> SMTP: </strong>我们使用<strong class="lb iu">‘smtplib’</strong>模块自动发送邮件。(不需要安装，因为它附带Python。)我们从包含<strong class="lb iu"> SMTP </strong>类开始。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="ec76" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">from smtplib import SMTP</strong></span></pre><blockquote class="ow ox oy"><p id="65ba" class="kz la oz lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">SMTP:简单邮件传输协议—是一种用于邮件操作的TCP IP协议。</p></blockquote><ul class=""><li id="b94f" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">为邮件信息创建一个变量:</strong>我们为将要发送的邮件创建一个名为“subject”的主题标题。我们还用“消息”变量创建消息的内容。然后我们创建电子邮件，将显示“内容”和这两者结合在一起。为此，我们将进行合并。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="2fa4" class="ol nk it oh b gy om on l oo op">#Information Mail Message</span><span id="c6b6" class="ol nk it oh b gy pd on l oo op"><strong class="oh iu">subject = "Test"<br/>message = "This is a test message"<br/>content = Subject = "{0}\n\n{1}".format(subject,message)</strong></span></pre><p id="83e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在创建<strong class="lb iu">【内容】</strong>变量时，我们将主题和消息之间的空间确定为两行，我们用<strong class="lb iu"> 1 </strong>发送消息，我们执行格式操作。第一个参数设置为<strong class="lb iu">主题</strong>，第二个参数设置为<strong class="lb iu">消息</strong>。</p><ul class=""><li id="ede2" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">创建邮件帐户信息:</strong>我们创建了一个名为<strong class="lb iu">‘我的邮件地址’</strong>的变量来指定我们的邮件地址。然后我们创建<strong class="lb iu">‘密码’</strong>变量。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="c68a" class="ol nk it oh b gy om on l oo op">#Information Mail Account</span><span id="67dc" class="ol nk it oh b gy pd on l oo op"><strong class="oh iu">myMailAddress = "email@gmail.com"<br/>password = "password"</strong></span></pre><ul class=""><li id="dc73" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">定义邮件要发送到的变量:</strong>在邮件内容和账户信息之后，我们需要定义邮件要发送给谁。为此，我们设置了另一个名为“sendTo”的变量。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="b4eb" class="ol nk it oh b gy om on l oo op">#Send to Message</span><span id="36e5" class="ol nk it oh b gy pd on l oo op"><strong class="oh iu">sendTo = "sendto@gmail.com"</strong></span></pre><h1 id="db0c" class="nj nk it bd nl nm or no np nq os ns nt jz ot ka nv kc ou kd nx kf ov kg nz oa bi translated">步骤3:连接到电子邮件服务器</h1><ul class=""><li id="ffd0" class="me mf it lb b lc ob lf oc li od lm oe lq of lu mj mk ml mm bi translated"><strong class="lb iu">从SMTP类创建一个邮件对象:</strong>我们创建一个名为<strong class="lb iu">‘邮件’</strong>的对象。我们在这里输入我们使用的电子邮件服务器的主机地址。由于我们使用的是<strong class="lb iu">‘Gmail’</strong>，我们需要将主机地址设置为<strong class="lb iu">‘SMTP . Gmail . com’</strong>。我们输入用作587的服务号码。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="c3d2" class="ol nk it oh b gy om on l oo op">#Set Gmail Host Address</span><span id="19e1" class="ol nk it oh b gy pd on l oo op"><strong class="oh iu">mail = SMTP("smtp.gmail.com", 587)</strong></span></pre><blockquote class="ow ox oy"><p id="5332" class="kz la oz lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">如果你要用不同的邮件服务器发送邮件，你可以通过谷歌搜索“你使用IMAP的邮件服务器”来获得最新的官方信息。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/c0cd0f17f311f81bf1d6441ce1f27718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*P6I2Vl1tpMAQofFyCyq2fg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Screenshot after search for gmail</figcaption></figure><ul class=""><li id="a595" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">连接服务器:</strong>我们将使用<strong class="lb iu">‘ehlo’</strong>函数来连接服务器。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="e428" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">mail.ehlo()</strong></span></pre><ul class=""><li id="988a" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">发送加密数据:</strong>我们将使用<strong class="lb iu">‘starttls’</strong>函数将我们的数据以加密形式发送到服务器。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="1b88" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">mail.starttls()</strong></span></pre><ul class=""><li id="afe2" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">登录:</strong>我们将使用<strong class="lb iu">‘登录’</strong>功能登录邮件服务器。这里我们需要输入我们的密码信息。我们之前已经指定了我们的<strong class="lb iu">‘my mail address’</strong>和<strong class="lb iu">‘password’</strong>变量。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="a5af" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">mail.login("myMailAddress, password")</strong></span></pre><h1 id="bbbc" class="nj nk it bd nl nm or no np nq os ns nt jz ot ka nv kc ou kd nx kf ov kg nz oa bi translated">步骤4:发送电子邮件</h1><p id="278a" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li pf lk ll lm pg lo lp lq ph ls lt lu im bi translated">现在我们已经登录到邮件服务器，我们可以发送我们的邮件。为此:</p><ul class=""><li id="f68a" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">我们将使用<strong class="lb iu">‘sendmail’</strong>功能。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="d3e1" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">mail.sendmail()</strong></span></pre><ul class=""><li id="cfd9" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">我们的第一个参数将显示是谁发送了邮件，即<strong class="lb iu"> myMailAddress </strong>，我们的第二个参数将显示邮件将发送给谁，为此创建了'<strong class="lb iu"> sendTo' </strong>变量，我们的第三个参数是邮件本身，因此我们之前设置了'<strong class="lb iu"> content </strong>'变量。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="4fa1" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">mail.sendmail("myMailAddress, sendTo, content") </strong></span></pre><blockquote class="ow ox oy"><p id="e924" class="kz la oz lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">为了避免因语言选项不同而导致邮件内容不符合您的要求，您可以使用<strong class="lb iu">‘编码’</strong>功能根据您需要的字符执行转换过程。</p></blockquote><ul class=""><li id="5226" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><strong class="lb iu">输出给用户:</strong>我们希望在最后阶段得到邮件已经发出的通知。<strong class="lb iu">那样的话:</strong></li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="53fd" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">print("Your mail has been sent successfully")</strong></span></pre><h1 id="d03c" class="nj nk it bd nl nm or no np nq os ns nt jz ot ka nv kc ou kd nx kf ov kg nz oa bi translated">步骤5:针对错误发生采取的措施</h1><ul class=""><li id="c168" class="me mf it lb b lc ob lf oc li od lm oe lq of lu mj mk ml mm bi translated">此外，让我们确定在出现错误的情况下如何继续。为此，我们将使用'<strong class="lb iu"> try-except' </strong>,我们将让所有代码行对错误做出反应。我们将把这个表示为<strong class="lb iu">【e】</strong>。</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="3062" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">try</strong></span><span id="9ed2" class="ol nk it oh b gy pd on l oo op"><strong class="oh iu">except Exception as e:<br/></strong>    </span></pre><ul class=""><li id="bc08" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">然后，我们会将错误显示为打印输出。下面一行我们要显示错误。我们将通过格式化来发送e参数。<strong class="lb iu">那样的话:</strong></li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="a3f6" class="ol nk it oh b gy om on l oo op"><strong class="oh iu">print("An error happened!\n{0}.format(e)"</strong></span></pre><p id="1f2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，整个代码阶段就完成了。你可以看到他们都在一起，如下。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pi pj l"/></div></figure></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h1 id="95ff" class="nj nk it bd nl nm nn no np nq nr ns nt jz nu ka nv kc nw kd nx kf ny kg nz oa bi translated">要点</h1><ul class=""><li id="5857" class="me mf it lb b lc ob lf oc li od lm oe lq of lu mj mk ml mm bi translated">对于Gmail用户，需要自动邮件发送流程确认。为此，您需要启用该选项以允许不太可靠的应用程序。否则，将会出现错误。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/b24a5291da1aed801625fd0add13fd3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G__by0u0G51V7uTR.png"/></div></div></figure><ul class=""><li id="ebd2" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">你可以使用<strong class="lb iu"> cmd </strong> <em class="oz"> ('py app.py) </em>来运行你的<strong class="lb iu"> SendMail </strong>项目。如果出现错误，您的屏幕将如下所示:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/082a3fc95f0f6e0f02691c84541248b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*EIoFTOBbaF_1YBIxRKDOdw.png"/></div></figure></div></div>    
</body>
</html>