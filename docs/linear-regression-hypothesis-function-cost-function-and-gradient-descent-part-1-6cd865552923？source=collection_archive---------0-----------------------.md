# 线性回归:假设函数、成本函数和梯度下降。你需要知道的一切！

> 原文：<https://medium.datadriveninvestor.com/linear-regression-hypothesis-function-cost-function-and-gradient-descent-part-1-6cd865552923?source=collection_archive---------0----------------------->

## 内部人工智能

## 最著名的监督学习技术背后的数学和理论

![](img/4201b3e2ed1ce44c0dd35e6cce35327a.png)

Photo by [Jonas Verstuyft](https://unsplash.com/@verstuyftj?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/bridge?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

在本文中，您将了解监督学习中使用的线性回归技术的所有内容。您将学习成本函数和梯度下降背后的理论和数学。之后，您还将实现特征缩放以快速获得结果，然后最终矢量化。到本文结束时，您将能够在 Octave/Matlab 中编写实现单变量线性回归的代码。在图表上绘制数据，并观察线条如何与数据相吻合。

# 监督学习:-

如果你选择阅读这篇文章，那么你很有可能熟悉监督学习。如果是这种情况，那么你可以跳过这一节。对于那些不了解监督学习的人，让我给你一点关于监督学习的概念。在机器学习中，我们使用不同的模型和技术来训练我们的机器。几乎所有的模型都属于三个主要类别。

![](img/e0d5d0196c40bc2636c873c4afd37eb5.png)

credits:edureka.co

由于我们关注的是监督学习，我将只谈论这一点。让我试着用最基本的例子来解释。假设你从事房地产已经多年。你可以很容易地预测一所房子/房产的价格，只需考虑该房子/房产的一些特征，如土地面积、邻居、卧室数量(如果是房子)等。你想休息一下，但又不想停止你的业务。你雇了一个助理，但他/她对不同房子/房产的价格一无所知。你会怎么做？最好的方法是训练你的助手正确预测房子/房产的价格，以便在买卖时获得最大利润。但是你要怎么教你的助手呢？没有必要担心那个。只要在销售或购买物业时将他/她带在身边一个月左右，一个月后，他/她就会相当擅长预测。但是你的助理是怎么学的呢？记住，房子/房产的特点和它们的价格是有关系的。通过考虑房子/房产的特点，然后观察你以特定的价格购买房子/房产，你的助手收集了不同房子和特点及其价格的数据。这是监督学习(线性回归)的核心概念。你首先给程序一些数据，并输出这些数据，以便训练，然后训练后程序自己预测输出。

还有一个关于无监督学习的概念，叫做分类，但是对于这个领域，我们不需要知道它。

![](img/f7c8a599d5237771b8860c7c8d5c4e77.png)

credits:[https://afit-r.github.io/](https://afit-r.github.io/)

# 线性回归:-

考虑我在上一段中给出的关于预测房屋或财产价格的例子[我知道你们可能跳过了上面的部分，但是你们可能对预测房屋价格的例子很熟悉。].我们将使用线性回归来实现这个想法。在这类问题[线性回归]中，我们打算用连续的输出流来预测结果。对于不同的输入值，该函数被映射到不同的输出值。

![](img/cefd7bc99afa867f3552c0f69cae9302.png)

为简单起见，我们将首先考虑只有一个变量的线性回归

# 模型表示:-

为了稍微更正式地描述监督学习问题，我们的目标是，给定一个训练集，学习一个函数 h:X → Y，使得 h(x)是相应 Y 的“好”预测器。h(x)被称为假设函数。

![](img/0733a63ac558e86d08b0c038864d4fac.png)

现在这幅图对你来说可能已经很清楚了。我们的主要任务是设计 h 函数。我们试图实现的是，将所有数据集绘制在一张图上，输入变量在独立轴上，输出变量在 y 轴或副轴上。通过这种方式，我们可以直接绘制输入到输出。例如:-

![](img/b8e6d511eda9c00b131b84ea91afd6f3.png)

在上面的例子中，我们有不同房子的数据。对于不同土地面积的房子，我们有不同的价格。这是我们的训练数据。现在在图中画出这个数据集的草图。

![](img/57a8343bc3f35282fdf01f02d85f0daf.png)

现在，我们的主要任务是使用这个数据集预测新房子的价格。这是使用线性回归实现的。我们所做的是将一条线拟合到我们的数据集中，使它与每个点的距离最小化。

![](img/50f01accf66469fdb8e33573aad06a5b.png)

一个预测是上面的蓝线。请注意，我已经尝试以这样一种方式画线，它相对于所有点都很近。所以我们必须选择一条完全符合我们数据集的线。

[](https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/) [## 将定义 2020 年就业前景的五大数据科学和机器学习趋势|数据驱动…

### 数据科学和 ML 是 2019 年最受关注的趋势之一，毫无疑问，它们将继续发展…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/) 

下一次，每当我输入新房子的面积，它就会自动用这条线告诉我那栋房子的价格。

![](img/8050b1193ce86cf3bcb9a6704fbf5f77.png)

我输入 area=30，它为我们预测了大约 195 美元的价格。根据我们的训练集，这是一个合理的价格。那么，如何教你的计算机预测一条符合你的数据集的线呢？让我们深入研究数学:-

# 假设函数:-

这种情况下的假设函数是:-
**hθ = θ + θ1x**

![](img/c4cc8c7fadf5b7a1aa77b79db32d76f8.png)

如果你不熟悉这个等式，不要不知所措。让我深入研究一下这背后的数学原理。
我认为在考虑这个公式之前，你应该参考一下这里用到的不同术语。
您可能熟悉使用斜率和 y 轴截距的直线公式。
**y=mx+b**

![](img/933331042db9cc6725a4963b55fd91b1.png)

Refer to [Khan Academy](https://www.khanacademy.org/math/algebra/x2f8bb11595b61c86:forms-of-linear-equations/x2f8bb11595b61c86:intro-to-slope-intercept-form/v/slope-intercept-form) if you are not familiar with this equation

这个方程用来表示截距形式的直线。我们的假设函数和一条线的方程完全一样。

![](img/8c02cfa1bba5a63893797490370adb35.png)

因此，θ1 是斜率(m)，θ0 是截距(b)。现在，你已经熟悉了假设函数，以及我们为什么要使用这个函数[当然，我们想在我们的图中拟合一条线，这是一条线的方程]。

# 平方误差成本函数:-

在这个阶段，我们的首要目标是最小化线和每个点之间的差异。这是通过调整线的斜率值(θ1)和线的 y 轴截距值(θ0)来实现的。因此，我们必须找到线误差最小的θ0 和θ1。我所说的最小误差是什么意思？让我们考虑一下我们上面的预测。

![](img/35db45a6b94f99e1556ea0160d6bdb3d.png)

这些线显示了每个点到线的距离。当我们对所有点的差值求和时，就得到那条线上的误差。所以我们必须最小化误差以获得最优解。我们能做的是把线移动得高一点，低一点，通过调整θ0 和θ1 的值来改变角度。但是不用担心，我们的程序会替我们完成这项艰巨的任务。

为此，我们将对θ0 和θ1 使用虚拟值，将其放入我们的假设函数中，并计算该线路的成本。重复这个步骤，直到我们达到最小成本。我们怎么知道最小成本是多少？我会谈到这一点，但首先，看看计算成本的函数。

![](img/3b1dc8a531ef5265d878f79bf59cdb33.png)![](img/004610fecc5114a2bf270d762cb23f54.png)

回想一下我们的不同房价表。

![](img/b8e6d511eda9c00b131b84ea91afd6f3.png)

Don’t worry about scrolling up.

![](img/052316bb27f502a2368621660e56dab4.png)

清楚不同的符号吗？
现在回到我们的线和误差函数。为了理解成本函数，我们必须借助微积分。再来看看这张图。让我们尝试手动计算每个点和线的成本。

![](img/f12b9e81860342a55fa813ac4b032e18.png)

所以我们从这条线上减去每个点。通过将 x 的值代入直线方程，可以找到直线上恰好位于某一特定点下方的点。【如果不了解一条线的方程，先通过看网上的一些教程来考虑。]

![](img/b1332e7a33680af1797cc633bc1cc98c.png)![](img/cc3a3138deb792c9c397c5bf9ffe1679.png)

现在，使用求和 sigma 对所有项求和。要求和的值的限制等于点的数量，每个点指的是一个特定的训练示例，因此我们的 I 从 1 到 m 不等。现在交换 y 和假设函数的位置，并使用 square 来计算负值。将总和除以 2m 以降低成本。这只是为了让计算机更容易计算。你也可以忽略这部分。

你有你的误差函数。记得我说过的调整θ0 和θ1 的值。这就是我们将如何计算θ0 和θ1 的每个值的成本。

好了，这已经接近 10 分钟阅读(顺便说一下，当我写完这篇文章，然后把它分成两部分之前，我编辑了它)，我想把它分成两部分来分享，只是为了给你一些停顿。

[](https://medium.com/analytics-vidhya/linear-regression-hypothesis-function-cost-function-and-gradient-descent-part-2-730b13959b3c) [## 线性回归:假设函数、成本函数和梯度下降。(第二部分)

### 在这篇文章中，你将学习梯度下降背后的数学和理论。在 Octave 中实现它以找到…

medium.com](https://medium.com/analytics-vidhya/linear-regression-hypothesis-function-cost-function-and-gradient-descent-part-2-730b13959b3c) 

非常感谢你的阅读。我希望这篇文章能帮助你理解这个概念。

问候，

马赫亚尔·阿里，

## 访问专家视图— [订阅 DDI 英特尔](https://datadriveninvestor.com/ddi-intel)