<html>
<head>
<title>SAP Automation for Retail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向零售业的SAP自动化</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/sap-automation-for-retail-using-vb-and-python-part-1-intro-to-sap-gui-scripting-2b065e122c6f?source=collection_archive---------0-----------------------#2020-07-29">https://medium.datadriveninvestor.com/sap-automation-for-retail-using-vb-and-python-part-1-intro-to-sap-gui-scripting-2b065e122c6f?source=collection_archive---------0-----------------------#2020-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3bfe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用通过SAP GUI脚本工具构建的Visual Basic脚本设计自动化解决方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/38b6fe8ffbc40d31f62648522015dba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*D8YB2QsnhVZQr7hXc-d1gA.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">SAP Automation for Product Listing — (Image by Author)</figcaption></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><p id="dc44" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">SAP是一个强大的企业软件套件，可以帮助企业简化运营并提高生产率。</p><p id="d9da" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">然而，许多企业仍然依赖手动流程来完成SAP中的任务，这既耗时又容易出错。这就是自动化的用武之地。</p><p id="e3e4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">通过在SAP中实现重复性任务的自动化，企业可以解放员工，让他们专注于更高价值的任务，并提高他们的整体工作效率。</p><p id="6d2e" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在本文中，我们将探讨SAP automation如何让零售业受益，并深入探讨使用Visual Basic和Python在SAP中自动化任务的细节。</p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="a37b" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated"><strong class="ak">一、什么是机器人过程自动化？</strong></h1><p id="8c8c" class="pw-post-body-paragraph ky kz iq la b lb mm jr ld le mn ju lg lh mo lj lk ll mp ln lo lp mq lr ls lt ij bi translated">管理咨询公司德勤(Deloitte)将<strong class="la ir">机器人流程自动化</strong> <strong class="la ir"> (RPA) </strong>定义为使用“通常称为‘机器人’的软件，来捕获和解释现有的IT应用程序，以实现跨多个IT系统的交易处理、数据操作和通信。”</p><p id="51cd" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">像许多自动化爱好者(或懒惰的工程师)一样，我将其定义为“找到一种方法来自动化枯燥和耗时的任务，以创造更多的时间来进行分析和设计解决方案，从而为您的项目增加价值。”</p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="d292" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated"><strong class="ak">二。使用SAP GUI脚本实现SAP自动化</strong></h1><p id="f69f" class="pw-post-body-paragraph ky kz iq la b lb mm jr ld le mn ju lg lh mo lj lk ll mp ln lo lp mq lr ls lt ij bi translated">我需要在有限的时间内完成大量复杂的手工任务。在这一系列文章中，我将分享几个基本手工任务自动化的例子:</p><ul class=""><li id="ac96" class="mr ms iq la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated"><strong class="la ir"> 1。SKU列表:</strong>将一个<em class="na">商品</em>链接到他的<em class="na">商品组合</em>(位置:仓库或商店)</li><li id="4543" class="mr ms iq la b lb nb le nc lh nd ll ne lp nf lt mw mx my mz bi translated"><strong class="la ir"> 2。采购订单创建:</strong>用于以商定的价格向供应商请求商品或服务的文件</li><li id="8b52" class="mr ms iq la b lb nb le nc lh nd ll ne lp nf lt mw mx my mz bi translated"><strong class="la ir"> 3。货物转移订单提取:</strong>货物转移允许您在一次数据输入交易中映射系统中的转移交货</li></ul><p id="4f23" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">我们的工具:SAP GUI脚本<br/> </strong> SAP GUI包括一个记录工具，像Microsoft Excel宏，用来记录任务并将其转换成Visual Basic代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1ddc16cf6b70cd47f36ca5720d194bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*mbI3iNVbxyya3nAf1BGfYA.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Record and Playback tool of SAP GUI to record tasks performed — (Image by Author)</figcaption></figure><p id="31f4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">您可以在SAP GUI主页上找到它</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/4f000a0b2a03aa495037acd757a1fa0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kPZK8lWSmkXltZYctYKr0g.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">SAP GUI Scripting Tool Menu — (Image by Author)</figcaption></figure><blockquote class="nm nn no"><p id="052a" class="ky kz na la b lb lc jr ld le lf ju lg np li lj lk nq lm ln lo nr lq lr ls lt ij bi translated"><strong class="la ir"> <em class="iq">实验一:发起交易</em> </strong></p></blockquote><p id="e59f" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">为了理解记录工具，我们将执行两个简单的任务并分析记录工具的输出。基于这些例子，我们可以得到它背后的逻辑，并尝试使它适应我们计划自动化的任何任务。</p><p id="6bf4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">让我们从启动事务的简单任务开始</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/3a5cb5fb086fb9acb54a19a1acc7e78d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*hPR4kqmS3oz0mCTyxax_Xg.gif"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Launching MM43 Transaction Code (Display Material) from SAP GUI Home Page — (Image by Author)</figcaption></figure><p id="3c15" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">输出</strong></p><pre class="kg kh ki kj gt nt nu nv nw aw nx bi"><span id="8a78" class="ny lv iq nu b gy nz oa l ob oc">#Visual Basic Script Exported by Recording Tool</span><span id="cf4c" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(application) Then<br/>   Set SapGuiAuto  = GetObject("SAPGUI")<br/>   Set application = SapGuiAuto.GetScriptingEngine<br/>End If</span><span id="cb8d" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(connection) Then<br/>   Set connection = application.Children(0)<br/>End If</span><span id="1587" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(session) Then<br/>   Set session    = connection.Children(0)<br/>End If</span><span id="f375" class="ny lv iq nu b gy od oa l ob oc">If IsObject(WScript) Then<br/>   WScript.ConnectObject session,     "on"<br/>   WScript.ConnectObject application, "on"<br/>End If</span><span id="9180" class="ny lv iq nu b gy od oa l ob oc">session.findById("wnd[0]").maximize<br/>session.findById("wnd[0]/tbar[0]/okcd").text = <strong class="nu ir">"MM43"</strong><br/>session.findById("wnd[0]").sendVKey 0</span></pre><blockquote class="nm nn no"><p id="498f" class="ky kz na la b lb lc jr ld le lf ju lg np li lj lk nq lm ln lo nr lq lr ls lt ij bi translated"><strong class="la ir"> <em class="iq">实验二:填表</em> </strong></p></blockquote><p id="6fca" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在让我们来看看如何填表</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/85ff60ccfe663641507dd83d55633a89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*L4JFOLoIMQ5SPqz-Y1zCsg.gif"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Form filling example — (Image by Author)</figcaption></figure><p id="c4bb" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">输出</strong></p><pre class="kg kh ki kj gt nt nu nv nw aw nx bi"><span id="e997" class="ny lv iq nu b gy nz oa l ob oc">#Visual Basic Script Exported by Recording Tool</span><span id="6867" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(application) Then<br/>   Set SapGuiAuto  = GetObject("SAPGUI")<br/>   Set application = SapGuiAuto.GetScriptingEngine<br/>End If</span><span id="cca6" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(connection) Then<br/>   Set connection = application.Children(0)<br/>End If</span><span id="15b6" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(session) Then<br/>   Set session    = connection.Children(0)<br/>End If</span><span id="633c" class="ny lv iq nu b gy od oa l ob oc">If IsObject(WScript) Then<br/>   WScript.ConnectObject session,     "on"<br/>   WScript.ConnectObject application, "on"<br/>End If</span><span id="a50d" class="ny lv iq nu b gy od oa l ob oc">session.findById("wnd[0]").maximize<br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").text = <strong class="nu ir">"100607255"</strong><br/>session.findById("wnd[0]/usr/ctxtRMMW1-EKORG").text = <strong class="nu ir">"WXYZ"</strong><br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").setFocus<br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").caretPosition = 9<br/>session.findById("wnd[0]").sendVKey 0<br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").caretPosition = 9<br/>session.findById("wnd[0]").sendVKey 0</span></pre><blockquote class="nm nn no"><p id="7fb7" class="ky kz na la b lb lc jr ld le lf ju lg np li lj lk nq lm ln lo nr lq lr ls lt ij bi translated"><strong class="la ir"> <em class="iq">结果分析:Visual Basic代码</em> </strong></p></blockquote><p id="de95" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">查看这两个输出，我们可以看到代码中的相似之处</p><ol class=""><li id="3084" class="mr ms iq la b lb lc le lf lh mt ll mu lp mv lt oe mx my mz bi translated"><strong class="la ir">第一部分:</strong>建立与SAP GUI的连接</li></ol><pre class="kg kh ki kj gt nt nu nv nw aw nx bi"><span id="bd3a" class="ny lv iq nu b gy nz oa l ob oc">#Visual Basic Script Exported by Recording Tool</span><span id="6287" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(application) Then<br/>   Set SapGuiAuto  = GetObject("SAPGUI")<br/>   Set application = SapGuiAuto.GetScriptingEngine<br/>End If</span><span id="55bb" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(connection) Then<br/>   Set connection = application.Children(0)<br/>End If</span><span id="3187" class="ny lv iq nu b gy od oa l ob oc">If Not IsObject(session) Then<br/>   Set session    = connection.Children(0)<br/>End If</span><span id="66dc" class="ny lv iq nu b gy od oa l ob oc">If IsObject(WScript) Then<br/>   WScript.ConnectObject session,     "on"<br/>   WScript.ConnectObject application, "on"<br/>End If</span></pre><p id="b700" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">看了SAP GUI脚本文档后，我们可以理解这部分代码是用来建立与GUI的连接的。我们将在下一篇文章中更详细地理解它。</p><p id="1f5a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir"> 2。第二部分:</strong>表演动作</p><pre class="kg kh ki kj gt nt nu nv nw aw nx bi"><span id="9cd3" class="ny lv iq nu b gy nz oa l ob oc"># Test 1</span><span id="2e12" class="ny lv iq nu b gy od oa l ob oc">session.findById("wnd[0]").maximize<br/>session.findById("wnd[0]/tbar[0]/okcd").text = <strong class="nu ir">"MM43"</strong><br/>session.findById("wnd[0]").sendVKey 0</span></pre><p id="293b" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">第2行的<strong class="la ir">“MM43”</strong>显示该行链接到交易名称字段中输入的内容。</p><pre class="kg kh ki kj gt nt nu nv nw aw nx bi"><span id="3dd6" class="ny lv iq nu b gy nz oa l ob oc"># Test 1<br/>session.findById("wnd[0]").maximize<br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").text = <strong class="nu ir">"100607255"</strong><br/>session.findById("wnd[0]/usr/ctxtRMMW1-EKORG").text = <strong class="nu ir">"WXYZ"</strong><br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").setFocus<br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").caretPosition = 9<br/>session.findById("wnd[0]").sendVKey 0<br/>session.findById("wnd[0]/usr/ctxtRMMW1-MATNR").caretPosition = 9<br/>session.findById("wnd[0]").sendVKey 0</span></pre><p id="f3b9" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">第3行中的<strong class="la ir"> "100607255" </strong>和第3行中的<strong class="la ir"> "WXYZ" </strong>向我们展示了这些行链接到“MM43”表单字段中键入的内容。</p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt of"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">萨米尔Samir供应链组合的数据科学</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">🏭使用高级数学概念的供应链网络优化👨‍🏭仓储的持续改进…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">samirsaci.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot kl of"/></div></div></a></div></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="acf9" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated"><strong class="ak">三。结论和后续步骤</strong></h1><p id="b5f8" class="pw-post-body-paragraph ky kz iq la b lb mm jr ld le mn ju lg lh mo lj lk ll mp ln lo lp mq lr ls lt ij bi translated"><em class="na">关注我的medium，了解更多与供应链数据科学相关的见解。</em></p><p id="1300" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">通过这两个简单的例子，我们可以预见SAP GUI Recording Tool在设计自动化任务脚本方面的潜力。</p><p id="3fc3" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在下一部分，我们将了解如何:</p><ol class=""><li id="171a" class="mr ms iq la b lb lc le lf lh mt ll mu lp mv lt oe mx my mz bi translated"><strong class="la ir">设置与SAP GUI的连接:</strong>修改此代码以在Excel VB中复制</li><li id="740e" class="mr ms iq la b lb nb le nc lh nd ll ne lp nf lt oe mx my mz bi translated"><strong class="la ir">执行动作的脚本:</strong>数据输入、将值粘贴到剪贴板和数据导出</li></ol><p id="0132" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在接下来的两部分中，我们将研究如何实现自动化</p><p id="c2f4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir"> SKU列表<br/> </strong>将商品与其分类关联的操作</p><div class="ou ov gp gr ow of"><a href="https://www.samirsaci.com/sap-automation-of-product-listing-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">零售产品列表的SAP自动化</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">自动化和报告使用Visual Basic自动化产品，通过SAP GUI脚本工具在SAP中自动列出产品…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">www.samirsaci.com</p></div></div><div class="oo l"><div class="ox l oq or os oo ot kl of"/></div></div></a></div><p id="aaca" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">采购订单创建:<br/> </strong> SAP零售自动化—采购订单创建</p><div class="ou ov gp gr ow of"><a href="https://www.samirsaci.com/sap-automation-of-orders-creation-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">SAP零售订单创建自动化</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">函数PO_Function() '(1)声明变量Dim W_BPNumber，W_SearchTerm，PONDim line items As long Dim Sht _ Name As…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">www.samirsaci.com</p></div></div><div class="oo l"><div class="oy l oq or os oo ot kl of"/></div></div></a></div><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oz pa l"/></div></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><p id="bffd" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如果你对供应链分析感兴趣，可以看看我的网站</p><div class="ou ov gp gr ow of"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">萨米尔·萨奇</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">数据科学博客，专注于仓储，运输，数据可视化和机器人流程自动化…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">samirsaci.com</p></div></div><div class="oo l"><div class="pb l oq or os oo ot kl of"/></div></div></a></div></div></div>    
</body>
</html>