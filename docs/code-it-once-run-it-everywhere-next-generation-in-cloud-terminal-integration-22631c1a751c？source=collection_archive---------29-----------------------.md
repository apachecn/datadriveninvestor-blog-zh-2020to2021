# 一次编码，随处运行:下一代云终端集成

> 原文：<https://medium.datadriveninvestor.com/code-it-once-run-it-everywhere-next-generation-in-cloud-terminal-integration-22631c1a751c?source=collection_archive---------29----------------------->

*阿里巴巴的孙棋(孔孟)。*

![](img/11be092da82591a7071809e56659a158.png)

在移动互联网领域的许多当前研发和运营维护模型中，混合云系统中的所有不同云服务似乎总是与移动终端分离。尽管*和*确实存在全栈解决方案，但实际上只有少数案例，整个行业缺乏云终端集成的创新解决方案。

因此，鉴于这种趋势，我们应该问自己几个问题:我们如何实现一个快速而简单的研发项目，以支持跨云和运行 Android 和 iOS 的移动终端的快速业务实现？或者，有没有新的研发或运营和维护模式，让程序员能够专注于编程，而不是让这两件事相互隔离？

嗯，我们的答案很简单:“编码一次，到处运行。”我们已经证明，这种方法适用于我们的二手买卖应用程序[闲鱼](https://pandaily.com/weiye-chen-xianyu-third-trillion-worth-platform-alibaba/?spm=a2c41.14027737.0.0)。使用这种方法，我们将一个特定开发项目所需的时间从 60 天减少到 40 天，效率提高了 33%。

[](https://www.datadriveninvestor.com/2019/02/21/best-coding-languages-to-learn-in-2019/) [## 2019 年最值得学习的编码语言|数据驱动的投资者

### 在我读大学的那几年，我跳过了很多次夜游去学习 Java，希望有一天它能帮助我在…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2019/02/21/best-coding-languages-to-learn-in-2019/) 

因此，在这篇文章中，阿里巴巴的高级技术专家孙棋将提供一些分析，说明这种方法如何在阿里巴巴很好地为我们服务，以及它如何改变你的业务。

# 我们从哪里来:R&D 商业模式的演变

效率是业务研发、运营和维护模式演变的核心驱动力。

在 PC 互联网时代，单个应用的前端和后端是现代 IT 最初的一些研发模型。例如，在淘宝桌面版[的早期，开发人员编写了 velocity 模板，以及之前的 JSP 和 ASP 页面。这些基本上是集中的类似火车的研发模式。](https://www.wsj.com/video/what-is-taobao/69BD4B54-0417-4075-A54D-5FC895B5B3F3.html?spm=a2c41.14027737.0.0)

![](img/c53011f3b6ee35ada68b82b2bea812f6.png)

但是，随着业务发展的复杂性迅速增加，火车般的交付模式极大地限制了业务发展。因此，为了补救这一点，引入了面向服务的拆分。并且，2009 年淘宝的多色石项目就是基于这种方式。这时候微服务就变成了软件架构。这是因为研发模式从集中式模式转变为分布式模式。

此外，当企业将其系统升级到这些更新的分布式研发模型时，前端-后端分离的研发模型也开始出现。从 [Ajax](https://www.w3schools.com/xml/ajax_intro.asp?spm=a2c41.14027737.0.0&file=ajax_intro.asp) 到专用前端，独立完成封闭的业务循环，提高了整体分工，同时也提高了效率。然而，对于前端人员来说，服务器端的操作和维护一直是一个难以克服的技术障碍。而且，这个问题甚至在阿里巴巴基于 Java 的中间件生态系统中也没有得到非常满意的解决方案。

现在，快进到移动互联网时代，互联网客户端也以同样的方式发展。比如阿里巴巴集团利用 Atlas 实现终端分布式研发模式。但是，相比 PC 时代前端和后端的分离，移动时代又重新启用了 Ajax 模式。因此，终端人员只对终端负责，而不是实施一个封闭的业务循环。同时，移动互联网也带来了自身的挑战，比如跨 Android 和 iOS 平台运营的问题。这就是产生 [React Native](https://facebook.github.io/react-native/?spm=a2c41.14027737.0.0) 、 [Weex](https://weex.apache.org/?spm=a2c41.14027737.0.0) 和其他类似产品的背景。

# 云终端集成的轻量级 R&D 模型的核心挑战

如果我们希望客户人员更进一步，实现闭环业务实施，同时防止后端对前端(BFF)层在研发、运营和维护以及跨语言工作中与客户人员对抗，这就是我们需要做的:

*   将业务研究和开发与代码运行时环境隔离开来。
*   开发跨云、终端和平台的功能。

在我看来， [Java](https://www.java.com/en/?spm=a2c41.14027737.0.0) 语言的成功在于其“编译一次，随处运行”的特性，在 Java 虚拟机(JVM)层面屏蔽了一些运行时环境。核心挑战是找到一种方法，为研究和开发提供独立于语言的透明代码运行时环境，这样除了业务代码之外的一切都由技术平台管理。

多年来，移动互联网的研发模式一直将云和终端分开。整个行业都在探索全栈解决方案，但迄今为止还没有成功的案例。问题是技术壁垒太高了。因此，开发人员必须做艰苦的工作，业务实现的复杂性没有发生本质的变化。原本需要三个人完成的事情现在一个人就可以完成，但是仍然缺乏有效的跨平台能力，特别是那些将云和终端平台交叉的能力。

本质上，你可以把研发模式的演变总结为降低了技术壁垒，增加了跨平台能力。但仍有很大的成长和提高空间。

# “编码一次，到处运行”

允许开发人员只关注业务逻辑编码是研发模型发展的下一个阶段。在这个阶段，cloud native 等技术给了我们很大的帮助。通过容器技术分离基础设施，基于容器的编排降低了操作和维护的复杂性。此外，服务网格用于将应用程序从中间件系统中分离出来。这提供了不可变的基础设施，其特点是提高了一致性和可靠性，同时降低了复杂性。通过运用无服务器理念，技术进步为研发模式的升级提供了新的机会。

# 盖亚轻量级 R&D 和 O&M 模式的探索与实践

上面描述的语境催生了盖亚，盖亚已经和仙游以及淘宝生态系统的 aplatform 交互平台紧密结合。盖亚的云终端功能即服务(FaaS)技术能力重新定义了研发的责任和边界。这使得程序员可以专注于他们的原始程序，并结合跨平台的终端能力实现轻量级的云终端集成业务研发和运维模型。

仙宇新的研发模式如下图:

![](img/c6493d7201c9a43ddc32861ff9c2bed0.png)

# 结果:

*   在仙寓的业务实施中，云终端一体化研发模式将原来 60 天的项目工期压缩至 40 天，效率提升 33%。
*   在支持 88VIP 互动活动的平台上，每秒处理数十万次查询的业务流量平稳可靠。这是阿里巴巴首次大规模验证轻量级复合多容器设计模型。

# 盖亚设计理念

容器化的设计模型将基础设施淹没和业务分离，使得代码运行时环境对业务透明。

# 轻型复合多容器设计模型

![](img/b0b029bc9b606d58994028705fc26541.png)

目前，我们的应用程序仍然使用富容器模型。然而，容器的不均衡责任导致了业务和基础设施之间的隔离和紧密耦合。

容器是盖亚的关键。他们的设计模式已经发生了革命性的变化，这是阿里巴巴对这种新方法的首次大规模测试。

*   基于 Kubernetes pods 的轻型复合多容器功能通过以边车的形式提供基础设施，重新定义了企业和基础设施之间的界限。
*   容器编排和调度用于统一资源、流量和容器的生命周期，为按需使用奠定基础。
*   基于 configmap，配置与环境分离，容器映像不可更改，例程、预发布和生产映像得到统一以降低复杂性。
*   基于 Init 容器技术，功能与基础设施完全解耦，通过容器生命周期初始化机制，将功能和基础设施结合起来构建运行状态。这为业务功能和基础设施的独立运营和维护提供了支持。
*   诸如 API 服务注册和发现之类的基础设施功能被淹没在 Kubernetes 技术系统中。

通过利用这些容器的设计功能，业务研发人员只需编写业务逻辑代码，并通过声明性 API 呈现出来。这样，他们可以在移动终端上快速部署云终端业务实现能力，而迷你程序等容器则封装了孤立业务的运行时环境。对于[颤振](https://flutter.dev/?spm=a2c41.14027737.0.0)也是如此。开发人员可以从事面向容器的编程，并使用容器来隔离基础设施和掩盖运行时环境平台之间的差异。

![](img/6620a957ede81cb122eb3ef3f0e422c2.png)

盖亚是一个开放的平台。根据其容器设计规范，Xianyu 根据 Dart 语言规范实现函数容器。同时，aplatform 引擎成功地连接到 GAIA 中的 Java 容器。这解决了基于平台的应用程序的问题，该集团有超过 10，000 个应用程序，并为任何应用程序提供了一条基于 GAIA 实现无服务器解决方案的路径。

# 总结和展望

目前，淘宝生态系统的盖亚、闲鱼、aplatform 互动平台的整合是一次具有重要意义的探索。“一次编码，随处运行”的能力让程序员可以专注于编程。目前，技术层面的云终端集成仍处于早期阶段。未来，我们希望看到深入的系统探索和建设。

# 不可抗拒的未来趋势:轻型商务 R&D 和 O&M 模型

随着 5G 和万物互联的到来，不同的终端设备将需要支持轻量级的研发和运维模式。从追求更低的技术壁垒和推动研发模式演进的跨平台能力开始，高效的业务实施能力是必由之路。目前的终端划分和协作模式入云，iOS 和 Android 的移动终端必然会被淘汰。

# 容器化和统一的 API 服务编程

云和终端运行时环境的容器化是将业务与基础设施分离的必要方式。容器化将封装孤立的运行时环境，服务交互将通过容器提供的统一 API 来实现。云和终端容器技术将会融合，允许两端容器的紧密交互。云与终端将在技术体系上深度融合，实现闭环的云终端技术体系。

# 客户端和服务器的统一工程系统和一致的版本发布和升级

目前，分离的研发模型通常表现为每个终端的不同代码分支。轻量级云终端集成业务研发模型将统一云与终端的业务工程系统。在单个项目中，我们可以定义服务接口来公开云容器中的服务，并调用客户端容器中的服务。同时，云和终端将采用统一的版本发布和运维体系。这将需要完全重新定义研发模型系统。

# 技术部门的重组

随着人们需求的变化，支撑企业的组织和生产关系也必须相应升级。

# 我们的使命

我们寻求革新研发模式，重组研发生态系统。

我们希望共同努力，建立整合云和终端的轻量级业务研发和运维模型，以便开发人员可以实现我们的“一次编码，随处运行”的系统。

# 原始来源:

[](https://www.alibabacloud.com/blog/code-it-once-run-it-everywhere-next-generation-in-cloud-terminal-integration_595815?spm=a2c41.14027737.0.0) [## 一次编码，随处运行:下一代云终端集成

### 孙棋 2020 年 2 月 12 日 1814 由孙棋(孔孟)在阿里巴巴。在当前的许多研发和…

www.alibabacloud.com](https://www.alibabacloud.com/blog/code-it-once-run-it-everywhere-next-generation-in-cloud-terminal-integration_595815?spm=a2c41.14027737.0.0)