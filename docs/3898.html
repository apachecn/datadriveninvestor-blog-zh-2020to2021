<html>
<head>
<title>Introduction to NoSQL and MongoDB for Rails Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向Rails开发人员的NoSQL和MongoDB简介</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/introduction-to-nosql-and-mongodb-for-rails-developers-bada4e74e01e?source=collection_archive---------3-----------------------#2020-07-14">https://medium.datadriveninvestor.com/introduction-to-nosql-and-mongodb-for-rails-developers-bada4e74e01e?source=collection_archive---------3-----------------------#2020-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="2233" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">探索Mongoid作为ActiveRecord的替代品</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3525708c4fe88c9e9563556dfdd9a215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V2yvZdb1kTe1vxRw"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@ikukevk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kevin Ku</a> on <a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="bafe" class="jq jr it bd js jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn bi translated">介绍</h1><p id="4cc6" class="pw-post-body-paragraph lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">SQL最早开发于20世纪70年代，其数据存储的关系模型一直延续至今。SQL数据库管理员和开发人员的需求量仍然很大，因此学习SQL及其相关技术仍然是一项值得努力的工作。但是在过去的十年里，一个新的流行词已经在数据库世界里流传开来:NoSQL。什么是NoSQL(“不仅是SQL”)，为什么它与今天相关？</p><p id="5f8a" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">当SQL在20世纪70年代被创造出来的时候，计算机科学家对数据如何存储和数据能做什么有着完全不同的概念。数据存储非常昂贵，因此减少数据重复至关重要。为了防止重复，SQL数据库利用带有主键和外键的固定模式来表达模型之间的关系。他们专注于为所有数据创建一个单一的真实来源。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/82890ee8ef0832a3a8248bffd8d1df01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*GKnIi367o7ru8eY4wppobw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Storage Costs over Time in USD</figcaption></figure><p id="b948" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">对于僵化的模式，在整个应用程序开发生命周期中更改SQL数据库既困难又耗时。然而，NoSQL数据库是灵活的，允许开发者避开基于模式的关系数据库的约束。随着敏捷开发实践席卷了技术世界，NoSQL数据库被独特地定位于满足开发人员拥有适应性强的数据存储系统的需求。</p><div class="mv mw gp gr mx my"><a href="https://www.datadriveninvestor.com/2020/07/13/2020-development-choices-for-multi-platform-saas-application/" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">多平台SaaS应用的2020年发展选择|数据驱动的投资者</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">我目前正在为公司做一个新项目。该项目包括一个移动应用程序，由一个…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ky my"/></div></div></a></div><p id="60e6" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">虽然通常有四种不同类型的NoSQL数据库(文档、键值、宽列存储和图形)，但文档数据库已经成为使用最广泛的选项。文档结构存储数据的方式是任何使用过JSON文档的开发人员都熟悉的。MongoDB是当今最流行的文档数据库。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a94877cbf9d04e8f8a2da99169e49c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*LzffYfuynAz3Y-hoHMHOTQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Document Database Structure (MongoDB)</figcaption></figure><h1 id="7290" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Rails: ActiveRecord和Mongoid</h1><p id="4c96" class="pw-post-body-paragraph lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">当我第一次学习Rails时，ActiveRecord是最“神奇”的部分。尽管ActiveRecord只是在幕后启动标准的SQL查询，但它允许开发人员轻松地创建复杂的关联和查询数据。作为一个对象关系映射器(ORM)，ActiveRecord允许程序员与存储在数据库表中的信息进行交互，就像它是一个传统的Ruby对象一样。在博客应用上访问用户的帖子就像<code class="fe no np nq nr b">User.first.posts</code>一样简单——不需要复杂的SQL <code class="fe no np nq nr b">JOIN</code>和<code class="fe no np nq nr b">SELECT</code>查询。</p><p id="9bbb" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">ActiveRecord是一个ORM(强调关系型的R)，而Mongoid是一个ODM(对象-文档-映射器),它用文档数据库MongoDB映射对象。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="227c" class="jq jr it bd js jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn bi translated">设置Mongoid</h1><p id="10da" class="pw-post-body-paragraph lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">请注意，本教程利用macOS上的家酿安装说明。如果您不在macOS上，请参阅MongoDB文档。</p><p id="3111" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">要在您的机器上安装MongoDB，请按照下列步骤操作:</p><ol class=""><li id="931d" class="ns nt it lt b lu mp ly mq mc nu mg nv mk nw mo nx ny nz oa bi translated">点击MongoDB自制软件点击:<code class="fe no np nq nr b">brew tap mongodb/brew</code></li><li id="2890" class="ns nt it lt b lu ob ly oc mc od mg oe mk of mo nx ny nz oa bi translated">安装MongoDB社区版:<code class="fe no np nq nr b">brew install mongodb-community@4.2</code></li><li id="6d77" class="ns nt it lt b lu ob ly oc mc od mg oe mk of mo nx ny nz oa bi translated">运行MongoDB: <code class="fe no np nq nr b">brew services start mongodb-community@4.2</code></li></ol><p id="1d25" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">现在我们已经在机器上安装了MongoDB，让我们创建一个新的Rails应用程序来开始探索这项技术。注意:本教程假设您的计算机已经为Rails开发进行了配置。</p><p id="fb69" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">要使用Mongoid创建新的Rails应用程序，请遵循以下步骤:</p><ol class=""><li id="e28a" class="ns nt it lt b lu mp ly mq mc nu mg nv mk nw mo nx ny nz oa bi translated">创建app: <code class="fe no np nq nr b">rails new &lt;app-name&gt; --skip-active-record</code>(由于我们使用的是Mongoid，所以不需要安装ActiveRecord及其依赖项)。</li><li id="636a" class="ns nt it lt b lu ob ly oc mc od mg oe mk of mo nx ny nz oa bi translated">在你的宝石文件中，添加一个对蒙古宝石的引用:<code class="fe no np nq nr b">gem 'mongoid', '~&gt; 7.0.5'</code></li><li id="2b47" class="ns nt it lt b lu ob ly oc mc od mg oe mk of mo nx ny nz oa bi translated">通过运行<code class="fe no np nq nr b">bundle install</code>安装依赖项</li><li id="1634" class="ns nt it lt b lu ob ly oc mc od mg oe mk of mo nx ny nz oa bi translated">生成默认的Mongoid配置:<code class="fe no np nq nr b">bin/rails g mongoid:config</code>(这将创建<code class="fe no np nq nr b">config/mongoid.yml</code>文件来代替传统上ActiveRecord附带的<code class="fe no np nq nr b">database.yml</code>文件)</li></ol><h1 id="ac80" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">与蒙古人的关系</h1><p id="9e93" class="pw-post-body-paragraph lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">虽然MongoDB不像SQL那样是关系数据库，但它仍然可以存储模型之间的关系。如果我们要创建一个学生应用程序，我们可能有两个类:<code class="fe no np nq nr b">Student</code>和<code class="fe no np nq nr b">Teacher</code>。一个老师<strong class="lt iu">有很多</strong>学生，一个学生<strong class="lt iu">属于</strong>一个老师。</p><p id="d576" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">我们不会创建迁移，而是立即开始用Mongoid构建我们的模型。首先，在<code class="fe no np nq nr b">app/models</code>中创建<code class="fe no np nq nr b">student.rb</code>和<code class="fe no np nq nr b">teacher.rb</code>。</p><p id="75d3" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在<code class="fe no np nq nr b">teacher.rb</code>中，插入以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="2351" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">同样，在<code class="fe no np nq nr b">student.rb</code>中，插入以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="8355" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">为了使用Mongoid建立学生和教师之间的一对多关系，我们将使用习惯于ActiveRecord的人会感到非常熟悉的语法。</p><p id="b4dc" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在教师类，插入<code class="fe no np nq nr b">has_many :students</code>。在学生类中插入<code class="fe no np nq nr b">belongs_to :teacher</code>。</p><p id="668d" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">MongoDB的另一个强大特性是能够存储ActiveRecord中没有的各种数据类型。例如，考虑下面的<code class="fe no np nq nr b">User</code>和<code class="fe no np nq nr b">Favorite</code>类。<code class="fe no np nq nr b">Favorite</code>类包含一个名为artists的属性，这是一个数组。使用MongoDB，不需要创建额外的带有外键和连接表的Artist模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/e9638d976a5a7bb69cc64f463138e6ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*OEf1dmcbvDKcoiUk-s6Xxg.jpeg"/></div></figure><h1 id="6b16" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="a163" class="pw-post-body-paragraph lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">尽管ActiveRecord经常让人觉得与Rails有着千丝万缕的联系，但Mongoid提供了一种查询数据库中存储的数据的替代方法。对于习惯于ActiveRecord的人来说，大部分语法都很熟悉，但是存储数据的基本方式却完全不同。</p><p id="419d" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">要使用MongoDB和scaffolding创建完整的Rails博客应用程序，请遵循<a class="ae le" href="https://docs.mongodb.com/mongoid/current/tutorials/getting-started-rails/#add-mongoid" rel="noopener ugc nofollow" target="_blank"> MongoDB官方教程</a>。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="9004" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated"><em class="oj">最初发表于</em><a class="ae le" href="https://gist.github.com/2565c7559762e9885e8ff7dfdae59a16" rel="noopener ugc nofollow" target="_blank">T5【http://github.com】</a><em class="oj">。</em></p><p id="12a8" class="pw-post-body-paragraph lr ls it lt b lu mp lw lx ly mq ma mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated"><strong class="lt iu">访问专家视图— </strong> <a class="ae le" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>