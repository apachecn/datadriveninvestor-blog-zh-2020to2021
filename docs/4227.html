<html>
<head>
<title>SAP Automation of Product Listing for Retail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零售产品列表的SAP自动化</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/sap-automation-for-retail-using-vb-and-python-part-2-listing-740c6cb690c1?source=collection_archive---------2-----------------------#2020-07-29">https://medium.datadriveninvestor.com/sap-automation-for-retail-using-vb-and-python-part-2-listing-740c6cb690c1?source=collection_archive---------2-----------------------#2020-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d56f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Visual Basic通过SAP GUI脚本工具在SAP中自动列出产品</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/a60c0426b1f072ad6c3bf6775b27e455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*qXom6hUpr8aoVJRLq0BvsQ.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Product Listing Automation with SAP for Retail Using VB — (Image by Author)</figcaption></figure><p id="e6ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文是SAP零售业自动化系列文章的一部分。( <a class="ae lo" href="https://medium.com/@s.saci95/sap-automation-for-retail-using-vb-and-python-part-1-intro-to-sap-gui-scripting-2b065e122c6f?source=friends_link&amp;sk=8a2708ffb63c2c9fa1ad61055bcab346" rel="noopener"> <em class="ln">第一部分</em> </a> <em class="ln"> ) </em></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="4d53" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">一. SAP中的材料清单</h1><h2 id="2800" class="mo lx iq bd ly mp mq dn mc mr ms dp mg la mt mu mi le mv mw mk li mx my mm mz bi translated">1.什么是材料清单？</h2><p id="9e99" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">在SAP Retail中,<strong class="kt ir">物料清单</strong>是将一件商品与一个分类联系起来的操作。</p><p id="908f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">定义:产品组合是一个SAP零售对象，材料被分配到该对象(一个称为“列表”的过程)。</em></p><p id="3363" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">示例:</strong>您的零售公司使用SAP，范围包括20家名为<em class="ln"> {ST01，ST02，… ST20} </em>的商店。这些店铺由卡车从两个名为<em class="ln"> {WH01，WH02} </em>的配送中心(DC)发货。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nf"><img src="../Images/70da78633e53d8a476fde751b48566a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_NPovHRbtxvzncpZjxmAg.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Material Listing Process in SAP Retail — (Image by Author)</figcaption></figure><blockquote class="nk nl nm"><p id="fe27" class="kr ks ln kt b ku kv jr kw kx ky ju kz nn lb lc ld no lf lg lh np lj lk ll lm ij bi translated">场景—您想要购买一个新的参考(SAP代码:145654789)，该参考将由供应商在WH02交付，并且仅在ST04销售。</p></blockquote><p id="57ad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">上市流程</strong></p><ul class=""><li id="b91a" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">WH02中的清单145654789:</strong>此参考可在此DC接收</li><li id="1cd8" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">ST04中的清单145654789:</strong>此参考可在ST04中接收和销售</li></ul><blockquote class="nk nl nm"><p id="8ee7" class="kr ks ln kt b ku kv jr kw kx ky ju kz nn lb lc ld no lf lg lh np lj lk ll lm ij bi translated"><em class="iq">你可以在下面的链接中找到这篇文章的Youtube版本和动画，</em></p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="241f" class="mo lx iq bd ly mp mq dn mc mr ms dp mg la mt mu mi le mv mw mk li mx my mm mz bi translated">2.如何进行材料列表？</h2><p id="4404" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated"><strong class="kt ir"> WSM3(批量维护)</strong>事务可用于操作特定工厂的批量参考列表，以控制商店可购买或销售的产品组合。</p><p id="dafb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">商店不能接收或出售不包含在其产品组合中的商品。</p><ol class=""><li id="0168" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm og nw nx ny bi translated"><strong class="kt ir">发起交易WSM3 </strong></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oh"><img src="../Images/b228a8784b976a8ecd3d423a2c472b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bRvNzuUbhG8EUtJ_kBmo-w.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Mass Listing Menu from Tcode “WSM3” — (Image by Author)</figcaption></figure><p id="0db3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要在商店中列出我们的商品，我们需要填写:</p><ul class=""><li id="1ae0" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">分类:</strong> ST04</li><li id="0410" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">材质:</strong> 145654789</li><li id="649c" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">上市程序:</strong>取决于您的组织</li><li id="daf4" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">清单有效期自:</strong> <em class="ln"> dd.mm.yyyy </em></li><li id="a39c" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">清单有效期至:</strong> <em class="ln"> dd.mm.yyyy </em></li><li id="48d7" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">选择选项</strong></li></ul><p id="378d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 2。验证和检查</strong></p><p id="0724" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先点击页面左上角的绿色按钮<em class="ln">(按钮1) </em>。<br/> SAP将加载列表报告，在该报告中您可以看到<strong class="kt ir">物料代码</strong> (+变量)以及它们所在的工厂。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/e76eb44f634fa2ebcdca10d4086b21da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*z61c-l-pN606sg0ZkyMs4Q.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Results of Listing of one SAP Code Variant (+ 1 Generic) — (Image by Author)</figcaption></figure><p id="bf90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">验证后，我们需要检查记录日期是否正确，这将证明您的列表已成功完成。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt oj"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">萨米尔·萨奇</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">数据科学博客，专注于仓储，运输，数据可视化和机器人流程自动化…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">samirsaci.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox kl oj"/></div></div></a></div></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="1135" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 3。手动子任务</strong></p><p id="fb2c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">必须运行一组手动子任务来执行列表，它们可以分为两类:</p><p id="ffd6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">手动数据输入<br/> </strong>填写表格、点击按钮、上传数据以及任何其他从用户到SAP GUI的信息传输动作</p><p id="af96" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">手动数据提取<br/> </strong>检查结果、下载报告、导出表格或任何其他从SAP GUI向用户传递信息的动作</p><p id="ef4b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于当前示例，事务表单填写任务可以放在类别1中，开始日期检查可以放在类别2中。</p><h2 id="8513" class="mo lx iq bd ly mp mq dn mc mr ms dp mg la mt mu mi le mv mw mk li mx my mm mz bi translated">3.如何使用SAP GUI脚本自动列出材料？</h2><p id="1a9b" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">我们的目标是使用Excel文件中的Visual Basic Bot脚本完全自动化该过程，其中输入数据将被提取，输出数据将被记录。</p><ol class=""><li id="5a15" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm og nw nx ny bi translated">目标:建造一个全自动机器人</li></ol><p id="74c7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Excel电子表格中包含各工厂的文章列表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oy"><img src="../Images/e5b90163cf4422095d6562b61e829151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mMrAHKoDIU6AZIXAi0sz3Q.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Excel Input File with Material Codes and Plants — (Image by Author)</figcaption></figure><ul class=""><li id="abbc" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">A/B/C栏:</strong>在交易表格[1]中输入材料代码、工厂代码和列表程序</li><li id="da4a" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">E列:</strong>从列表报告[2]中提取的开始日期(以确认列表已正确完成)</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/315f9ae5f09da76dccf8a9ddde9b28ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*jtdnLXCR7dDThbOSKDdNzw.gif"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Automation Bot performing Listing of Articles Codes listed in the Excel File — (Image by Author)</figcaption></figure><p id="7c1a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 2。Excel VBA脚本</strong></p><p id="b713" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">基于<a class="ae lo" href="https://medium.com/@s.saci95/sap-automation-for-retail-using-vb-and-python-part-1-intro-to-sap-gui-scripting-2b065e122c6f?source=friends_link&amp;sk=8a2708ffb63c2c9fa1ad61055bcab346" rel="noopener">第1部分</a>中的两个示例，我们必须分三部分构建我们的解决方案:</p><ol class=""><li id="171a" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm og nw nx ny bi translated"><strong class="kt ir">设置与SAP GUI的连接<br/> </strong>步骤:Create_SAP_Session</li><li id="740e" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm og nw nx ny bi translated"><strong class="kt ir">脚本执行动作<br/> </strong>函数:Listing_Function执行清单</li><li id="7653" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm og nw nx ny bi translated"><strong class="kt ir">在Excel文件中循环<br/> </strong>过程:Listing_Process循环所有行</li></ol><blockquote class="nk nl nm"><p id="60e5" class="kr ks ln kt b ku kv jr kw kx ky ju kz nn lb lc ld no lf lg lh np lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">声明公共变量</em> </strong></p></blockquote><pre class="kg kh ki kj gt pa pb pc pd aw pe bi"><span id="4c43" class="mo lx iq pb b gy pf pg l ph pi">Option Explicit</span><span id="8e0c" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'Variables for SAP GUI Tool</strong><br/>Public SapGuiAuto, WScript, msgcol<br/>Public objGui  As GuiApplication<br/>Public objConn As GuiConnection<br/>Public session As GuiSession<br/>Public objSBar As GuiStatusbar<br/>Public objSheet As Worksheet</span><span id="f3b4" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'Variables for Functions</strong><br/>Public Plant, SAP_CODE, Listing_Procedure As String<br/>Dim W_System<br/>Dim iCtr As Integer</span></pre><blockquote class="nk nl nm"><p id="bd0e" class="kr ks ln kt b ku kv jr kw kx ky ju kz nn lb lc ld no lf lg lh np lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">设置与SAP GUI的连接</em> </strong></p></blockquote><pre class="kg kh ki kj gt pa pb pc pd aw pe bi"><span id="7d51" class="mo lx iq pb b gy pf pg l ph pi">Function Create_SAP_Session() As Boolean<br/><strong class="pb ir">'Function to Connect with SAP GUI Sessions</strong></span><span id="5deb" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(1) Variables for Session Creation</strong><br/>Dim il, it<br/>Dim W_conn, W_Sess, tcode, Transac, Info_System<br/>Dim N_Gui As Integer<br/>Dim A1, A2 As String<br/>tcode = Sheets(1).Range("B3") 'Get Transaction Code</span><span id="56ed" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(2) Get System Name in Cell(2,1) of Sheet1</strong><br/>If mysystem = "" Then<br/>    W_System = Sheets(1).Cells(2, 2)<br/>Else<br/>    W_System = mysystem<br/>End If</span><span id="c14d" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(3) If we are already connected to a Session we exit this function</strong><br/>If W_System = "" Then<br/>   Create_SAP_Session = False<br/>   Exit Function<br/>End If</span><span id="bf60" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(4) If Object Session is not null and the system is matching with the one we target: we use this object</strong><br/>If Not session Is Nothing Then<br/>    If session.Info.SystemName &amp; session.Info.Client = W_System Then<br/>        Create_SAP_Session = True<br/>        Exit Function<br/>    End If<br/>End If</span><span id="d785" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(5) If we are not connected to anything and GUI Object is Nothing we create one</strong><br/>If objGui Is Nothing Then<br/>   Set SapGuiAuto = GetObject("SAPGUI")<br/>   Set objGui = SapGuiAuto.GetScriptingEngine<br/>End If</span><span id="50a2" class="mo lx iq pb b gy pj pg l ph pi">'(6) Loop through all SAP GUI Sessions to find the one with the right transaction<br/>For il = 0 To objGui.Children.Count - 1<br/>    Set W_conn = objGui.Children(il + 0)<br/>    <br/>    For it = 0 To W_conn.Children.Count - 1<br/>        Set W_Sess = W_conn.Children(it + 0)<br/>        Transac = W_Sess.Info.Transaction<br/>        Info_System = W_Sess.Info.SystemName &amp; W_Sess.Info.Client<br/>        <br/>        'Check if Session Name and Transaction Code are matching then connect to it<br/>        If W_Sess.Info.SystemName &amp; W_Sess.Info.Client = W_System Then<br/>        'If W_Sess.Info.SystemName &amp; W_Sess.Info.Client = W_System And W_Sess.Info.Transaction = tcode Then<br/>            Set objConn = objGui.Children(il + 0)<br/>            Set session = objConn.Children(it + 0)<br/>            Exit For<br/>        End If<br/>        <br/>    Next<br/>    <br/>Next</span><span id="8712" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(7) If we can't find Session with the right System Name and Transaction Code: display error message</strong><br/>If session Is Nothing Then<br/>   MsgBox "There is no active session found for " + W_System + " with transaction " + tcode + ".", vbCritical + vbOKOnly<br/>   Create_SAP_Session = False<br/>   Exit Function<br/>End If</span><span id="b5e5" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(8) Turn on scripting mode</strong><br/>If IsObject(WScript) Then<br/>   WScript.ConnectObject session, "on"<br/>   WScript.ConnectObject objGui, "on"<br/>End If</span><span id="78c3" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(9) Confirm connection to a session</strong><br/>Create_SAP_Session = True</span><span id="a50d" class="mo lx iq pb b gy pj pg l ph pi">End Function</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi pk"><img src="../Images/2ea114493e4b021902b7267a210d273c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tlBiCDs8idqiUImR6v1Mw.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">System Code: T01220 — (Image by Author)</figcaption></figure><p id="6479" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建链接到系统和交易代码的SAP GUI对象</p><ul class=""><li id="f468" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">步骤1至4: </strong>根据GUI窗口中的系统名称连接到SAP</li><li id="c465" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">步骤5: </strong>创建SAP GUI对象</li><li id="e30e" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">步骤6: </strong>遍历所有SAP窗口，并将GUI对象链接到与事务<em class="ln"> tcode </em>相关的对象</li><li id="69df" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">第7步:</strong>脚本模式“开”像在SAP GUI记录工具中输出</li></ul><blockquote class="nk nl nm"><p id="c4eb" class="kr ks ln kt b ku kv jr kw kx ky ju kz nn lb lc ld no lf lg lh np lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">脚本执行动作</em> </strong></p></blockquote><p id="0b0c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">采用工厂代码、SAP_Code和列表程序填写表格:</p><ul class=""><li id="3558" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">步骤1到2: </strong>连接到WSM3事务</li><li id="5e61" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">步骤3到5: </strong>填写表单并验证</li><li id="1fae" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">步骤6: </strong>从列表报告中提取开始日期以确认处理</li><li id="4bce" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated">第7步:把报告留给下一篇文章</li></ul><pre class="kg kh ki kj gt pa pb pc pd aw pe bi"><span id="f41b" class="mo lx iq pb b gy pf pg l ph pi">Function Listing_Function(Plant, SAP_CODE, Listing_Procedure, N)<br/>'Function for Listing</span><span id="96bc" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(1) if you want to maximize the screen</strong><br/>session.findById("wnd[0]").Maximize:</span><span id="d001" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(2) call the transaction</strong><br/>session.findById("wnd[0]/tbar[0]/okcd").Text = "wsm3"<br/>session.findById("wnd[0]").sendVKey 0</span><span id="f52f" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(3) ticking options on listing</strong><br/>session.findById("wnd[0]/usr/chkLSTFLMAT").Selected = True<br/>session.findById("wnd[0]/usr/chkLIEFWERK").Selected = True</span><span id="ac7e" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(4) clear + filling Plant, SAP Code and Listing Procedure</strong><br/>session.findById("wnd[0]/usr/ctxtASORT-LOW").Text = ""<br/>session.findById("wnd[0]/usr/ctxtASORT-LOW").Text = Plant<br/>session.findById("wnd[0]/usr/ctxtMATNR-LOW").Text = ""<br/>session.findById("wnd[0]/usr/ctxtMATNR-LOW").Text = SAP_CODE<br/>session.findById("wnd[0]/usr/ctxtLSTFL").Text = ""<br/>session.findById("wnd[0]/usr/ctxtLSTFL").Text = Listing_Procedure</span><span id="9d1c" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(5) validate</strong><br/>session.findById("wnd[0]/usr/chkLIEFWERK").SetFocus<br/>session.findById("wnd[0]/tbar[1]/btn[8]").press</span><span id="212d" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(6) getting start date from window and paste it in column 5</strong><br/>Sheets("Listing").Cells(N, 5) = session.findById("wnd[0]/usr/lbl[0,0]").Text</span><span id="a24a" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(7) wait 1 second and come back to transaction menu</strong><br/>Application.Wait (Now + TimeValue("0:00:1"))<br/>session.findById("wnd[0]/tbar[0]/btn[3]").press</span><span id="a8ea" class="mo lx iq pb b gy pj pg l ph pi">End Function</span></pre><blockquote class="nk nl nm"><p id="7e74" class="kr ks ln kt b ku kv jr kw kx ky ju kz nn lb lc ld no lf lg lh np lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">在Excel文件中循环</em> </strong></p></blockquote><p id="19b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">循环所有行，获取工厂代码、SAP_Code和列表程序，以调用Listing_Function:</p><ul class=""><li id="757f" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">步骤1到3: </strong>创建SAP GUI对象</li><li id="ee3a" class="nq nr iq kt b ku nz kx oa la ob le oc li od lm nv nw nx ny bi translated"><strong class="kt ir">步骤4到6: </strong>遍历文件并执行输入/提取动作</li></ul><pre class="kg kh ki kj gt pa pb pc pd aw pe bi"><span id="d664" class="mo lx iq pb b gy pf pg l ph pi">Public Sub Listing_Process()<br/>'Procedure to perform Listing</span><span id="0b19" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(1) Variable for Listing Process</strong><br/>Dim W_Src_Ord<br/>Dim W_Ret As Boolean<br/>Dim N As Integer<br/>Dim N_max As Integer</span><span id="118d" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(2) Connect to a system</strong><br/>Set objSheet = ActiveWorkbook.Sheets(1)<br/>W_Ret = Create_SAP_Session()</span><span id="9a3f" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(3) If Create_SAP_Session Return Nothing message</strong><br/>If Not W_Ret Then<br/>    MsgBox "Not connected to client"<br/>End If</span><span id="d57d" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(4) Loop though all lines</strong><br/>N = 2<br/>While Not (Sheets("Listing").Cells(N + 1, 1) = "")</span><span id="45f4" class="mo lx iq pb b gy pj pg l ph pi"><strong class="pb ir">'(5) Get Parameters from Excel Sheet</strong><br/>    SAP_CODE = Sheets("Listing").Cells(N, 1)<br/>    Plant = Sheets("Listing").Cells(N, 2)<br/>    Listing_Procedure = Sheets("Listing").Cells(N, 3)<br/>    <br/><strong class="pb ir">'(6) Call the function</strong><br/>    Call Listing_Function(Plant, SAP_CODE, Listing_Procedure, N)<br/>    <br/><strong class="pb ir">'(7) Confirm with a "V"</strong><br/>    Sheets("Listing").Cells(N, 4) = "V"<br/>    N = N + 1<br/>    <br/>Wend</span><span id="2fc1" class="mo lx iq pb b gy pj pg l ph pi">End Sub</span></pre></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="37a0" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">二。结论和下一步措施</h1><p id="aeec" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated"><em class="ln">关注我的medium，了解更多与供应链数据科学相关的见解。</em></p><p id="be71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当您在一个工厂中要列出许多商品时，WSM3事务有助于批量列表。</p><p id="83f6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是，要列出许多不同工厂的一篇文章，这个机器人会很有帮助。您只需在这个Excel文件中列出VBA程序/函数所在的不同工厂。</p><p id="7cb8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在下一篇文章中，我们将解决</p><ul class=""><li id="b85a" class="nq nr iq kt b ku kv kx ky la ns le nt li nu lm nv nw nx ny bi translated"><strong class="kt ir">采购订单创建<br/> </strong>采购订单是一种用于以商定的价格向供应商请求项目或服务的文档</li></ul><div class="pl pm gp gr pn oj"><a href="https://www.samirsaci.com/sap-automation-of-orders-creation-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">SAP零售订单创建自动化</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">函数PO_Function() '(1)声明变量Dim W_BPNumber，W_SearchTerm，PONDim line items As long Dim Sht _ Name As…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">www.samirsaci.com</p></div></div><div class="os l"><div class="po l ou ov ow os ox kl oj"/></div></div></a></div></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="026f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你对供应链分析感兴趣，可以看看我的网站</p><div class="pl pm gp gr pn oj"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">萨米尔·萨奇</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">数据科学博客，专注于仓储，运输，数据可视化和机器人流程自动化…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">samirsaci.com</p></div></div><div class="os l"><div class="pp l ou ov ow os ox kl oj"/></div></div></a></div></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="4d8a" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">参考</h1><p id="fe65" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">[1] <a class="pq pr ep" href="https://medium.com/u/bb0f26d52754?source=post_page-----740c6cb690c1--------------------------------" rel="noopener" target="_blank"> Samir Saci </a>，SAP Automation for Retail Using VB，<a class="ae lo" href="https://s-saci95.medium.com/sap-automation-for-retail-using-vb-and-python-part-1-intro-to-sap-gui-scripting-2b065e122c6f" rel="noopener"> Link </a></p></div></div>    
</body>
</html>