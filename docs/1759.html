<html>
<head>
<title>Logistic Regression — Simple, Multinomial And Ordinal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归—简单、多项式和序数</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/logistic-regression-simple-multinomial-and-ordinal-b2bc886bb974?source=collection_archive---------0-----------------------#2020-03-31">https://medium.datadriveninvestor.com/logistic-regression-simple-multinomial-and-ordinal-b2bc886bb974?source=collection_archive---------0-----------------------#2020-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="50bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要目标变量是分类的，就使用逻辑回归。逻辑回归有助于将数据分为不同的类别。</p><p id="d039" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，如果我们想知道图片是猫还是狗。在这种情况下，图像是两种动物中的任何一种，因此我们的输出可以是0(对于狗)或1(对于猫)。</p><p id="e72c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑回归类似于二进制分类问题，其中输出是二进制的0或1。如果我们想过滤电子邮件，不管它们是不是垃圾邮件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/ca660098b50e49dca1be3eaccf4b8eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zxQPLd0RlVelm-JH.jpg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Linear Regression v/s Logistic Regression</figcaption></figure><p id="49bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于这些问题是二元分类，并且值必须介于0和1之间，因此我们不能使用线性回归。线性回归是无限的，因此它可以超过0和1的范围。sigmoid函数是逻辑回归的基础。因为sigmoid函数的值位于0和1之间。因此，逻辑回归可用于预测二元分类问题。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/cb89e521139fdb1e16fd8d3791a99258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/0*mpdruP7nizq5qpE5"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Sigmoid function</figcaption></figure><h2 id="2026" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">逻辑回归的类型</h2><p id="cad3" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">有三种不同类型的逻辑回归算法，它们是:</p><ol class=""><li id="b93f" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">简单的逻辑回归:分类只分为两类。例如，如果一名乘客死亡或幸存。</li><li id="ed6b" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">多项逻辑回归:分类可以分为三个或更多的类别，但没有顺序。例如，鸢尾属植物可以分为三种，“Setosa”，“Versicolor”或“Virginica”。</li><li id="c4e0" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">有序逻辑回归:分类可以按照顺序分成三个或三个以上的类别。例如，葡萄酒的质量可以在1-10之间评级。</li></ol><div class="mo mp gp gr mq mr"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">认知计算——一套被广泛认为是……</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf kv mr"/></div></div></a></div><p id="9085" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将尝试了解更多关于逻辑回归的知识，并使用三个不同的数据集构建这三个模型。数据集分别是泰坦尼克号数据集、虹膜数据集和白葡萄酒质量数据集。</p><h2 id="21c5" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">价值函数</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/df0d07de2c7e5af85951b8196e05de32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*MvRRHq-vkJX5rbr4y-a34Q.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Cost function</figcaption></figure></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><blockquote class="no np nq"><p id="84f5" class="jn jo nr jp b jq jr js jt ju jv jw jx ns jz ka kb nt kd ke kf nu kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">简单逻辑回归</em> </strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/a88c1565d6570339d1a42c336f324d03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*02NUNbRANkjwCB3ZrFnocA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Titanic dataset</figcaption></figure><p id="cf3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将参考titanic数据集来理解简单的逻辑回归。泰坦尼克号数据集包含了标志性的泰坦尼克号上乘客的信息。该数据集包含姓名、性别、年龄、旅行舱位等级等信息。使用数据集中可用的信息，我们将尝试预测谁幸存，谁死亡。</p><p id="a2c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道妇女和儿童有更高的生存概率，因为他们被优先考虑，因此，性别可能是一个至关重要的特征。年轻人将比老年人优先，所以年龄是一个对我们的预测有用的特征。另一方面，我们有一些不必要的特征，如客舱、机票，它们根本没有用，所以我们将从数据集中移除这些特征。</p><p id="04e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">实现</strong></p><pre class="km kn ko kp gt nw nx ny nz aw oa bi"><span id="9033" class="lc ld iq nx b gy ob oc l od oe">#importing the libraries<br/>import pandas as pd<br/>from sklearn.linear_model import LogisticRegression</span><span id="0719" class="lc ld iq nx b gy of oc l od oe">#loading the dataset<br/>dataset=pd.read_csv("F:\\datasets\\titanic.csv")</span><span id="80bc" class="lc ld iq nx b gy of oc l od oe">#drop columns that are not necessary for predictions<br/>columns_to_drop = ['Name','Cabin','Embarked','Ticket']<br/>dataset = dataset.drop(columns_to_drop, axis=1)</span><span id="f8c0" class="lc ld iq nx b gy of oc l od oe">#assigning input and target values<br/>X = dataset.iloc[:, :-1]<br/>Y = dataset.iloc[:, -1]</span><span id="6d07" class="lc ld iq nx b gy of oc l od oe">#creating the logistic regression model<br/>regressor = LogisticRegression()<br/>regressor.fit(X, Y)</span><span id="e1d9" class="lc ld iq nx b gy of oc l od oe">#evaluating the score of the model<br/>score = model.score(X, Y)<br/>print(score)</span></pre><blockquote class="no np nq"><p id="2a03" class="jn jo nr jp b jq jr js jt ju jv jw jx ns jz ka kb nt kd ke kf nu kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">多项逻辑回归</em> </strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7ac671522e85676936082786661c5849.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*LfR_K-MlJaJTD0LZu1P_vQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Iris dataset</figcaption></figure><p id="1fda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多项式逻辑回归的运行原理与简单逻辑回归相似。它们之间的唯一区别是逻辑回归将数据分为两类，而多项式将数据分为三类或更多类。如果我们想将鸢尾属植物分类到它的种类中，那么我们可以使用多项逻辑回归，因为鸢尾属植物可以分为三个种类，并且没有特定的分类顺序。我们将使用iris数据集实现该模型。</p><p id="37a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">实施</strong></p><pre class="km kn ko kp gt nw nx ny nz aw oa bi"><span id="b47f" class="lc ld iq nx b gy ob oc l od oe">#importing the libraries<br/>import pandas as pd<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.preprocessing import StandardScaler</span><span id="5fa3" class="lc ld iq nx b gy of oc l od oe">#loading the dataset<br/>dataset=pd.read_csv("F:\\datasets\\iris.csv")</span><span id="4387" class="lc ld iq nx b gy of oc l od oe">#applying feature scaling on the input data<br/>scaler = StandardScaler()<br/>X = scaler.fit_transform(X)</span><span id="19a6" class="lc ld iq nx b gy of oc l od oe">#creating the multinomial logistic regression model<br/>regressor = LogisticRegression(random_state=0, multi_class='multinomial', solver='newton-cg')<br/>regressor.fit(X, Y)</span><span id="8af1" class="lc ld iq nx b gy of oc l od oe">#evaluating the score of the model<br/>score = model.score(X, Y)<br/>print(score)</span></pre><blockquote class="no np nq"><p id="13fb" class="jn jo nr jp b jq jr js jt ju jv jw jx ns jz ka kb nt kd ke kf nu kh ki kj kk ij bi translated"><strong class="jp ir">有序逻辑回归</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/5944660cfdcebf807f0f6274ce66193b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6KY8rdbEUz1SvAwKPFmSEA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">White wine quality dataset</figcaption></figure><p id="c815" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当数据被分成三个或更多的类别并且这些类别是有序的时，有序逻辑回归就发挥作用了。我们使用“白葡萄酒质量数据集”实施有序逻辑回归，我们应该在1-10的范围内对质量进行评级。因为目标值是有序的。</p><pre class="km kn ko kp gt nw nx ny nz aw oa bi"><span id="95cc" class="lc ld iq nx b gy ob oc l od oe">#importing the libraries<br/>import pandas as pd<br/>from mord import LogisticAT<br/>from sklearn.preprocessing import StandardScaler</span><span id="57c4" class="lc ld iq nx b gy of oc l od oe">#loading the dataset<br/>dataset=pd.read_csv("F:\\datasets\\white_winequality.csv")</span><span id="a019" class="lc ld iq nx b gy of oc l od oe">#applying feature scaling on the input data<br/>scaler = StandardScaler()<br/>X = scaler.fit_transform(X)</span><span id="a37b" class="lc ld iq nx b gy of oc l od oe">#creating the multinomial logistic regression model<br/>regressor = LogisticAT(<em class="nr">alpha=1.0</em>, <em class="nr">verbose=0</em>)<br/>regressor.fit(X, Y)</span><span id="d368" class="lc ld iq nx b gy of oc l od oe">#evaluating the score of the model<br/>score = model.score(X, Y)<br/>print(score)</span></pre><p id="dac8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您也可以尝试用其他数据集实现算法，并检查数据与模型的拟合程度。</p></div></div>    
</body>
</html>