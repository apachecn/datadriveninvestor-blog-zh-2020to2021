<html>
<head>
<title>Pyspark, Kafka &amp; Tableau : Experience Stream Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">派斯帕克、卡夫卡和画面:经验流分析</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/experience-stream-analysis-using-pyspark-kafka-and-tableau-24edbb813c08?source=collection_archive---------1-----------------------#2020-12-25">https://medium.datadriveninvestor.com/experience-stream-analysis-using-pyspark-kafka-and-tableau-24edbb813c08?source=collection_archive---------1-----------------------#2020-12-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b1bb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python、pyspark、Kafka、zookeeper和Tableau分析和可视化推文</h2></div><p id="0e64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">将海量的流数据整合起来，并对所提供的数据进行实时分析，这是一项革命性的技术。Python与pyspark的结合使之成为可能。这里，我们有使用twitter提供的api获取数据的优势。Twitter API允许获得实时数据，使用RDD处理它，传递它以显示计数，然后，仪表板显示整个数据处理的分析。它很有趣，充满了学问。这很容易实现，因为对于理解给定的问题陈述来说，它看起来很麻烦。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/31fac0466db28623c49d142eeb2fdd35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mvw9MxSb7CA4Q3AFdCllgA.png"/></div></div></figure><blockquote class="lz ma mb"><p id="5bd4" class="ki kj mc kk b kl km ju kn ko kp jx kq md ks kt ku me kw kx ky mf la lb lc ld im bi translated">使用的技术:Python与pyspark，zookeeper，Kafka，Chart.js和Tableau</p></blockquote><h1 id="2ee8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">我们的目标</h1><ol class=""><li id="5b6c" class="my mz it kk b kl na ko nb kr nc kv nd kz ne ld nf ng nh ni bi translated">可扩展性、准确性和速度</li><li id="4ddf" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">数据分析和决策</li><li id="a80c" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">仪表板:使用交互式仪表板对推文进行情感分析和更多洞察</li></ol><h1 id="9d8b" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">解决方法</h1><ol class=""><li id="17ce" class="my mz it kk b kl na ko nb kr nc kv nd kz ne ld nf ng nh ni bi translated">创建一个应用程序帐户twitter，并提取连接细节以供使用</li><li id="8831" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">使用应用程序细节，调用twitter API每2秒提取数据并存储</li><li id="1137" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">使用<strong class="kk iu"> Kafka </strong>消息传递层处理数据并提取标签</li><li id="0a28" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated"><strong class="kk iu">统计标签被使用的次数</strong>和<strong class="kk iu">可视化</strong></li></ol><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4d45f78accc662311baf2df65f49256b.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*f5hZewF0vcv8DkIB3SAp8w.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Solution Pipeline : Data Storage can be replaced with local CSV/JSON</figcaption></figure><h1 id="15b2" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">数据源和摄取</h1><ol class=""><li id="2193" class="my mz it kk b kl na ko nb kr nc kv nd kz ne ld nf ng nh ni bi translated">使用Twitter提供的API以json格式收集数据。</li><li id="f3bf" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">可以根据容量配置帐户配置和数据提取率</li><li id="2d9a" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">收集感兴趣的数据字段并进行转换</li><li id="77ee" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">数据清理检查数据字段、内部数据，处理缺失值和异常值</li><li id="00c9" class="my mz it kk b kl nj ko nk kr nl kv nm kz nn ld nf ng nh ni bi translated">数据存储为HDFS或CSV格式(用于独立和测试目的)</li></ol><h1 id="a97a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">关于使用的技术</h1><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nt"><img src="../Images/928c1e8f29d0b2512010e372c8079064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3FJecv95w7xXWpufeqYn2Q.png"/></div></div></figure><p id="739d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> Spark : </em> Spark是一个开源、灵活的内存框架，可作为map-reduce的替代方案，用于处理批处理、实时分析和数据处理工作负载。它为Java、Scala、Python和R编程语言提供了原生绑定，并支持SQL、流数据、机器学习和图形处理。它将有助于以良好的性能处理大量数据。</p><p id="522a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> Kafka : </em> Kafka是一个开源分布式流平台，在构建实时数据管道和流处理应用程序方面非常有用。它被用作消息传递层，将数据从一个源传输到另一个源。Kafka帮助您提供可扩展且持久的解决方案，而不会丢失任何消息。</p><p id="92e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> Tableau : </em> Tableau将是一个显示细节的可视化层和显示情绪的仪表板，使用户能够做出决策。</p><p id="6b7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> Chart.js </em>:使用python flask框架，Chart.js可用于动态生成条形图，以显示带有各自计数的hashtags。烧瓶使它变得很轻。</p><h1 id="7838" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">解决办法</h1><p id="0a3e" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nu kt ku kv nv kx ky kz nw lb lc ld im bi translated">这个问题可能有多种解决方案。在这里，解决方案包括使用Hadoop Yarn、Kafka、Spark、HBase和Elasticsearch实现数据管道。然后，转换数据以输入机器学习管道。机器学习模型将提供消息的情感分析。并且，可视化将有助于用户理解结果和数据。</p><p id="9cd5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">● <strong class="kk iu">具有运行spark流作业的Yarn架构的多节点Hadoop:<br/></strong>使用Hadoop Yarn设置节点集群(1个主节点和2个工作节点)以实现高可用性，并在集群上应用Apache spark over Yarn的多个作业。</p><p id="1b04" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">● <strong class="kk iu">将用于流式传输的多节点Kafka:<br/></strong>Kafka用于分布式流式传输平台，用于构建数据管道。它用于大规模的消息处理，并为Kafka实现HA，它设置在多个节点上。</p><p id="3521" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">● <strong class="kk iu"> HBase，用于存储数据:<br/> </strong>帮助稀疏数据集。</p><p id="72d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">● <strong class="kk iu">机器</strong> <strong class="kk iu">学习:</strong>对给定的数据进行机器学习，从数据中获取情感</p><p id="5832" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">● <strong class="kk iu">数据可视化:</strong>使用Tableau讲述故事和仪表板来可视化数据</p><h1 id="333d" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结果</h1><p id="5690" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nu kt ku kv nv kx ky kz nw lb lc ld im bi translated">以下是使用流数据和存储数据的结果示例。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/cf653fa8bf59a2e438620703abb0d36d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*BBz2Avz1O0VAApLExElK3w.png"/></div></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/f1fea927e887d72c36a9c3522805604b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*TuWkyyZGmub3y1yJs60dnA.png"/></div></figure><h1 id="99ca" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="54d6" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nu kt ku kv nv kx ky kz nw lb lc ld im bi translated">这个解决方案是以嵌入式方式使用python、pyspark、zookeeper、kafka、hadoop和chart.js等最新技术开发的。这为与流数据和分析数据相关的问题提供了解决方案。使用kafka进行消息消费，然后在Kafka和spark之间进行同步，以在数据帧中处理消息。</p><blockquote class="lz ma mb"><p id="4b84" class="ki kj mc kk b kl km ju kn ko kp jx kq md ks kt ku me kw kx ky mf la lb lc ld im bi translated">这个解决方案可以扩展到适当的用例，并可以用来从流中提取一些有用的含义。非常有用的用例，并能以深思熟虑的方式实现任何需求，以证明其有用性。</p></blockquote><p id="802a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种解决方案是以模块化的方式实现的，因此很容易扩展。该解决方案可以进一步探索，以实现针对不同客户的多个可视化层。享受这种体验并尝试实现，<strong class="kk iu">快乐编码！</strong></p><h2 id="2e36" class="ny mh it bd mi nz oa dn mm ob oc dp mq kr od oe ms kv of og mu kz oh oi mw oj bi translated">访问专家视图— <a class="ae ok" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank">订阅DDI英特尔</a></h2></div></div>    
</body>
</html>