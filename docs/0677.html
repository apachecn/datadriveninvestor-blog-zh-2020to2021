<html>
<head>
<title>A Decade of Container Development: Chronicles of Software Delivery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">容器开发十年:软件交付编年史</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/a-decade-of-container-development-chronicles-of-software-delivery-9ca2b83f586c?source=collection_archive---------9-----------------------#2020-02-11">https://medium.datadriveninvestor.com/a-decade-of-container-development-chronicles-of-software-delivery-9ca2b83f586c?source=collection_archive---------9-----------------------#2020-02-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="52e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">阿里云容器平台高级技术专家、CNCF大使、Kubernetes高级会员、维护者章雷</em></p><p id="f53f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今年，世界各地的开发人员开始使用容器进行软件测试和在线发布，现在已经习惯了基于容器的软件构建和交付。围绕“云原生”技术和多云时代的应用治理方法的讨论现在很常见。自然，“sidecar”容器模式是默认选择。在当今时代，云已经成为一种常见的基础设施，将容器视为现代软件基础设施的基本依赖是一种规范。现在我们使用容器就像每天使用Eclipse编写Java代码一样自然。</p><p id="2898" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，两年前，整个集装箱生态系统围绕Docker展开了激烈的辩论，而<a class="ae km" href="https://www.alibabacloud.com/product/container-service?spm=a2c41.13977163.0.0" rel="noopener ugc nofollow" target="_blank">集装箱服务</a>的前景似乎完全不确定。那时，中国许多公共云提供商还没有正式的<a class="ae km" href="https://www.alibabacloud.com/product/kubernetes?spm=a2c41.13977163.0.0" rel="noopener ugc nofollow" target="_blank"> Kubernetes服务</a>。通过使用容器技术在云上管理整个软件生命周期是一种相当前沿的探索。谁能想到在短短两年内，集装箱真的会成为技术人员日常工作的一部分？</p><p id="878d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着容器技术变得越来越流行，过去两年见证了现代软件交付方式的重大变革。</p><h1 id="509b" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">起源:监狱时代</h1><p id="76e2" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">虚拟化容器技术可以追溯到20世纪70年代末。1979年，贝尔实验室开始为Unix V7(版本7 Unix)操作系统的发布进行最后的开发和测试工作。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/fc65e49e5e7c428de57b92b50303622d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*S8LwRaMKxJ822Swr.jpeg"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Ken Thompson(sitting) and Dennis Ritchie at PDP-11 ©wikipedia</figcaption></figure><p id="f1f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那段时间，Unix操作系统还是贝尔实验室的内部项目。运行Unix的机器是一个巨大的PDP系列盒子，看起来像有音频拨号盘和控制器。在软件危机的最后阶段，即使对贝尔实验室来说，开发和维护庞大的Unix操作系统项目也不容易。让事情变得更加困难的是，程序员在开发Unix的同时还必须开发C语言。</p><div class="mg mh gp gr mi mj"><a href="https://www.datadriveninvestor.com/2018/09/22/infographic-journey-to-the-clouds/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">信息图:云之旅|数据驱动的投资者</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">聪明的企业领导者了解利用云的价值。随着数据存储需求的增长，他们已经…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx ma mj"/></div></div></a></div><p id="b088" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Unix V7的开发过程中，构建和测试的效率是最困难的问题之一。原因很明显，当一个系统软件应用程序被编译和安装时，整个测试环境实际上被“污染”了。为了实现下一个构建、安装和测试，必须重建和重新配置测试环境。如今，有了云计算功能，我们可以通过使用虚拟机(VM)之类的方法来复制整个集群。然而，在一个64 KB内存芯片售价419美元的时代，快速摧毁和重建基础设施的想法是一种幻想。</p><p id="8dc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了提高效率，贝尔实验室的聪明人想出了在现有操作系统环境下为软件构建和测试创建一个隔离环境的主意。具体来说，他们想知道是否可以通过运行一些简单的指令来改变应用程序的视图，以便将当前目录用作根目录。如果这被证明是可行的，那么运行一个软件应用程序所需的所有依赖项都将准备就绪，只需将整个操作系统的文件系统部分放入当前目录中。</p><p id="e527" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更重要的是，有了这种能力，开发人员就间接拥有了快速销毁和复制应用程序基础结构的能力，在环境构建完成后，他们不再需要安装和配置依赖项。这是因为运行软件应用程序所需的所有依赖项将以OS下的文件目录的形式预先准备好。开发人员在构建和测试应用程序时，只需要将应用程序的根目录切换到文件目录。</p><p id="7c5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">于是，一个叫做chroot(更改根)的系统调用诞生了。</p><p id="d442" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，chroot将当前正在运行的进程及其子进程的根目录更改到文件系统上的一个新位置，这样当前进程就不再能够访问这个位置的“上层世界”了。这个与世隔绝的环境获得了一个生动的名字——ch root监狱。</p><p id="151c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得一提的是，诞生chroot的Unix V7 OS是贝尔实验室对Unix的一级内部发布。当年年底，Unix被美国电话电报公司正式商业化并允许对外使用，这为Unix成为经典操作系统铺平了道路。</p><p id="936d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">chroot的诞生第一次打开了进程隔离的大门。</p><p id="c873" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着越来越多的用户采用这种机制，chroot也成为配置开发和测试环境以及管理应用程序依赖性的重要工具。描述过程环境隔离的“监狱”概念也激发了该技术领域的更多成就。</p><p id="c119" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2000年，FreeBSD操作系统上发布了“jail”命令，该操作系统也属于Unix家族。</p><p id="d257" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它表明FreeBSD监狱环境的普遍可用性。与Chroot Jail相比，FreeBSD jail机制将“隔离”概念扩展到进程的完整视图，并提供隔离的进程环境和用户系统，为Jail分配独立的IP地址。因此，确切地说，尽管chroot是进程环境隔离的起源，但实际上是FreeBSD监狱机制使被监禁的进程沙箱化。关键的部分是这个沙箱的实现是基于操作系统级的隔离和限制，而不是硬件虚拟化。然而，无论是FreeBSD jail(在Unix上)还是后来的Oracle Solaris Containers(在Solaris上)都没能在更广泛的软件和交付场景中扮演更重要的角色。在监狱时代，进程沙箱技术总是有限的，并且只为一个小社区所知，因为那时云的概念还没有普及。</p><h1 id="0c77" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">开发:云和应用容器</h1><p id="22f6" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">事实上，在jails获得过度普及的过去几年中，在快速发展的Linux平台上也开发出了多种类似沙盒的技术，如Linux VServer和OpenVZ(不包含在内核主干中)。然而，像监狱一样，这些类似沙盒的技术也只有一小部分人知道。这再次证明，在流程沙箱的开发中缺少云的角色会产生巨大的负面影响。谈到云，我们不能不提到基础设施领域的领先公司——谷歌。</p><p id="739e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谷歌在云计算背后的核心组成部分——基础设施领域的影响是业内公认的。无论是三篇开创性的论文，还是多年来领先业界的内部基础设施项目，如Borg和Omega，Google都在这个行业扮演着重要的角色。但在目前的云计算市场，仅比Google Cloud早发布一年的AWS无疑是行业的佼佼者。考虑到他们在GAE的经历，许多人可能会认为这是一个有争议的结论。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi my"><img src="../Images/89ad060f3a3b582c9be2f7202fde0b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Edaxz5NLO0-oZ2YV.jpeg"/></div></div></figure><p id="f063" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谷歌应用引擎(GAE)在几代中国技术人员的脑海中留下了不可磨灭的印象。然而，即使是这些忠实的GAE用户也可能不知道，GAE实际上是谷歌当时计划与AWS竞争的核心云产品。事实上，GAE本身与其说是PaaS，不如说是无服务器的简化版本。在2008年，像GAE这样的产品很难赢得企业级用户，当时大多数人根本不知道什么是云计算。</p><p id="115f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们要讨论的不是谷歌的云战略，而是为什么谷歌在技术上把GAE这样的应用托管服务视为云计算服务。</p><p id="2d6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很多人可能已经知道的一个重要原因是，Google的基础设施技术栈实际上是一个标准的容器技术栈，而不是虚拟机技术栈。更重要的是，在谷歌的系统下，容器不再是孤立进程的简单沙箱，而是封装应用程序本身的方法，这要归功于Borg项目提供的独特的应用程序编排和管理功能。依靠这种轻量级的应用程序封装，谷歌的基础设施被视为一个自然的以应用程序为中心的托管和编程框架。这就是为什么许多前谷歌员工开玩笑说，如果没有Borg，他们不知道如何编写代码。现在更容易理解的是，这种架构和形式，在映射到外部云服务之后，变成了像GAE一样的PaaS/无服务器产品。</p><p id="2379" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于容器的基础设施在Google的大规模应用和成熟可以追溯到2004年到2007年。这个过程中的一个重要里程碑是过程容器的发布。</p><p id="12cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">流程容器的目标非常简单，并且实际上与前面提到的沙盒技术的目标一致，为流程提供操作系统级的资源限制、优先级控制、资源审计和流程控制功能，就像虚拟化技术一样。这些能力是Google内部基础设施实现的基本要求和依赖。他们也构成了谷歌的容器技术原型。在2006年被Google工程师发布后，Process Container在次年被包含在Linux内核主干中。</p><p id="6e7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于术语“容器”是在Linux内核中使用的，所以在Linux中，进程容器被重命名为Cgroups。Cgroups的出现和成熟标志着Linux对“容器”概念的重新审视和实现。这一次，容器技术的倡导者是Google，它是大规模使用容器技术来定义其世界级基础设施的先驱。</p><p id="8abc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2008年，Linux Container (LXC)通过结合Cgroups的资源管理和Linux名称空间的视图隔离，在Linux内核中形成了一种完整的容器技术。虽然LXC为用户提供了类似于早期Linux沙盒技术的功能，如前面提到的Jails和OpenVZ，但随着Linux操作系统开始迅速抢占其在商业服务器市场的份额，它的处境要比它的前辈好得多。</p><p id="276e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从2008年开始，AWS、微软等行业巨头在公有云市场不断发力，很快孕育出一个叫PaaS的新兴行业。</p><p id="18ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于这些老公司在IaaS层的先发优势以及这方面的技术壁垒，越来越多受到公有云和云计算继任者影响的科技公司开始考虑如何在IaaS之上开发新的技术和商业价值，避免GAE曾经走过的错误道路。在这种情况下，第一次出现了一组开源和平台级项目来实现和应用抽象的“PaaS”概念。</p><p id="fecb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些PaaS项目被定位为应用托管服务。与GAE等公共云托管服务不同，这些开放的PaaS项目有望构建一个完全独立于IaaS层的应用管理生态系统。目标是利用PaaS更接近开发者的优势，占领云的更高层入口，甚至所有的数据中心。这意味着PaaS项目必须能够封装用户提交的应用程序，并将其快速部署到底层基础设施，而不依赖于IaaS层中的虚拟化。开源、中立、轻量和敏捷的Linux容器自然成为使用PaaS托管和部署应用程序的最佳选择。</p><p id="09b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2009年收购SpringSource(Spring框架的创始人)后，VMware使用SpringSource内部一个Java PaaS项目的名称作为自己内部PaaS项目的名称，后来在2011年成为开源项目。这个项目叫做云铸造。创建于2009年的Cloud Foundry首次清晰完整地定义了PaaS。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/787827b2af095372529b801e3ef46064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*PJIMDRA-_y0NNGLI.png"/></div></figure><p id="8b7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个项目第一次为云计算行业带来了许多重要的概念，这些概念也得到广泛的认可。这些概念包括“由PaaS项目实现的直接应用程序管理、编排和调度，关注业务逻辑而不是基础设施”和“PaaS项目通过容器技术实现应用程序封装和启动”。值得一提的是，Cloud Foundry使用Warden来启动和操作容器。Warden最初是LXC的封装，后来被直接重构为Cgroups和Linux名称空间的架构。</p><p id="a9de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些越来越受欢迎的PaaS项目与谷歌早些时候发布的GAE项目具有相同的目标。所有这些项目都有一个共同的概念，即开发人员应该关注具有最高价值的业务逻辑，而不是底层基础设施(例如，虚拟机)。直到云的普及让越来越多的人意识到基础设施管理的高度复杂性和成本，这个概念才变得非常有说服力。在这个蓝图中，Linux容器已经打破了进程沙箱的限制，开始扮演app容器的角色。在这个新阶段，容器和应用程序之间建立了平等的关系，最终允许平台层系统实现完整的应用程序生命周期管理。</p><p id="8cf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果事情继续这样下去，容器技术和云计算应该会朝着PaaS和“以应用程序为中心”的趋势发展。如果Docker公司没有成立，这可能是真的。</p><h1 id="7641" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">容器:改变软件交付过程</h1><p id="19f3" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">如果不是这些变化的见证者，你可能会发现很难相信PaaS甚至整个云计算行业已经被一家初创公司在2013年发布的开源项目彻底改变了。但是，这个开源项目的发布，确实是过去五年来整个云计算行业变革的缩影。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0e338880d256fc234ccf7466a530b472.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/0*UK-uZJhXxzrstMV0.png"/></div></figure><p id="2df2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有必要详细说明Docker项目的发布及其与PaaS的关系。光是“降维攻击”这个概念就足以给业内原本激烈的争论划上一个清晰的句号。</p><p id="181a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道Docker在《LXC》发布的时候只不过是它的一个用户。Docker用来创建和使用app容器的逻辑和Warden没有本质区别。然而，我们现在知道真正改变PaaS的是Docker项目最强大的杀手锏——容器图像。</p><p id="d6f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开发人员不关心如何封装应用程序本身。因此，PaaS项目可能会发挥很大的作用。然而，如何定义应用程序与每个开发人员密切相关。为了解决这个问题，Cloud Foundry提供了Buildpack，它是应用程序可执行文件的封装(例如，WAR包)。Buildpack具有内置的启动和停止脚本，可由Cloud Foundry和配置信息识别。</p><p id="9470" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，Docker通过使用容器映像直接打包运行应用程序所需的整个环境(即OS上的文件系统)。这种方式解决了长期困扰PaaS用户的一致性问题。创建一个一旦发布就可以在任何地方运行的Docker映像比构建一个甚至不能实现统一开发和测试环境的构建包要聪明得多。</p><p id="2a9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更重要的是，Docker还介绍了创建容器映像的层。基于层实现构建、推送和更新操作(即提交)显然是对Git的借鉴。这种方式的优点也和GitHub一样。构建Docker映像不再是一项单调乏味的工作，因为映像托管仓库Docker Hub允许您和您的软件参与全球软件分发。</p><p id="bfa1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，你可能会意识到Docker实际上解决了一个更高维度的大得多的问题——软件应该如何交付。当软件交付方法被清晰和完整地定义时，制作一个像PaaS平台一样的软件托管平台将变得简单和容易。这就是Docker几次说它只是站在巨人的肩膀上的根本原因。如果没有像Linux容器这样的有用技术在过去十年中的诞生和改进，使用一个开源项目来定义和统一软件交付过程将是一个白日梦。</p><h1 id="e762" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">云、应用和云原生</h1><p id="5302" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">今天，容器映像是现代软件交付和分发的事实上的标准。然而，Docker在这一领域并没有获得同样的领先地位。原因是显而易见的，Docker在容器技术取得巨大成功后，在后来的“编排之战”中犯了一些错误。事实上，Docker凭借“容器映像”的巧妙创新，成功解决了“应用交付”这一最关键的技术难题。然而，对于如何定义和管理应用程序这一更高层次的问题，容器技术并不是“灵丹妙药”。在与开发者息息相关的“应用”领域，对复杂性和灵活性的需求总是不可或缺的，而容器技术自然要求应用的“微服务”和“单负责”，这对于绝大多数真正的企业用户来说是非常困难的。而这些用户恰好是云计算产业的关键。</p><p id="a441" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，与Docker系统以“单一容器”为核心的应用定义方法相比，Kubernetes项目提出了一套完整的容器化设计模式和相应的控制模型，从而明确了如何构建一个真正与开发者对接的以容器为核心的应用交付和开发范式。Docker、Mesosphere、Kubernetes项目对“应用”层有不同的理解和顶层设计，而“应用”层是所谓“编排竞争”的核心。</p><p id="0303" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2017年底，谷歌在过去十年编制世界上最先进的容器化基础设施的经验，最终帮助Kubernetes项目获得了关键的领导地位，并将CNCF这个以“Cloud-native”为关键词的组织和生态系统推向了巅峰。</p><p id="eefd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最有意思的是，谷歌注入Kubernetes项目的“灵魂”，既不是Borg/Omega多年积累的大规模调度和资源管理能力，也不是当年其他公司赶不上的行业领先技术“三篇论文”。Kubernetes项目中最能体现Google container概念的设计是“源自Borg/Omega系统的应用编排和管理能力”。</p><p id="5a33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道Kubernetes是一个重API的项目，但是我们也应该明白Kubernetes是一个以API为中心的项目。Kubernetes的容器设计模式、控制器模型以及极其复杂的apiserver实现和扩展机制只有基于这种声明式API才有意义。然而，在这些看似复杂的设计和实现背后，它们实际上只服务于一个目的——用户在管理应用时如何最大化容器和云的价值。</p><p id="b2c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为此，Kubernetes结合了容器，并使用Pod的概念来模拟进程组的行为。也正是出于这个目的，Kubernetes坚持使用声明式API加上控制器模型来编排应用程序，并使用API资源对象的创建和更新(补丁)来驱动整个系统的持续运行。更具体地说，使用Pod和容器设计模式，应用程序基础设施可以与应用程序(而不是容器)交互并对其做出响应，从而实现云和应用程序之间的直接连接。有了声明式API，应用基础设施可以真正与云的细节和逻辑分离，比如底层资源、调度、编排、网络和存储。我们现在可以将这些设计称为“云原生应用程序管理思想”，这是让开发人员专注于业务逻辑并最大化云价值的关键路径。</p><p id="6232" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以Kubernetes项目一直在做的事情，就是进一步明确“应用交付”这个不变的话题。然而，Kubernetes项目试图明确定义云时代的“应用”概念，而不是交付一个容器和一个容器映像。在这里，应用程序是一组容器的有机组合，还包括应用程序运行所需的网络和存储需求的描述。描述这种应用的YAML文件存储在Etcd中，然后控制器模型用于驱动整个基础设施的状态不断接近用户声明的状态。这是Kubernetes的核心工作原理。</p><h1 id="069b" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">未来:应用交付的革命不会停止</h1><p id="8f92" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">回到2019年，Kubernetes和containers重新定义了软件交付。</p><p id="4027" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，Kubernetes项目正在继续尝试将应用程序的定义、管理和交付推向一个新的高度。我们实际上已经看到了现有模型的一些问题和缺点，尤其是声明式API如何更好地与用户体验保持一致。在这个问题上，Kubernetes项目还有很长的路要走，但它正在快速前进。</p><p id="3735" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，整个云计算生态系统都在试图重新思考PaaS的“故事”。在Google Cloud Next 2019上发布的Cloud Run，事实上已经间接宣布，GAE凭借Kubernetes和Knative的标准API“从灰烬中重生”。另一个典型的例子是，越来越多的应用程序以一种更“极端”的方式被抽象成功能，以便它们完全托管在独立于基础设施的环境中(FaaS)。如果容器把应用环境完全封装起来，把应用交付的权利还给开发者，那么函数就把应用和环境的关系分开，把应用交付的权利交给FaaS平台。不难看出，云计算在发展到PaaS的过程中被Docker打乱后，开始以全新的容器理念向PaaS融合。但这一次，PaaS可能会改名为Serverless。</p><p id="176d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还看到，技术和开源正在迅速抹平云的边界。越来越多的软件和框架不再被设计成直接绑定到云。毕竟，你无法缓解用户对商业竞争的担忧和焦虑，也无法阻止越来越多的用户在全球所有的云和数据中心部署Kubernetes。我们经常将云比作水、电和煤，并建议开发人员不要关心“发电”和“烧煤”。但实际上，开发商不仅不关心这些东西，甚至可能不知道水、电、煤从哪里来。在未来的云世界中，开发人员将把他们的应用程序交付到世界上的任何地方，没有任何区别，这很可能像现在我们把电脑插到房间里的任何一个插孔中一样自然。这也是为什么越来越多的开发者在讨论“云原生”。</p><p id="8bfe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们无法预见未来，但是代码和技术的发展告诉我们一个事实，未来的软件必须基于云。这将是“软件交付”本质问题不断自我革命的最终趋势，也是“云原生”概念的核心假设。所谓“云原生”，其实就是定义一条最优路径，让应用程序最大限度地利用云能力，发挥云的价值。在这条道路上，没有“应用”这个载体，“云原生”就无从谈起。容器技术是实现这一概念和延续软件交付革命的重要手段之一。</p><p id="989d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至于Kubernetes项目，它确实是整个“云原生”概念实施的核心和关键。但更重要的是，在这场软件技术革命中，Kubernetes不需要进入PaaS领域。它将成为连接云和应用程序的“高速公路”，以标准和高效的方式将应用程序快速交付到世界上的任何地方。这里的交付目的地可以是最终用户，也可以是PaaS/Serverless，从而创建一个更加多样化的应用托管生态系统。云的价值一定会回归到应用本身。</p><h1 id="ffa4" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">一起进入云原生架构时代</h1><p id="caa7" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">在云趋势下，许多企业开始将业务和技术向“云原生”演进。这个过程中最困难的挑战是如何将应用程序和软件迁移、交付和持续发布到Kubernetes系统。在这一波技术变革中，“云-原生应用交付”成为2019年云计算市场最热门的技术关键词之一。</p><p id="7138" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自2011年以来，阿里巴巴开始利用容器将云原生技术系统付诸实践。由于整个行业没有可供参考的例子，阿里巴巴正在逐步开发一种容器化的基础设施架构，这种架构可以与世界一流的科技公司相媲美，并服务于整个阿里巴巴集团。在这数万条集群管理经验中，阿里巴巴集装箱平台团队探索总结出了四种方法，让配送更加智能化、标准化。库伯内特网上的一切。这意味着要用K8S来管理一切，包括K8S本身。</p><p id="091d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序发布回滚策略。应用程序是按照规则分阶段发布的，包括发布kubelets本身。通过图像分割将环境分为模拟环境和生产环境。应该在监测方面做出足够的努力，使Kubernetes更加透明，以便尽早发现、预防和解决问题。</p><p id="98cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">近日，阿里云容器平台团队公布了两个社区项目:Cloud Native App Hub(仅中文版)和OpenKruise。<a class="ae km" href="https://developer.aliyun.com/hub?spm=a2c41.13977163.0.0" rel="noopener ugc nofollow" target="_blank"> Cloud-Native App Hub </a>是一个面向所有开发者的Kubernetes应用管理中心，而<a class="ae km" href="https://github.com/openkruise/kruise?spm=a2c41.13977163.0.0" rel="noopener ugc nofollow" target="_blank"> OpenKruise </a>是一个基于世界顶级互联网场景的Kubernetes自动化开源项目。</p><p id="97b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">云原生App Hub为国内开发者提供了一个掌舵应用国内映像站点，方便用户获取云原生应用资源。还推广了标准化的应用打包格式，将应用一键交付到K8S集群，大大简化了将云原生应用交付到多个集群的流程。OpenKruise/Kruise项目致力于成为“云原生应用自动化引擎”，解决大规模应用场景中的诸多O&amp;M痛点。OpenKruise项目源自过去几年阿里巴巴经济体中大规模应用部署、发布和管理的最佳实践。它从不同维度解决了Kubernetes上应用的自动化问题，包括部署、升级、弹性调整大小、QoS调整、健康检查、迁移和修复。</p><p id="eeaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步，阿里云容器平台团队也将以此为基础，继续与整个生态系统合作，推动云原生应用定义、K8S CRD和运营商编程范式、增强型K8S自动化插件等一系列标准化，使云原生应用实现大规模多集群场景下的快速交付、更新和部署。</p><p id="a59e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们期待与您携手共进，迎接云原生时代的到来！</p><h1 id="340c" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">关于作者</h1><p id="c0dc" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">张曾在Hyper和微软研究院(MSR)工作，目前从事Kubernetes和相关的上下游工作。</p><h1 id="b2cf" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">原始来源:</h1><div class="mg mh gp gr mi mj"><a href="https://www.alibabacloud.com/blog/a-decade-of-container-development-chronicles-of-software-delivery_595787?spm=a2c41.13977163.0.0" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">容器开发十年:软件交付编年史</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">阿里巴巴开发者2020年2月3日101由CNCF阿里云容器平台高级技术专家章雷…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.alibabacloud.com</p></div></div><div class="ms l"><div class="nb l mu mv mw ms mx ma mj"/></div></div></a></div><figure class="lr ls lt lu gt lv"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div></div>    
</body>
</html>