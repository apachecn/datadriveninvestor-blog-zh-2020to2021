<html>
<head>
<title>How to Build KMeans to Cluster Physical Activities on Wearable Device Dataset With Python Step-By-Step</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python逐步构建KMeans来对可穿戴设备数据集上的身体活动进行聚类</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/kmeans-clustering-on-wearable-device-dataset-are-you-lying-sitting-or-running-ffe0637e7844?source=collection_archive---------2-----------------------#2020-02-01">https://medium.datadriveninvestor.com/kmeans-clustering-on-wearable-device-dataset-are-you-lying-sitting-or-running-ffe0637e7844?source=collection_archive---------2-----------------------#2020-02-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/74df894438d6a0f55be72650de551757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xw2Lvz0_svuI8RrW6QVyIw.png"/></div></div></figure><div class=""/><div class=""><h2 id="9d2b" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">基于Python的物联网数据无监督学习</h2></div><p id="3a4c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">你或你的朋友戴Fitbit、Apple Watch或Garmin吗？从监测穿戴者身体活动的可穿戴设备收集的数据正被纳入大量商业用途，包括医疗保健、健身训练、导航系统等。</p><p id="e299" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">本文介绍了一种端到端的无监督学习解决方案<strong class="kv jf"> KMeans聚类</strong>来区分穿戴者的身体活动:躺着、坐着或跑步，而不使用任何标签，由此您可以对使用KMeans聚类的端到端过程产生直觉。此外，有了用KMeans构建的技能和经验，您可以在购物、营销、电影、书籍、新闻、音乐等社交媒体中创建推荐系统。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lp"><img src="../Images/4a7f0114c5018157beb4f54e14ece6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHyKl4QD4PPo7EOdHNo2Pw.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">icons credit to Karina M. and A M from the Noun Project</figcaption></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="d852" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">概述</h1><ul class=""><li id="0792" class="mx my je kv b kw mz kz na lc nb lg nc lk nd lo ne nf ng nh bi translated">数据的整体视图</li><li id="2f08" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">传感器数据的统计分布</li><li id="a47c" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">通过标准化和活动的一键编码实现功能扩展</li><li id="1e53" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">python中KMeans集群的基本版本</li><li id="a5e2" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">高级版本的KMeans聚类与聚类数实验:惯性，轮廓和整体准确性</li><li id="4fbf" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">结论和未来工作</li></ul></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="1a49" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">数据的整体视图</h1><p id="509e" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">本文中使用的数据可以从这个<a class="ae nq" href="https://drive.google.com/open?id=1sqbJBOB_eL1Zy-PO2OoMhWsZ18Epevam" rel="noopener ugc nofollow" target="_blank">链接</a>下载，这个链接是从UCI机器学习库中的公共<a class="ae nq" href="https://archive.ics.uci.edu/ml/datasets/PAMAP2+Physical+Activity+Monitoring" rel="noopener ugc nofollow" target="_blank">数据集</a>调整而来的子集。</p><h2 id="dcd5" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">导入库</h2><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="0dee" class="nr mg je oe b gy oi oj l ok ol">import os<br/>import numpy as np<br/>import pandas as pd<br/>from datetime import datetime as dt<br/>from sklearn import preprocessing as pp<br/>from sklearn.model_selection import train_test_split <br/>from sklearn.decomposition import PCA<br/>from sklearn.preprocessing import label_binarize<br/>from sklearn.cluster import KMeans, MiniBatchKMeans<br/>from sklearn.metrics import silhouette_samples, silhouette_score</span><span id="9ec9" class="nr mg je oe b gy om oj l ok ol">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>sns.set(style='whitegrid', palette='muted', font_scale=1.5)</span><span id="cca5" class="nr mg je oe b gy om oj l ok ol">pd.set_option('display.max_colwidth', -1)<br/>pd.set_option('display.max_columns', 5000)<br/>pd.set_option('display.max_rows' , 10000)<br/>pd.set_option('display.width', 10000)<br/>pd.set_option('display.precision', 6)<br/>plt.rcParams['figure.figsize'] = [12, 6]</span></pre><h2 id="e28a" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">加载数据</h2><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="de67" class="nr mg je oe b gy oi oj l ok ol">df = pd.read_csv(‘physical activity monitoring_UCI.csv’)</span><span id="192c" class="nr mg je oe b gy om oj l ok ol">if 'Unnamed: 0' in df.columns.tolist():<br/>    df = df.drop(['Unnamed: 0'], axis=1)<br/>if 'timestamp' in df.columns.tolist():<br/>    df = df.drop(['timestamp'], axis=1)<br/><br/>df.head()</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/5d11c780a501708a94f5ebc3014b9b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*WNpWcHWXqosf1UhjxUZUIA.png"/></div></figure><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="d330" class="nr mg je oe b gy oi oj l ok ol">df.info()</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/307d538e8e2704423f83b421b28c6ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*rvYjU3Cqu5JOVj9J91aY4Q.png"/></div></figure><p id="64e3" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如上所示，52列有472576个条目。这52个功能组织如下:</p><ul class=""><li id="95e5" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated"><strong class="kv jf">【活动】</strong></li></ul><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="86cf" class="nr mg je oe b gy oi oj l ok ol">'''<br/>3 types of activities<br/>– 1 lying<br/>– 2 sitting     <br/>– 5 running<br/>'''</span><span id="ae35" class="nr mg je oe b gy om oj l ok ol">df['activity'].value_counts()</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/c54a0dec55f2d9b5f3675295ce853d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*GIp4ReEFyQoIi6L6T5ebZA.png"/></div></figure><p id="82d9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">数据集中有3种类型的活动。“1”对应“躺”，“2”对应“坐”，“5”对应“跑”。简单来说，我们用“3”代表“跑步”来更新数据集。<strong class="kv jf">此标签仅用于评估我们的KMeans模型，而非训练模型。</strong></p><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="83cd" class="nr mg je oe b gy oi oj l ok ol">#  use 3 for running</span><span id="621b" class="nr mg je oe b gy om oj l ok ol">conditions = [df['activity']==1,df['activity']==2,df['activity']==5]<br/>choices = [1,2,3]<br/>df['activity']  = np.select(conditions, choices, default='null')</span><span id="1927" class="nr mg je oe b gy om oj l ok ol">df['activity'].value_counts()</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/1f9b8afcf5fd1b5683e53d3c898df317.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*rcsk7EraMT8tyXs-QTgQHA.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">1 for lying, 2 for sitting, 3 for running</figcaption></figure><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="ed59" class="nr mg je oe b gy oi oj l ok ol"># Pie chart, where the slices will be ordered and plotted counter-clockwise:<br/>labels = 'lying', 'sitting', 'running'<br/>sizes = [192290, 184645, 95641]</span><span id="495a" class="nr mg je oe b gy om oj l ok ol"># only "explode" the 3nd slice (i.e. 'running')<br/>explode = (0, 0, 0.1)</span><span id="90eb" class="nr mg je oe b gy om oj l ok ol">fig1, ax1 = plt.subplots()<br/>ax1.pie(sizes, explode=explode, labels=labels, autopct='%1.1f%%',<br/>        shadow=True, startangle=90)<br/>ax1.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.</span><span id="a4ec" class="nr mg je oe b gy om oj l ok ol">plt.show()</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/092f83d0e6f21893383308b488d6f4cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*jEqfe2CpwlQ-XUOVq79xsQ.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">20.2% of the activities are “running”</figcaption></figure><ul class=""><li id="2f20" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated"><strong class="kv jf">“IMU *”数据来自3个传感器</strong></li></ul><p id="9ec1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用了3个Colibri无线IMU(惯性测量单元)。传感器的位置和收集的数据:</p><ol class=""><li id="838c" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ov nf ng nh bi translated">主臂<strong class="kv jf">手腕上的1个IMU</strong>——采集的数据存储在“IMU hand 4”～“IMU hand 20”中</li><li id="e163" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ov nf ng nh bi translated"><strong class="kv jf">胸部</strong>上的1个IMU采集的数据存储在“imuchest 21”~“imuchest 37”中</li><li id="20b8" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ov nf ng nh bi translated">1优势侧<strong class="kv jf">脚踝</strong>的IMU采集的数据存储在“IMU ankle 38”～“IMU ankle 54”中</li></ol><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/4c6f2ec34f5c0e48fee9db855cd1a182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*dTfGrOeT8eUtYoJcEYiiGw.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">photo edited from a post at <a class="ae nq" href="https://www.ebuyer.com/blog/2013/11/the-impact-of-technology-in-sport/" rel="noopener ugc nofollow" target="_blank">ebuyer</a></figcaption></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="27a9" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">传感器数据的统计分布</h1><p id="97b0" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">可视化和比较从三个位置收集的传感器数据的分布:手、脚踝和胸部。</p><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="ca6c" class="nr mg je oe b gy oi oj l ok ol">fig, axes = plt.subplots(1, 2, figsize=(16, 6))</span><span id="193a" class="nr mg je oe b gy om oj l ok ol">axes[0].hist(df[df['activity']!=3]['IMUhand20'], bins=100, alpha=0.7, color='LightCoral');<br/>axes[0].hist(df[df['activity']==3]['IMUhand20'], bins=100, alpha=0.7, color='LightSkyBlue');<br/>axes[0].vlines(x=df['IMUhand20'].mean(),ymin=0, ymax=10**3, linestyles='dashed')<br/>axes[0].set_yscale('log')<br/>axes[0].set_title('IMUhand20')</span><span id="1666" class="nr mg je oe b gy om oj l ok ol">axes[1].hist(df[df['activity']!=3]['IMUankle51'], bins=100, alpha=0.7, color='LightCoral');<br/>axes[1].hist(df[df['activity']==3]['IMUankle51'], bins=100, alpha=0.7, color='LightSkyBlue');<br/>axes[1].vlines(x=df['IMUankle51'].mean(),ymin=0, ymax=10**2, linestyles='dashed')<br/>axes[1].set_yscale('log')<br/>axes[1].set_title('IMUankle51');</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/67b79775f262637e5ef97fa6b44bdeaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dedvc1OsiiUCJIVYTMVa7w.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">hand and ankle</figcaption></figure><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="fa9e" class="nr mg je oe b gy oi oj l ok ol">fig, axes = plt.subplots(1, 2, figsize=(16, 6))</span><span id="a92e" class="nr mg je oe b gy om oj l ok ol">axes[0].hist(df[df['activity']!=3]['IMUchest24'], bins=100, alpha=0.7, color='LightCoral');<br/>axes[0].hist(df[df['activity']==3]['IMUchest24'], bins=100, alpha=0.7, color='LightSkyBlue');<br/>axes[0].vlines(x=df['IMUchest24'].mean(),ymin=0, ymax=10**3, linestyles='dashed')<br/>axes[0].set_yscale('log')<br/>axes[0].set_title('IMUchest24')</span><span id="c6a5" class="nr mg je oe b gy om oj l ok ol">axes[1].hist(df[df['activity']!=3]['IMUchest33'], bins=100, alpha=0.7, color='LightCoral');<br/>axes[1].hist(df[df['activity']==3]['IMUchest33'], bins=100, alpha=0.7, color='LightSkyBlue');<br/>axes[1].vlines(x=df['IMUchest33'].mean(),ymin=0, ymax=10**2, linestyles='dashed')<br/>axes[1].set_yscale('log')<br/>axes[1].set_title('IMUchest33');</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/6902196874fb7e429b36568f11d71b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDecB8ia1s-baVbArZWqjg.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">chest</figcaption></figure><p id="ef00" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">红色条代表佩戴者处于“跑步”状态，而蓝色条代表“躺着”或“坐着”。我们随机选取了列:“IMUhand20”、“IMUankle51”、“IMUchest24”和“IMUchest33”，它们分别是从手、脚踝和胸部收集的数据。</p><p id="dab5" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如上图所示，与手和脚踝数据相比，从跑步到非跑步状态，胸部数据的分布变化更大。跑步时心率会升高是有道理的，这是一个强烈的信号。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="a28f" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">标准化的功能扩展</h1><p id="6052" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">应用来自sklearn的标准定标器来标准化除“活动”之外的特征，以便这些特征以0为中心，标准偏差为1。正如我在以前的帖子中多次强调的那样，标准化数据以确保特征在相同的相对范围内是一个必不可少的步骤，也是许多机器学习算法的一般要求。</p><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="6b87" class="nr mg je oe b gy oi oj l ok ol"># standardization<br/>data_std = data.copy().drop(['activity'], axis=1)<br/>Class = data['activity'].copy()<br/>featuresToScale = data_std.columns<br/>scaler = pp.StandardScaler(copy=True, with_mean=True, with_std=True)<br/>data_std.loc[:, featuresToScale] = scaler.fit_transform(data_std[featuresToScale])</span><span id="9a43" class="nr mg je oe b gy om oj l ok ol">data_std.describe()</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oz"><img src="../Images/0cd301f98fb63e10b54a43a167122d12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1JYSdbpmrpoyg12F9srxg.png"/></div></div></figure><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="15f9" class="nr mg je oe b gy oi oj l ok ol"># One-hot encoding</span><span id="5048" class="nr mg je oe b gy om oj l ok ol">from sklearn.preprocessing import label_binarize</span><span id="ba1c" class="nr mg je oe b gy om oj l ok ol">'''<br/>3 activities<br/>– 1 lying<br/>– 2 sitting     <br/>– 3 running<br/>'''</span><span id="0cfe" class="nr mg je oe b gy om oj l ok ol"># one-hot encoding<br/>n_classes = 3<br/>lb = pp.LabelBinarizer()<br/>y_label = lb.fit_transform(Class)</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/035c1606f81f9bf8453b5b074bfc3fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*5LSzHpEXJCvSRsCna5pvbA.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">one-hot encoding for Class which is the type of activities</figcaption></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="8ef7" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">python中KMeans集群的基本版本</h1><p id="11ff" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">聚类是无监督学习家族中的重要成员，该家族试图在不使用任何标签的情况下基于相似性将对象分组在一起。正如本文开头所提到的，在零售、在线购物、市场营销、新闻、电影、书籍、音乐等社交媒体中，聚类通常用于构建推荐系统的基础。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/3129529e9f146e07d5dfe96f0e454f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMwvmukJYe3mWU6gKeDIxQ.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">Before clustering; 3 centroids added</figcaption></figure><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pc"><img src="../Images/da434b043a42766be81d1b4b24067f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iM73Udgmugk5kd-GuvSY7g.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">After clustered with 3 centroids; Image created using <a class="ae nq" href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/" rel="noopener ugc nofollow" target="_blank">an online tool</a></figcaption></figure><p id="0333" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在KMeans聚类中，需要在训练模型之前指定所需的聚类数。KMeans的不同运行的结果会略有不同，因为该算法随机将每个观察值分配给一个聚类以开始聚类，然后通过最小化聚类内变化的总和(也称为所有聚类的<a class="ae nq" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html" rel="noopener ugc nofollow" target="_blank">惯性</a>)来优化分段。通常，KMeans会运行几次，并选择所有集群中惯性总和最低的运行。</p><p id="f0fb" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">1.将数据分成训练和测试数据集。</p><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="cd55" class="nr mg je oe b gy oi oj l ok ol">X_train , X_test , y_train , y_test = \<br/>            train_test_split(data_std, y_label, test_size=0.2, random_state=42, stratify=y_label)</span></pre><p id="9d22" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">2.加载库并设置参数。</p><ul class=""><li id="bd1e" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated"><strong class="kv jf"> n_init </strong>是KMeans将与不同数量的集群一起运行的初始化次数。最终结果将是n_init连续运行在惯性方面的最佳输出(组内变化)。</li><li id="b3a8" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><strong class="kv jf"> max_iter </strong>是算法单次运行的最大迭代次数。在我们的例子中，总迭代次数是(225次迭代/每次运行)* 12次运行。</li><li id="6954" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">n_jobs  = -1意味着我们正在使用所有的处理器。KMeans真的很慢(没有抱怨:)。</li></ul><p id="cb54" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">3.建立和训练模型；得到惯性值；计算平均轮廓分数。</p><figure class="lq lr ls lt gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">Basic version of KMeans clustering python code</figcaption></figure><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/2340628f3f19eb1630b832ade429cc0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*67BR_KbiMjRM6e38CtGshA.png"/></div></figure><p id="578a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">当类的数量为3时，KMeans将所有观察结果分组为3个类，平均轮廓得分为0.21，惯性为735341.49。</p><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="45cc" class="nr mg je oe b gy oi oj l ok ol"># plot the distribution of the 3 clusters </span><span id="01ec" class="nr mg je oe b gy om oj l ok ol">plt.scatter(X_train.iloc[:, 0], X_train.iloc[:, 1], c=cluster_labels, label=cluster_labels)<br/># Labeling the clusters<br/>centers = clusterer.cluster_centers_<br/># Draw white circles at cluster centers<br/>plt.scatter(centers[:, 0], centers[:, 1], marker='o',<br/>            c="white", alpha=1, s=200, edgecolor='k')</span><span id="d137" class="nr mg je oe b gy om oj l ok ol">for i, c in enumerate(centers):<br/>    plt.scatter(c[0], c[1], marker='$%d$' % i, alpha=1,<br/>                s=50, edgecolor='k')</span><span id="321e" class="nr mg je oe b gy om oj l ok ol">plt.title("Distributed based on clusters");</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pg"><img src="../Images/ad1c7399b4008f79f086846393cca6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7AD5BO7Ix52XJHRYbP8zWg.png"/></div></div></figure><p id="6f5b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果您对信息感到有点不知所措，尤其是如果您是第一次构建聚类模型，您可以在这里暂停一下，过几天再回来。太多的投入可能会太大，一口吃不完。如果你对如何通过计算惯性、剪影得分<em class="ph">和整体准确度来实验和选择理想的聚类数超级好奇，让我们继续。</em></p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="3056" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">高级版本的KMeans聚类与聚类数实验:惯性，轮廓和整体准确性</h1><p id="4c60" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">有三个指标被广泛用于评估KMeans算法:</p><ul class=""><li id="b565" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated">惯性</li><li id="0ae9" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">剪影分数</li><li id="2f8a" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">总准确度</li></ul><p id="56c9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><a class="ae nq" href="https://gist.github.com/alinazhanguwo/d8d3cf8e6621f5886f3a4a4f1b3956d8" rel="noopener ugc nofollow" target="_blank">k means高级版</a>的python代码由基本版升级而来，有以下变化:</p><figure class="lq lr ls lt gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk"><a class="ae nq" href="https://gist.github.com/alinazhanguwo/d8d3cf8e6621f5886f3a4a4f1b3956d8" rel="noopener ugc nofollow" target="_blank">The python code of KMeans advanced version</a></figcaption></figure><ul class=""><li id="c629" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated">在2到20个不同数量的集群上运行KMeans</li><li id="a41d" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">记录惯性</li><li id="5659" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">记录剪影分数</li><li id="821a" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">添加一个自定义函数来计算整体精度，我们将在下面详细讨论</li></ul><h2 id="d55e" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated"><strong class="ak">惯性</strong></h2><p id="6fb1" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">惯性是观测值到最近的聚类中心的平方距离的总和，也称为类内变化。下图显示了当集群数量从2到20时的惯性值。</p><p id="c727" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">惯性随着簇数量的增加而减小。这确实有意义，因为我们拥有的集群越多，每个集群内的观测值的同质性就越大。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pi"><img src="../Images/4522f3723d5523aed8fa934cc1081395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Vrq1Gwz9wRwHs7AikUNbg.png"/></div></div></figure><h2 id="f982" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">剪影分数</h2><p id="2b81" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">轮廓分数可用于研究形成的聚类之间的密度和间隔，其范围为[-1，1]。</p><p id="f22d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">以下带有<em class="ph"> n_clusters=4 </em>的剪影图显示了一个簇中的每个点与相邻簇中的点的接近程度:</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/2927474e6cc60c1425929abce3382bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0Sv_uIgdD0epXoD2Mtb4w.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">n_cluster = 4</figcaption></figure><h2 id="7381" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">集群之间的分离</h2><ul class=""><li id="c211" class="mx my je kv b kw mz kz na lc nb lg nc lk nd lo ne nf ng nh bi translated"><strong class="kv jf"> 0 &lt;剪影得分≤1 </strong>:剪影得分接近+1表示该点远离相邻聚类，算法对此决定有信心</li><li id="76d5" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><strong class="kv jf">剪影得分≈0 </strong>:剪影得分几乎等于0，表示该点位于或非常接近两个相邻聚类之间的判定边界</li><li id="c24b" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><strong class="kv jf">-1≤剪影分数&lt; 0 </strong>:剪影分数为负值表示这些点可能被分配到错误的簇</li></ul><h2 id="ff60" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">厚度—簇的大小</h2><p id="bb67" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">轮廓图的厚度代表簇的大小。例如，黑色的<strong class="kv jf"> <em class="ph">簇0 </em> </strong>和蓝色的<strong class="kv jf"> <em class="ph">簇1 </em> </strong>具有相似的厚度，因此具有相似的大小，这也可以从右侧的标记散点图中得到验证(黑点与蓝点)。</p><p id="365a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf"> <em class="ph">集群3 </em> </strong>黄色中最细意味着它是最小的集群。从标记的散点图中，我们可以看到很少有黄色点。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/ac8203b2a3847cee99e3706ef6c9fe8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*yvlQb57SSqfx4l3whHQjOg.png"/></div></figure><p id="0be0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">尝试使用我们刚刚经历的方法分析下面的<em class="ph"> n_clusters=7 </em>的轮廓图。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pl"><img src="../Images/6a5f2a74f87b1ff8ef51fd7953de4a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tqICPd84D5cRvgrWWGtQfg.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk"><em class="pm">n_clusters=7</em></figcaption></figure><p id="f954" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">该线图说明了当n_clusters从2增长到20时轮廓分数如何变化。我们可以看到<em class="ph"> n_clusters=17 </em>可能是一个很好的候选者，因为它是所有观测中最高的平均轮廓分数。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pn"><img src="../Images/c174193b5334d1a1d15e49fe2186908f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3wYyQ3Za5glrFk71PQfMCg.png"/></div></div></figure><h2 id="518f" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">总准确度</h2><p id="31de" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">下面的代码定义了一个函数<em class="ph"> overallAccuracy(clusterDF，labelsDF) </em>来分析每个聚类的精度和整体精度。</p><figure class="lq lr ls lt gt iv"><div class="bz fp l di"><div class="pd pe l"/></div></figure><p id="5398" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">让我们进入一些细节。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi po"><img src="../Images/1e508c5c3022914f5a4c198f49cba529.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*QGf-syDglBDi3wi2NGaqnA.png"/></div></figure><p id="3f9c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">上面的截图是print by函数<em class="ph">整体准确性的一部分。</em></p><p id="8b8b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">总共有5个聚类，我们将计算每个聚类中最频繁的标签，并将其用作聚类标签。例如，在<strong class="kv jf"> <em class="ph">簇0 </em> </strong>中，总共有5972个观察值。其中5964个具有标签1，在我们的例子中它代表<strong class="kv jf"><em class="ph"/></strong>，因此我们将把<strong class="kv jf"> <em class="ph">簇0 </em> </strong>标记为<strong class="kv jf"><em class="ph"/></strong>。</p><p id="9824" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">其他集群也是如此。7220个观测值被分组为<strong class="kv jf"> <em class="ph">簇1 </em> </strong>，其中6518个具有标签2 ( <strong class="kv jf"> <em class="ph">坐</em> </strong>)。<strong class="kv jf"> <em class="ph">集群1 </em> </strong>会被标注为<strong class="kv jf"> <em class="ph">坐</em> </strong>这是它最频繁的标注。</p><p id="aac9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">不同的分类可以有相同的标签。如上图，<strong class="kv jf"> <em class="ph">簇3 </em> </strong>和<strong class="kv jf"> <em class="ph">簇4 </em> </strong>中出现频率最高的标签都是3 ( <strong class="kv jf"> <em class="ph">运行</em> </strong>)。这两个集群中的观测值将被标记为<strong class="kv jf"> <em class="ph">运行</em> </strong>。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/b9677da324c64dd311b4232cd47d6122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*xNr3G50kFlFf5gwCZRjgbg.png"/></div></figure><h2 id="68b9" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">计算准确度和总准确度的公式</h2><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pq"><img src="../Images/616148b8c537adaa38c6c04526d42841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*WD5AF0jNi8PwltrmlOeuUA.png"/></div></div></figure><p id="bbba" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">如何计算每个集群的accuracyByLabel:</strong></p><p id="b255" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于<strong class="kv jf"> <em class="ph">簇0 </em> </strong>，精度为5964/5972=0.998660。</p><p id="2d42" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于<strong class="kv jf"> <em class="ph">簇4 </em> </strong>，精度为1463/2432=0.601562。</p><p id="8c7f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">如何计算所有聚类的总体准确率:</strong></p><p id="d60d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">为了计算总体精确度，它是</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/bec517194b79440424a560dcb9ccdcc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*8rq-VyD7lJ0E2JsH1npsBQ.png"/></div></figure><p id="b17e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下面的线形图显示了n_clusters在范围[2，20]内时的总体精确度。</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ps"><img src="../Images/b7919924da95f51b1a9018307402bb3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Brj30DC4T-JyDuCEb-5EXA.png"/></div></div></figure><h2 id="3aec" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">创建分数表</h2><p id="8df4" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">创建一个分数表来保存上面为不同数量的簇计算的惯性、轮廓平均值和总精确度。</p><pre class="lq lr ls lt gt od oe of og aw oh bi"><span id="711d" class="nr mg je oe b gy oi oj l ok ol">evaluation_df = inertia_df.copy()<br/>evaluation_df['inertia'] = inertia_df['inertia']<br/>evaluation_df['silhouetteAvg'] = silhouette_avg_df['silhouetteAvg']<br/>evaluation_df['overallAccuracy'] = overallAccuracy_df['overallAccuracy']<br/>evaluation_df['numOfClusters'] = inertia_df.index</span><span id="a73a" class="nr mg je oe b gy om oj l ok ol">cols = ['numOfClusters','inertia','silhouetteAvg','overallAccuracy']<br/>evaluation_df = evaluation_df[cols]<br/>evaluation_df</span></pre><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/baf68883392d06cd861131b3d7dde840.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*AXpsJI-mecipH7-AConGdw.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">experiment results</figcaption></figure><p id="838e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">基于实验结果，<strong class="kv jf"> 17 </strong>可能是该数据集上聚类数的最佳选择。在实践中，我们可以使用<em class="ph"> n_clusters=17 </em>在这个数据集上训练KMeans，并使用训练好的模型对看不见的数据进行聚类。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="a107" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">结论和未来工作</h1><p id="5f96" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">在本文中，首先，我们分析了一个传感器数据集，该数据集是从穿着者在三种身体活动中收集的:躺、坐或跑。然后，我们介绍了KMeans实现的两个版本，其中引入了惯性、轮廓和整体准确性。</p><p id="5fb9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">对于未来的</strong>，我们能做些什么来推动这个项目更上一层楼？至少，如果你是在做一个真实世界的项目而不是自学，有两件重要的事情值得考虑:</p><ul class=""><li id="9d16" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated">聚类前PCA支持的维数约减</li><li id="5aee" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">迷你批处理意味着</li></ul><h2 id="04cf" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">聚类前PCA支持的维数约减</h2><p id="0d03" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">在我们的示例中，有51列传感器数据被送入KMeans模型。如果我们在运行聚类算法之前使用普通PCA实现降维会怎么样？</p><p id="b4c0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在我的实验中，当主成分的数量等于5时，捕获了原始数据集的55%的方差，KMeans模型可以达到稍好的整体准确性。</p><p id="6f6f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">印象深刻吧？您可以仅使用<strong class="kv jf">10%</strong>(从51到5)的功能来获得更好的性能！原因是降维可以在去除冗余信息的同时密集地捕获原始数据集中的显著信息，而最典型的线性降维方法之一就是正态PCA。</p><p id="48b6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我强烈建议在聚类之前将普通PCA作为机器学习管道的一部分，因为它会有所帮助</p><ul class=""><li id="eaca" class="mx my je kv b kw kx kz la lc op lg oq lk or lo ne nf ng nh bi translated">解决大规模、计算量大的问题</li><li id="df4e" class="mx my je kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">更有效地识别数据中有趣的潜在模式<strong class="kv jf"> </strong>因为<strong class="kv jf"> </strong>大量的噪音(冗余信息)已经被减少</li></ul><h2 id="710a" class="nr mg je bd mh ns nt dn ml nu nv dp mp lc nw nx mr lg ny nz mt lk oa ob mv oc bi translated">迷你批处理意味着</h2><p id="3f54" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nn le lf lg no li lj lk np lm ln lo im bi translated">KMeans超级超级超级慢。如果你在笔记本电脑上运行，可能要花很长时间。对于具有超过10k个观察值的大规模数据集，您可以训练自己更有耐心，或者使用MiniBatchKMeans，这是一种更快的实现方式，因为它使用小批量进行增量更新。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="6fcf" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">哇！！！这确实是一大块，如果你到了这里，你会做得很好。你已经走了很长的路。现在，你能通过聚集我正在做的事情来庆祝吗:</p><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pu"><img src="../Images/73bb0c94ab6cb82e47c78a131333ee90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oAxHdo0rGjT3jfzKp45OHQ@2x.jpeg"/></div></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="6843" class="mf mg je bd mh mi mj mk ml mm mn mo mp kk mq kl mr kn ms ko mt kq mu kr mv mw bi translated">报名参加🦞:的Udemy课程</h1><h1 id="421f" class="mf mg je bd mh mi pv mk ml mm pw mo mp kk px kl mr kn py ko mt kq pz kr mv mw bi translated"><a class="ae nq" href="https://www.udemy.com/course/recommender-system-with-machine-learning-and-statistics/?referralCode=178D030EF728F966D62D" rel="noopener ugc nofollow" target="_blank">具有机器学习和统计的推荐系统</a></h1><figure class="lq lr ls lt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qa"><img src="../Images/1bc21612997f8444fd0645e2051bfaf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKOCPURU3yAr82_zvOXIJw.jpeg"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk"><a class="ae nq" href="https://www.udemy.com/course/recommender-system-with-machine-learning-and-statistics/?referralCode=178D030EF728F966D62D" rel="noopener ugc nofollow" target="_blank">https://www.udemy.com/course/recommender-system-with-machine-learning-and-statistics/?referralCode=178D030EF728F966D62D</a></figcaption></figure></div></div>    
</body>
</html>