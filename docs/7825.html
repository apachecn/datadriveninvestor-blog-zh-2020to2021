<html>
<head>
<title>Spam detection in 15 lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">15行代码中的垃圾邮件检测</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/detecting-spam-in-15-lines-f238c20b6ab4?source=collection_archive---------19-----------------------#2020-12-23">https://medium.datadriveninvestor.com/detecting-spam-in-15-lines-f238c20b6ab4?source=collection_archive---------19-----------------------#2020-12-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cc2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3分钟DIY机器学习模型</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4c95c95d923206dec26b128bb57aa8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYlwpKq8zUFxMD7i8hEQRg.jpeg"/></div></div></figure><p id="cc6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">机器学习一直被视为一个黑盒，其根源在于微积分、线性代数和统计学。实际上，它比大多数算法都要简洁和容易得多。以下是如何用15行代码构建垃圾邮件检测算法。跟我一起或者只是浏览一下！</p><h1 id="4696" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">导入必要的包</h1><pre class="km kn ko kp gt lv lw lx ly aw lz bi"><span id="6e74" class="ma ky iq lw b gy mb mc l md me">import pandas as pd<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.feature_extraction.text import CountVectorizer<br/>from sklearn import svm</span></pre><p id="238c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">导入pandas作为pd </strong>导入pandas一个数据清理和分析包。“as pd”允许我们将pandas方法称为“pd”而不是“pandas”。</p><p id="10d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从sklearn.model_selection导入train_test_split </strong>这是一个包，它允许我们将数据集分成训练集和测试数据集，在训练集中我们教授模型，在测试集中我们测试模型的表现。</p><p id="fb17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">来自sk learn . feature _ extraction . text import count vectorizer</strong>一个对电子邮件中出现的单词进行标记和计数的包。Tokenizes只是意味着给每个单词一个随机数，以便于操作。</p><p id="7590" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从sklearn导入svm </strong>导入svm一个支持向量机，它使用数据训练模型。如果机器学习背后有秘方的话，这就是了。</p><h1 id="07ef" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">数据分析</h1><pre class="km kn ko kp gt lv lw lx ly aw lz bi"><span id="c9cb" class="ma ky iq lw b gy mb mc l md me">spam = pd.read_csv('spam.csv')</span></pre><p id="a967" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">spam = PD . read _ csv(' spam.csv ')</strong>将CSV文件' spam . CSV '转化为数据帧，保存到spam。数据框只是python可以解释的表格数据，不会对数据集进行任何更改。在这里找到数据<a class="ae mf" href="https://drive.google.com/file/d/1vBFxXjwFmojH80e0hVnsB7Hjy7hbgCMT/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="mg mh gp gr mi mj"><a href="https://www.datadriveninvestor.com/2020/11/19/how-machine-learning-and-artificial-intelligence-changing-the-face-of-ecommerce/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">机器学习和人工智能如何改变电子商务的面貌？|数据驱动…</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">电子商务开发公司，现在，整合先进的客户体验到一个新的水平…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx kv mj"/></div></div></a></div><h1 id="2fbc" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">分割训练和测试数据集</h1><pre class="km kn ko kp gt lv lw lx ly aw lz bi"><span id="bc49" class="ma ky iq lw b gy mb mc l md me">x = spam['EmailText']<br/>y = spam["Label"]<br/>x_train, x_test,y_train, y_test = train_test_split(x,y,test_size = 0.2)</span></pre><p id="f6f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> x = spam['EmailText']: </strong>将spam中的“EmailText”列分配给x。这是我们放入模型的数据。你可以在下面看到原始数据集的截图。</p><p id="a85e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> y = spam["Label"]: </strong>将spam中的" Label "列分配给y。这将告诉模型如何更正答案。你可以在下面看到原始数据集的截图。</p><p id="73a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> x_train，x_test，y_train，y_test = train_test_split(x，y，test_size = 0.2): </strong>将x和y列分为用于训练输入的x_train、用于训练标签的y_train、用于测试输入的x_test和用于测试标签的y_test。test_size=0.2将测试集设置为x和y的20%。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi my"><img src="../Images/a21a4ee435f5bc64b5c25db7d0d85b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*do7R5j-z4hy78Na5QsVjaw.png"/></div></div></figure><h1 id="855e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">提取特征</h1><pre class="km kn ko kp gt lv lw lx ly aw lz bi"><span id="3d73" class="ma ky iq lw b gy mb mc l md me">cv = CountVectorizer()<br/>features = cv.fit_transform(x_train)</span></pre><p id="81e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> cv= CountVectorizer(): </strong>保存CountVectorizer()为每个单词随机分配一个数字(标记化)，统计单词的出现次数，并保存到cv。还没有做什么，我们只是暂时把这个方法分配给cv。</p><p id="bf17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">features = cv . fit _ transform(x _ train):</strong>随机给每个单词分配一个数字(标记化)，统计单词的出现次数，保存到cv。在下图中，0代表电子邮件的索引，随机数代表单词，最右边是出现的次数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/16e3acdcd26ae1cf8a2144efab8ab165.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*duViccVEwuClh-725lDwdg.png"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">The word corresponding to 1841 is used twice in email number 0</figcaption></figure><h1 id="a8c5" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">建立模型</h1><pre class="km kn ko kp gt lv lw lx ly aw lz bi"><span id="c8cd" class="ma ky iq lw b gy mb mc l md me">model = svm.SVC()<br/>model.fit(features,y_train)</span></pre><p id="9aba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">模型=支持向量机。SVC(): </strong>分配svm。SVC()到模型。</p><p id="0b21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> model.fit(features，y_train): </strong> model.fit用特征训练模型，y_train。它通过对照标签(y_train)检查它的预测并调整参数直到它达到最优。</p><h1 id="603e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">测量精度</h1><pre class="km kn ko kp gt lv lw lx ly aw lz bi"><span id="6436" class="ma ky iq lw b gy mb mc l md me">features_test = cv.transform(x_test)<br/>print(model.score(features_test,y_test))</span></pre><p id="8665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">features _ test = cv . transform(x_test):</strong>根据经过计数矢量化的x _ test进行预测。将结果保存到features_test。</p><p id="b182" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">print(model . score(features_test，y_test)): </strong> mode.score()针对y_test实际标签对features _ test的预测进行评分。</p><p id="4e0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！通过这个模型，我们能够以97%的准确率对垃圾邮件进行分类。希望这篇文章揭开了机器学习的神秘面纱，帮助你获得更好的理解，甚至可能帮助你建立你的第一个模型。如果你喜欢这篇文章，请鼓掌，并关注我！</p><h2 id="3420" class="ma ky iq bd kz ne nf dn ld ng nh dp lh jy ni nj ll kc nk nl lp kg nm nn lt no bi translated">访问专家视图— <a class="ae mf" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank">订阅DDI英特尔</a></h2></div></div>    
</body>
</html>