<html>
<head>
<title>RNA-Seq Data Analysis using PCA (Principal Component Analysis)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PCA(主成分分析)的RNA-Seq数据分析</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/rna-seq-data-analysis-using-pca-principal-component-analysis-a28156d72c0d?source=collection_archive---------1-----------------------#2020-05-11">https://medium.datadriveninvestor.com/rna-seq-data-analysis-using-pca-principal-component-analysis-a28156d72c0d?source=collection_archive---------1-----------------------#2020-05-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ec3cf52288e203bc1b9900e7347e5aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jr-GpftxpquqIr7q"/></div></div></figure><p id="15f2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">今天，我将告诉你<strong class="kd iu"> RNA测序分析</strong>如何改变<strong class="kd iu">医学研究。</strong></p><p id="3df4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">看完你会知道:如何使用<strong class="kd iu">机器学习算法</strong>来获得对各种<strong class="kd iu">疾病</strong>的<strong class="kd iu">正确洞察</strong>。</p><blockquote class="kz la lb"><p id="a9e3" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">最后你就知道这个过程的<strong class="kd iu"> Python </strong>代码了。所以，让我们首先建立对整个场景的<strong class="kd iu">理解</strong>。</p></blockquote><h1 id="cdcd" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">简介:</h1><p id="543d" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated"><strong class="kd iu">胰腺癌</strong> (PAAD)是<strong class="kd iu">癌症</strong>的第三大常见死因，总体5年生存率低于5%</p><p id="65ef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">据预测，到2030年，它将成为美国第二大癌症死亡原因 。</p><div class="mj mk gp gr ml mm"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">认知计算——一套被广泛认为是……</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na jz mm"/></div></div></a></div><p id="ec13" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">核糖核酸(RNA ) </strong>是一种聚合分子，在基因的编码、解码、调节和<strong class="kd iu">表达的各种生物学作用中必不可少。</strong></p><p id="6d25" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> RNA-Seq (RNA测序)</strong>，是一种在给定时刻检测生物样本中RNA 的<strong class="kd iu">数量的测序技术。</strong></p><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/657df2bd6ce376f9eeeb2d8bdf78e1ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*liNjL-iiw3vhq-bj"/></div></div></figure><p id="7e75" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里我们有一个<strong class="kd iu">标准化RNA测序数据集</strong>读取<strong class="kd iu">胰腺癌肿瘤</strong>。该测量包括185个胰腺癌肿瘤的约20，000个基因。</p><p id="2205" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">文件格式为GCT </strong>，一个制表符分隔的文件，用于共享样本的基因表达数据和元数据(每个样本的详细信息)。</p><blockquote class="kz la lb"><p id="24ef" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><strong class="kd iu">GCT文件就像一个多维数据帧，由3个二维数据帧组成。</strong></p></blockquote><p id="0035" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些是:</p><ul class=""><li id="a547" class="nf ng it kd b ke kf ki kj km nh kq ni ku nj ky nk nl nm nn bi translated"><strong class="kd iu"> data_df: </strong>它有18465行(基因ID)和183列(样本名称/ID)</li><li id="f133" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated"><strong class="kd iu"> row_metadata_df: </strong>它有行元数据，当我们看到类型时，它是一个空的数据框。这意味着在我们的数据中，行元数据不存在。</li><li id="8f66" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated"><strong class="kd iu"> col_metadata_df: </strong>对于每个样本，它有183列(样本名称/ID)和124行(列元数据，如组织学类型、患者ID、状态(他是否活着))。</li></ul><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9d1c0a22e00b02eee0ea6701cd6f5913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HrgZN65VXYhpDDz6"/></div></div></figure><h1 id="b06d" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">数据清理和检查样本间基因表达的分布:</h1><p id="ee4d" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">在18465行中，有4367行在某些列中有空值<strong class="kd iu">。</strong></p><p id="e904" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以我在数据清理过程中删除了它们。因此，在数据清理后，有14098行和183列。</p><p id="a111" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这14098行代表基因ID，183列代表183个不同的样本。</p><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/54c97594eb4882fd8392872fb7f110a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XDl9Bmt2Pw3EUvrZ"/></div></div></figure><h1 id="0626" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">生成所有样品的基因表达分布:</h1><p id="a37a" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">这里我们画出了表达式(范围从0到15的数值，例如7.5或11.2等。)理解图的要点:</p><ul class=""><li id="bfc3" class="nf ng it kd b ke kf ki kj km nh kq ni ku nj ky nk nl nm nn bi translated">热图的x轴有样本名称。</li><li id="3889" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">热图的y轴具有基因id。</li><li id="29dc" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">颜色表示对应于每个样品的基因表达值。</li><li id="209c" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">所以右边的颜色条帮助我们深入了解基因表达的分布，因为这些值是通过颜色编码的。</li></ul><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a5ac602512bf5c15ca12ff5246ee273d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wk1H49284w8nTHwu"/></div></div></figure><h1 id="f40e" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">使用Phantasus工具在线可视化所有数据。</h1><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/fb99551277a4dabc69e79d84d6ff449f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NvBKK3bpEN-fFlTu.png"/></div></div></figure><h1 id="263c" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">所有样本基因分布图:</h1><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/55e33740aaad22d2652ebc2c4c90ceaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xMsR8VvBHVRckBVR.png"/></div></div></figure><h1 id="ac26" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">仅识别外分泌(腺癌)肿瘤，去除神经内分泌肿瘤:</h1><h2 id="868c" class="nv lh it bd li nw nx dn lm ny nz dp lq km oa ob lu kq oc od ly ku oe of mc og bi translated">为PCA准备数据:</h2><p id="b742" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">使用PCA结果绘制数据。</p><p id="84e2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们已经知道这些数据是针对两大类胰腺癌的:</p><ul class=""><li id="06a5" class="nf ng it kd b ke kf ki kj km nh kq ni ku nj ky nk nl nm nn bi translated"><strong class="kd iu">外分泌</strong></li><li id="5d65" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated"><strong class="kd iu">神经内分泌</strong>基于此，将会有2组不同的<strong class="kd iu">数据点</strong>。</li></ul><p id="87e4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里我使用了<strong class="kd iu">‘organization _ type _ other’</strong>数据来区分这两种类型的癌症。</p><h1 id="978c" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">PCA图图像:</h1><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/245cfd9475cd9d9dcdbe4fe03d7ef50b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/0*8okpZKzl_sCxO0QY.png"/></div></figure><p id="debf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以看到，大多数点都集中在PC1和PC2值的特定范围内。这样我们就可以把样本从<strong class="kd iu">神经内分泌</strong>和<strong class="kd iu">外分泌</strong>中分离出来。</p><p id="1328" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">异常值为-100 &gt; PC1，PC1 &gt; 100。我选择这个范围是因为它是<strong class="kd iu"> PC1和一个更突出的特征</strong>。另一个约束是PC2 &lt; 50。</p><p id="15e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它将为我们分离出<strong class="kd iu">异常值</strong>。因此，在下一步中，我们将从数据框中移除异常样本。</p><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e4df23bc08cac297e683b9ce37a2cdff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TbLpxLRf8ssYEIpM"/></div></div></figure><h1 id="a84f" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">了解干扰素在胰腺癌中的作用:</h1><p id="b0c5" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated"><strong class="kd iu">干扰素(IFNs) </strong>是一组<strong class="kd iu">信号蛋白</strong>，由宿主细胞在对几种病原体(如病毒、细菌、寄生虫以及肿瘤细胞)的存在做出反应时产生并释放。</p><p id="2c36" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">I型干扰素(IFNs)是干扰素蛋白的一个大亚群，有助于调节免疫系统的活动。</p><p id="7471" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">负责1型干扰素的基因被称为1型干扰素标记，在智人中由25个基因组成。</p><p id="3fe8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，我们知道了属于<strong class="kd iu">胰腺癌</strong>类别的样本，我们也知道了负责1型干扰素(1型IFN信号)的基因。</p><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b49f89343d41117a505bec3345b14f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u5aJZLEOmv4V2z6y"/></div></div></figure><p id="db82" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些基因是智人的一组25个基因。因此，为了绘制基因表达图，对于<strong class="kd iu">胰腺癌</strong>，我们将创建一个数据帧，其中这25个基因作为行，样本名称(这是pp数据帧的索引。)作为列。</p><h1 id="97c0" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">1型干扰素基因(25个基因)的图像→这是外分泌样本的分布。</h1><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oi"><img src="../Images/561c1152d2ed09753c61fec810b39f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GyuUmh83JB-MRmTr.png"/></div></div></figure><p id="afee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，我们可以看到基因在不同样本中的分布，就像它在10和12附近有最多的值，因为10和12附近的热图颜色最有可能被观察到。蓝色的频率较低。所以它表示一些值在4左右。</p><h1 id="87fb" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">GSVA算法的输出显示为命令终端的屏幕截图。我在Docker中运行了这个算法。</h1><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/20af7aa13f52e62696017d422a4c4c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*trrf79DUaEMpMruY"/></div></div></figure><blockquote class="kz la lb"><p id="44db" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae oj" href="https://github.com/praveenpareek11/RNA-Seq/blob/master/run.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">完整代码，访问我的GitHub句柄。</strong>T3】</a></p></blockquote><h1 id="8393" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">总结:</h1><ul class=""><li id="e74f" class="nf ng it kd b ke me ki mf km ok kq ol ku om ky nk nl nm nn bi translated">我们学习了RNA测序数据。</li><li id="a503" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">用于更好分析的RNA测序的数据存储格式。</li><li id="fcbc" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">在医学研究中使用机器学习算法，如PCA(主成分分析)。</li><li id="83c8" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">外行人对算法输出的理解。</li><li id="aba8" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">干扰素及其对免疫系统的影响。</li><li id="4dc0" class="nf ng it kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">最后使用Docker中的GSVA(基因集变异分析)算法得到具体的见解。</li></ul><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d8102507dbc59524bf867d45db602796.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HizooV1C6gwtv5L6"/></div></div></figure><blockquote class="kz la lb"><p id="eca0" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">【阅读更多】在<a class="ae oj" href="https://praveenpareek11.github.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">https://praveenpareek11.github.io/</strong></a></p><p id="ba16" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae oj" href="https://medium.com/@praveen.pareek" rel="noopener"> <strong class="kd iu">更多有趣的博文，安装medium app关注我！</strong>T13】</a></p></blockquote><figure class="nb nc nd ne gt ju"><div class="bz fp l di"><div class="on oo l"/></div></figure></div></div>    
</body>
</html>