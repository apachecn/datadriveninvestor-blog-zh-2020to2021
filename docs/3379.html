<html>
<head>
<title>A workflow system based on email and Google Forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于电子邮件和谷歌表单的工作流系统</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/a-workflow-system-based-on-email-and-google-forms-fc8f08ca7212?source=collection_archive---------4-----------------------#2020-06-15">https://medium.datadriveninvestor.com/a-workflow-system-based-on-email-and-google-forms-fc8f08ca7212?source=collection_archive---------4-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/3389e0610a1a692efafb6f8c8964cf9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*NScdjIzh8qT9zC54cxkNIw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk"><a class="ae kb" href="https://blog.betalabs.com.br/a-importancia-do-workflow-no-atendimento-ao-cliente/" rel="noopener ugc nofollow" target="_blank">https://blog.betalabs.com.br</a></figcaption></figure><p id="725c" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">目标是使用Google Forms收集的信息，应用python发送电子邮件的过程，以大规模和自动的方式管理Google电子表格中注册的信息。</p><h2 id="9002" class="la lb it bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">定义:</h2><p id="4b44" class="pw-post-body-paragraph kc kd it ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz im bi translated">工作流是根据一组已定义的规则，使业务流程自动化所必需的一系列步骤，允许业务流程从一个人传递到另一个人。</p><p id="d508" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">理论上，这种管理可以手工组织，但目前，大多数工作流是在信息技术(更好地称为IT系统)的背景下系统化的。</p><p id="12ec" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">从技术角度来看，什么是工作流？它如何改进业务流程？</p><p id="5102" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">工作流技术指的是一套工具，从宏观环境的角度来看，这些工具在最终单位和特定公司的办公室之间架起了一座桥梁。</p><div class="ly lz gp gr ma mb"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd iu gy z fp mg fr fs mh fu fw is bi translated">认知计算——一套被广泛认为是……</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp jv mb"/></div></div></a></div><p id="3226" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">一般来说，工作流技术不仅保证了同一业务流程中不同部门之间的沟通和信息交换，而且保证了任何和所有任务都由预定的员工来执行。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/b5f7149d28ed0e71ed57e1f3aab86645.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*JRJOeiqiTjQzqixicMI9dg.jpeg"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk"><a class="ae kb" href="https://blog.betalabs.com.br/a-importancia-do-workflow-no-atendimento-ao-cliente/" rel="noopener ugc nofollow" target="_blank">https://blog.betalabs.com.br</a></figcaption></figure><p id="7494" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">发展:</strong></p><p id="34e8" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我们需要制定5项工作策略:</p><p id="647b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">1.创建一个谷歌表单(非常容易)</p><p id="522d" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">2.为Google Drive定义一个关键API</p><p id="6857" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">3.为Google电子表格共享信息，其中包含从Google表单收集的信息</p><p id="7350" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">4.用python程序读取电子表格到熊猫数据框</p><p id="28e1" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">5.创建python程序来发送电子邮件，其中包含来自熊猫数据帧的信息</p><h2 id="a7cb" class="la lb it bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">我们走吧:</h2><p id="3716" class="pw-post-body-paragraph kc kd it ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz im bi translated"><strong class="ke iu"> 1。创建一个谷歌表单</strong></p><p id="dbcc" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">Google Forms是一个搜索管理应用程序，与Google Docs、Google Sheets和Google Slides一起包含在Google Drive office套件中。表单展示了文档、电子表格和演示文稿中的所有协作和共享功能。这是一种强大、简单和免费的方式来创建您的查询和/或从您的客户那里收集格式化的信息。</p><p id="b025" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">去<a class="ae kb" href="https://docs.google.com/forms/" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/forms/</a>创建你的表格。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/3328aac1be62eb4591ea88472c318be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B2ij08lTHI5tYNOIbOzJKw.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Google Forms example</figcaption></figure><p id="8b7b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">Google自动创建一个与表单相关联的电子表格Google Spreadsheet，它将把从填写表单中收到的所有信息放在那里。这是一个电子表格，在云中。我的电子表格创建的示例:</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/a43745e11f2baad1fced12dcda98e230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y5YL_0Vs3ePeSdSeTD3HEA.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">The spreadsheet generated with my google form</figcaption></figure><p id="8854" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu"> 2。为Google Drive定义一个关键API</strong></p><p id="1ef3" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">要用程序访问Google Drive，我们需要创建我们的API。要创建API，请转到谷歌控制台:<a class="ae kb" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">https://console.developers.google.com/</a></p><p id="51c6" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">一部好的作品描述的就是这个过程，<a class="ae kb" href="https://towardsdatascience.com/accessing-google-spreadsheet-data-using-python-90a5bc214fd2" rel="noopener" target="_blank">这里</a>。</p><p id="44cf" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这个配置Google API生成一个JSON文件，可以访问您的Google Drive。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nb"><img src="../Images/645530e2e820f0cdb4602fe5034f3709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVviYIWrWuYtJsU9b1Qi9w.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">My JSON File</figcaption></figure><p id="5230" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu"> 3。为谷歌电子表格共享信息，该表格包含从谷歌表单收集的信息</strong></p><p id="c0f5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">最后一步给了我们一个在Google Drive上的文档中使用的密钥。这个键是我们向其提供电子表格共享的元素。使用“客户端电子邮件”信息。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a5e39e36a7928a7957299cc246ad9512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*uuo_he2HWEVyaYlQqlTJow.png"/></div></figure><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/baf82cac69f9218ea0b33caea4d70b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*Cf-GVpTJyDVxpR65__fceQ.png"/></div></figure><p id="4c8b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我们可以使用这个密钥在python程序中访问文件。</p><p id="4411" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu"> 4。用python程序将电子表格读入熊猫数据框</strong></p><p id="c132" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我们需要在python程序中导入<strong class="ke iu"> gspread </strong>和<strong class="ke iu"> oauth2client </strong>。</p><p id="655a" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">文件“Client _ My _ Drive _ API _ secret . JSON”是在Google API配置期间创建的。这是一个JSON文件，包含使用程序访问Google Drive的密钥。您需要将JSON文件放在您的工作路径中。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nd"><img src="../Images/d96b20077ac577ccc0bd620f0a7ba828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sVDyyGy2_3cCqhEsmPNJdw.png"/></div></div></figure><p id="f02a" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">另一种方法是获取电子表格的密钥。</strong></p><p id="ee73" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">为此，我们需要发布我们的谷歌电子表格文件:文件&gt;发布在网络上&gt; CSV格式</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ne"><img src="../Images/7b3031d17cac78c87f328da207d4a53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWu9i9xyG8qe9LAgfRpetA.png"/></div></div></figure><p id="5eb1" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">在Python程序中，我们像这样访问，读取电子表格，然后放入Pandas数据框中:</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nf"><img src="../Images/d4e38373171700831364baf6a7b6b776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w46JLw_cTZqa0L45Av5kAw.png"/></div></div></figure><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ng"><img src="../Images/ce4ebf7d4ce48fd81eff6e387228271a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCInjIOhPdMq31wpZSZypQ.png"/></div></div></figure><p id="5221" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu"> 5。我创建了一个python程序来发送电子邮件，信息来自熊猫数据框</strong></p><p id="ebcf" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我尝试了两种方法，一种是使用email.mime功能，另一种是使用Yagmail。使用yagmail更容易。</p><p id="d408" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我需要<strong class="ke iu">导入yagmail </strong>，我创建了一个循环来读取pandas数据帧并调用函数为每一行发送电子邮件。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nh"><img src="../Images/7ec6b6be4db5779ca271adb92284ceff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8_gc6wW5CpBZS7V-m800Q.png"/></div></div></figure><p id="ce89" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">在正文中，我们可以使用HTML来创建更好的设计。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ni"><img src="../Images/8762f9540984e96aa11a3933aa0b958a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6V18fdADreGxNtQzy393CA.png"/></div></div></figure><p id="4fe9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">对于附件只需要告知路径和文件名就可以在邮件中附上。我尝试附加许多类型的文件，包括PDF、JPG和ICS(用于日历约会)，并成功执行。创建ics文件的一个更简单的方法是，我找到了网页<a class="ae kb" href="https://ical.marudot.com/" rel="noopener ugc nofollow" target="_blank">https://ical.marudot.com/</a>，在那里我们可以定义事件并将其下载为ics格式的文件。</p><p id="4b79" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这是收到的邮件。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nj"><img src="../Images/aef69ca5aaa5883f483165958dd5d2cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4fVvqPkJKHBiYJGchir1-Q.png"/></div></div></figure><h2 id="2765" class="la lb it bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">结论</h2><p id="3673" class="pw-post-body-paragraph kc kd it ke b kf lt kh ki kj lu kl km kn lv kp kq kr lw kt ku kv lx kx ky kz im bi translated">过程自动化、数字化和工业4.0有很多创新，通常从每个软件公司检索软件片段，合并跨各种平台和语言分布的许多知识。安全方便管理的实例。</p><h2 id="dd02" class="la lb it bd lc ld le dn lf lg lh dp li kn lj lk ll kr lm ln lo kv lp lq lr ls bi translated">参考资料:</h2><div class="ly lz gp gr ma mb"><a href="https://github.com/MRobalinho/Read_Google_Sheet" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd iu gy z fp mg fr fs mh fu fw is bi translated">MRobalinho/Read_Google_Sheet</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">阅读谷歌电子表格使用谷歌表单收集的信息，应用python发送电子邮件的过程…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="nk l mm mn mo mk mp jv mb"/></div></div></a></div><div class="ly lz gp gr ma mb"><a href="https://github.com/MRobalinho/Send_email" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd iu gy z fp mg fr fs mh fu fw is bi translated">MRobalinho/发送电子邮件</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">发送电子邮件并附上文件JPG，PDF和。ICS(日历事件)…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="nl l mm mn mo mk mp jv mb"/></div></div></a></div><div class="ly lz gp gr ma mb"><a href="https://ical.marudot.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd iu gy z fp mg fr fs mh fu fw is bi translated">iCal事件生成器-创建icalendar(。ics)分享您的活动</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">创建iCalendar(。ics)文件...单个或多个事件。重复发生的事件。带时区…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">ical.marudot.com</p></div></div></div></a></div><div class="ly lz gp gr ma mb"><a href="https://towardsdatascience.com/accessing-google-spreadsheet-data-using-python-90a5bc214fd2" rel="noopener follow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd iu gy z fp mg fr fs mh fu fw is bi translated">使用Python访问Google电子表格数据</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">当构建一个简单的内部应用时，你可能会想‘我现在就需要一个数据库！’…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">towardsdatascience.com</p></div></div><div class="mk l"><div class="nm l mm mn mo mk mp jv mb"/></div></div></a></div><p id="a0a0" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">进入专家视图— </strong> <a class="ae kb" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="ke iu">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>