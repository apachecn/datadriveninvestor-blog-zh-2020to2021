<html>
<head>
<title>Classify Images of Clothing Using Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用张量流对服装图像进行分类</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/classify-images-of-clothing-using-tensorflow-7bc71b357739?source=collection_archive---------2-----------------------#2020-09-25">https://medium.datadriveninvestor.com/classify-images-of-clothing-using-tensorflow-7bc71b357739?source=collection_archive---------2-----------------------#2020-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="17c7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">训练基本神经网络模型以对服装图像进行分类</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dd15a0a30b149fce6a1dadc9b6cf492e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gqYftMfJ-uB8M4lV.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fashion MNIST (Image source and credits: Zalando Research)</figcaption></figure><h1 id="47dd" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">机器学习中的分类</h1><p id="7be2" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">分类是将一组给定的数据分类的过程。该过程从预测给定数据点的类别开始，其中这些类别可以被称为目标、标签或类别。</p><p id="d4ab" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">可以对结构化或非结构化数据执行分类。分类的主要目标是识别新数据将属于哪个类/类别，并且当输出具有有限和离散值时最好使用哪个类/类别<em class="mr">。</em></p><p id="a687" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">不同类型的分类算法是—</p><p id="f56e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">线性模型</p><ul class=""><li id="62b0" class="ms mt it ls b lt mm lw mn lz mu md mv mh mw ml mx my mz na bi translated">逻辑回归</li><li id="07a6" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">支持向量机(SVM)</li></ul><p id="107c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">非线性模型</p><ul class=""><li id="d440" class="ms mt it ls b lt mm lw mn lz mu md mv mh mw ml mx my mz na bi translated">k-最近邻(KNN)</li><li id="53ee" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">核支持向量机(SVM)</li><li id="fc65" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">朴素贝叶斯</li><li id="d0d5" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">决策树分类</li><li id="68af" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">随机森林分类</li></ul></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="b5ca" class="ky kz it bd la lb nn ld le lf no lh li jz np ka lk kc nq kd lm kf nr kg lo lp bi translated">其他一些最好的系列—</h1><blockquote class="ns nt nu"><p id="a38a" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/day-1-of-30-days-of-machine-learning-ops-7c299e4b09be?sk=4ab48350a5c359fc157109e48b1d738f" rel="noopener"> <strong class="ls iu"> 30天的机器学习Ops </strong> </a></p><p id="1ff6" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/quick-recap-30-days-of-natural-language-processing-nlp-with-projects-series-ceb674e3c09b?sk=ca09b27b3d5867f23ab4dc367b6c0c32" rel="noopener"> <strong class="ls iu"> 30天自然语言处理系列</strong> </a></p><p id="b8a0" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/day-1-of-30-days-of-data-engineering-894822fcb128?sk=76ba558bfe2d9f85cbe741e505295531" rel="noopener"> <strong class="ls iu"> 30天数据工程与项目系列</strong> </a></p><p id="9d85" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/day-1-data-science-and-ml-research-papers-simplified-a68b00a3b1c4?sk=56136229ff738bd734f19d2b6953f78c" rel="noopener"> <strong class="ls iu">数据科学与机器学习研究(论文)简体</strong> </a> <strong class="ls iu"> ** </strong></p><p id="6907" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/day-1-day-60-quick-recap-of-60-days-of-data-science-and-ml-6fc021643d1?sk=4e75e043b7630a9f963562ebac94e129" rel="noopener"> <strong class="ls iu"> 60天数据科学与ML系列带项目</strong> </a></p><p id="fb06" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/100-days-your-data-science-and-ml-degree-part-3-c621ecfdf711?sk=1a8c7b0c204d73432d56b7d1a3a26474" rel="noopener"> <strong class="ls iu"> 100天:你的数据科学与机器学习学位系列与项目</strong> </a></p><p id="5203" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://ai.plainenglish.io/23-data-science-techniques-you-should-know-61bc2c9d1b3a?sk=1680c36193eb22198974c9008d62a33c" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">你应该知道的23个数据科学技巧</strong> </a></p><p id="ac12" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/mega-post-tech-interview-the-only-list-of-questions-you-need-to-practice-ee349ea197bb?sk=fac3614684daff4b50a70c0a71e4d528" rel="noopener"> <strong class="ls iu">科技面试系列—编码问题精选清单</strong> </a></p><p id="dede" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/system-design-made-easy-quick-recap-of-complete-system-design-34af7e3aedfb?sk=bdd6a19edc1f3ce4a5064923f5b68721" rel="noopener"> <strong class="ls iu">完成系统设计与最热门问题系列</strong> </a></p><p id="6508" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/complete-data-preprocessing-and-data-visualization-with-projects-mega-compilation-part-2-41584ef0920e?sk=842390da51689b8d43148c3980570db0" rel="noopener"> <strong class="ls iu">完成数据可视化及预处理系列与项目</strong> </a></p><p id="409a" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/complete-python-and-projects-mega-compilation-7ec8f7adfe71?sk=ee0ecf43f23c6dd44dd35d984b3e5df4" rel="noopener"> <strong class="ls iu">完整的Python系列与项目</strong> </a></p><p id="67e0" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/complete-advanced-python-with-projects-mega-compilation-part-6-729c1826032b?sk=7faffe20f8039fa57099f7a372b6d665" rel="noopener"> <strong class="ls iu">完成高级Python系列与项目</strong> </a></p><p id="4ded" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/my-list-of-kaggle-best-notebooks-topic-wise-data-science-and-machine-learning-part-2-84772863e9ae?sk=5ed02e419854a6c11add3ddc1e52947f" rel="noopener"> <strong class="ls iu"> Kaggle最会教你的笔记本</strong> </a></p><p id="4b2e" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" rel="noopener ugc nofollow" target="_blank" href="/the-complete-developers-guide-to-git-6a23125996e1?sk=e30479bbe713930ea93018e1a46d9185"><strong class="ls iu">Git开发者指南</strong> </a></p><p id="732e" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/6-exceptional-github-repos-for-all-developers-part-1-21e8fa04e150?sk=9140b249af6fe73d45717185fad48962" rel="noopener"> <strong class="ls iu">打赏Github Repos </strong> </a> <strong class="ls iu"> —第一部分</strong></p><p id="7079" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" href="https://medium.com/coders-mojo/6-exceptional-github-repos-for-all-developers-part-2-3eec9a68c31c?sk=8e31d0eb7eb1d2d0bbbcecaa66bd4e7e" rel="noopener"> <strong class="ls iu">打赏Github Repos </strong> </a> <strong class="ls iu"> —第二部</strong></p><p id="d9c6" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" rel="noopener ugc nofollow" target="_blank" href="/best-resources-for-data-science-and-machine-learning-full-list-5ceb9a2791bf?sk=cf85b2cef95560c58509877a794577ff"> <strong class="ls iu">所有数据科学和机器学习资源</strong> </a></p><p id="b2cb" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated"><a class="ae ny" rel="noopener ugc nofollow" target="_blank" href="/210-machine-learning-projects-with-source-code-that-you-can-build-today-721b035649e0?sk=da5f593572a0261a6314afad99a0356c"> <strong class="ls iu"> 210机器学习项目</strong> </a></p></blockquote><h2 id="9083" class="nz kz it bd la oa ob dn le oc od dp li lz oe of lk md og oh lm mh oi oj lo ok bi translated">科技时事通讯—</h2><blockquote class="ns nt nu"><p id="f86c" class="lq lr mr ls b lt mm ju lv lw mn jx ly nv mo mb mc nw mp mf mg nx mq mj mk ml im bi translated">如果你感兴趣，你可以加入我的时事通讯，通过它我向超过30，000名读者发送技术面试技巧，技术，模式，黑客——软件开发，ML，数据科学，创业公司和技术项目。可以订阅<strong class="ls iu"> Tech Brew : </strong></p></blockquote><div class="ol om gp gr on oo"><a href="https://naina0405.substack.com/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">点火器</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">数据科学，人工智能，人工智能和更多…点击阅读由Naina Chaturvedi撰写的Ignito，子堆栈出版物。推出7个月…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">naina0405.substack.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ks oo"/></div></div></a></div><h2 id="7a12" class="nz kz it bd la oa ob dn le oc od dp li lz oe of lk md og oh lm mh oi oj lo ok bi translated">Github —</h2><div class="ol om gp gr on oo"><a href="https://github.com/Coder-World04" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">编码器-world 04-概述</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">github.com</p></div></div><div class="ox l"><div class="pd l oz pa pb ox pc ks oo"/></div></div></a></div></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="00b1" class="ky kz it bd la lb nn ld le lf no lh li jz np ka lk kc nq kd lm kf nr kg lo lp bi translated">什么是神经网络？</h1><p id="3d07" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">简单来说，神经网络是设计用于识别模式的多层神经元网络。<strong class="ls iu"> </strong>它们识别的模式是数字，包含在向量中，所有现实世界的数据，无论是图像、声音、文本等等，都进入其中。，必须改造。</p><p id="2658" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">一个简单的神经网络包括—</p><ol class=""><li id="6a8f" class="ms mt it ls b lt mm lw mn lz mu md mv mh mw ml pe my mz na bi translated">输入层—这一层将大量数据作为输入来构建神经网络</li><li id="deb4" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml pe my mz na bi translated">隐藏层-该层通过执行复杂计算来处理数据，并执行特征提取</li><li id="674e" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml pe my mz na bi translated">输出层—使用合适的激活函数生成预测输出</li><li id="ff33" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml pe my mz na bi translated">箭头-连接图层并显示数据如何从输入图层通过隐藏图层到达输出图层。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/dbfeaa2622be193a1972986e12a45c3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C5dnrEh9226lGfQT.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">A simple neural network(Image source and credits: Pinterest)</figcaption></figure><h1 id="d6a5" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">什么是张量流？</h1><p id="8468" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">TensorFlow最初是为大型数值计算开发的，是由谷歌大脑团队开发的开源库，用C++、Python和CUDA编写，用于深度学习和机器学习应用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/72e70c305d3e54e4e5ef17bc3041b5bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UzQCB0x_8gkaQ5N0"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Example of Image recognition using TensorFlow (Image source and credits: Source Dexter)</figcaption></figure><p id="da7d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">TensorFlow基于有节点和边的数据流图工作。它接受张量形式的数据，张量不过是更高维度的多维数组，可以处理大量数据。</p><div class="ol om gp gr on oo"><a href="https://www.datadriveninvestor.com/2020/08/27/what-is-a-data-catalog-and-how-does-it-enable-machine-learning-success/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">什么是数据目录，它如何使机器学习取得成功？数据驱动的投资者</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">数据目录是机器学习和数据分析的燃料。没有它，你将不得不花费很多…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ox l"><div class="ph l oz pa pb ox pc ks oo"/></div></div></a></div><h1 id="cd2d" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">项目-对服装图像进行分类</h1><h1 id="9ca6" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">1.导入重要的库</h1><p id="3de7" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将使用<strong class="ls iu"> tf.keras，</strong>这是TensorFlow用于构建和训练深度学习模型的高级API。它用于快速原型制作，创建新的层、指标、损失函数，并开发最先进的模型。</p><p id="485b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">Numpy是Python中科学计算的核心库，Matplotlib是用于创建静态、动画和交互式可视化的库。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="121d" class="nz kz it pj b gy pn po l pp pq"><strong class="pj iu"># import TensorFlow, tf.keras, numpy and matplotlib</strong><br/>import tensorflow as tf<br/>from tensorflow import keras<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span></pre><h1 id="7992" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">2.导入数据集</h1><p id="78d1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将在这个项目中使用<a class="ae ny" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">时尚MNIST数据集</a>。该图像包含10个类别的70，000幅灰度图像，其中60，000幅图像用于训练网络，10，000幅图像用于评估网络学习图像分类的准确性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/d3a13d1bbfcb103a2ec6a3308d9364c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*__AF479h8XkTWUNR.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Individual articles of clothing at low resolution (28 by 28 pixels)</figcaption></figure><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="91c4" class="nz kz it pj b gy pn po l pp pq">fashion_mnist = keras.datasets.fashion_mnist<br/>#returns four numpy 28x28 arrays with pixel values ranging from 0 to #255<br/>(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()</span></pre><p id="2bd0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">每个图像映射到一个标签。标签不过是整数数组，范围从0到9，对应于图像所代表的服装类别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/742ec624d31c3b466bd7762fece6c7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/0*02qPP22s0_dFOWCN.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Clothing Labels and Classes</figcaption></figure><p id="a391" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">训练集代表模型用来学习的数据— <code class="fe pt pu pv pj b">train_images</code>和<code class="fe pt pu pv pj b">train_labels</code>数组。</p><p id="4edc" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">测试集代表模型用来测试— <code class="fe pt pu pv pj b">test_images</code>和<code class="fe pt pu pv pj b">test_labels</code>阵列的数据。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="28a8" class="nz kz it pj b gy pn po l pp pq">class_names = ['T-shirt/top', 'Trouser', 'Pullover', 'Dress',     <br/>              'Coat','Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle    <br/>               boot']</span></pre><h1 id="fd31" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">3.数据探索</h1><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="aed9" class="nz kz it pj b gy pn po l pp pq">train_images.shape</span></pre><p id="57ee" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi">(60000, 28, 28)</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="f44d" class="nz kz it pj b gy pn po l pp pq">len(train_labels)</span></pre><p id="9d79" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi">60000</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="234d" class="nz kz it pj b gy pn po l pp pq">test_images.shape</span></pre><p id="ae78" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi">(10000, 28, 28)</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="321a" class="nz kz it pj b gy pn po l pp pq">len(test_labels)</span></pre><p id="1257" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi">10000</p><h1 id="80d9" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">4.数据预处理</h1><p id="5b50" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">对于训练集和测试集，您可以看到图像的像素值在0到255的范围内，需要在0到1的范围内进行缩放，然后再输入到神经网络中。为此，将这些值除以255。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="2aaa" class="nz kz it pj b gy pn po l pp pq">train_images = train_images / 255.0</span><span id="c96c" class="nz kz it pj b gy pw po l pp pq">test_images = test_images / 255.0</span></pre><p id="404a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">若要验证数据的格式是否正确，请显示训练集中的前25幅图像，并在每幅图像下显示类名。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="6b83" class="nz kz it pj b gy pn po l pp pq">plt.figure(figsize=(10,10))<br/><strong class="pj iu">for</strong> i <strong class="pj iu">in</strong> range(25):<br/>    plt.subplot(5,5,i+1)<br/>    plt.xticks([])<br/>    plt.yticks([])<br/>    plt.grid(<strong class="pj iu">False</strong>)<br/>    plt.imshow(train_images[i], cmap=plt.cm.binary)<br/>    plt.xlabel(class_names[train_labels[i]])<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi px"><img src="../Images/268356c16a2fc63ff1289642aba84a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/0*yF3o0kQ6Wt9JW5KT.png"/></div></figure><h1 id="2f06" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">5.建立模型</h1><p id="c944" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">要构建模型，首先链接不同的层，配置它们，然后编译模型。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="d9c4" class="nz kz it pj b gy pn po l pp pq">model = keras.Sequential([<br/>    keras.layers.Flatten(input_shape=(28, 28)),<br/>    keras.layers.Dense(128, activation='relu'),<br/>    keras.layers.Dense(10)<br/>])</span></pre><p id="8b04" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这些层—</p><p id="6d0e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><code class="fe pt pu pv pj b">tf.keras.layers.Flatten</code> —将图像格式从二维数组(28 x 28像素)转换为一维数组(28 x 28 = 784像素)。一旦像素被展平，网络就由两个密集层的序列组成。</p><p id="cedc" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><code class="fe pt pu pv pj b">tf.keras.layers.Dense</code> —这两层是密集/全连接的神经层，第一密集层有128个节点，第二层返回长度为10的logits数组。</p><p id="bb0c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在此之后编译模型，其中—</p><ul class=""><li id="b7fc" class="ms mt it ls b lt mm lw mn lz mu md mv mh mw ml mx my mz na bi translated">优化器-这是模型基于其看到的数据及其损失函数进行更新的方式。Adam是一种优化算法，可以用来代替经典的随机梯度下降过程，以基于训练数据迭代地更新网络权重。用起来很简单。</li><li id="37e6" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">损失函数——损失函数是神经网络的重要组成部分之一，它只不过是神经网络的一个预测误差。这衡量了模型在训练过程中的精确度。</li><li id="a223" class="ms mt it ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated">指标——为了监控培训和测试步骤，我们使用指标。在这个例子中，我们将使用<strong class="ls iu"> <em class="mr">准确度</em> </strong>度量，其仅指示正确分类的图像的部分<em class="mr"> </em>。</li></ul><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="af27" class="nz kz it pj b gy pn po l pp pq">model.compile(optimizer='adam',<br/>loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<strong class="pj iu">True</strong>),metrics=['accuracy'])</span></pre><h1 id="3fba" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">6.模特培训</h1><p id="0792" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这分为4个步骤— <em class="mr">输入训练数据、学习、预测、验证预测</em></p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="4048" class="nz kz it pj b gy pn po l pp pq">#fit the model to the training data <br/>model.fit(train_images, train_labels, epochs=10)Epoch 1/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 1.0486 - accuracy: 0.6656<br/>Epoch 2/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.6211 - accuracy: 0.7744<br/>Epoch 3/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.5498 - accuracy: 0.8026<br/>Epoch 4/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.5096 - accuracy: 0.8185<br/>Epoch 5/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.4832 - accuracy: 0.8284<br/>Epoch 6/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.4636 - accuracy: 0.8363<br/>Epoch 7/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.4485 - accuracy: 0.8418<br/>Epoch 8/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.4365 - accuracy: 0.8456<br/>Epoch 9/10<br/>1875/1875 [==============================] - 3s 2ms/step - loss: 0.4265 - accuracy: 0.8496<br/>Epoch 10/10<br/>1875/1875 [==============================] - 4s 2ms/step - loss: 0.4175 - accuracy: 0.8539&lt;tensorflow.python.keras.callbacks.History at 0x7faeadc6d048&gt;</span></pre><p id="f8c0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">您可以看到，损失和准确性是在每个历元中计算的。该模型在训练数据上达到了大约85%的准确率。</p><h1 id="199c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">7.评估测试数据的准确性</h1><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="e5ad" class="nz kz it pj b gy pn po l pp pq">test_loss, test_acc = model.evaluate(test_images,  test_labels, verbose=2)</span><span id="c41d" class="nz kz it pj b gy pw po l pp pq">print('<strong class="pj iu">\n</strong>Test accuracy:', test_acc)</span></pre><p id="42b4" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">测试精度:0.80486868881</p><p id="ede6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这是一个<strong class="ls iu"> <em class="mr">过拟合</em> </strong>的情况，其中测试数据集的精度小于训练数据集的精度。当您的模型“记忆”训练数据集中的噪音和细节达到一定程度时，就会发生过度拟合，这会对模型在新数据上的性能产生负面影响。</p><h1 id="f1cf" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">8.预测时间</h1><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="1152" class="nz kz it pj b gy pn po l pp pq">probability_model = tf.keras.Sequential([model, <br/>                                         tf.keras.layers.Softmax()])<br/>predictions = probability_model.predict(test_images)<br/>predictions[0]<br/>#Output is an array of 10 numbers which represent model's confidencearray<br/>([2.0062183e-07, 3.7709762e-11, 7.3624884e-10, 2.9959158e-12, 1.1696175e-09, 3.5686058e-04, 2.6559412e-08, 1.0531254e-03, 7.2562241e-11, 9.9858981e-01], dtype=float32)</span></pre><p id="2a38" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">可以看到哪个标签的置信度值最高。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="9d2e" class="nz kz it pj b gy pn po l pp pq">np.argmax(predictions[1])<br/>Output : 0</span></pre><p id="3b83" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">所以，模特最有信心的是这张图片是t恤/上衣，或者<code class="fe pt pu pv pj b">class_names[0]</code>。</p><p id="d3ea" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们用它们的预测来绘制几幅图像。</p><pre class="kj kk kl km gt pi pj pk pl aw pm bi"><span id="ad59" class="nz kz it pj b gy pn po l pp pq"><em class="mr"># Plot the first X test images, their predicted labels, and the true #labels.</em><br/><em class="mr"># Color correct predictions in blue and incorrect predictions in #red.</em><br/>num_rows = 5<br/>num_cols = 3<br/>num_images = num_rows*num_cols<br/>plt.figure(figsize=(2*2*num_cols, 2*num_rows))<br/><strong class="pj iu">for</strong> i <strong class="pj iu">in</strong> range(num_images):<br/>  plt.subplot(num_rows, 2*num_cols, 2*i+1)<br/>  plot_image(i, predictions[i], test_labels, test_images)<br/>  plt.subplot(num_rows, 2*num_cols, 2*i+2)<br/>  plot_value_array(i, predictions[i], test_labels)<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/7de81df1a27296d9be6b612a9c91d8c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1fg2jfAICgfVkea_.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Cloth images with their predictions</figcaption></figure><p id="17fa" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><em class="mr">注:这是一个非常基础的使用TensorFlow(代码参考:TensorFlow.org)的项目。我写这篇文章是为了介绍神经网络，张量流，并通过一个项目展示它的内部工作。非常感谢Google提供了TensorFlow库。</em></p><h1 id="a5c0" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">感谢阅读。继续学习:)</h1><h1 id="c26f" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">想看程序员幽默？</h1><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/programming-humor-part-2-f92cf5a26f2b" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">编程幽默第2部分</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">继续笑，因为太搞笑了…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="pz l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/the-most-hilarious-code-comments-ever-bae3cb1030b5" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">史上最搞笑的代码注释</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">程序员幽默:是的，实际上是程序员写的！</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qa l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/coding-sins-hilarious-developer-confessions-f55eb342454e" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">编码原罪:令人捧腹的开发者自白</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">“白板”是如何被嘲笑的</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qb l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/10-witty-programming-jokes-that-will-make-you-go-rofl-a53fbfb91943" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">10个让你着迷的诙谐编程笑话</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">这些太搞笑了…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qc l oz pa pb ox pc ks oo"/></div></div></a></div><h1 id="d281" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">推荐文章-</h1><div class="ol om gp gr on oo"><a href="https://medium.com/python-in-plain-english/python-iterators-generators-and-decorators-made-easy-659cae26054f" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">Python迭代器、生成器和装饰器变得简单</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">快速实施指南</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qd l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/ai-in-plain-english/23-data-science-techniques-you-should-know-61bc2c9d1b3a" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">你应该知道的23种数据科学技术！</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">使用这些技巧来节省你的宝贵时间</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qe l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/coding-sins-hilarious-developer-confessions-f55eb342454e" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">编码原罪:令人捧腹的开发者自白</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">“白板”是如何被嘲笑的</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qb l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/5-cool-advanced-pandas-techniques-for-data-scientists-c5a59ae0625d" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">面向数据科学家的5项酷炫先进熊猫技术</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">使用这些技巧…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qf l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/stack-overflow-analyzed-data-from-60-000-software-developers-hours-they-work-languages-they-476ac6ca0197" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">Stack Overflow分析了来自60，000多名软件开发人员的数据，包括他们的工作时间、语言…</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">以下是他们的发现…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qg l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/advanced-python-made-easy-part-4-a4996ba9fe19" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">高级Python变得简单—第4部分</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">使用这些技巧和技术…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qf l oz pa pb ox pc ks oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/datadriveninvestor/advanced-python-made-easy-part-1-ce1e2f17431e" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">高级Python变得简单—第1部分</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">使用这些技巧和技术…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="qf l oz pa pb ox pc ks oo"/></div></div></a></div></div></div>    
</body>
</html>