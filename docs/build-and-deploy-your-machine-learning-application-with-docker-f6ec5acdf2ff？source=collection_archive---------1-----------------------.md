# ä½¿ç”¨ Docker æ„å»ºå’Œéƒ¨ç½²æ‚¨çš„æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åº

> åŸæ–‡ï¼š<https://medium.datadriveninvestor.com/build-and-deploy-your-machine-learning-application-with-docker-f6ec5acdf2ff?source=collection_archive---------1----------------------->

æœ‰æ²¡æœ‰éƒ¨ç½²è¿‡ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå®ƒåœ¨ä½ çš„æœ¬åœ°è®¡ç®—æœºä¸Šè¿è¡Œå¾—éå¸¸å¥½ï¼Œä½†æ˜¯å½“å®ƒè¢«éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­æ—¶ï¼Œä»£ç åœ¨å¦ä¸€å°æœºå™¨ä¸Šå°±å´©æºƒäº†æˆ–è€…æ›´ç³Ÿï¼Ÿåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¸¦ä½ äº†è§£å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªåä¸ºâ€œDockerâ€çš„æµè¡Œå·¥å…·æ¥è¿è¡Œå’Œéƒ¨ç½²ä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚

![](img/1722baf98529a67a1a6a3b770980d010.png)

# é‚£ä¹ˆ Docker æ˜¯ä»€ä¹ˆï¼Ÿ

Docker æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œé€šè¿‡ä½¿ç”¨æ‰€è°“çš„**å®¹å™¨ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°åˆ›å»ºã€éƒ¨ç½²å’Œè¿è¡Œä»»ä½•åº”ç”¨ç¨‹åºã€‚**å®ƒä¹Ÿæ˜¯ä¸€ä¸ªè½¯ä»¶å¹³å°ï¼Œç”¨äºåˆ›å»º **Docker æ˜ åƒ**ï¼Œè¿™äº›æ˜ åƒåœ¨éƒ¨ç½²åå°†è¢«ç§°ä¸º Docker å®¹å™¨ã€‚

Docker å®¹å™¨æ˜¯ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼ŒåŒ…å«äº†åº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰ä¾èµ–å…³ç³»ï¼Œå®ƒé€šå¸¸è¢«ç§°ä¸º Docker æ˜ åƒçš„è¿è¡Œå®ä¾‹ã€‚

*Docker é•œåƒ* æ˜¯ä¸€ä¸ªæ–‡ä»¶(åªè¯»)ï¼Œç”±å¤šä¸ªå±‚ç»„æˆï¼Œç”¨äºæ‰§è¡Œ Docker å®¹å™¨ä¸­çš„ä»£ç ã€‚Docker æ˜ åƒä½äºä¸€ä¸ªè¢«ç§°ä¸º **Docker hub çš„å¤§å‹ Hub ä¸­ã€‚**å› æ­¤ï¼Œæ‚¨å¯ä»¥ä»ä¸­å¿ƒæå–å›¾åƒï¼Œæˆ–è€…ä»åŸºç¡€å›¾åƒæ„å»ºè‡ªå®šä¹‰å›¾åƒï¼Œå½“è¿™äº›å›¾åƒè¢«æ‰§è¡Œæ—¶ï¼Œå®ƒä»¬å°†å……å½“æ‚¨çš„åº”ç”¨ç¨‹åºçš„å®¹å™¨ã€‚

[](https://www.datadriveninvestor.com/2020/03/24/encoder-decoder-sequences-how-long-is-too-long/) [## ç¼–ç å™¨è§£ç å™¨åºåˆ—:å¤šé•¿æ˜¯å¤ªé•¿ï¼Ÿæ•°æ®é©±åŠ¨çš„æŠ•èµ„è€…

### åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¤„ç†çš„è¾“å…¥æ˜¯åºåˆ—ï¼Œè¾“å‡ºä¹Ÿæ˜¯åºåˆ—ã€‚æˆ‘ä»¬ç§°è¿™æ ·çš„ä¸€ä¸ªâ€¦

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2020/03/24/encoder-decoder-sequences-how-long-is-too-long/) 

å› æ­¤ï¼Œå°†è¿™äº›éƒ¨åˆ†ç»“åˆåœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°† Docker å®šä¹‰ä¸º:

> ä¸€ä¸ªè½¯ä»¶å¹³å°ï¼Œé€šè¿‡åˆ›å»º Docker æ˜ åƒä½¿åˆ›å»ºå’Œéƒ¨ç½²ä»»ä½•åº”ç”¨ç¨‹åºå˜å¾—æ›´å®¹æ˜“ï¼ŒDocker æ˜ åƒå°†æˆä¸ºä¸€ä¸ª Docker å®¹å™¨ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåœ¨éƒ¨ç½²åå·¥ä½œæ‰€éœ€çš„æ‰€æœ‰ä¾èµ–é¡¹å’Œè½¯ä»¶åŒ…ã€‚

# ç å¤´å·¥äººçš„å¥½å¤„

*   Docker è§£å†³äº†åœ¨ä¸åŒçš„å¼€å‘é˜¶æ®µæ‹¥æœ‰ç›¸åŒçš„ç¯å¢ƒä»¥åŠåœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­æ‹¥æœ‰ç‹¬ç«‹ç¯å¢ƒçš„é—®é¢˜ã€‚
*   Docker å…è®¸æ‚¨ä»ä»»ä½•åœ°æ–¹è¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œåªè¦æ‚¨åœ¨é‚£å°æœºå™¨ä¸Šå®‰è£…äº† dockerã€‚
*   Docker ä¸ºæ‚¨æä¾›äº†å¿«é€Ÿæ‰©å±•çš„è‡ªç”±ã€‚
*   è½»æ¾æ‰©å±•æ‚¨çš„å¼€å‘å›¢é˜Ÿã€‚

# å®‰è£… Docker

Docker å¯ä»¥è·¨å¤šç§å¹³å°ä½¿ç”¨ï¼Œæ— è®ºä½ ä½¿ç”¨çš„æ˜¯ Linuxã€Windows è¿˜æ˜¯ Mac ç”µè„‘ï¼Œä½ éƒ½å¯ä»¥ç‚¹å‡»è¿™é‡Œçš„å®‰è£…æŒ‡å—[](https://docs.docker.com/)

*****

*ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº† Docker çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶ä¸”æ‚¨å·²ç»è®© Docker åœ¨æ‚¨çš„æœºå™¨ä¸Šè¿è¡Œäº†ï¼Œè®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å®ƒéƒ¨ç½²ä¸€ä¸ªæœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åºã€‚*

***å·¥ä½œç›®å½•***

*å¯¹äºæˆ‘æƒ³è¦éƒ¨ç½²çš„æ¨¡å‹ï¼Œæˆ‘çš„å·¥ä½œç›®å½•çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:*

```
*.
â”œâ”€â”€ app.py
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ ML_Model
â”‚   â”œâ”€â”€ Diabetestype.csv
â”‚   â”œâ”€â”€ model.pkl
â”‚   â””â”€â”€ model.py
â””â”€â”€ requirements.txt1 directory, 6 files*
```

***app.py***

*app.py æ˜¯ä¸€ä¸ª python è„šæœ¬ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä½¿ç”¨ flask ä¸ºæˆ‘çš„æœºå™¨å­¦ä¹ æ¨¡å‹æ„å»ºçš„ APIã€‚æˆ‘å®šä¹‰äº† API ç«¯ç‚¹å’Œè·¯å¾„ï¼Œæˆ‘ä»¬å¦‚ä½•ä» web æ¥æ”¶æ•°æ®ï¼Œå¦‚ä½•å¤„ç†æ•°æ®ï¼Œä»¥åŠå¦‚ä½•å°†é¢„æµ‹ä½œä¸ºå“åº”è¿”å›ã€‚*

***ML _ æ¨¡å‹***

***ML_Model** ç›®å½•åŒ…å« ML æ¨¡å‹ï¼Œæˆ‘ç”¨æ¥è®­ç»ƒæ¨¡å‹çš„æ•°æ®ï¼Œä»¥åŠæ¨¡å‹è¢«è®­ç»ƒåç”Ÿæˆçš„ pickle æ–‡ä»¶ï¼ŒAPI å°†ä½¿ç”¨è¿™äº›æ–‡ä»¶ã€‚*

***requirements.txt***

*requirements.txt æ–‡ä»¶æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰ python åŒ…ã€‚æˆ‘ä½¿ç”¨çš„ä¸€äº›åŒ…æ˜¯:*

*![](img/6dda1e954a3dab95c240d807f4cc829b.png)*

*requirements.txt*

***Dockerfile***

*Docker æ–‡ä»¶æ˜¯å®šä¹‰ Docker å›¾åƒçš„æ–‡æœ¬æ–‡ä»¶ã€‚å½“æ‚¨æƒ³è¦ç”¨äºé¡¹ç›®çš„åŸºç¡€å›¾åƒä¸èƒ½æ»¡è¶³æ‚¨çš„éœ€æ±‚æ—¶ï¼Œæ‚¨å°†ä½¿ç”¨ Docker æ–‡ä»¶æ¥åˆ›å»ºæ‚¨è‡ªå·±çš„è‡ªå®šä¹‰ Docker å›¾åƒã€‚å¯¹äºæˆ‘å°†è¦éƒ¨ç½²çš„æ¨¡å‹ï¼Œæˆ‘çš„ Dockefile çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:*

*åœ¨æˆ‘çš„ Docker æ–‡ä»¶ä¸­ï¼Œæˆ‘æå–äº† Docker åŸºç¡€æ˜ åƒ python:3.7ï¼Œæ›´æ–°äº†ç³»ç»Ÿä¾èµ–é¡¹ï¼Œåœ¨ requirements.txt æ–‡ä»¶ä¸­å®‰è£…äº†åŒ…ï¼Œè¿è¡Œ ML ä»£ç æ¥è®­ç»ƒæ¨¡å‹å¹¶ç”Ÿæˆ API å°†ä½¿ç”¨çš„ pickle æ–‡ä»¶ï¼Œæœ€ååœ¨æœ¬åœ°è¿è¡ŒæœåŠ¡å™¨ã€‚*

*ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»æˆ‘ä»¬åˆ›å»ºçš„ Docker æ–‡ä»¶æ„å»º Docker æ˜ åƒ:*

```
*israel@israel:~/Documents/Projects/Docker_ML$ docker build -t aminu_israel/ml_model:1.0 .*
```

*æˆ‘å°†æˆ‘çš„è‡ªå®šä¹‰å›¾åƒå‘½åä¸ºâ€œaminu_israel/ml_model â€,å¹¶å°†æ ‡ç­¾è®¾ç½®ä¸º 1.0ã€‚è¯·æ³¨æ„â€œ.â€åœ¨å‘½ä»¤çš„æœ«å°¾ï¼Œæ„å‘³ç€æˆ‘å‘Šè¯‰ Docker åœ¨æˆ‘çš„å½“å‰ç›®å½•ä¸­å®šä½ Dockerfileï¼Œè¿™ä¸ªç›®å½•æ˜¯æˆ‘çš„é¡¹ç›®æ–‡ä»¶å¤¹ã€‚å¦‚æœå®ƒæˆåŠŸäº†ï¼Œæ‚¨åº”è¯¥ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœ:*

```
*Sending build context to Docker daemon  249.3kB
Step 1/16 : FROM python:3.7
 ---> cda8c7e31f89
Step 2/16 : MAINTAINER aminu israel <[aminuisrael2@gmail.com](mailto:aminuisrael2@gmail.com)>
 ---> Running in cea1c80b990f
Removing intermediate container cea1c80b990f
 ---> 2c82fc9c1b5a
Step 3/16 : ENV PYTHONDONTWRITEBYTECODE 1
 ---> Running in 6ee3497a7ff4
Removing intermediate container 6ee3497a7ff4
 ---> 56f5f9838610
Step 4/16 : ENV PYTHONUNBUFFERED 1
 ---> Running in 1f53b581eed7...Step 16/16 : CMD [ "app.py","run","--host","0.0.0.0"]
 ---> Running in 1f7fc05b4e12
Removing intermediate container 1f7fc05b4e12
 ---> 8636b5bc482e
Successfully built 8636b5bc482e
Successfully tagged aminu_israel/ml_model:1.0*
```

*æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æ‚¨åˆ›å»ºçš„æ–°å›¾åƒ:*

```
*israel@israel:~$ docker images*
```

*ç°åœ¨æˆ‘ä»¬å·²ç»æˆåŠŸæ„å»ºäº†æ˜ åƒï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œ docker æ˜ åƒ:*

```
*israel@israel:~$ docker run --name deployML -p 8080:8080 aminu_israel/ml_model:1.0*
```

*å¦‚æœæˆåŠŸï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹ç»“æœ:*

```
** Serving Flask app "app" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: off
 * Running on [http://0.0.0.0:8080/](http://0.0.0.0:8080/) (Press CTRL+C to quit)*
```

*è¦æ£€æŸ¥ docker å®¹å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:*

```
*israel@israel:~$ docker ps*
```

*ä½ ä¼šçœ‹åˆ°è¿™æ ·çš„ç»“æœ:*

*![](img/02f427607faaae0b5284bbe93a3d02a8.png)*

*è¿™è¡¨æ˜æ–°å®¹å™¨å½“å‰æ­£åœ¨è¿è¡Œã€‚è¦è·å¾—å®Œæ•´çš„ docker æ–‡æ¡£ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¿™é‡Œçš„ã€‚*

***ç°åœ¨ï¼Œæ‚¨å·²ç»ä½¿ç”¨ docker æˆåŠŸåœ°éƒ¨ç½²äº†æ‚¨çš„ ML æ¨¡å‹ã€‚***

*ä½ å¯ä»¥åœ¨è¿™é‡Œè·å¾—è¿™ç¯‡æ–‡ç« çš„ä»£ç *

*æ„Ÿè°¢é˜…è¯»ğŸ˜€*

*æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘:*

*ç”µå­é‚®ä»¶:aminuisrael2@gmail.com*

*æ¨ç‰¹:@aminu_israelb*