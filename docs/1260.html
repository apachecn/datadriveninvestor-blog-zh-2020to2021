<html>
<head>
<title>DevOps disasters: Overusing tools and messing up.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DevOps灾难:过度使用工具和搞砸。</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/devops-disasters-overusing-tools-and-messing-up-7d8a37feeee?source=collection_archive---------13-----------------------#2020-03-10">https://medium.datadriveninvestor.com/devops-disasters-overusing-tools-and-messing-up-7d8a37feeee?source=collection_archive---------13-----------------------#2020-03-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ea17d76c840cedcb1038cda18073d288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*PnqoCCXd_d37xiuqz4f9yQ.jpeg"/></div></figure><h1 id="dcd1" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">这种现象</h1><p id="b824" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">一个非常有趣的现象现在出现在我们的日常生活中。它与我们在环境中使用特定工具的方式有关。在许多情况下，当有任务要完成时，工程师根据他们的直觉行动。我们的理解和智慧往往仅限于一些工具。到我们最有经验的工具。我们试图将我们的知识联系起来，解决我们的工具不太适合甚至根本不适合的问题。当我们抓住当天的炒作时，情况完全不同。在这种炒作下，我们试图让新工具不符合它们的主要目的，也不符合它们不属于的环境。</p><p id="6adc" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">问题的根源可能是不愿意看到工具真正的设计意图。知识库和专家之间缺乏沟通也是一个原因。</p><div class="lv lw gp gr lx ly"><a href="https://www.datadriveninvestor.com/2019/03/26/agile-management-the-good-the-bad-and-the-downright-ugly/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">敏捷管理:好的、坏的、丑陋的|数据驱动的投资者</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">公司不断重塑自己，以获得或保持竞争优势和市场份额。这是…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm js ly"/></div></div></a></div><p id="9f33" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">DevOps协作在这一点上失败了，我们处于这样一种情况:开发人员对操作了解较少，而运营人员对开发了解较少。他们每个人都试图过度使用熟知的工具。</p><p id="5f9f" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">结果是:</p><ul class=""><li id="9c8c" class="mn mo iq ku b kv lq kz lr ld mp lh mq ll mr lp ms mt mu mv bi translated">难以维护和调试的实用BASH程序。为什么我们这里不能用Python，Ruby或者GO？。</li><li id="d821" class="mn mo iq ku b kv mw kz mx ld my lh mz ll na lp ms mt mu mv bi translated">CI建立在带有本地执行自制模块的Terraform上，我们甚至不需要任何工具来实现这一点。</li><li id="09b6" class="mn mo iq ku b kv mw kz mx ld my lh mz ll na lp ms mt mu mv bi translated">Ansible，Puppet，Chef混沌与声明性工具上应用的命令式逻辑。</li><li id="af25" class="mn mo iq ku b kv mw kz mx ld my lh mz ll na lp ms mt mu mv bi translated">作为虚拟机的Docker。程序设计语言的exec函数中的一种Docker run命令。</li></ul><h1 id="3026" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">坏的，丑陋的</h1><p id="7849" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这里有一些过度使用工具的真实例子。</p><p id="6b71" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">让我们看看在这个不可知的世界里事情是怎样的。</p><p id="a8c5" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">Ansible是一个配置管理工具。它最大的优势之一是以声明的方式编写基础设施。你只需要声明你想要什么，你不需要关心Ansible怎么做。</p><p id="e0b8" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">许多组织中有大量的Ansible代码试图将Bash脚本的每一行翻译成Ansible代码。这些组织不愿意将他们的过程改变为可行的概念。通常他们会过度使用<code class="fe nb nc nd ne b">shell</code>或<code class="fe nb nc nd ne b">command</code>模块。为什么这样不好？这种做法给工具本身带来了许多问题。例如缺乏幂等性。因此，代码不会检查机器上的任何资源状态。这使我们失去了Ansible和其他配置工具的最大优势之一。我们可以预期更多的CPU消耗和最长的执行时间。这也使得我们的代码是可靠的，我们可以忘记Ansible的抽象能力。更重要的是，这很难调试、测试和维护。Ansible并不打算将它的代码作为一步一步的命令来运行，但它是被迫的。最好使用声明式编程风格，该工具将决定如何以正确的方式完成。最佳实践是根本不使用shell或command。这通常发生在工程师沉迷于新技术的宣传，但是按照他们所知道的写代码的时候。</p><p id="288c" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">现在是<strong class="ku ir">码头工人</strong>的时间</p><p id="f1f1" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">将docker包装成bash脚本的有趣例子。一个产品的多容器docker交付完全自动化成几个bash脚本，这是一个非常肮脏的自动化黑客。意图很好，但结果很糟糕，给生产中的这种特定产品带来了很多问题。自动化任务通过docker内部IP地址将应用程序链接到数据库容器。没什么特别的，一个经典的docker桥接网络。作为这种方法的结果，服务器重启导致docker容器IP地址改变。应用程序无法启动，它无法连接到数据库，因为数据库的IP已更改。bash的过度使用不仅在生产中产生了真正的bug。这也使得理解应用程序结构、调试和改变环境变量变得困难。不愿意学习新的东西，比如docker-compose，另一方面，在bash-scripting方面有丰富的经验，这使得我们可以有这个过度使用shell脚本的好例子。</p><p id="017b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">过度使用编程语言来运行docker-compose命令。不，当你用设计好的API来使用它的时候，它还不错。但是当我们在程序中使用exec函数来包装<code class="fe nb nc nd ne b">docker-compose up</code>命令时，这种情况确实很糟糕。docker无法启动，并且没有任何错误消息，是的，这就是发生的情况。“现在就做”的期限和舒适的环境(编程语言)起到了作用。更正确和更快速的方法是简单地使用maven插件、bash脚本(以正确的方式)或者甚至是手动步骤。</p><p id="cccf" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">过度使用docker的一个很好的例子是在生产环境中将它作为虚拟机使用。我发现的时候也是这样用docker的。在局部环境下进行一些实验，像VM一样使用docker并没有错。在生产环境中，当我们使用docker容器作为虚拟机时会带来很多问题。最佳实践是将docker用作单个流程服务。将它与systemd或其他进程管理工具一起使用，会使跟踪容器中的应用程序变得更加困难。这可能会给你的应用程序带来错误的运行状态。同样，如果你错误地设计了docker图片，传统的“CTRL-C”也将不起作用。</p><h1 id="1cb5" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">蝴蝶效应</h1><p id="4457" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">过度使用工具正迫使我们，工程师，多年来停留在相同的自我发展水平，使我们成为IT世界的恐龙。我们很难跟上技术发展的步伐。其结果是另一种对最新技术的错误使用，因为我们几乎没有正确理解它们。</p><p id="33c4" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">对于组织和项目来说，这带来了更多的问题。最大的一个是遗产。只有一个人知道“它是如何工作的”,因为它不像手册或文档中那样工作。代码中充满了杂乱无章的东西。维护它在时间、质量和金钱方面都是昂贵的。让新人加入项目既困难又耗时。在存在这种现象的项目中，新工程师的进入可能需要一年甚至更长时间。时间就是金钱。</p><p id="5b30" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">然而，最危险的事情是把这种经历带到社区。在新人们学习的社区中，他们交流知识并推动事情向前发展。这件事发生在我个人的一个社区。很多工程师试图用工具去做他们不打算做的事情。例如，在Terraform的帮助下，在生产环境中保持代码“最新”。这种做法花了我很多时间通过丑陋和难以维护的变通方法解决问题。当然，这不仅会导致开支，还会导致有才华的团队和个人丧失热情。</p><h1 id="86ed" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">表现得像个真正的德沃普。</h1><p id="ec6c" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最佳实践是仅将工具用于其设计目的。如果没有这样的工具，你最好写出来，为什么不把它带到社区里。</p><p id="d6bc" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">此外，建议不要偏离官方文件。有时我们在使用某些工具时并不那么灵活，但是你最好不要为了你的目的而修改它。更好的办法是将这个问题带到社区中，为这个工具开发一个真正酷的功能，或者一个插件。</p><p id="dfe3" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果你过度使用DevOps工具，不仅请停止。如果您只是按照预期方式使用技术，请为社区做出贡献。转到堆栈溢出，使它变得更好。走进社区去争论，要么你会学到，要么你会教很多人那才是正确的解决方案。</p><p id="aedf" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">工具的正确使用是基础设施的代码质量。我们可以衡量这种情况的一个关键因素是组织中人员的切入点。代码和解决方案应该不言自明，不需要解释，没有隐藏的路径会发生奇迹。人们越快融入团队，越快修改你的解决方案，你就能越好地使用DevOps工具。</p><h1 id="0e2c" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="13a1" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">众所周知，DevOps不仅仅是工具，它让我们的生活变得更轻松、更精彩。这个世界现在太混乱了，我们必须解决它。设计正确的架构比编写代码行更重要。理解更适合我们的任务已经是解决方案的一半，就像理解问题本身一样。我们应该总是深入问题，选择最佳的解决方案，这将使我们远离麻烦。</p><p id="701d" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">有许多不断改进的DevOps工具目录可以帮助我们达到最佳效果。在该目录中，深入分析了所有工具对每个领域的影响。让每个工具适合正确的任务，并保持更新。因此，您将开始更快地整合人员，并且您的解决方案将基于技术和团队。你的解决方案不会集中在一个单一的未记录的知识来源上，也就是“无所不知的家伙”</p><p id="6968" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">让这个世界变得更美好是我们的力量。思考，编码，分享。</p><p id="2f57" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">别忘了我们可以衡量DevOps，而且我们应该使用正确的指标。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure></div></div>    
</body>
</html>