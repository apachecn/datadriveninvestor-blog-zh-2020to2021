# 使用 Bert 的基于上下文的搜索

> 原文：<https://medium.datadriveninvestor.com/context-based-search-using-bert-8957d25feaa9?source=collection_archive---------2----------------------->

![](img/f69d98004271f91aab4e6c0557cc039f.png)

(Photo By Nicolas J Leclercq On Unsplash)

我们现在是在 2020 年，在 40 年内，互联网已经给我们带来了大约 15 亿个网站。这比 2011 年印度的人口还要多。因此，通过互联网搜索是一项艰巨的任务。但是多亏了像谷歌这样的搜索引擎，必应变得简单了。为了改善搜索体验，他们使用 pagerank、knowledge graph 等算法( ***这是一个完全不同的话题*** )。

# 语义搜索的力量:

用户使用一些我们称之为查询的术语通过这些搜索引擎进行搜索，并且基于这些查询，搜索引擎将获取一些结果。之前可以看到，这些引擎主要依靠关键字匹配来执行搜索。然而，这些基于关键字的匹配无法理解查询的上下文，并且基于它所使用的匹配关键字返回结果。然而，最近随着深度学习的进步，有可能理解查询的语义，这是一个巨大的成功。例如让我们考虑两个句子"*是的银行损失了所有的钱"*和*"恒河的河岸很漂亮"*这个词**银行**有两种不同的意思。但是传统的模型会为同一个单词返回相同的向量表示。伯特来救援了。它将能够理解单词的含义，并根据上下文返回向量。下图展示了语义搜索的威力

![](img/476f298b89990659142c47171a5fdcc9.png)

正如我们所看到的，使用 bert 后，搜索结果有了显著的改善。伯特通过理解单词*到*与其他单词的关系来学习其语义。而之前的算法无法理解单词*对*的重要性，并返回一个美国公民想要去巴西旅游的结果。

# 伯特:

来自 Transformers 或 BERT 的双向编码器被认为是自然语言处理领域的一场革命。该模型由谷歌在 2018 年开源。该模型同时考虑了左右上下文。这项任务是通过两种策略实现的。

## 掩蔽语言建模:

在这种技术中，我们屏蔽了大约 15–20%的令牌，并让模型预测它们。这种方法有助于我们获得关于单词表征的各种统计见解。当我们想了解单词的更深层次的表达时，这种方法非常有用。

## 下一句预测:

在这种技术中，我们获取一个句子，并预测作为输入提供的下一个句子是否是原始文档中的下一个句子。在训练过程中，我们取两个句子，其中第二个句子实际上是原始文档中的下一个句子，占 50%，而其余 50%是任何其他随机的句子。这个方法基本上在问答模型中帮助我们。

# 如何执行语义搜索:

现在我们对 bert 的工作有了一点了解，让我们看看如何将它应用到我们的任务中。假设我们有 100 个文档，当然我们会有一个查询。因此，我们将计算每个文档的嵌入，我们也将为我们的查询这样做。在计算嵌入向量之后，我们将找到查询和每个文档之间的余弦相似性。现在，基于相似性，我们将对文档进行排序，并返回前 k 个文档*，其中 k 值取决于我们的要求。*

*为了实现这一点，我们将使用句子转换器库，它将帮助我们嵌入每个句子或文档。*

```
***from** **sentence_transformers** **import** SentenceTransformer
model = SentenceTransformer('bert-base-nli-mean-tokens')*
```

*上面的代码片段创建了一个对我们的句子进行编码的模型。利用这一点，我们可以计算每个句子的嵌入。*

*要将一个句子转换成它的嵌入形式，我们可以简单地使用 encode 方法。*

*为了找到每个句子之间的余弦相似性，我们可以利用 scipy 库。*

```
*from scipy.spatial.distance import cosine*
```

*现在，使用由模型为查询和文档计算的嵌入，我们将尝试找到最相似的文档并作为结果返回它们。*

*[](https://www.datadriveninvestor.com/2019/02/07/8-skills-you-need-to-become-a-data-scientist/) [## 成为数据科学家所需的 8 项技能|数据驱动型投资者

### 数字吓不倒你？没有什么比一张漂亮的 excel 表更令人满意的了？你会说几种语言…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2019/02/07/8-skills-you-need-to-become-a-data-scientist/) 

这是语义搜索的理论概述。在下一篇文章中，我们将使用一些不同的方法，如 xlnet，看看它是否工作正常。*