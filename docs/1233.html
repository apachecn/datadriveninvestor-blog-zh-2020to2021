<html>
<head>
<title>Introduction to NLP with NLTK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NLTK介绍NLP</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/introduction-to-nlp-with-nltk-1921b2f155f9?source=collection_archive---------10-----------------------#2020-03-09">https://medium.datadriveninvestor.com/introduction-to-nlp-with-nltk-1921b2f155f9?source=collection_archive---------10-----------------------#2020-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="dbf9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何处理自然语言数据</p><p id="4294" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们从经验中学习语言。我们的经验是以听、听、说、读的形式出现的。同样，机器学习算法也在一定程度上从经验中学习语言。由于机器学习算法的“学习”与我们的“学习”相去甚远，语言必须以一种漂亮、整洁的格式进行处理和准备，以便机器学习算法学习。在某种意义上，自然语言处理(NLP)是以机器学习算法可以处理和学习的格式来准备语言。维基百科上更正式的定义是:</p><blockquote class="kp kq kr"><p id="ce4a" class="jq jr ks js b jt ju jv jw jx jy jz ka kt kc kd ke ku kg kh ki kv kk kl km kn im bi translated"><strong class="js iu">自然语言处理</strong> ( <strong class="js iu"> NLP </strong>)是语言学、计算机科学、信息工程和人工智能的一个子领域，涉及计算机和人类(自然)语言之间的交互，特别是如何编写计算机程序来处理和分析大量自然语言数据。</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/711434013ae2b27121a120656aef3a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*f4a_-nrvWfUM5E_hpiv0Qg.jpeg"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk"><a class="ae ko" href="https://www.datasciencecentral.com/profiles/blogs/see-this-simple-introduction-to-natural-language-processing-nlp?platform=hootsuite" rel="noopener ugc nofollow" target="_blank">Figure source</a></figcaption></figure><p id="e2c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在详细介绍如何使用NLTK处理文本之前，我想给出一些NLP用例的例子:</p><ul class=""><li id="3088" class="li lj it js b jt ju jx jy kb lk kf ll kj lm kn ln lo lp lq bi translated">自动更正</li><li id="dc3c" class="li lj it js b jt lr jx ls kb lt kf lu kj lv kn ln lo lp lq bi translated">聊天机器人</li><li id="0690" class="li lj it js b jt lr jx ls kb lt kf lu kj lv kn ln lo lp lq bi translated">翻译</li><li id="f8be" class="li lj it js b jt lr jx ls kb lt kf lu kj lv kn ln lo lp lq bi translated">推文、评论等的情感分析。</li><li id="acaf" class="li lj it js b jt lr jx ls kb lt kf lu kj lv kn ln lo lp lq bi translated">假新闻和垃圾邮件检测</li><li id="8bc4" class="li lj it js b jt lr jx ls kb lt kf lu kj lv kn ln lo lp lq bi translated">生成文本</li></ul><p id="5042" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些只是当今实践中使用的NLP的一些例子。自从在NLP上做了大量的研究以来，它一直在改进。语言是非结构化数据，所以我们可以从语言中推断出很多信息。然而，为了得到有意义和有用的结果，非结构化需要大量的预处理。</p><div class="lw lx gp gr ly lz"><a href="https://www.datadriveninvestor.com/2019/02/07/8-skills-you-need-to-become-a-data-scientist/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">成为数据科学家所需的8项技能|数据驱动型投资者</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">数字吓不倒你？没有什么比一张漂亮的excel表更令人满意的了？你会说几种语言…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn lc lz"/></div></div></a></div><p id="b00a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像任何其他高级领域一样，全面了解基础知识至关重要。对于优秀的自然语言处理模型来说，预处理语言数据是绝对必要的。在这篇文章中，我将介绍使用自然语言工具包(NLTK)处理文本的一些基础知识。</p><p id="cc01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如NLTK <a class="ae ko" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank">网站</a>上所说，“NLTK是构建Python程序来处理人类语言数据的领先平台”。它提供了许多有用的方法和函数来处理和分析语言数据。</p><p id="4367" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们从导入依赖项开始:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="9fca" class="mt mu it mp b gy mv mw l mx my">import nltk<br/>nltk.download("popular")</span></pre><p id="b000" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">NLTK也提供书籍让我们练习。我们只需要下载这些书:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="727a" class="mt mu it mp b gy mv mw l mx my">nltk.download("book")<br/>from nltk.book import *</span></pre><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/bf42ecfc1d45c08f703ccdbef8f20426.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*yaETCrcDT6X0gE0firZMIg.png"/></div></figure><h1 id="e54a" class="na mu it bd nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bi translated"><strong class="ak">文本长度</strong></h1><p id="aa1b" class="pw-post-body-paragraph jq jr it js b jt nx jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj ob kl km kn im bi translated">文本最基本的特征是长度，使用<strong class="js iu"> len </strong>函数可以很容易地计算出长度:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="213c" class="mt mu it mp b gy mv mw l mx my">len(text3)<br/>  44764</span><span id="cf9b" class="mt mu it mp b gy oc mw l mx my">len(text1)<br/>  260819</span></pre><p id="e6c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">《莫比·迪克》比《创世纪》长得多。len函数给出了令牌的总数。一个<strong class="js iu">令牌</strong>是一个字符序列。例如，在“你好，世界！”中有2个令牌以及“你好，世界:)”中的3个代币。我们可能还想通过计算独特单词的数量来检查文本的多样性。例如，一段文本可能很长，只是重复相同的单词。为此，我们<strong class="js iu">使用</strong>设置python的方法。集合只包含不同的值:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="4c94" class="mt mu it mp b gy mv mw l mx my">list = ['a','a','b','c','d','d','d']</span><span id="c293" class="mt mu it mp b gy oc mw l mx my">set(list)<br/>  {'a', 'b', 'c', 'd'}</span></pre><p id="0b9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，我们可以计算出“莫比迪克”和“创世纪”中独特记号的数量。但是，比较唯一令牌数与所有令牌数的比率更有意义。这一比率也被称为<strong class="js iu">词汇多样性</strong>，它是一篇文本多样性的一种度量。</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="1df6" class="mt mu it mp b gy mv mw l mx my">len(set(text3)) / len(text3)<br/>  0.06230453042623537</span><span id="01fd" class="mt mu it mp b gy oc mw l mx my">len(set(text1)) / len(text1)<br/>  0.07406285585022564</span></pre><p id="eb1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这两本书的词汇多样性相似，只有1.2%的差异。</p><h1 id="6177" class="na mu it bd nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bi translated"><strong class="ak">词频</strong></h1><p id="dcac" class="pw-post-body-paragraph jq jr it js b jt nx jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj ob kl km kn im bi translated">我们检查了单词和独特单词的总数。最常用的词呢？NLTK还提供了简单易用的函数来确定词频。</p><p id="cd41" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">词频可以用于情感分析，或者在不阅读全文的情况下对文本有一个大概的了解。</p><p id="7375" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以使用<strong class="js iu"> FreqDist </strong>函数计算单词的频率:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="761f" class="mt mu it mp b gy mv mw l mx my">dist1 = FreqDist(text1)</span><span id="5a0f" class="mt mu it mp b gy oc mw l mx my">dist3 = FreqDist(text3)</span></pre><p id="b81e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们只是在两本不同的书中创造了单词的频率分布。我们可以用<strong class="js iu"> most_common </strong>方法找到常用的单词:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="bf1b" class="mt mu it mp b gy mv mw l mx my">dist1.most_common(10)<br/>[(',', 18713),('the', 13721),('.', 6862),('of', 6536),      ('and', 6024),('a', 4569),('to', 4542),(';', 4072),<br/> ('in', 3916),'that', 2982)]</span></pre><p id="55dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">most_common方法根据每个标记在文本中出现的次数依次返回它。我们只传递我们想看到的令牌数。然而，这里有一个问题。我们可以在最常见的20个标记列表中看到，它们大多数是标点符号或无信息的单词(即a，an，the，is…)。这些记号并没有告诉我们太多关于文本的特征。我们可以轻易地移除这些代币。NLTK提供了一个简单的下载工具，可以下载常见的无用词，如<strong class="js iu">停用词:</strong></p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="2cdf" class="mt mu it mp b gy mv mw l mx my">from nltk.corpus import stopwords</span><span id="7e24" class="mt mu it mp b gy oc mw l mx my">punc = [',','.',';','-','"','!','--','?', '."',"'",':']</span></pre><p id="281f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们使用停用词和标点符号列表来过滤原始文本。我手动创建了一个标点符号列表，但是NLTK也为这个任务提供了工具，比如<strong class="js iu"> regexp_tokenize </strong>函数。在我们过滤文本之前，我们将单词转换为小写字母和大写字母不会导致相同的单词被检测为不同的单词:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="6f7d" class="mt mu it mp b gy mv mw l mx my">text1_lower = [w.lower() for w in text1]</span><span id="ef0a" class="mt mu it mp b gy oc mw l mx my">#filter out stopwords and punctuations<br/>text1_filtered = [word for word in text1 if word not in (stopwords.words('english') + punc)]</span></pre><p id="bd26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我们可以创建一个新的频率分布:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="27df" class="mt mu it mp b gy mv mw l mx my">dist1_filtered = FreqDist(text1_filtered)</span></pre><p id="e10d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">按照与text3相似的步骤，我们发现这两本书最常见的单词如下:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="dd62" class="mt mu it mp b gy mv mw l mx my">dist1_filtered.most_common(10)<br/>[('whale', 1226),('one', 921),('like', 647),('upon', 566),<br/> ('man', 527),('ship', 518),('ahab', 511),('ye', 472),<br/> ('sea', 455),('old', 450)]</span><span id="24e0" class="mt mu it mp b gy oc mw l mx my">dist3_filtered.most_common(10)<br/>[('unto', 598),('said', 477),('thou', 284),('thy', 278),<br/> ('shall', 259),('thee', 257),('god', 231),('lord', 207),<br/> ('father', 198),('land', 184)]</span></pre><p id="2761" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">令人惊讶的是，在莫比迪克中最常见的词是“鲸鱼”！</p><p id="5541" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们还可以使用FreqDist对象检查特定单词的计数:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="cbcb" class="mt mu it mp b gy mv mw l mx my">dist1_filtered['sea']<br/>455</span><span id="d138" class="mt mu it mp b gy oc mw l mx my">dist1['sea']<br/>433</span><span id="e344" class="mt mu it mp b gy oc mw l mx my">dist1['Sea']<br/>22</span></pre><p id="efa0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们不转换成小写字母，我们会误算单词的出现次数。</p><p id="9e25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以画出常用词的频率:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="fc85" class="mt mu it mp b gy mv mw l mx my">len(dist1_filtered)<br/>17074</span><span id="3edf" class="mt mu it mp b gy oc mw l mx my">dist1_filtered.plot(10, cumulative=True)</span></pre><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi od"><img src="../Images/4290f20b3ddaaec27f0eb37562202170.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*TmX_XYw_OdPsEcq5wjk9VQ.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Cumulative frequency distribution plot of 10 most common words</figcaption></figure><p id="364d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">10个最常见的单词产生了全书的35%以上(过滤版)。</p><h1 id="8dbb" class="na mu it bd nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bi translated"><strong class="ak">二元模型</strong></h1><p id="9154" class="pw-post-body-paragraph jq jr it js b jt nx jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj ob kl km kn im bi translated">有时，仅仅根据单个单词进行分析是不够的。检查组词能让我们对文章有更多的了解。<strong class="js iu"> Bigram </strong>是一对词，trigram是一组三个词等等。如果我们把分析局限在语言上，我们肯定会忽略有价值的信息。因此，在分析自然语言时，我们需要开放思维，寻找复杂的模式和简单的统计数据。</p><p id="15b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">搭配</strong>NLTK的功能给了我们一个常见二元模型的列表:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="dfcf" class="mt mu it mp b gy mv mw l mx my">text1.collocations()</span><span id="2826" class="mt mu it mp b gy oc mw l mx my">Sperm Whale; Moby Dick; White Whale; old man; Captain Ahab; sperm<br/>whale; Right Whale; Captain Peleg; New Bedford; Cape Horn; cried Ahab; years ago; lower jaw; never mind; Father Mapple; cried Stubb; chief mate; white whale; ivory leg; one hand</span></pre><p id="acd6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在“莫比·迪克”这本书的情况下，“莫比”和“迪克”都没有出现在常用词中。然而，“莫比·迪克”却在常见的重婚者名单中。</p><h1 id="aca3" class="na mu it bd nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bi translated"><strong class="ak">条件</strong></h1><p id="3cf5" class="pw-post-body-paragraph jq jr it js b jt nx jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj ob kl km kn im bi translated">语言数据也可以根据定义的条件进行分析。例如，我们可能希望检查以特定字符结尾或长度超过特定长度的单词。</p><p id="c032" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们检查一下我们一直在分析的书中的单词长度:</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="f444" class="mt mu it mp b gy mv mw l mx my">fdist1_length = FreqDist(len(w) for w in text1_filtered)<br/>fdist3_length = FreqDist(len(w) for w in text3_filtered)</span><span id="591b" class="mt mu it mp b gy oc mw l mx my">fdist1_length.most_common(5)<br/>[(4, 24215), (5, 21529), (6, 16349), (7, 13547), (3, 10476)]</span><span id="8786" class="mt mu it mp b gy oc mw l mx my">fdist3_length.most_common(5)<br/>[(4, 6172), (5, 3840), (6, 2431), (3, 2083), (7, 1530)]</span></pre><p id="78c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这两本书在单词长度方面是相似的，但是平均单词长度可以在一些任务中提供有用的信息。例如，更正式的来源通常比非正式的来源(如推特或短信)有更长的单词。</p><p id="78e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以基于多个条件搜索文本。例如，下面的代码返回以“tion”结尾且超过10个字符的单词。</p><pre class="kx ky kz la gt mo mp mq mr aw ms bi"><span id="1829" class="mt mu it mp b gy mv mw l mx my">[w for w in set(text1_filtered) if w.endswith('tion') and len(w) &gt; 10]<br/>['congregation','ejaculation','abstraction','combination', ...</span><span id="814e" class="mt mu it mp b gy oc mw l mx my">#length &gt; 15</span><span id="0630" class="mt mu it mp b gy oc mw l mx my">[w for w in set(text1_filtered) if w.endswith('tion') and len(w) &gt; 15]</span></pre><h1 id="d8fd" class="na mu it bd nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bi translated"><strong class="ak">结论</strong></h1><p id="ce40" class="pw-post-body-paragraph jq jr it js b jt nx jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj ob kl km kn im bi translated">NLP是一个非常广泛的领域，在工业和我们的日常生活中有许多不同的应用。在这篇文章中，我的目的是让你了解使用NLTK的NLP。我们可以将语言视为非结构化数据，因此它需要大量的处理和分析，以获得对语言数据的全面理解并从中得出结果。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="5545" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p><h1 id="9405" class="na mu it bd nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bi translated"><strong class="ak">参考文献</strong></h1><ul class=""><li id="01ab" class="li lj it js b jt nx jx ny kb ol kf om kj on kn ln lo lp lq bi translated"><a class="ae ko" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank">https://www.nltk.org/</a></li></ul><figure class="kx ky kz la gt lb"><div class="bz fp l di"><div class="oo op l"/></div></figure></div></div>    
</body>
</html>