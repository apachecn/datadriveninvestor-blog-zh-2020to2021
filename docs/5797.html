<html>
<head>
<title>How To Setup Gitlab CI-CD Pipeline For Flutter Applications: Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为颤振应用设置Gitlab CI-CD流水线:第2部分</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-setup-gitlab-ci-cd-pipeline-for-flutter-applications-part-2-511b43d8cc7e?source=collection_archive---------9-----------------------#2020-10-01">https://medium.datadriveninvestor.com/how-to-setup-gitlab-ci-cd-pipeline-for-flutter-applications-part-2-511b43d8cc7e?source=collection_archive---------9-----------------------#2020-10-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7799dcc1065b34902b2ebf135fd24537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zFBZc67gHr_crKKEJC0Bpw.jpeg"/></div></div></figure><h1 id="3efd" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第2部分—配置Android和iOS发布模块</h1><p id="44ca" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">欢迎回到如何为颤振应用设置Gitlab CI-CD流水线。在第一部分的中，你学习了如何<a class="ae lu" href="https://www.thesunflowerlab.com/blog/how-to-setup-gitlab-ci-cd-pipeline-for-flutter-applications-part-1/" rel="noopener ugc nofollow" target="_blank">为Android和iOS配置不同风格的</a>Flutter应用程序。</p><p id="6437" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在这一部分，我们将使用发布配置来配置我们的Android和iOS模块。我们开始吧！</p><p id="7b61" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">首先，我们将一步一步地配置Android模块，如下所示。</p><ol class=""><li id="1bb8" class="ma mb iq ky b kz lv ld lw lh mc ll md lp me lt mf mg mh mi bi translated">我们需要创建一个密钥库文件，我们可以按照这个链接的指示<a class="ae lu" href="https://flutter.dev/docs/deployment/android#signing-the-app" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</li><li id="aa48" class="ma mb iq ky b kz mj ld mk lh ml ll mm lp mn lt mf mg mh mi bi translated">我们需要在应用程序中的APP_DIR/android/key.properties位置引用这个密钥库，它包含如下数据:</li></ol><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/9d70d36b6216a0d724e71e61fff6ba40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qbMJiGMk-VO-XqoH.png"/></div></div></figure><p id="6a1c" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">正如我们所看到的，我们必须将在步骤1中创建的jks文件放在文件夹APP_DIR/ci-cd/android/jks/中。jks</p><p id="bfd0" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">3.接下来，我们必须在app/build.gradle文件中配置签名。</p><ul class=""><li id="e6ab" class="ma mb iq ky b kz lv ld lw lh mc ll md lp me lt mt mg mh mi bi translated">如下所示，在android块之前添加代码，这会将key.properties文件加载到keystoreProperties对象中。</li></ul><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/595242db82d29aeceb41dbdd15a16827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n58zSf4-7-8FMFiG.png"/></div></div></figure><p id="d9ad" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在buildTypes块之前添加代码，签名配置如下，并同样更新发布buildType。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/09f6a7d11b246a73ecc6c819ab257245.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q5Dx4M6sZ8RfViKP.png"/></div></div></figure><p id="3c45" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">我们还将使用发布配置更新构建类型，并可选地添加调试，如下所示:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/37099e054914c2bb48e7da9eb1fa7da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iLcMSRYYe_HmM0KS.png"/></div></div></figure><p id="92c2" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">就是这样。我们这边已经完成了Flutter应用程序Android模块的签名配置。现在我们将为我们的iOS模块添加相同的内容。</p><div class="mw mx gp gr my mz"><a href="https://www.datadriveninvestor.com/2020/08/28/tech-is-the-market-top-dog/" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">技术是市场的领头羊|数据驱动的投资者</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">大量的首次公开募股，中国做他们自己的事，微软政府的灾难应对，以及抖音的民谣…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn jw mz"/></div></div></a></div><p id="2853" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">对于iOS，在开始之前，我们需要为我们在<a class="ae lu" href="https://www.thesunflowerlab.com/blog/how-to-setup-gitlab-ci-cd-pipeline-for-flutter-applications-part-1/" rel="noopener ugc nofollow" target="_blank">第1部分</a>中定义的所有方案/风格创建ExportOptions.plist文件。我们可以创造。手动创建plist文件，但我们强烈建议仅使用XCode生成ExportOptions.plist文件。那么，让我们看看如何生成这个plist文件。</p><ol class=""><li id="6e93" class="ma mb iq ky b kz lv ld lw lh mc ll md lp me lt mf mg mh mi bi translated">在“签名和功能”选项中设置有效的证书和配置文件。</li></ol><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/c7681115202a80e36ddfd9136ceb2f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/0*1bxxYq5VJjDGtCyV.png"/></div></figure><p id="f682" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">2.选择开发方案，将通用iOS设备放在旁边，如下所示:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/441d2f38107577da40e9b9ba1a30c442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YsLoojs8savmhSaG.png"/></div></div></figure><p id="58f9" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">现在产品菜单，并选择存档，让它执行操作，以创建存档。完成后，进入下一步。</p><p id="869d" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">3.选择“created archive”并单击“Export ”,然后选择“Development”并单击“next”。等待它创建构建，并在被要求时将其导出到特定位置。完成后，我们将进入下一步。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/6895245c82291ca4f440b05238719a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/0*7RfvmEhnd1v_-CEM.png"/></div></figure><p id="8fab" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">4.在导出的目标文件夹中，我们将找到ExportOption.plist文件。我们将复制该文件并将其粘贴到此处指定的路径APP _ DIR/ci-CD/iOS/develop/debug/</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d6fe306898a58ad52611eb6851b4c671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/0*I9jROEMyUyr77vrG.png"/></div></figure><p id="cb20" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">5.最后，我们将以相同的方式为生产生成归档文件，并在特定的目标文件夹中导出构建。在该文件夹中，我们将找到生产模式的ExportOption.plist文件。我们将复制该文件并粘贴到此处指定的路径APP _ DIR/ci-CD/iOS/develop/release/。</p><p id="bd59" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这里，我们只完成了开发方案/偏好&amp;对于生产方案，选择带有通用iOS设备的生产方案，并重复上述3到5个步骤。我们将把开发和生产ExportOption.plist文件分别复制到之前指定为APP _ DIR/ci-CD/iOS/production/debug/和APP _ DIR/ci-CD/iOS/production/release/的同一路径下。</p><p id="332d" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">就是这样。我们在这里为我们的Flutter应用程序的iOS模块添加签名配置。在下一个也是最后一个部分，我们将会看到，为了我们的Flutter项目，我们需要在Gitlab上做什么样的配置和改变，这样我们就可以直接在git lab上启用和运行构建管道。</p><p id="1372" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">所以，敬请期待最后的部分！</p><h2 id="ed80" class="nr jz iq bd ka ns nt dn ke nu nv dp ki lh nw nx km ll ny nz kq lp oa ob ku oc bi translated">访问专家视图— <a class="ae lu" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank">订阅DDI英特尔</a></h2></div></div>    
</body>
</html>