<html>
<head>
<title>Outstanding Returns Using Sentiment Analysis to Predict Alphabet (Google) Stock Price</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用情绪分析预测Alphabet(谷歌)股价的出色回报</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/outstanding-performance-using-sentiment-analysis-to-predict-alphabet-google-stock-price-c74ef86c82a6?source=collection_archive---------4-----------------------#2020-11-10">https://medium.datadriveninvestor.com/outstanding-performance-using-sentiment-analysis-to-predict-alphabet-google-stock-price-c74ef86c82a6?source=collection_archive---------4-----------------------#2020-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a06e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">简单是关键</h2></div><p id="b5b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简单是所有真正优雅的基调。<em class="le"/></p><p id="036e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">亚伯拉罕·马斯洛</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/48d994fca2101efcb74fc84076474854.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/0*emECGkTQQI9Gls0F.jpg"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Photo of Google Headquarters from <a class="ae lr" href="http://shutterstock.com/" rel="noopener ugc nofollow" target="_blank">source</a>.</figcaption></figure><p id="2cea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">*免责声明:我假设任何有能力理解和执行本文内容的人都足够精明，能够在生产中实际运行之前，在交易管道的每个角落执行强大的回溯测试。然而，这篇文章没有考虑到一些因素(利差、滑点和交易成本等)，就此而言，这篇文章<strong class="kk iu">不被视为财务建议</strong>。这被认为是朝着更好的成绩迈出的教育一步。</p><h1 id="63d4" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">介绍</h1><p id="a91d" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">这篇文章的目标是利用前一天交易时段的<strong class="kk iu">收盘时间(纽约证券交易所美国东部时间下午4点)到当天开市前(美国东部时间上午9点30分)的消息，预测<a class="ae lr" href="https://openblender.io/#/dataset/explore/5d4c38739516290b02fe15d7/or/44" rel="noopener ugc nofollow" target="_blank"> Alphabet (GOOGL) </a>的股价在任何给定的一天结束时是会上涨还是下跌<strong class="kk iu"/>。</strong></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/bd425e5b0b7cc83c94dbc63a48b051d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NiEIknPsyO0ZEfBzRijGbg.png"/></div></div></figure><p id="a96e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过将<strong class="kk iu">情感分析应用于新闻</strong>报道，我们将创建数字特征，并通过使用<a class="ae lr" href="https://www.academia.edu/44233887/PROXIMITY_BLEND_ALGORITHM_TO_IMPUTE_Discrete_VARIABLES_REFLECTED_IN_THE_RANGE_Of_AN_ANCHOR_VARIABLE_on_a_variable_from_a_different_axis_" rel="noopener ugc nofollow" target="_blank">近似混合算法</a>将它们加入我们的股票数据。</p><p id="58f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我会在文章底部添加一个<strong class="kk iu">链接到笔记本</strong>，这样你就可以复制这个学习案例了。</p><h1 id="a03f" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">目标</h1><p id="dc00" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">这是字母表(GOOGL) 股价的<a class="ae lr" href="https://openblender.io/#/dataset/explore/5d4c38739516290b02fe15d7/or/44" rel="noopener ugc nofollow" target="_blank">日蜡烛线数据集。我们会用过去的两年。</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mu"><img src="../Images/978f5152765a08f932719caa99fb8587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttcCNnkVzAcVVcWsn-065w.png"/></div></div></figure><p id="cca8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们想要预测给定一天的收盘价相对于开盘价的的<strong class="kk iu">百分比。</strong></p><pre class="lg lh li lj gt mv mw mx my aw mz bi"><span id="6ffd" class="na lt it mw b gy nb nc l nd ne">df_alphabet['<strong class="mw iu">change</strong>'] = np.log(df_alphabet['<strong class="mw iu">close</strong>']) - np.log(df_alphabet['<strong class="mw iu">open</strong>'])</span></pre><p id="d129" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看看开盘价和收盘价与变化的关系。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nf"><img src="../Images/7ebd4c1287bca0a39d4b29b563d330ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_lLEK3wi4i5H9nwu5B2Vg.png"/></div></div></figure><p id="99f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们放大，我们可以看到当收盘价比开盘价高<strong class="kk iu">比开盘价高</strong>时，<strong class="kk iu">绿点在“零变化”</strong>线上方，反之亦然。这意味着线上方的绿点是<strong class="kk iu">投资将在那天</strong>产生 <strong class="kk iu">正回报的地方。</strong></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ng"><img src="../Images/3f0cb78e8c8869fa05cd098ea5264e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YmZIZwH1i0SjRX_tmRVTGg.png"/></div></div></figure><p id="13f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的目标是<strong class="kk iu">使用在某一天</strong>之前来自<strong class="kk iu">的信息来预测某一天的变化是否会大于零</strong>，以便我们可以决定在开盘时买入，在收盘时卖出。</p><p id="b4bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是<strong class="kk iu">变化</strong>分布的样子:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nh"><img src="../Images/ae62375633259f35c3617a5d937fb5a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwBPkAmWcAhJGK3np6gSiA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lu">change</strong> distribution (mean = 0.00053)</figcaption></figure><pre class="lg lh li lj gt mv mw mx my aw mz bi"><span id="4aad" class="na lt it mw b gy nb nc l nd ne"><strong class="mw iu">743</strong> times change is <strong class="mw iu">positive (53%)</strong><br/><strong class="mw iu">639</strong> times change is <strong class="mw iu">negative (47%)</strong></span></pre><p id="b466" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以硬币已经‘倾斜’在我们这边了。</p><p id="e31f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们通过将<strong class="kk iu">变化</strong>二值化并添加一个小障碍(0.003)来补偿滑点、价差和交易成本，从而创建一个成功/失败<strong class="kk iu">目标特征</strong>。(以便投资产生正回报)。</p><pre class="lg lh li lj gt mv mw mx my aw mz bi"><span id="b449" class="na lt it mw b gy nb nc l nd ne">df_alphabet['<strong class="mw iu">target</strong>'] = [1 if ch &gt; 0.003 else 0 for ch in df_alphabet['change']]</span></pre><p id="e1e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们有了一枚更加“不方便”的硬币。</p><pre class="lg lh li lj gt mv mw mx my aw mz bi"><span id="0944" class="na lt it mw b gy nb nc l nd ne"><strong class="mw iu">551</strong> times target is <strong class="mw iu">1 (39%)</strong><br/><strong class="mw iu">832</strong> times target is <strong class="mw iu">0 (61%)</strong></span></pre><p id="e590" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的<strong class="kk iu">目标</strong>是在产生收入的比例上检测成功。我们希望筛选并找到更多天的正回报进行投资(precision &gt; 0.5)。</p><h1 id="a26b" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">情感分析</h1><p id="97e1" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">简单来说，一个有监督的ML模型可以看作是由自变量解释的因变量。在应用情感分析时，自变量来自文本。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ba4a5f03d78ec14d5ec8583f91fe326f.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*HmcXJWGzMjHgG_fmSmd1aA.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lu">ŝ </strong>=<strong class="bd lu"> </strong>sentiment<strong class="bd lu"> | t </strong>= text</figcaption></figure><p id="6d94" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的例子中(以及在许多情况下)，因变量'<strong class="kk iu"> ŝ ' </strong>将为第二个“相关”模型提供情绪的特定用例(如股票预测)。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/c487a4a4299dafec121350e18f3236a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*znl0MkPgoreZarGncEjoAQ.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lu">x̂</strong> = prediction of<strong class="bd lu"> x</strong> | <strong class="bd lu">ŝ </strong>=<strong class="bd lu"> </strong>sentiment</figcaption></figure><p id="99e3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<strong class="kk iu"> x </strong>是我们的<strong class="kk iu">目标变量</strong>。</p><p id="f6ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，在我们建立一个相关模型来预测我们的目标之前，我们需要创建一个独立模型来对新闻<strong class="kk iu">情感</strong>进行分类，这样我们就可以<strong class="kk iu">将结果用作输入</strong>。</p><p id="6223" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">情感分析是量化主观信息的艺术。</p><p id="5682" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">“情绪”表示可以被看作是一个多维空间，其中充满了面向许多方向的向量(参见<a class="ae lr" href="http://robotics.stanford.edu/~amaas/papers/multisent-techreport-2011.pdf" rel="noopener ugc nofollow" target="_blank">“具有学习表示的多维情绪分析”</a>)。</p><p id="a202" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是为了这篇文章的目的，我们将<strong class="kk iu">简化</strong>，将情感简化为每个新闻标题的一个<strong class="kk iu">数字特征</strong>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nk"><img src="../Images/bec5c2c1d59095f18efb1b52be6d3d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDUOtp2qTCnkgunVZZGIeA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Range of ‘Sentiment’</figcaption></figure><p id="ab01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个标题都有一个“<strong class="kk iu">情绪</strong>特征，代表新闻对潜在的股票走势有多积极或消极。</p><p id="9b2d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们来看看一些提到谷歌的新闻——按天汇总。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nl"><img src="../Images/1a9657ada8137c2edfc51edd14185ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbenG6g3gYQzKtVX-aCRFQ.png"/></div></div></figure><p id="70cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">主观部分是我们对股价的<strong class="kk iu">正面或负面</strong>标题的看法。我们需要<strong class="kk iu">手动标记</strong>一组新闻，让模型用这些知识进行训练。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nm"><img src="../Images/207514da081bcba0a99e40239c41a4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ol8-u_QhbIKiGH5NpnOZVA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">My interpretation of positive, negative and neutral.</figcaption></figure><p id="2996" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我从1300多天的“谷歌”新闻中手动标记了500多个新闻标题(没错，我赢得了我的向上投票)，添加了<strong class="kk iu"> -1 </strong>、<strong class="kk iu"> 0 </strong>或<strong class="kk iu"> 1 </strong>的<strong class="kk iu">情感</strong>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nn"><img src="../Images/bc1c719e10125bdc79e5c7d151f61a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ehR6yh9R2_gFBjFIgsyvjg.png"/></div></div></figure><p id="8fe5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们需要想出一个模型，它可以训练<strong class="kk iu">对新文本的情感进行分类</strong>，这样我们就可以自动化这项工作，并立即将情感作为我们目标的ML燃料。</p><p id="db75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们需要将文本转换成数字格式，以便应用ML。为此，我们需要对文本进行<strong class="kk iu">符号化</strong>和<strong class="kk iu">矢量化</strong>。</p><p id="6113" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">标记化</strong></p><p id="e75e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">标记化是将单词或词组中的字符串分开(称为n元语法)。例如，让我们为一个文本的“1个和2个单词”创建n元语法:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi no"><img src="../Images/1a309693916b92b2f56e4d58a1e9e237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1kt-YkTPC0Sgw3zZe5Ejaw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">List of n-grams (1 and 2 words) created from text</figcaption></figure><p id="f266" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">矢量化</strong></p><p id="a1a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">矢量化是从文本数组中创建一个稀疏矩阵，其中<strong class="kk iu">列是n元语法</strong>，而<strong class="kk iu">行是每个文本上的提及</strong>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi np"><img src="../Images/162bdc6e39498a4fb64de732644e3fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ahNY0R4Lm5oqr5yy.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Simple representation of text vectorization.</figcaption></figure><p id="b6a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们<strong class="kk iu">将文本</strong>符号化，并将其添加为数字特征:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nq"><img src="../Images/a9f050a4922a1a37a7a8db62d95eee00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vE-F6dh46jKsnjcDVaPH1g.png"/></div></div></figure><p id="5763" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们<strong class="kk iu">增加了1550列</strong>到我们的情感数据框架中。现在，让我们看看与“情绪”最相关的(负面和正面)标记。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nr"><img src="../Images/7b2c56cb01a73344509b17032c897371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fNUSXTyI2OT-etpDu92Xsg.png"/></div></div></figure><p id="02b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，这些本身并不意味着什么，所以让我们创建一个机器学习模型，将它们结合起来预测情绪。</p><p id="7f0d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，用一个简单的模型来检测<strong class="kk iu">【正面】</strong>新闻。培训用365，测试用157。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/141d48531a755b5819f493303460444f.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*j2_zgJswPEXOUo1Zu_SGQA.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Confusion matrix for detecting ‘positive’ news</figcaption></figure><p id="d507" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它正确检测出<strong class="kk iu"> 7 </strong>正面消息，<strong class="kk iu">T23】错误标注<strong class="kk iu"> 1 </strong>并遗漏<strong class="kk iu"> 28 </strong>。它正确地丢弃了<strong class="kk iu">121</strong>‘不积极’的消息。</strong></p><p id="2c13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在完全相同的过程来检测这次'<strong class="kk iu">负面的</strong>消息。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/114f37c4d558b35d34a9c7bc021fe0ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*YsKSq353hNGa_SPYBYvpgg.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Confusion matrix for detecting ‘negative’ news</figcaption></figure><p id="1a23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它正确地检测到了<strong class="kk iu"> 12 </strong>，错误地将<strong class="kk iu"> 7 </strong>标记为“负面”，并且错过了<strong class="kk iu"> 28 </strong>“负面”消息。它正确地过滤掉了<strong class="kk iu">110</strong>‘非负面’新闻。</p><p id="0e8a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两个模型之间的分类没有重叠<strong class="kk iu">(没有新闻同时被标记为‘正面’和‘负面’)。</strong></p><p id="45ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管还有巨大的<strong class="kk iu">改进空间</strong>(通过预处理数据、模型/参数优化、词干化和词条化、添加更多数据进行训练、语义分析、通过神经网络运行等)..)这对于我们的主要目的来说<strong class="kk iu">很好，也很简单</strong>。</p><h1 id="c8b1" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">新闻价格预测</h1><p id="b308" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">让我们一起来看看价格和人气。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nu"><img src="../Images/5d73120f59701e714624843080740d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zRkY2AdnQTnGIQsbVszKA.png"/></div></div></figure><p id="54a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">绿线是'<strong class="kk iu">正</strong>新闻，红线是'<strong class="kk iu">负</strong>。</p><p id="ea9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们去掉价格曲线。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ng"><img src="../Images/f6a7ae77eb02ff3ef76eeeb01748b657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axslPOSUOIZch4-hCUnrEw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Sentiment from news with GOOGL change</figcaption></figure><p id="30cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">乍看之下，很难看出其中的关系，因为有太多的“变化”点。</p><p id="7c5a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们再次混合新闻，并使用我们的“情绪”模型计算过去24小时的平均情绪。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nv"><img src="../Images/40b5676cd0f25da392c40e8d2d2c490d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*65urKOMeOMIg3M27P_WaoQ.png"/></div></div></figure><p id="7a61" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们试着<strong class="kk iu">用<strong class="kk iu">我们现在从</strong>前一天开始的变量来预测“变化”是否会是正的</strong>(高于我们的0.003差点)。</p><p id="e18e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">再次尝试一个简单的模型，用1078个观测值的先验(按时间顺序)训练集进行训练，用304个观测值的后验训练集进行测试。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/8bc6a4fef22839f440f75ef8571f354e.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*4t48joLm9SDOOkHbcLPI3w.png"/></div></figure><p id="bece" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的模型正确地预测了<strong class="kk iu"> 85次价格上涨</strong>(变化&gt; 0.003)，它错误地接受了<strong class="kk iu"> 65 ' </strong>非上涨<strong class="kk iu"> ' </strong>的情况。它<strong class="kk iu">遗漏了50个</strong>增量，它<strong class="kk iu">正确地过滤掉了104个</strong>‘非增量’案例。</p><p id="29d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，考虑到影响股票价格的因素如此之多，仅凭新闻标题和蜡烛图中包含的信息来获得这些结果是非常出色的。</p><p id="4cf5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">记住，世上没有免费的钱。每项投资都有风险。不仅要理解数学和模型，还要理解这些模型代表了什么，这一点总是很重要的。</p><p id="7d0f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以在这里下载笔记本来重现这一切<a class="ae lr" href="https://github.com/federico2001/google_stock_prediction/tree/master" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>