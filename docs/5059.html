<html>
<head>
<title>Web scraping using python | Easy Steps for Web Scraping | Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用python进行网页抓取|网页抓取的简单步骤|方法</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/web-scraping-easy-steps-for-web-scraping-methods-python-da3333f8d959?source=collection_archive---------3-----------------------#2020-09-04">https://medium.datadriveninvestor.com/web-scraping-easy-steps-for-web-scraping-methods-python-da3333f8d959?source=collection_archive---------3-----------------------#2020-09-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8371" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">网络抓取本身并不违法。事实上，web抓取或web爬行在历史上与众所周知的搜索引擎如Google或Bing相关联。这些搜索引擎抓取网站并索引网络。</h2></div><p id="9d68" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从网页抓取过程开始，需要以下步骤:</p><blockquote class="lb lc ld"><p id="d0d8" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated"><strong class="kh ir">所需进口:</strong></p></blockquote><p id="fafb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 1。</strong> <strong class="kh ir"> xlrd </strong></p><p id="0f6a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">xlrd是一个允许Python从Excel文件中读取数据的模块。</p><p id="8c1b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">安装:</strong></p><p id="bd97" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">pip安装xlrd</p><p id="aee2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2。</strong> <strong class="kh ir">硒</strong></p><p id="b639" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Selenium WebDriver是最流行的Web UI自动化工具之一。</p><p id="d0c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">安装:</strong></p><p id="a48d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">pip安装硒</p><p id="d493" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3。美汤</strong></p><p id="460c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Beautiful Soup是一个库，可以很容易地从网页上抓取信息</p><p id="53aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">安装:</strong></p><p id="b001" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">pip安装beautifulsoup4</p><p id="fccd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4。</strong> <strong class="kh ir">熊猫</strong></p><p id="d895" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Pandas是一个Python包，它提供了快速、灵活和富于表现力的数据结构，旨在使结构化(表格、多维、潜在异构)和时序数据的处理变得既简单又直观。</p><p id="4455" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">安装:</strong></p><p id="4863" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">pip安装熊猫</p><p id="55bb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 5。</strong> x <strong class="kh ir"> lwt </strong></p><p id="8fee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">xlwt是一个开发人员用来生成与Microsoft Excel版本95到2003兼容的电子表格文件的库。</p><p id="a95c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">安装:</strong></p><p id="b5ee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">pip安装xlwt</p><h1 id="c862" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">在下面的步骤中，我们将进行Web抓取，以获取组织的详细信息。</h1><blockquote class="lb lc ld"><p id="96d3" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤1:导入导入</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="015e" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">import xlrd</strong></span><span id="dc25" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">from selenium import webdriver</strong></span><span id="f654" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">from bs4 import BeautifulSoup</strong></span><span id="fbca" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">import pandas as pd</strong></span><span id="294c" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">import xlwt</strong></span><span id="064b" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">from xlwt import WorkbookStep 2: Importing the imports</strong></span></pre><blockquote class="lb lc ld"><p id="f73a" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤2:为Excel工作表创建对象</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="cfba" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">wb1 = Workbook()</strong></span></pre><blockquote class="lb lc ld"><p id="4c80" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤3:在Excel中创建工作表</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="204d" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">sheet1 = wb1.add_sheet('Sheet 1')</strong></span></pre><blockquote class="lb lc ld"><p id="dc76" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤4:处理循环的列和行的变量</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="8732" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">col=0</strong></span><span id="c057" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">row=0</strong></span></pre><blockquote class="lb lc ld"><p id="8566" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤5:包含用于抓取的数据集的Excel表的路径变量</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2a52" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">loc = ("C:/Users/Thinksprout Infotech/Desktop/CompReg_31AUGUST2020.xlsx")</strong></span></pre><p id="0f3e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">我们正在使用测试版Chrome浏览器。</strong></p><p id="ae13" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">必须要有chrome浏览器。</strong></p><div class="mp mq gp gr mr ms"><a href="https://www.datadriveninvestor.com/2020/05/20/simulating-popular-distributions-in-python/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">在Python中模拟流行的分布|数据驱动的投资者</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">近年来，对机器学习和数据科学的兴趣一直在快速增长。越来越多的学生…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng nh ms"/></div></div></a></div><p id="cde3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查你的Chrome版本，并下载同样的兼容版本。</p><figure class="ma mb mc md gt nj gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi ni"><img src="../Images/0dc20460c596a38b9171034f461326f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKbx37PziDiL8cK-3nEcjQ.jpeg"/></div></div></figure><h2 id="7da0" class="mj lj iq bd lk np nq dn lo nr ns dp ls ko nt nu lu ks nv nw lw kw nx ny ly nz bi translated"><em class="oa">可从</em>下载Chrome测试网络浏览器驱动程序</h2><div class="mp mq gp gr mr ms"><a href="https://chromedriver.chromium.org/downloads" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">下载-Chrome driver-Chrome的WebDriver</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">Chrome的网络驱动</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">Chromechromedriver.chromium.org的web驱动程序</p></div></div></div></a></div><blockquote class="lb lc ld"><p id="0de4" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤6:用于设置测试web浏览器驱动程序位置的变量</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="1a05" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">driver = webdriver.Chrome("C:/Users/ Thinksprout Infotech /Desktop/chromedriver_win32/chromedriver"</strong></span></pre><blockquote class="lb lc ld"><p id="ef45" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤7:从excel中读取数据集的工作簿对象</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="4b55" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">wb = xlrd.open_workbook(loc)</strong></span><span id="99d6" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">sheet = wb.sheet_by_index(0)</strong></span></pre><blockquote class="lb lc ld"><p id="83c0" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤8:遍历数据集</p></blockquote><h2 id="e675" class="mj lj iq bd lk np nq dn lo nr ns dp ls ko nt nu lu ks nv nw lw kw nx ny ly nz bi translated"><em class="oa">继续循环直到结束</em></h2><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="aa0e" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">for i in range(sheet.nrows):</strong></span><span id="56a2" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">      cin = sheet.cell_value(i, 0)</strong></span><span id="0206" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">      name = sheet.cell_value(i, 1)</strong></span></pre><blockquote class="lb lc ld"><p id="503e" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤9:抓取网页的网址</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="6070" class="mj lj iq mf b gy mk ml l mm mn">#HiddenData is the URL of website to be webscrapped<br/>#brackets ‘{ }’ represents the data for parameters to the website URL</span><span id="e0ec" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">stuff_in_string = "https://HiddenData/{}/{}".format(name,cin)</strong></span></pre><blockquote class="lb lc ld"><p id="4189" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤10:向网络浏览器发送URL数据</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="c703" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">driver.get(stuff_in_string)</strong></span><span id="ecca" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">content = driver.page_source</strong></span><span id="e93c" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">soup = BeautifulSoup(content,"html.parser")</strong></span></pre><blockquote class="lb lc ld"><p id="ac6c" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">第11步:实际网站标签的数据必须刮和数据必须提取</p></blockquote><figure class="ma mb mc md gt nj gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi ob"><img src="../Images/2d1ea17e8522728351aaa20da76af1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m8Q9_yFyhOKwQCJe"/></div></div></figure><p id="9025" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">例如:</strong></p><p id="84cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae oc" href="https://thinksproutinfotech.com/" rel="noopener ugc nofollow" target="_blank">https://thinksproutinfotech.com</a></p><p id="c36f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想从我的组织网站URL获取Thinksprout Infotech名称</p><p id="4f50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在网页上单击右键—&gt;单击“检查”</p><figure class="ma mb mc md gt nj gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi ni"><img src="../Images/134d0dcb48dc5e2622797478dc9a4639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gSRFSAhb5Vdm9ztLp8CKUg.jpeg"/></div></div></figure><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="d890" class="mj lj iq mf b gy mk ml l mm mn"><strong class="mf ir">content1 = soup.find('div', {"class": " elementor-widget-container"})</strong></span><span id="2033" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">article = ''</strong></span></pre><blockquote class="lb lc ld"><p id="6c9c" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤12:将数据导出到新的Excel表格</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="d286" class="mj lj iq mf b gy mk ml l mm mn"><em class="le">#another Loop in our previous for loop</em></span><span id="d69c" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">for i in content1.findAll('p'):</strong></span><span id="359f" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">    article =i.text</strong></span><span id="0a33" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">    print(article)</strong></span><span id="7656" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">    sheet1.write(row, col, article)</strong></span><span id="197e" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">    wb1.save('C:/Users/Viraj Shelar/Desktop/data2.csv')</strong></span><span id="e591" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">    row+=1</strong></span></pre><blockquote class="lb lc ld"><p id="18cd" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">步骤13:关闭测试版Chrome浏览器</p></blockquote><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2598" class="mj lj iq mf b gy mk ml l mm mn"><em class="le">#outside the second for loop i.e inside second first for loop</em></span><span id="5dcd" class="mj lj iq mf b gy mo ml l mm mn"><strong class="mf ir">driver.quit()</strong></span></pre><p id="eeb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">这个循环将继续，直到数据集的所有数据都没有被解析。</strong></p><h1 id="aaaa" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">结论:</h1><p id="1269" class="pw-post-body-paragraph kf kg iq kh b ki od jr kk kl oe ju kn ko of kq kr ks og ku kv kw oh ky kz la ij bi translated">每次成功执行数据集中的数据后，Chrome测试浏览器将重新启动，继续处理数据中的数据值。</p><p id="5a4b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当稀疏化数据并同时获取值时，它会将获取的数据存储到新的Excel表中。同时执行是因为在元组、列表或字典中存储数据可能会由于互联网连接失败而导致数据丢失。</p><p id="cfe9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了避免这个缺点，最好同时执行。</p><h1 id="cae5" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">参考资料:</h1><ol class=""><li id="ba90" class="oi oj iq kh b ki od kl oe ko ok ks ol kw om la on oo op oq bi translated"><a class="ae oc" href="https://www.geeksforgeeks.org/reading-excel-file-using-python/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/reading-excel-file-using-python/</a></li><li id="5a55" class="oi oj iq kh b ki or kl os ko ot ks ou kw ov la on oo op oq bi translated"><a class="ae oc" href="https://www.geeksforgeeks.org/writing-excel-sheet-using-python/?ref=lbp" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/writing-excel-sheet-using-python/？ref=lbp </a></li><li id="f07d" class="oi oj iq kh b ki or kl os ko ot ks ou kw ov la on oo op oq bi translated"><a class="ae oc" href="https://www.extendoffice.com/documents/excel/2517-excel-if-column-contains-value-text-then-copy-cell.html" rel="noopener ugc nofollow" target="_blank">https://www . extend office . com/documents/excel/2517-excel-if-column-contains-value-text-then-copy-cell . html</a></li><li id="1371" class="oi oj iq kh b ki or kl os ko ot ks ou kw ov la on oo op oq bi translated"><a class="ae oc" href="https://matthew-brett.github.io/teaching/string_formatting.html" rel="noopener ugc nofollow" target="_blank">https://Matthew-Brett . github . io/teaching/string _ formatting . html</a></li><li id="3d0a" class="oi oj iq kh b ki or kl os ko ot ks ou kw ov la on oo op oq bi translated">图片:<a class="ae oc" href="https://unsplash.com/photos/RYyr-k3Ysqg" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/RYyr-k3Ysqg</a></li></ol><p id="51e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">访问专家视图— </strong> <a class="ae oc" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>