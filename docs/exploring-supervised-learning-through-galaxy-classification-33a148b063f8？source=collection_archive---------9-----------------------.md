# 通过星系分类探索监督学习

> 原文：<https://medium.datadriveninvestor.com/exploring-supervised-learning-through-galaxy-classification-33a148b063f8?source=collection_archive---------9----------------------->

## 可教授的机器项目

![](img/ae7c2961735ef66da5a3d916c5e9d621.png)

Source: [https://acrosstheuniverseinnotime.wordpress.com/category/nasa/](https://acrosstheuniverseinnotime.wordpress.com/category/nasa/)

试着在晴朗的夜晚仰望天空，数一数你能看到的所有星星。很有可能，不管你多么努力地去记录，不久你的眼睛就会疲劳，你就不得不重新开始。

让这项任务变得不可能的是你必须记录的恒星数量。这些仅仅是我们从地球上看得见的。

借助望远镜和天文台，我们可以看到比光点更多的东西——巨大的红巨星、爆发成超新星的恒星、旋转的致密中子星——以及恒星构成的物体:星系。很快我们意识到计数宇宙中的一切是多么困难。

显然，对宇宙中*事物*数量的估计并不是通过一个一个地数来的。相反，这是一个比例问题。我们取一大块天空，我们*可以*精确地计算出它拥有的*事物*的数量，然后我们乘以那一大块来反映整个天空的密度、体积和整体大小。这种方法就是我们如何计算宇宙中最大的物体:星系，我们估计其数量在 2000 亿到 2 万亿之间。

问题是，我们并不真正关心有多少个*星系。更令人着迷的是星系能告诉我们关于宇宙的什么。**星系是宇宙中发现的最大的独特结构，因此了解星系的行为=了解宇宙中物质的行为。***

*我们了解星系的一些方法是通过它们发出的光(光谱)或通过分析它们对周围环境的引力效应。但是我们研究星系的主要方式是视觉。*

# *哈勃分类*

*星系是根据它们的外观来分类的。分类方法是由埃德温·哈勃创立的，他在天文学和宇宙学方面的工作为我们理解宇宙铺平了道路。他首先根据星系是椭圆形(看起来像太空蛋)还是螺旋形(像我们的银河系一样有旋臂)来划分所有的星系。*

*由字母 E 表示的椭圆星系，根据它们的椭圆度，或者它们看起来有多圆(E0)和多平(E7)，被进一步划分为子类。*

*由字母 S 表示的螺旋星系是根据旋臂的结构和相对于星系其他部分的中心凸起的大小来划分的。具有平滑、宽阔的臂和巨大的中心凸起的星系被归类为 Sa，而具有许多狭窄、轮廓分明的臂和相对微小的中心的星系被归类为 Sc。*

*有时，在中央隆起的旁边，螺旋星系有栅栏，或者一条尘埃和气体的直线，从那里分出它的分支。这些被称为棒旋星系，它们遵循与规则螺旋相同的 a-c 分类方案，只是用 SB 代替。*

*椭圆星系和螺旋星系之间的中间物用 S0 表示，称为透镜星系。他们有两种类型的共同特征。*

*![](img/cd2430b53bfb864931853ffb2dbdd74c.png)*

*The Hubble Tuning Fork, representing how galaxies are classified based on how elliptical or how spiral they are.*

*然而，哈勃音叉没有位置给:*

*   *不规则星系:没有明显结构但具有爆炸外观的星系*
*   *矮星系:超级小椭圆星系*
*   *巨型椭圆星系:矮星的对立面，巨大的椭圆星系位于星系团的中心*

*很快，哈勃看似简单的分类方案被宇宙的复杂性复杂化了。*

## *但是为什么我们首先需要分类呢？*

*嗯，结构相同的星系还有其他非视觉特征。螺旋星系既有老恒星也有年轻恒星，但椭圆星系只有老恒星。螺旋星系的圆盘有大量的气体和尘埃，椭圆星系通常有超热的 X 射线气体。*

*星系结构是恒星形成的一个指标——螺旋通常在其旋臂上有很多活动，而椭圆星系是古老的，至少在过去的 100 亿年中没有活跃的恒星形成！*

*所以，是的，我们可以根据星系的外观来了解它们。*

*问题是手动给星系分类就像试图数清夜空中你能看到的所有星星一样困难。当人工计算让我们失败时，机器学习就会介入。*

# *监督学习*

***监督学习是由人类指导的机器学习的子集**。尽管如此，与机器学习模型的能力相比，人类的脑力参与很少。*但是如果我们告诉计算机做什么，这和传统的计算有什么不同呢？**

***在传统计算中，我们必须*编写规则*让计算机遵循。如果我们想对一个星系进行分类，我们需要写下 ***完整的条件集*** ，当遇到这些条件时，会引导计算机得出一个明确的结论。***

*当然，如果我们只想知道根据理论定义它是螺旋形还是椭圆形，这可能对一些星系有用。*

*但是，当我们把真实星系的自然和不规则特征，包括棒、膨胀的核心、透镜、碰撞、引力相互作用，加入到混合物中，会发生什么呢？从明显的不规则到细微的偏差，**为任何给定星系的分类写一个*无限长的规则和结果集*如果不是不可能的话，将是极其乏味的。***

*另一方面，监督机器学习允许我们向模型提供输入数据 的有限样本 ***，就像一组星系图像。了解了一些天文学知识后，我们用星系的类型标记了每一条输入数据。所以现在，计算机也知道一些关于天文学的东西。一旦我们给模型输入了足够大的数据样本，就可以说它已经被**训练过了**。****

*一旦一个模型被训练好，我们现在可以给它输入新的、未标记的数据，就像一个未分类星系的图像，这个模型将能够使用它所知道的标签来预测这个新星系的标签。基于具有相同标签的数据所共有的特征，该模型将能够推断出新数据最适合的类别。监督学习模型就是这样分类的。*

# *可示教机器工作流程*

*我选择使用[可教机器](https://teachablemachine.withgoogle.com/)，谷歌人工智能实验室的在线工具。我借用了微软机器学习[演示](https://docs.microsoft.com/en-us/archive/blogs/mlserver/galaxy-classification-with-neural-networks-a-data-science-workflow)的想法，其中 240，000 张来自斯隆数字巡天的星系图像被用来训练星系分类的预测模型。*

*借用 SDSS 的数据是足智多谋的，并使监督学习模型在星系分类中高度准确。我想简化这个演示，而不是用可教机器从概念上实验监督学习的本质。*

*在选择图像来训练我的模型时，我避免了具有特殊性的星系，如星系相互作用/合并、引力透镜或爱因斯坦环，以及包含多个星系或星系特定部分特写的图像，如其核心或原子核，以便模型可以只专注于中心物体。我能负担得起的一些视觉变化包括星系相对于黑白图像的大小和颜色。*

*我从梅西耶星表下载了星系，并把它们分为两类:螺旋星系和椭圆星系。为了简化，我使用了 2 个类，但是在进一步的探索中，我想创建更多的类来表示螺旋和椭圆的细分。*

*对于训练，我将模型保持在默认的训练参数 50 个时期(意味着模型对所有样本数据工作 50 次)，由于我的样本数据集相对较小，所以批量大小为 16，学习率为 0.001。*

## *最大限度减少监督*

*虽然我已经知道用巨大的数据集训练模型会提高其准确性(为什么微软 ML 演示使用了 240，000 张 SDSS 图像)，但我很想知道最小化标记数据会如何影响模型预测的准确性。***有监督的学习模型随着对标记数据的更多访问而提高的速度有多快？****

*我从一个极端开始:对于每个类，我只上传了一个图像样本。我增加了每个类的图像样本，并记录了每个新星系的输出。*

*我将正确类别的每个预测的%置信度组织到下表中，其中在顶行读取 8 个测试图像，在前 2 列读取每个类别的图像样本。*

*![](img/db41b7bbe63be50df7b047b888cd662d.png)*

*Output for 8 galaxy inputs for each of 1–9 sample images per elliptical/spiral class*

*模型预测不正确(我定义为> 50%)的每个实例都用红色突出显示。此外，对于模型精度下降的每次迭代，预测都加下划线(即，模型在预测方面变得更差)。*

***我的发现摘要:***

*   *输入#1(椭圆星系 NGC 1600)的预测误差最大，精确度增加和减少之间的波动最大。*
*   *模型准确预测星系类型和/或随着更多样本不断改进的输入是#3 和#5(都是在不同波长拍摄的棒旋 NGC 1365)和#6(椭圆 NGC 3610)。*
*   *将第 3 个(M59 和 M58)和第 7 个(M89 和 M64)样本图像添加到每个类别中导致了模型中的大多数误差。*

***为什么会出现错误？***

*波动的一个原因是 NGC 1600 的图像没有被裁剪，因此相对于图像的大小，椭圆星系显得较小，可能使它看起来更像一个螺旋星系的核心。*

*训练数据与输入的相似程度在预测误差中起着作用，因为 M64 变暗了，所以它的旋臂模糊在一起，使它看起来是椭圆形的。颜色也有贡献，因为较少的颜色变化，包括黑白图像，往往会洗掉明显的旋臂。我注意到螺旋星系看起来越模糊，精确度就越低。这是因为星系的旋臂与其螺旋性质密切相关。*

*通过限制样本数据的数量，我有效地最小化了学习模型中的标记和人为监督，这导致了由于图像缩放、模糊或其他简单变化到严格椭圆或严格螺旋星系而产生的错误。后来我研究了当模型遇到不那么黑白分明的东西时会发生什么。*

*在此之后，我将梅西耶星表中剩余的星系图像添加到我的模型的样本数据中，期望模型的准确性大幅提高，特别是对于之前难以预测正确类别的输入——它做到了:*

*![](img/07160358f3b07b67ab1229fece0ca0b6.png)*

*The model’s predictions trained on sample data of 35 Messier Catalogue galaxies*

*监督学习模型超级强大，因为它们可以用相对较小的数据样本做出准确的预测！注意到所有的螺旋输入是如何被 100%正确分类的，我想知道为什么椭圆星系的预测略低。*

*![](img/e99e37e2c1df32f0a26f3b69ff40e50e.png)*

*The model with the full set of Messier catalogue galaxy images for samples*

*我的结论是:*

*   *我在螺旋训练课上的训练数据是在椭圆训练课上的两倍多。这仅仅意味着这个模型不太熟悉椭圆星系的样子。*
*   *经过一些研究，我发现椭圆星系 NGC 3610 很特别，因为在 1990 年，它被发现有一个圆盘，这通常是螺旋星系的特征。很可能我的模型在学习过程中也抽象出一个中心圆盘作为螺旋星系的特征，这将解释预测 NGC 3610 是椭圆星系的困惑和降低的信心。*

## *增加实际的星系变异*

*接下来，我想探索模型如何与新数据交互。我特别感兴趣的是这个模型将如何对透镜状星系进行分类(记住:透镜状星系被定义为螺旋星系和椭圆星系之间的中间物)。我用 M85 和车轮星系来测试这个。*

*![](img/051091307b726aa9266ceb1ce3b15c14.png)*

*Lenticular galaxies M85 (left) and Cartwheel Galaxy (right). Source: Hubble Space Telescope*

*m85 99%被归类为旋涡星系，车轮星系 100%被归类为旋涡星系。有趣的是，预测并没有接近 50–50，因为透镜状星系与螺旋星系和椭圆星系有着大致相同的特征。*

*实际上，星系的分类并不是黑与白，螺旋或椭圆，尽管哈勃有精心设计的分类方案。虽然用可教的机器探索很有趣，但真正的天文问题将需要一个更合适的无监督学习模型来解释星系真实图像的所有变化。*

# *关键要点*

*   *人工智能作为分类工具的力量来自监督学习和传统计算之间的区别:如果我们想要解释不规则性，传统计算就会变得乏味，而监督学习则允许计算机使用新数据进行高度可靠的预测。*
*   *哈勃分类是一种根据星系是椭圆形(看起来有点像鸡蛋)、螺旋形(旋臂)还是介于两者之间(我们称之为透镜状)来对星系进行分类的方法。*
*   *我使用谷歌的可教机器通过星系分类探索监督学习，用梅西耶目录中的样本数据训练我的模型。*
*   *一个潜在的未来研究项目是对星系进行分类的无监督机器学习模型。这样，不规则星系、矮星系和巨型椭圆星系就不局限于严格的类别。*

*下次你抬头看夜空时，不要觉得有必要在那里数星星。我们肉眼看不到的是数千亿个星系，它们的规模和复杂性令人惊叹，这是开始计数、分类或以其他方式了解的更大壮举。但这种学习是至关重要的，因为它深刻地塑造了我们对我们所生活的广阔宇宙的理解，并为我们指明了如何在这个构成我们广阔领域的无限小的星球上推进我们自己的生活的解决方案。*

**感谢阅读！欢迎并非常感谢掌声和反馈。请在 Medium 上关注我，获取更多类似的文章，并加入我的旅程，因为我使用新兴技术来改变世界。大家连上* [*LinkedIn*](https://www.linkedin.com/in/caitlyncoloma/) *或者发邮件给我(caitayc@gmail.com)，订阅我的* [*每月简讯*](https://mailchi.mp/f4a8169c9d09/caitayc-455229) *！**