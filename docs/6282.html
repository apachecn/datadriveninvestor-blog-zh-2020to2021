<html>
<head>
<title>How we increased our Machine Learning Pipeline efficiency at Mirrorr</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们如何提高Mirrorr的机器学习管道效率</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-we-increased-our-machine-learning-pipeline-efficiency-at-mirrorr-9d574b82613?source=collection_archive---------19-----------------------#2020-10-19">https://medium.datadriveninvestor.com/how-we-increased-our-machine-learning-pipeline-efficiency-at-mirrorr-9d574b82613?source=collection_archive---------19-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d121" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我想说我在这篇文章中陈述的所有方法和步骤并不一定是所有商业案例的最终解决方案。但至少对我们来说，这是最好的练习，在<a class="ae km" href="http://mirrorr.com/" rel="noopener ugc nofollow" target="_blank"><em class="kl">mirror</em></a><em class="kl">，就目前而言！因此，我建议所有读者考虑所有的管道障碍，如果他们错过了任何障碍，就加强他们的障碍，或者如果对他们的技术堆栈和商业模式来说方便的话，就尝试应用所有障碍。</em></p><p id="ca60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">需要提及的是，如果没有与</em><a class="kn ko ep" href="https://medium.com/u/d5eedac576f2?source=post_page-----9d574b82613--------------------------------" rel="noopener" target="_blank"><em class="kl">Tooploox</em></a><em class="kl">及其ML工程师</em><a class="kn ko ep" href="https://medium.com/u/2347898e52fb?source=post_page-----9d574b82613--------------------------------" rel="noopener" target="_blank"><em class="kl">Ivona taut kute</em></a><em class="kl">的持续成功合作，这项工作是无法完成的。</em></p><p id="0204" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Mirrorr是建立在机器学习基础上的产品，而不是以它为后盾。因此，我们准备的模型给出的结果是我们在应用程序中显示的所有报告的主要支柱。为了提供最终的解决方案，我们必须集中精力，尽最大努力完成这一部分。然而，这一点也不容易。我们经历了很多尝试和错误，我们做了很多没有产生任何有效结果的过程。直到我们到达“啊哈！”瞬间。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/7018d5ea211b9c74d6b1aacb779dc589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Sf_BZkbOQ2GqgjYYlEbzA.png"/></div></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lb"><img src="../Images/9f0d186c2cc4f7119276d15afcef2967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGZsKvEaBNhSXwVCLVHUwQ.png"/></div></div></figure><h2 id="b62e" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">背后的原因</h2><p id="fdaa" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">这种管道的创建来自于任何一个ML部门的数据科学家都会问的最基本的问题:</p><ul class=""><li id="a061" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">需要的数据量？</li><li id="dd07" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">需要培训时间吗？</li><li id="ed16" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">需要模型精度？</li></ul><p id="2b7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在旅途中，我们多次试图回答这些问题，但一次也没有给出正确的答案。那是在我们明白这不是回答这些问题之前。它是关于建立正确的过程，在没有任何人为干预或错误估计的情况下回答这些问题。</p><p id="1f2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们开始投资自动化几乎所有流程的地方:从数据收集、注释、数据准备等，直到模型评估和部署。构建这个自动化模块链消除了每个模块在技术方面的负担，并将我们的关注点转移到结果的质量以及如何改进它们上。</p><h2 id="67db" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">管道的不同部分</h2><p id="b5c7" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们的机器学习过程基于4个主要模块:数据标注、数据预处理、训练和部署。在Mirrorr，我们一直努力改进和关注的主要模型是徽标检测。它包括检测任何给定媒体材料(图像或视频)中的品牌标志。所需的数据是一个不确定的数量的图像，有/没有品牌标志。</p><p id="46a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将我们的云解决方案迁移到AWS极大地促进了这条管道的创建以及围绕它的所有自动化流程。</p><ul class=""><li id="e93c" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir">数据注释<br/> </strong>我们的品牌标志检测模型要求为我们服务的每个品牌准备一份经过良好注释的图片列表。这是我们必须考虑的第一步。手动操作是强制性的，尤其是在第一次引入品牌时，然而，在生产出模型的第一个测试版本后，我们重新设计了这个模块，并引入了“主动学习”流程。主动学习自动对beta模型预测得分高的图像进行标注，而将其他图像留给手动标注。<br/>有什么帮助？使用模型的第一个版本，我们注意到了一个小的改进和手工注释图像数量的少量减少。然而，当部署更好的版本时，该模型在检测品牌徽标方面变得更好，因此需要手动注释的图像数量呈指数级减少。</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mo"><img src="../Images/28c2c82299a96374b696f2d1b2a57615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0yj1E-yQ7rnbmchWOeeu2w.png"/></div></div></figure><ul class=""><li id="d70b" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir">数据预处理<br/> </strong>这是一个复杂的部分，因为它是根据每个机器学习案例的需求定制的。在我们的例子中，我们对图像应用了一些操作，以便为训练做准备。我们的目标是通过在每次完成后触发一个lambda函数来自动化这个模块的每一步。许多脚本是在SageMaker中创建的笔记本实例中编写的:数据扩充—因此我们增加了训练图像集，预处理脚本—创建CSV文件，然后创建TFrecords并将其存储到S3存储桶中。</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mo"><img src="../Images/879fece9c9b2faded6b5f840789d5c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uOVtgziq9ksgej1s55ikQw.png"/></div></div></figure><ul class=""><li id="9014" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">数据处理完成后，我们得到了启动培训工作所需的一切。SageMaker也有助于这一点，我们可以使用所需的预设算法或上传的算法来创建正确的训练作业。这总是比创建我们自己的实例、设置环境、处理访问权限和数据访问以及在我们必须执行的每个流程步骤中监控实例CPU使用情况要好。<br/>您可能需要一个第三方工具来评估实验，并做出正确的决定，即您需要为生产部署哪个模型，或者您需要执行哪些确切的更改，以便达到所需的最终精度。为此，我们使用了comet.ml，它快速、简单且易于实现。</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mp"><img src="../Images/22614df75e4bdf07717f1be9b818c832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8dnEJnn-U0zWeAfZU4x3gA.png"/></div></div></figure><ul class=""><li id="7fd5" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir">部署<br/> </strong>这是管道的最后一块。一旦我们对训练工作的结果感到满意，并且将模型工件存储在您的S3存储桶中，我们所要做的就是通过指定模型工件的正确路径，使用SageMaker服务创建一个模型。然后，当然，为部署的模型创建一个端点，最后创建一个Lambda函数，这样我们也可以将模型提供给在AWS中创建的API网关。</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/68a52fb526af68930f0db61404ec896b.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*CrAn1tfVWrAdocgGXLMuXA.png"/></div></figure><h2 id="b536" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">结论</h2><p id="cb31" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">正如我在引言中提到的，所描述的这条管道是目前在我们的ML工作中交付最快和最好结果的最佳实践。该管道实施的预期结果:</p><ul class=""><li id="3bba" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">减少与数据及其处理相关的手动和编程任务的时间/精力</li><li id="5944" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">模型准确性持续改进</li><li id="5e9d" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">机器学习流水线块中的独立性</li></ul><p id="0a7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然有很多需要改进的地方，一些流程也需要自动化，但是使用AWS提供的服务为我们节省了大量的计算时间，并且在正确的位置实现Lambda函数也将许多脚本转移到了无服务器状态。此外，虽然我们的目标是始终改进我们当前的徽标检测模型结果，但我们已经开始研究和训练其他领域的模型，如:上下文检测和人脸情感识别。</p></div></div>    
</body>
</html>