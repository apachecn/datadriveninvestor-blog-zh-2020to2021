<html>
<head>
<title>Sales Forecast Using Prophet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Prophet进行销售预测</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/sales-forecast-using-prophet-99bf9ad93fbc?source=collection_archive---------1-----------------------#2020-04-09">https://medium.datadriveninvestor.com/sales-forecast-using-prophet-99bf9ad93fbc?source=collection_archive---------1-----------------------#2020-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1aa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用脸书的预言家预测未来的销售。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/3467fa5357e9a81734c4daec943349bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*j4gneLdMCfrlCRw2.jpg"/></div></figure><p id="72a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个项目中，我们的目标是使用一家英国零售商提供的数据来展示我们如何利用数据科学解决方案来获得相对于其他企业的竞争优势。</p><p id="e8e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，这让我们对公司本身有了更多的了解，帮助我们更好地了解顾客、他们的习惯、产品等等。</p><p id="fe42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本项目所用的数据可以在<strong class="jp ir"> </strong> <a class="ae kt" href="https://www.kaggle.com/carrie1/ecommerce-data/kernels" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">这里找到</strong> </a>。</p><p id="be96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个项目分为三个部分。在这里，我们将研究:</p><ul class=""><li id="e749" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><strong class="jp ir">分析一段时间内的销售情况，以及使用Prophet进行销售预测。</strong></li><li id="faa8" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><a class="ae kt" href="https://medium.com/@rafaelnduarte/rfm-customer-segmentation-using-k-means-6fa5f72604c" rel="noopener"> <strong class="jp ir"> RFM客户细分用K-Means </strong> </a></li><li id="163c" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><a class="ae kt" href="https://medium.com/@rafaelnduarte/understanding-your-customers-with-nlp-929771ae2d0b" rel="noopener"> <strong class="jp ir">用NLP了解你的客户</strong> </a></li></ul><p id="ff3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开始吧！</p><h1 id="0d2d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">从这篇文章中可以期待什么？</h1><p id="695c" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">在这里，我将尝试简化项目的步骤，以便交付一个以结果为中心的方法。如果你想检查代码和整个项目，请查看这个<a class="ae kt" href="https://colab.research.google.com/drive/1jHJ0T7nWFHE1tH9Xh2xMNbjoL8vhls9q" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">链接</strong> </a>。</p><h1 id="2763" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">数据</h1><p id="9a74" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">如前所述，我们使用的是一家英国零售商的数据，可在Kaggle上获得。它包含了2010年到2011年的销售数据。尽管它不是最新的数据集，但它完成了工作，因为它帮助我们表明，即使只有8个功能，我们也可以创造巨大的价值。</p><div class="ml mm gp gr mn mo"><a href="https://www.datadriveninvestor.com/2019/01/23/which-is-more-promising-data-science-or-software-engineering/" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">数据科学和软件工程哪个更有前途？数据驱动的投资者</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">大约一个月前，当我坐在咖啡馆里为一个客户开发网站时，我发现了这个女人…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc kr mo"/></div></div></a></div><h1 id="d9c9" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">我们有什么数据？</h1><ul class=""><li id="7485" class="ku kv iq jp b jq mg ju mh jy nd kc ne kg nf kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">InvoiceDate</code> -购买的日期和时间。</li><li id="22ee" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">InvoiceNo</code> -发票识别号。</li><li id="d419" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">StockCode</code> -产品的库存代码。</li><li id="8a43" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">Description</code> -产品的简要描述。</li><li id="2e1c" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">Quantity</code> -购买的物品数量。</li><li id="edaf" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">UnitPrice</code> -给定产品的单位价格，单位为英镑。</li><li id="df79" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">CurtomerID</code> -进行购买的客户的ID。</li><li id="8a60" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><code class="fe ng nh ni nj b">Country</code> -购买的国家。</li></ul><h1 id="ccea" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">探索性数据分析</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/2440fc83154155cfec7783ca1fd727d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAqsAfqdNHqJq3gWUA83Xg.png"/></div></div></figure><p id="ad3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了使这篇文章更容易、更快地阅读，我不会在这里介绍关于数据清理、特征创建、准备和选择的所有细节，而是侧重于所研究的准备数据的最重要的方面和结果。</p><h2 id="2f06" class="np lj iq bd lk nq nr dn lo ns nt dp ls jy nu nv lw kc nw nx ma kg ny nz me oa bi translated">统计分布亮点</h2><p id="5cb0" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated"><code class="fe ng nh ni nj b">Price</code></p><ul class=""><li id="e529" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">最低价格是0，00，这意味着商店赠送一些物品。</li><li id="52f9" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">产品均价3，11。</li><li id="f630" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">最贵的单品要8.142，75。</li><li id="ea27" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">即使有昂贵的物品，但大多数都很便宜。</li></ul><p id="34dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ng nh ni nj b">Quantity</code></p><ul class=""><li id="da52" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">平均值实际上高于第75百分位，这表明大多数购买量都较大。数据来源说这家商店迎合批发商。即使这可以解释它，他们不是唯一的客户类型，因为平均不值得批发。</li></ul><p id="5d9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ng nh ni nj b">AmountSpent</code></p><ul class=""><li id="f412" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">在这方面，再次看到这种消费模式实际上是廉价的，真的很有趣。当然，我们还没有全部订单的数据，但人们不会在这些商品上花很多钱。</li></ul><h1 id="8248" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">畅销产品和国家</h1><p id="7e9e" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">同样，这一部分在我的另一篇文章 的<a class="ae kt" href="https://medium.com/@rafaelnduarte/understanding-your-customers-with-nlp-929771ae2d0b" rel="noopener"> <strong class="jp ir">中进行了充分的讨论，其中涵盖了使用<strong class="jp ir"> NLP </strong>来更好地了解我们的客户。在这里，你会看到一些最有趣的发现。</strong></a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ob"><img src="../Images/f90a5c773693113518492cc54f78dbd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TsEp5VY4FXbJB5ysnYylHw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Top-Selling Products</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi og"><img src="../Images/c17ea1b5b4f65deec8a6e3d9b6696c2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pr8-p3Ef6jfcpNzLep2tw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Top-Selling Countries</figcaption></figure><h2 id="f8ff" class="np lj iq bd lk nq nr dn lo ns nt dp ls jy nu nv lw kc nw nx ma kg ny nz me oa bi translated">分类特征的统计分布</h2><ul class=""><li id="0824" class="ku kv iq jp b jq mg ju mh jy nd kc ne kg nf kk kz la lb lc bi translated">这家公司向全球37个不同的国家销售产品。</li><li id="ff7a" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">同样，唯一发票号的数量与行数的对比表明，大多数发票都有很多产品，这再次强化了批发商的想法。</li><li id="6d69" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">作为一家总部位于英国的公司，它在英国的销量最大是有道理的。</li><li id="f7a2" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">他们有将近4000种不同的产品。</li></ul><h1 id="9a7c" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结论</h1><p id="4124" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">由于我们将致力于这项业务的不同方面，提供不同类型的分析，这不应是一个广泛的分析，而是对数据集的概述。</p><p id="9afe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kt" href="https://medium.com/@rafaelnduarte/understanding-your-customers-with-nlp-929771ae2d0b" rel="noopener"> <strong class="jp ir">在这里</strong> </a>我们可以看一看一些基本的<strong class="jp ir"> NLP </strong>探索，以便更好地了解产品和市场。</p><h1 id="658a" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">时间序列探索</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/5172c3094a1207bd6a4a4ff578a9e9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*IAf0odlUc-aSTmYDyoT2Aw.jpeg"/></div></figure><p id="c45e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在分析开始时看到的，我们在这里处理的是<strong class="jp ir">时间序列</strong>。</p><p id="01ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">时间序列是在一段固定的时间内记录的观察序列。</p><p id="147a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一件大事，因为我们及时衡量一切。在这种情况下，我们谈论的是一段时间内的销售额。</p><h1 id="4dcc" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">真正的商业应用</h1><p id="1650" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">我们使用的数据集来自一家英国零售商一段时间的销售额。在现实世界中，他们会将这些数据用于:</p><ul class=""><li id="8eb2" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">分析以前的时期，看看哪里出了问题(<strong class="jp ir">毕</strong>)</li><li id="1093" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">使用这些数据对未来进行预测(<strong class="jp ir">数据科学</strong>)</li></ul><p id="a93f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好的。但是这些预测有用吗？它们能保证什么吗？</p><p id="daad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它们不能保证任何事情，特别是因为我们没有分析外部因素，比如天气、灾难、火灾等等。然而，它们可以成为可靠的信息来源，有助于:</p><ul class=""><li id="386b" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">股票</li><li id="a050" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">新产品、销售等的商业策略。</li><li id="dd54" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">营销</li></ul><p id="1446" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有很多。</p><h1 id="3ca0" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">为机器学习准备数据</h1><p id="f8f4" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">我们需要为勘探准备数据。同样，要查看所有细节，请查看代码为 的<a class="ae kt" href="https://colab.research.google.com/drive/1jHJ0T7nWFHE1tH9Xh2xMNbjoL8vhls9q" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">完整项目。</strong></a></p><p id="735d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了使用<strong class="jp ir"> Prophet </strong>，脸书的时间序列机器学习模型，我们需要以非常特定的格式保存数据。</p><p id="12ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个非常健壮且使用起来相当简单的模型，当对正确的数据进行操作时，它的功能足够强大，即使很少甚至没有调整也能产生良好的结果。</p><p id="272e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">平稳时间序列</strong></p><p id="62f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当对时间序列进行预测时，人们通常会担心它们是否是平稳的。例如，与<strong class="jp ir"> ARIMA </strong>合作，拥有<strong class="jp ir">固定</strong>系列是<strong class="jp ir">必不可少的</strong>。</p><p id="2794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你会发现项目使用<strong class="jp ir"> Prophet </strong>的例子，甚至没有检查时间序列是否平稳。在这里，我们将首先对它进行处理，然后检查它是否是静止的，如果不是，我们将使它如此，然后再次训练模型以比较结果。</p><h2 id="cce9" class="np lj iq bd lk nq nr dn lo ns nt dp ls jy nu nv lw kc nw nx ma kg ny nz me oa bi translated">与先知一起工作</h2><p id="2163" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">Prophet需要一种非常特殊的数据框架来工作。我们需要的是:</p><ul class=""><li id="1de9" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">日期列为<code class="fe ng nh ni nj b">ds</code>。</li><li id="e97e" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">值列为<code class="fe ng nh ni nj b">y</code>。</li></ul><p id="f9ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们这样做吧。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi oh"><img src="../Images/125216a8980df3f392f7ffd8af3218b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*12zoN3ts2cSExqV_R8zF8w.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Data as is</figcaption></figure><p id="1af3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，在将数据放入Prophet需要的格式之前，我将数据分组为每日数据，而不是每小时的原始格式。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/1e6f3c86438eed06edb2a220d23f9e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*Tac_5HxcODu5lVGlrb-pQQ.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Daily Data</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/0c32b293fba6564de7cc75b1e5d0300c.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*ujW1ARSAVDYIbGta46GO5g.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Daily Data ready for Prophet</figcaption></figure><h2 id="6c4b" class="np lj iq bd lk nq nr dn lo ns nt dp ls jy nu nv lw kc nw nx ma kg ny nz me oa bi translated">静态测试</h2><p id="c2a9" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">如前所述，我们将分析使用<strong class="jp ir"> Prophet </strong>处理<strong class="jp ir">静态</strong>时间序列的影响。</p><p id="23bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们使用<a class="ae kt" href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">增强的Dickey-Fuller</strong></a><strong class="jp ir"/>测试(ADF)来检查我们的数据是否平稳。</p><pre class="km kn ko kp gt ok nj ol om aw on bi"><span id="ca70" class="np lj iq nj b gy oo op l oq or"><strong class="nj ir">from</strong> <strong class="nj ir">statsmodels.tsa.stattools</strong> <strong class="nj ir">import</strong> adfuller<br/><em class="os"># extracting values</em><br/>X = df_ts.y<br/><br/><em class="os"># apply ADF and print results</em><br/>result = adfuller(X)<br/>print('Augmented Dickey–Fuller')<br/>print('Statistical Test: <strong class="nj ir">{:.4f}</strong>'.format(result[0]))<br/>print('P Value: <strong class="nj ir">{:.10f}</strong>'.format(result[1]))<br/>print('Critical Values:')<br/><strong class="nj ir">for</strong> key, value <strong class="nj ir">in</strong> result[4].items():<br/>	print('<strong class="nj ir">\t{}</strong>: <strong class="nj ir">{:.4f}</strong>'.format(key, value))</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/8544b2dd536259ca317e33b63ec3d18f.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*HSd14l6XphKknezurJsuAQ.png"/></div></figure><p id="bb72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">答对了。我们的P值是0.57，这意味着我们的时间序列是<strong class="jp ir">而不是</strong>平稳的。</p><p id="91ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看Prophet是如何处理我们的基线的。</p><h1 id="eaa8" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用预言家做预测</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/a04f1a5d5b3def400db3778ab31c088f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*QoBKxzxxEBY5T5gSTS6O_w.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ou"><img src="../Images/15b5a62ff0ccd642e59e77512377cd27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FXJI2SB5XWencvKE1JWktA.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Non-stationary Forecast</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/0baf19b09bd86432ae03bde91a3e0a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*eEXHQj9is58B2HTLSX8_vw.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Non-stationary Components</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ow"><img src="../Images/6801937c13837eaf2f693f2e7ba65cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyFKeQiDppvCGRsj9oQZmg.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Visualizing the predictions over the actual values</figcaption></figure><p id="968b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些看起来都很棒，但是，我们怎么知道我们的预测是否准确呢？</p><p id="28a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们使用to指标进行评估:</p><ul class=""><li id="4204" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><a class="ae kt" href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">平均绝对百分比误差</strong> </a> —我们的预测值与实际值相差多少百分比。</li><li id="17f3" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><a class="ae kt" href="https://en.wikipedia.org/wiki/Mean_absolute_error" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">平均绝对误差</strong> </a> —预测值与实际值之间的绝对误差值。</li></ul><p id="0e7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在计算了MAPE和梅之后，我们得到了这些结果:</p><ul class=""><li id="8e20" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">MAPE:18.31</li><li id="cd9d" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">美:6253.81</li></ul><h1 id="0ebf" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">平稳时间序列</h1><p id="f83e" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">这是一个相当大的错误。我们不能把它作为可靠的信息来源。</p><p id="6781" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以做的一件事是尝试改进我们的结果，让我们的时间序列平稳，然后看看它会怎样。</p><p id="e465" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将通过使用一种叫做<strong class="jp ir">差分</strong>的技术来做到这一点。你可以在这里 了解更多关于这个方法的<a class="ae kt" href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">。</strong></a></p><p id="791f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">转换我们的数据并重新训练模型后，让我们检查结果:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ou"><img src="../Images/bab2301a2385fd947b4dcc059cd1bbf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qdPtLTU39-oarEqA5UH8Mw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Stationary Forecast</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/6466203b5eb1d82e13b89383dafc732d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*TU0QrtacUuPFOjYeO4QngA.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Stationary Components</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ox"><img src="../Images/4b886751d0b1772f6c173743637b3269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNwyfwnxxJ76QyzWBG1jMw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Visualizing the predictions over the actual values</figcaption></figure><p id="9423" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到图表之间的一些差异，但真正的差异来自结果。在使用平稳时间序列进行预测后，我们获得了以下结果。</p><ul class=""><li id="25af" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><strong class="jp ir"> MAPE </strong> : 1.85</li><li id="e907" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">平均相对误差 : 0.19</li></ul><h1 id="45fe" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结论</h1><p id="ff99" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">平均绝对百分比误差小于2%，平均绝对误差约为0.19，可以说我们已经创建了一个可以成为可靠信息源的模型。</p><p id="ef5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由此可见，对平稳数据进行预测是多么强大。</p><p id="467e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样重要的是，我们没有在模型中使用任何调整，这可以改善非平稳数据的结果。</p><p id="f4cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到，我们的数据往往低估了销售额，这并不坏，因为企业需要为最坏的情况做准备。</p><p id="6c0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们想要更乐观的预测，我们可以使用<code class="fe ng nh ni nj b">yhat_upper</code>而不是<code class="fe ng nh ni nj b">yhat</code>。</p><p id="4fbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于更保守的预测，我们可以使用<code class="fe ng nh ni nj b">yhat_lower</code>。</p><h1 id="0f78" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">谢谢大家！</h1><p id="ef29" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">感谢您的时间和关注。我希望这是一个信息丰富和有趣的项目。如果您有任何问题或任何类型的反馈，请随时在<a class="ae kt" href="https://www.linkedin.com/in/rafael-n-duarte/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> LinkedIn </strong> </a>上联系我，并在<a class="ae kt" href="https://github.com/rafaelnduarte/portfolio" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> GitHub </strong> </a>上查看我的其他项目。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi oy"><img src="../Images/d5a62aa48fe90968e2a3289f16fc304b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5V0bLVBwhrINM24jbpk6Dg.png"/></div></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oz pa l"/></div></figure></div></div>    
</body>
</html>