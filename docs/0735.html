<html>
<head>
<title>Nginx Server SSL Setup on AWS EC2 Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS EC2 Linux上的Nginx服务器SSL设置</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/nginx-server-ssl-setup-on-aws-ec2-linux-b6bb454e2ef2?source=collection_archive---------0-----------------------#2020-02-14">https://medium.datadriveninvestor.com/nginx-server-ssl-setup-on-aws-ec2-linux-b6bb454e2ef2?source=collection_archive---------0-----------------------#2020-02-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e46e23e48350eb30016442d3f5722d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H1fta8gX1zalGP2PeOkpOA.jpeg"/></div></div></figure><p id="b3bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我们将讨论如何使用SSL在<strong class="ka ir"> Nginx </strong>服务器中设置任何域。<strong class="ka ir"> Nginx </strong>可以处理大量的连接，<strong class="ka ir"> NGINX </strong>通常用作反向代理和负载平衡器来管理传入的流量，并将其分发到较慢的上游服务器。</p><div class="kw kx gp gr ky kz"><a href="https://www.datadriveninvestor.com/2019/03/25/a-programmers-guide-to-creating-an-eclectic-bookshelf/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">创建折衷书架的程序员指南|数据驱动的投资者</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">每个开发者都应该有一个书架。他的内阁中可能的文本集合是无数的，但不是每一个集合…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><p id="f604" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在开始之前，我假设这些点都准备好了。</p><blockquote class="lo lp lq"><p id="2ff6" class="jy jz lr ka b kb kc kd ke kf kg kh ki ls kk kl km lt ko kp kq lu ks kt ku kv ij bi translated">1.获得了一个域名。<br/> 2。为http连接打开了端口80。<br/> 3。为SSL或https连接打开了端口443。<br/> 4。获得了SSL证书。<br/> 5。已下载私钥、证书和捆绑文件。</p></blockquote><p id="9742" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一步:-连接你的服务器</strong></p><p id="db49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过<code class="fe lv lw lx ly b">ssh</code>命令将服务器连接到本地终端。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="c9f0" class="mh mi iq ly b gy mj mk l ml mm">$ ssh -i [key] ubuntu@[DNS]</span></pre><p id="857d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤2:-更新软件包</strong></p><p id="7e06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过<code class="fe lv lw lx ly b">update</code>命令更新所有包。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="2438" class="mh mi iq ly b gy mj mk l ml mm">$ sudo apt update</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/62e3d726dc5a38cf33bde0c0c9746daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHnn-ipxsl_u0pKKniFdOA.jpeg"/></div></div></figure><p id="33ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤3:-安装Nginx </strong></p><p id="91a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过下面的命令安装Nginx。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="2121" class="mh mi iq ly b gy mj mk l ml mm">$ sudo apt install nginx</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/ab6eb61b7e6f0213e0f7660e98057c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XPtAHNXAO5NNnXuT1xlEKA.jpeg"/></div></div></figure><p id="2b04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤4:-验证Nginx </strong></p><p id="6195" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您检查<strong class="ka ir">状态时。</strong>它应该<strong class="ka ir">激活</strong>，如果它没有激活，那么你必须通过下面的命令启动Nginx。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="e430" class="mh mi iq ly b gy mj mk l ml mm"><strong class="ly ir">Start Nginx:-</strong><br/>$ service nginx status</span><span id="709f" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Status Nginx:-<br/></strong>$ sudo service nginx start</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/327db139f09976622f515ef5b4fcf9b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ERxkHRx5oENFwvsXyonyCQ.jpeg"/></div></div></figure><p id="0351" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果状态是<strong class="ka ir">活动(运行)</strong>那么你可以通过Ip地址点击浏览器，你会在你的窗口上看到Nginx的默认页面。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/b27c65608b521ed73e3ba904b1694b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1U_kmhJW2dlLyAtcYjf3Mw.jpeg"/></div></div></figure><p id="3d53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，<strong class="ka ir"> Nginx </strong>已经成功安装并正常运行。</p><p id="ba34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤5:-保存密钥和证书</strong></p><p id="16fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，证书和私钥保存在你的服务器上的<code class="fe lv lw lx ly b">/etc/nginx/ssl</code>里。如果<code class="fe lv lw lx ly b"><strong class="ka ir">ssl</strong></code>文件夹不存在，则创建并保存文件。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/af5cecca51acabc5de0b67fec3d8d14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLLMJ1qLGjBkOlIyJ1LN7Q.jpeg"/></div></div></figure><p id="3a51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤6:-修改默认文件</strong></p><p id="5ce9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">转到<code class="fe lv lw lx ly b">/etc/nginx/site-available</code>，在默认文件中添加代码。这里<code class="fe lv lw lx ly b">/etc/nginx/site-available</code>默认文件和<code class="fe lv lw lx ly b">/etc/nginx/site-enable</code>默认文件是软连接的。如果您要更改<code class="fe lv lw lx ly b">site-available</code>默认文件的代码，那么<code class="fe lv lw lx ly b">site-enable</code>默认文件的代码会自动更改。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="c2d2" class="mh mi iq ly b gy mj mk l ml mm">server {<br/>       listen 80;<br/>       server_name example.com <a class="ae mt" href="http://www.z2psandbox.today" rel="noopener ugc nofollow" target="_blank">www.example.c</a>om;<br/>       return 301 <a class="ae mt" href="https://z2psandbox.today$request_uri" rel="noopener ugc nofollow" target="_blank">https://example.com$request_uri</a>;</span><span id="92c7" class="mh mi iq ly b gy mp mk l ml mm">}</span><span id="963e" class="mh mi iq ly b gy mp mk l ml mm">server {<br/>       listen 443 ssl;</span><span id="db93" class="mh mi iq ly b gy mp mk l ml mm">server_name example.com web.example.com;<br/>       <strong class="ly ir"># Certificate</strong><br/>       ssl_certificate /etc/nginx/ssl/cbe170b66b1f2233.crt;<br/>       <br/>       <strong class="ly ir"># Private Key</strong><br/>       <!-- -->ssl_certificate_key /etc/nginx/ssl/generated-private-key.key;<br/>       location / {<br/>               proxy_pass <a class="ae mt" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a>;<br/>               proxy_set_header Host $host;<br/>               proxy_set_header X-Real-IP $remote_addr;<br/>               proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br/>               proxy_set_header X-Forwarded-Proto $scheme;</span><span id="1959" class="mh mi iq ly b gy mp mk l ml mm">}<br/>}</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/a3f30b0a5243c9762a8cb875b36cc6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*aJ19LWkrMbBokjh5jAG9JA.jpeg"/></div></figure><p id="6214" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">核实这些变化是否有任何错误。您可以通过下面的命令进行检查。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="cc2a" class="mh mi iq ly b gy mj mk l ml mm"><strong class="ly ir">Test Nginx Configuration:-</strong></span><span id="df99" class="mh mi iq ly b gy mp mk l ml mm">$ service nginx configtest<br/>$ sudo nginx -t</span></pre><p id="1d06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe lv lw lx ly b">service nginx configtest</code>命令告诉你是否有错误。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/06fdc237173a6ccdf39439ca47e3ae45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mqd8vbUjEoUSH0iCZtRwrw.jpeg"/></div></div></figure><p id="c657" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe lv lw lx ly b">nginx -t</code>命令告诉我们哪里有什么错误。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/2e55befbfc79c3efeed20743b13ec5ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7idWjfdFvYyA2rE1Wlt95A.jpeg"/></div></div></figure><p id="0e71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">修复错误后，现在一切正常，然后你可以通过这些命令<strong class="ka ir">重启</strong>或<strong class="ka ir">重新加载</strong>你的服务器。</p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="40e8" class="mh mi iq ly b gy mj mk l ml mm"><strong class="ly ir">Restart Nginx:-<br/></strong>$ service nginx restart </span><span id="81d3" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Reload Nginx:-<br/></strong>$ service nginx reload </span><span id="9d71" class="mh mi iq ly b gy mp mk l ml mm">   OR</span><span id="2f51" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Start Nginx:-</strong><br/>$ service nginx status</span><span id="36ad" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Status Nginx:-<br/></strong>$ sudo service nginx start</span></pre><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/327db139f09976622f515ef5b4fcf9b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ERxkHRx5oENFwvsXyonyCQ.jpeg"/></div></div></figure><p id="5b0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第7步:-更改A记录</strong></p><p id="b18d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您应该必须更改<code class="fe lv lw lx ly b"><strong class="ka ir">A</strong></code>记录，因为A <strong class="ka ir">记录</strong>将域名映射到IP地址。去域名提供商那里，你的域名是可用的。如果它在<strong class="ka ir"> GoDaddy </strong>中，那么您应该在DNS设置中更改<strong class="ka ir"> A记录</strong>。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/0785592f1ed97f5ba2f1bcaa4fdd7791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BPukdg5QIWT88h-ImLaG5g.jpeg"/></div></div></figure><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/e5cb5ebedb3fc8a88dd96925f0de663c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITVB168SQaVK0gP2M8DCyQ.png"/></div></div></figure><p id="3504" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，您应该可以使用<code class="fe lv lw lx ly b">https</code>访问您的网站。</p><p id="3783" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">基本Nginx命令:- </strong></p><pre class="lz ma mb mc gt md ly me mf aw mg bi"><span id="95a9" class="mh mi iq ly b gy mj mk l ml mm"><strong class="ly ir">Start Nginx:- </strong></span><span id="4586" class="mh mi iq ly b gy mp mk l ml mm">$ sudo service nginx start <br/>$ sudo systemctl start nginx</span><span id="9d7e" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Stop Nginx:-</strong></span><span id="344c" class="mh mi iq ly b gy mp mk l ml mm">$ sudo service nginx stop <br/>$ sudo systemctl stop nginx</span><span id="f606" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Restart Nginx:-</strong></span><span id="6386" class="mh mi iq ly b gy mp mk l ml mm">$ service nginx restart <br/>$ systemctl restart nginx</span><span id="04e1" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Reload Nginx:-</strong></span><span id="0c4c" class="mh mi iq ly b gy mp mk l ml mm">$ service nginx reload <br/>$ systemctl reload nginx</span><span id="73c1" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Status Nginx:-</strong></span><span id="f53d" class="mh mi iq ly b gy mp mk l ml mm">$ service nginx status <br/>$ systemctl status nginx</span><span id="1533" class="mh mi iq ly b gy mp mk l ml mm"><strong class="ly ir">Test Nginx Configuration:-</strong></span><span id="c54b" class="mh mi iq ly b gy mp mk l ml mm">$ sudo nginx -t <br/>$ service nginx configtest</span></pre><p id="f9f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lr">保护您的服务器。</em>🤓</p><p id="24b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">欢迎在评论区提出任何问题或疑问，或者你可以在脸书上ping我。 </p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div></div>    
</body>
</html>