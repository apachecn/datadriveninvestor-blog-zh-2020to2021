<html>
<head>
<title>How to Create Animation using Matplotlib and Celluloid</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Matplotlib和赛璐珞创建动画</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-create-animation-using-matplotlib-and-celluloid-70533ba013e8?source=collection_archive---------0-----------------------#2021-01-03">https://medium.datadriveninvestor.com/how-to-create-animation-using-matplotlib-and-celluloid-70533ba013e8?source=collection_archive---------0-----------------------#2021-01-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a2c0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Python可视化</h2><div class=""/><div class=""><h2 id="bbd1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Matplotlib动画理解指南</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/18efd0e09d103ebadddc2270691d7cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6kDwoMHp4t3l2__I"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@eiskonen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hans Eiskonen</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7623" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated">一张图胜过千言万语意味着图形比许多文字更能有效地传达思想。动画或者视频怎么样？<a class="ae lh" href="https://en.wikipedia.org/wiki/Animation" rel="noopener ugc nofollow" target="_blank">动画</a>或视频由许多画面组成。当然，动画可以更有效地传递思想。下一个层次是模拟。动画和模拟的区别在于，无论我们是否播放和重放一个动画，我们都会得到相同的结果(就像看电影一样)，但它不同于模拟。当我们改变参数时，模拟可以产生不同的结果。在这个故事中，我只是覆盖动画和简单地创建动画，使用<a class="ae lh" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>和<a class="ae lh" href="https://pypi.org/project/celluloid/" rel="noopener ugc nofollow" target="_blank">赛璐珞</a>。</p><p id="c682" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在Matplotlib中创建动画可能需要复杂的代码。但是，结合Matplotlib和赛璐珞会给你一个令人兴奋的体验来创建动画。对我来说，这个程序不能应用于3D动画(仅2D动画)，因为我的笔记本被低估了(我的笔记本于2013年在:D发布)。如果你的笔记本足够好，你可以用它。如果你想用Matplotlib制作和我条件一样的3D动画，可以执行<a class="ae lh" href="https://medium.com/swlh/creating-3d-video-visualization-with-matplotlib-python-data-visualization-series-d8f5dfe1c460" rel="noopener">一个半手工的方法</a>。让我给你看我用Matplotlib创建的3D动画的例子。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mn"><img src="../Images/c68cf2c2bd9691ffac1a207806a7f6b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3-0mxNvaHrJKlqG5XO0fuQ.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">3D animation with Matplotlib (<em class="mo">Image by Author </em>/ Rizky MN).</figcaption></figure><p id="cecf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是我们在这个故事中想要创作的2D动画</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mp"><img src="../Images/9e7a1aa4d997a9f0ac5baecc006b5d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*th8tpvpOT0r3hMtOf_tUTA.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">2D animation with Matplotlib and Celluloid (<em class="mo">Image by Author </em>/ Rizky MN).</figcaption></figure><p id="a886" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您需要安装Matplotlib和赛璐珞，使用以下语法</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="fb85" class="mv mw it mr b gy mx my l mz na">pip install matplotlib<br/>pip install celluloid</span></pre><p id="c334" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">之后，导入一些模块，如下面的代码所示</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="24d9" class="mv mw it mr b gy mx my l mz na">import numpy as np<br/>import matplotlib.pyplot as plt<br/>from celluloid import Camera<br/>from IPython.display import HTML</span></pre><p id="ba07" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们希望将正弦函数做成动画，所以用下面的代码创建模拟数据</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="cd61" class="mv mw it mr b gy mx my l mz na">x = np.linspace(0, 10, 500)<br/>y = np.sin(x)</span></pre><p id="257c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们创建500个从0到10的数字作为<strong class="lk jd"> <em class="nb"> x </em> </strong>变量和<strong class="lk jd"> <em class="nb"> y </em> </strong>作为每个sin的值(x)。这里是<strong class="lk jd"> <em class="nb"> x </em> </strong>和<strong class="lk jd"> <em class="nb"> y </em> </strong>的线条图，如图1所示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/81f3072f4ace845e9d5f8d834b73ca9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LiP3T5g0ZFR1HvBFik9Bw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Figure 1. Line plot of <strong class="bd nd"><em class="mo">y</em></strong> as a function of <strong class="bd nd"><em class="mo">x </em></strong>(<em class="mo">Image by Author </em>/ Rizky MN).</figcaption></figure><p id="2c30" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们要为每个<strong class="lk jd"> <em class="nb"> x </em> </strong>数据点创建500张图片，并按一定时间顺序展示，比如每张图片10毫秒。为了捕捉每一张照片，我们需要一台赛璐珞相机。你可以用这个代码。</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="90c1" class="mv mw it mr b gy mx my l mz na">fig = plt.figure(dpi = 300)<br/>camera = Camera(fig)</span><span id="0ab1" class="mv mw it mr b gy ne my l mz na">for i in range(len(x)):<br/>    plt.plot(x[:i], y[:i], c = 'royalblue')<br/>    camera.snap()</span></pre><p id="8222" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的代码会捕捉到<strong class="lk jd"> <em class="nb"> x </em> </strong>和<strong class="lk jd"> <em class="nb"> y </em> </strong>的每一个线条图，并保存在名为<strong class="lk jd"> <em class="nb"> camera </em> </strong>的变量中。如果您运行Jupyter笔记本代码，您将只得到一张图片，与图1相同。</p><p id="6aeb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要在<strong class="lk jd"> <em class="nb">相机</em> </strong>中采集每张图片，可以使用下面的代码</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="f4f7" class="mv mw it mr b gy mx my l mz na">animation = camera.animate(blit=False, interval=10)</span></pre><p id="84d8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">代码将生成一个变量<strong class="lk jd"> <em class="nb"> camera </em> </strong>的动画，两个图片之间的间隔为10毫秒，并且没有用于过渡的blit。你可以尝试不同的习惯，比如打开blit并设置不同的时间间隔。</p><p id="a8d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你想在Jupyter Notebook中观看你创建的动画，你可以使用这个代码来显示它。</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="5adc" class="mv mw it mr b gy mx my l mz na">HTML(animation.to_html5_video())</span></pre><p id="ff9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你不使用Jupyter也没关系。您可以使用这段代码保存动画，而不用在Jupyter中观看它。</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="a313" class="mv mw it mr b gy mx my l mz na">animation.save('animation_sin.mp4',<br/>               dpi=300,<br/>               savefig_kwargs={<br/>                   'frameon': False,<br/>                   'pad_inches': 'tight'<br/>               }<br/>              )</span></pre><p id="c8f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们保存动画的名称为<strong class="lk jd"><em class="nb">animation _ sin . MP4</em></strong>，每英寸300点(dpi)，没有帧，并设置垫为“紧”。让我展示一下保存动画的结果。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="4fb1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你想把它转换成。gif，你可以使用在线转换器或使用ffmpeg。</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="012d" class="mv mw it mr b gy mx my l mz na">ffmpeg -i animation_sin.mp4 -filter:v fps=fps=30 animation_sin.gif</span></pre><p id="ed50" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">代码会将<strong class="lk jd"><em class="nb">animation _ sin . MP4</em></strong>转换为<strong class="lk jd"><em class="nb">animation _ sin . gif</em></strong>，每秒帧数设置为30。如果你没有安装ffmpeg，你可以通过终端用这个代码安装。</p><pre class="ks kt ku kv gt mq mr ms mt aw mu bi"><span id="efcf" class="mv mw it mr b gy mx my l mz na">sudo apt update<br/>sudo apt install ffmpeg</span></pre><h2 id="2e0a" class="mv mw it bd nd nh ni dn nj nk nl dp nm lr nn no np lv nq nr ns lz nt nu nv iz bi translated">结论</h2><p id="d422" class="pw-post-body-paragraph li lj it lk b ll nw kd ln lo nx kg lq lr ny lt lu lv nz lx ly lz oa mb mc md im bi translated">使用Matplotlib和赛璐珞，我们可以轻松地创建动画。但是它需要一件合适的设备来进行3D创作。使用的概念是将许多图片堆叠成一张。希望这个故事对你有用，遇到一些问题可以留下回应。谢了。</p><div class="ob oc gp gr od oe"><a href="https://www.datadriveninvestor.com/2020/12/01/how-to-build-a-twitter-scraping-app-with-python/" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd jd gy z fp oj fr fs ok fu fw jc bi translated">如何用Python |数据驱动投资者构建Twitter抓取应用</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">每秒发出约6000条推文，每天发布5亿条推文，普通人甚至不能…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="on l"><div class="oo l op oq or on os lb oe"/></div></div></a></div><p id="e5a8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">访问专家视图— </strong> <a class="ae lh" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>