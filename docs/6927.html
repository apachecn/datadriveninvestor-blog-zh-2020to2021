<html>
<head>
<title>A Dual Heterogeneous Graph Attention Network to Improve Long-Tail Performance for Shop Search in E-Commerce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提高电子商务商店搜索长尾性能的双异质图注意网络</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/a-dual-heterogeneous-graph-attention-network-to-improve-long-tail-performance-for-shop-search-in-775abbe91baa?source=collection_archive---------12-----------------------#2020-11-16">https://medium.datadriveninvestor.com/a-dual-heterogeneous-graph-attention-network-to-improve-long-tail-performance-for-shop-search-in-775abbe91baa?source=collection_archive---------12-----------------------#2020-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/97154d5d7324e21dc30db290c6c8ac99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*a4yHOFgWqJuTaSJW.png"/></div></figure><p id="0f88" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ks">下载“</em><a class="ae kt" href="https://resource.alibabacloud.com/whitepaper/cloud-knowledge-discovery-on-kdd-papers_2592" rel="noopener ugc nofollow" target="_blank"><em class="ks">【KDD论文云知识发现】</em> </a> <em class="ks">”白皮书，探索12篇KDD论文和12位阿里巴巴专家的知识发现。</em></p><p id="a382" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ks">由牛淅川、、、、孙浩川、邓洪波、陈</em></p><h1 id="c924" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">背景</h1><p id="3445" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">店铺搜索是中国最大的电子商务平台淘宝提供的一项重要服务。淘宝目前有近1000万个店铺，包括几百万个7天活跃店铺。商店搜索场景每天注册数千万用户视图(uv)和数亿gvm。</p><p id="b940" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以点击下图所示的选项卡，在其PC客户端或移动客户端使用淘宝的店铺搜索功能。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lx"><img src="../Images/6e37b952fb565e1c00487b3385a3ae77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vUKF00ZkO5SthtTu.png"/></div></div></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/1a7928ae560919c9f85a01c759578770.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/0*gkF07qtudvkBLxdq.png"/></div></figure><p id="3a22" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在淘宝平台上，绝大多数的曝光都是针对经常被搜索的查询、商品或店铺，这就导致了长尾效应。下图显示了查询和商店的搜索频率及其排名之间的关系。y轴显示每日查询页面浏览量(qpv)或商店页面浏览量(SPV)的数量，x轴显示查询或商店的排名。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mh"><img src="../Images/304f0bad05994cf35f163172b7842bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YM0NpbpqRcc4YEsy.png"/></div></div></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mi"><img src="../Images/5370869a84b59df6e78a7a77fce147bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DtdCkORw7TNiYgg7.png"/></div></div></figure><p id="6f6a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们为长尾查询和与查询高度相关的长尾商店构建了一个双重异构图注意力网络(DHGAN)。DHGAN被设计为专注地采用查询和商店的异构和同构邻居来增强它们自身的矢量化表示，这有助于缓解长尾现象。</p><h1 id="0dc7" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">直觉</h1><p id="b4b2" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">为什么异质信息可以改善长尾效应？我们在训练和预测过程中发现了以下例子。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mj"><img src="../Images/239db06173b3359b74fa76a532acca80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IpxP3Mz-81HjIa-l.png"/></div></div></figure><p id="3f07" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在上图中，用户搜索的查询和目标商店没有在训练数据中同时出现，它们的语义也没有关联。然而，它们可以通过使用查询商品和商品商店嵌入来关联。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mj"><img src="../Images/3eb8819ff508f49a8ac12a5ff0590def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DeyoGZhFLGnkHL0Z.png"/></div></div></figure><p id="4254" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是一个更复杂的例子。上图中的查询和目标商店在定型数据中并不同时出现，但是可以使用异类信息将它们关联起来。</p><p id="e5d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在前面的例子中，NCF基线本身不会导致预测成功，但下面描述的DHGAN模型会。</p><h1 id="641e" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">异构图构造</h1><p id="860e" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">我们将商店搜索场景中的查询、商店和商品节点结合起来，形成异构边缘。</p><p id="c2eb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">例如，query2query关系连接到同一商店中的一个查询，而shop2item关系连接到商店中的一个商品。下图显示了详细数据。具体来说,“边”列显示异构边的总数，而“加权边”列表示聚合级重复数据消除后异构边的总数。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/e08d2e5628eef36e5dfbf9beafeb5e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*fob5aDcqr5xu5Qco.png"/></div></figure><h1 id="71f4" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">条款</h1><p id="9f9c" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated"><strong class="jw ir">异构图:</strong>具有多种类型的节点和多条边关系的图结构。异构图的对应物是只包含一种类型的节点和边的同构图。</p><p id="b4a0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">图形神经网络(GNN): </strong>将神经网络应用于不规则图形结构的一类算法。gnn主要应用于学习图节点的语义向量，然后将学习到的节点表示应用于下游任务，例如节点分类和链接预测。</p><p id="3166" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">注意力机制:</strong>模仿人类注意力的计算系统，广泛应用于自然语言处理和计算机视觉。注意机制的核心目标是从海量信息中选择对当前任务目标更为关键的信息。</p><h1 id="0816" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">模型概述</h1><p id="1eb4" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">我们提出<strong class="jw ir"> DHGAN </strong>来解决长尾问题。该模型首先基于用户在商店搜索和商品搜索中的行为日志构建异构图网络，然后在异构图中挖掘和使用查询或商店的同构和异构邻居。该模型使用这些邻居来增强查询和商店的矢量化表示，然后迁移项目搜索中的知识和数据，以在项目标题的帮助下弥合用户搜索的查询和商店名称之间的文本语义鸿沟。最后，该模型引入用户特征来个性化搜索召回结果。</p><h1 id="1781" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">模型细节</h1><h2 id="808e" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">总体框架</h2><p id="48b0" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">模型的整体框架是双塔架构，如下图所示。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c5c1329dbc643b1935efc95882c6e0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/0*orCO99zBlLkDFauB.png"/></div></figure><p id="c53c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">左侧的输入是用户和查询，包括同类和异类邻居，以及项目搜索中已售出项目标题后的信息。DHGAN和来自产品搜索(TKPS)模块的知识转移将数据聚集到一个向量中。(有关更多信息，请参见下一节。)右边的输入是商店。与查询信息类似，DHGAN和TKPS模块将商店信息聚合到一个向量中。最后，相关性通过双塔架构顶部的向量的内积来测量，并作为向商店召回分配权重的基础。</p><h2 id="b056" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">DHGAN模块</h2><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/460c78553555358b9d9ecccbf7db003d.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/0*TDO0gpCcnmUTRcFz.png"/></div></figure><p id="972f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">DHGAN模块采用查询和商店的异构和同构邻居来增强自身的矢量化表示，如上图所示。</p><p id="2ec7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以一个用户查询为例。我们首先挖掘它的同构邻居(查询邻居)和异构邻居(商店邻居)。然后，我们使用作用于两类邻居的注意力网络图层图来融合信息。第一层注意网分别融合同质信息和异质信息。具体来说，同质信息由注意力网络直接融合，而异质信息由异质邻居变换矩阵(HNTM)处理，该矩阵将查询映射到商店的向量空间。注意力网络的第二层进一步融合同质和异质信息，最终通过使用同质和异质邻居来增强矢量化表示。作用于商店的层图的注意网与作用于查询的注意网完全相同，只是它们的网络参数不同。</p><h2 id="4710" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">TKPS模块</h2><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mz"><img src="../Images/93481d690e2e401d88394d733aa03270.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/0*m2vLIH_w4Ky8OHVz.png"/></div></div></figure><p id="c354" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如上图所示，我们以用户查询为例，首先迁移项目搜索中的知识。也就是说，我们在基于同一查询的项目搜索中使用项目邻居标题，然后对目标查询文本和项目邻居标题进行矢量化。通过使用汇集操作来获得矢量化表示。最后，我们聚合项目邻居标题，将其与查询连接，并转换它以获得查询的增强文本矢量化表示。在商店的情况下，我们利用商店中的项目文本信息来增强商店的文本矢量化表示。</p><h2 id="e493" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">损失的定义</h2><p id="13af" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">我们模型的基本损失是传统的交叉熵，定义如下。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/5aa0673156ddb1588ae39700a1c8c6af.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/0*Jc1j3EXRHdNotvcq.png"/></div></figure><p id="fa21" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">直观上，查询和商店邻居节点应该与查询和商店相似。因此，除了交叉熵，我们还定义了邻居邻近损失，如下式所示。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/e3268b0aad08fbf02a14662617b6eff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/0*4vx6jViX7Dj59wrI.png"/></div></figure><p id="3249" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">其中，h_i为当前节点，h_j为h_i的邻居节点，作为正样本，h_k为随机采样节点，作为负样本。</p><p id="19bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">模型的最终损失是正则化后两个损失值的结果。惩罚分别由α和λ参数控制。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/4719833868bae59451df513016b3a63e.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/0*H3SJZLl4EueJORye.png"/></div></figure><h1 id="6776" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">离线预测</h1><h2 id="4d46" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">离线数据集构建</h2><p id="15a4" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">为了展示DHGAN模型在优化长尾查询和商店方面的优势，除了测试所有测试数据之外，我们还构建了两个特殊的数据集，即硬数据集和长尾数据集。硬数据集包含未出现在训练数据中的查询-商店对，长尾数据集包含仅在训练数据集中出现一次的查询和商店。下图显示了详细的数据集统计信息。交互列指示训练和测试数据中正面记录的数量，查询、商店、项目和用户列指示训练和测试数据中相应数据记录的数量。请注意，在测试过程中没有使用项目数据，以避免特性遍历问题。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nd"><img src="../Images/6be11ead254208b38b8c78f50da2b3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TQcS2Evw13yf4jz4.png"/></div></div></figure><h2 id="f1e5" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">总性能</h2><p id="e259" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">我们使用了11种类型的基线进行比较，并测试了添加和不添加(DHGAN_{NP})个性化信息的DHGAN版本。最终结果如下。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ne"><img src="../Images/a67c8c8a084693d9e56cd1f9530b281e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4qxzpyv006PC4lyw.png"/></div></div></figure><p id="ce6d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">可以看出，DHGAN模型在所有测试中的指标上提高了1%，在侧重于优化的硬模型和长尾模型的指标上提高了4%到8%。</p><h2 id="e0ae" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">聚变实验</h2><p id="37ec" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">下图中，w/o homo表示删除query2query和shop2shop数据，这里的w/o表示删除query2shop和shop2query数据，w/o item表示删除query2item和shop2item数据。如图所示，不同类型的异质信息都提高了模型的性能，异质项目信息的提高最为显著。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3c3adcad4e6953386d3322fc7b784ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/0*5vG6lNMNWSt_RbnL.png"/></div></figure><h2 id="e8ed" class="ml kv iq bd kw mm mn dn la mo mp dp le kf mq mr li kj ms mt lm kn mu mv lq mw bi translated">超参数分析</h2><p id="1e34" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">我们还分析了邻居计数和丢失权重α。如下图所示，需要调整这两个参数以提供最佳性能。模型的最终邻居计数设置为6，α设置为0.001。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ng"><img src="../Images/12ef9c8ea54e221ffc09afc16e945b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aREoVGC38GD5D03X.png"/></div></div></figure><h1 id="7b04" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">摘要</h1><p id="d9a4" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">淘宝店铺搜索召回面临长尾和语义鸿沟问题的挑战。为了解决这些问题，我们在商店搜索召回场景中补充了DHGAN模型的语义，以获得更好的性能。目前，模型的用户端只包含概要信息。未来，我们将在模型中引入用户项目和用户商店等异构信息，以提高模型的性能。</p><p id="f0e4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ks">本文观点仅供参考，不一定代表阿里云官方观点。</em></p><h1 id="b172" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">原始来源:</h1><div class="nh ni gp gr nj nk"><a href="https://www.alibabacloud.com/blog/a-dual-heterogeneous-graph-attention-network-to-improve-long-tail-performance-for-shop-search-in-e-commerce_596750" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">一个双异质图注意网络来改善商店搜索的长尾性能…</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">Alibaba Clouder年10月15日178下载《KDD论文中的云知识发现》白皮书，探索12…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">www.alibabacloud.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny js nk"/></div></div></a></div></div></div>    
</body>
</html>