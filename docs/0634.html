<html>
<head>
<title>Data Augmentation Techniques in Deep Learning.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习中的数据增强技术。</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/data-augmentation-techniques-in-deep-learning-d78c59be8ea5?source=collection_archive---------1-----------------------#2020-02-09">https://medium.datadriveninvestor.com/data-augmentation-techniques-in-deep-learning-d78c59be8ea5?source=collection_archive---------1-----------------------#2020-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/348f0552d85a3ebac581938bbc7de64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8BN-jCiS3DLt00pH2EQiqw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by Kaboompics .com from Pexels</figcaption></figure><p id="3aeb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最近八个月一直在练习机器学习(主要是深度学习)，作为硕士论文的一部分。在那段时间里，medium.com和towardsdatascience.com帮助我更好地理解事情。许多人建议我在学习的同时写一些关于medium.com的东西，我也认为分享我所学到的东西会很好！。</p><p id="d3c7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这是我的第一篇文章。</p><p id="772d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi ld translated">在我的论文中，我主要研究图像数据。有时我收集并准备它们，但有时我会从网站上下载图像数据集。当您这样做时，数据集可能会有许多问题，如缺乏对比度、可变分辨率和类不平衡。</p><p id="9e92" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在深度神经网络架构中，我们首先基于我们要解决的问题构建一个深度架构。对于一个典型的图像分类问题，可能是基于卷积神经网络的架构。在构建架构或模型之后，我们将一部分可用数据(训练数据)应用于模型。这个过程称为训练，在这个过程中，模型学习数据分布、数据模式等。在此之后，该模型能够根据它从训练图像中学到的东西对看不见的图像进行分类。但是，对于从训练图像中学习的模型，图像数据集应该满足某些条件，如果不满足，我们必须在将其应用于模型进行训练之前进行大量的数据预处理。</p><div class="lm ln gp gr lo lp"><a href="https://www.datadriveninvestor.com/2019/01/23/deep-learning-explained-in-7-steps/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd iu gy z fp lu fr fs lv fu fw is bi translated">深度学习用7个步骤解释-更新|数据驱动的投资者</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">在深度学习的帮助下，自动驾驶汽车、Alexa、医学成像-小工具正在我们周围变得超级智能…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md jz lp"/></div></div></a></div><p id="0bd4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用传统的图像处理技术解决了像低对比度、低分辨率这样的问题。深度神经网络在从低对比度图像中推断知识方面存在局限性，因此使用图像增强技术，如<em class="me">直方图均衡化</em>、<em class="me">自适应直方图均衡化(AHE) </em>，以及<em class="me">对比度受限AHE (CLAHE) </em>等高级技术来解决这个问题。但是，最具挑战性和最有趣的是阶级不平衡问题。</p><h1 id="fab2" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated"><strong class="ak">阶层失衡！</strong></h1><p id="021a" class="pw-post-body-paragraph kf kg it kh b ki nd kk kl km ne ko kp kq nf ks kt ku ng kw kx ky nh la lb lc im bi translated">类别不平衡或类别偏差意味着样本在类别间的不平等分布。对于二元分类数据集(只有两个类，比如正类和负类)，如狗对猫数据集，当每个类中的样本数量不相等或不大致相等时，会出现类偏移。两个类中的样本数量应该几乎相等，以便模型可以无任何偏差地学习。但是，实际上，第一类中的样本数量可能少于/多于第二类中的样本数量。在这种情况下，我们的模型将学习样本数量更多的类，而不是样本数量较少的类。那么我们最终将得到一个有偏差的模型，该模型在样本较少的情况下对一个类的表现/预测比另一个类好。</p><p id="6f04" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个问题不仅出现在图像数据集中，也出现在任何类型的数据集中。它可以是类似垃圾邮件分类器数据集的表格数据，其样本属于两个类别，垃圾邮件/伪造和原始。在类别不平衡的情况下，数据集在垃圾邮件类别中可能有数千个样本，而在原始电子邮件类别中只有数百个样本。有了这样的数据集，没有机器学习算法能学得更好。使用重采样、SMOTE等技术来克服这一限制。</p><h1 id="5539" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated">重新取样</h1><p id="884f" class="pw-post-body-paragraph kf kg it kh b ki nd kk kl km ne ko kp kq nf ks kt ku ng kw kx ky nh la lb lc im bi translated">重采样是解决表格数据中的类偏差问题的最直接的技术/思想。这里，我们对可用数据进行<strong class="kh iu">欠采样</strong>或<strong class="kh iu">过采样</strong>，以满足等类别分布的要求。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/85a85931635f34bbae3c8bce87369826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H6XodlitlGDl9YdbwaZLMw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Image from Kaggle.com</figcaption></figure><p id="80b9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">假设我们有一个包含两个类的数据集，第一个类包含总样本数的95 %,剩下的5 %归第二个类(很不平衡！！).对于欠采样，我们欠采样最大的类，以使样本数等于最小类中的样本数，如上图所示。也就是说，我们随机删除最大类的一些数据样本/观察值。但是这个过程会导致信息的丢失，因为我们只是简单地避开了各种各样的样本。如果多数类已经有某种数据冗余，那么删除冗余样本不会导致太多的信息损失。</p><p id="8468" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在过采样中，我们一次又一次地对少数类进行采样，直到它等于多数类中的样本数。在这里，通过增加样本，我们正在向少数类引入冗余！。</p><p id="3cf3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们现在可以编写一个说明这些技术的例子。</p><p id="afb5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">首先，我们创建一个具有类偏斜的合成数据集。让我们使用<em class="me"> Keras库的<em class="me">数据集模块</em>创建一个。</em></p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="09d5" class="ns mg it no b gy nt nu l nv nw">from sklearn.datasets import make_classification #Import library  </span></pre><p id="00ae" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">创建包含1000个样本的数据集，其中95%属于类0，其余5%属于类1。</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="f34e" class="ns mg it no b gy nt nu l nv nw">nb_samples = 1000  #Total number of samples.<br/>weights = (0.95, 0.05)  #Percentage of split<br/>X, y = make_classification(n_samples = nb_samples, n_features = 2, n_redundant = 0, weights = weights, random_state = 1000)</span></pre><p id="3c92" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，我们有了包含1000个样本的合成数据集，包含两个类和两个特征。0班95%，1班5%。</p><p id="79e7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后，我们可以重新采样，以获得一个平衡的数据集。</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="f08f" class="ns mg it no b gy nt nu l nv nw"># Re-sampling process<br/>import numpy as np<br/>from sklearn.utils import resample<br/>X_1_resampled = resample(X[y == 1], n_samples = X[y == 0].shape[0], random_state = 1000) #Up-smapling </span><span id="373c" class="ns mg it no b gy nx nu l nv nw">#Conacatenate to get up-sampled Xu and yu.<br/>Xu = np.concatenate ((X[y == 0], X_1_resampled))<br/>yu = np.concatenate ((y[y == 0], np.ones(shape = (X[y ==0].shape[0]), dtype = np.int32)))</span></pre><p id="fd92" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最后，我们在类0 (Xu[y == 0])和类1 (Xu[y == 1])中有相同数量的样本。</p><h1 id="d82a" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated"><strong class="ak">重击</strong></h1><p id="9a91" class="pw-post-body-paragraph kf kg it kh b ki nd kk kl km ne ko kp kq nf ks kt ku ng kw kx ky nh la lb lc im bi translated">SMOTE(合成少数过采样技术)是另一种解决类偏移问题的巧妙方法。与重采样技术不同，这里不重复使用可用数据，而是使用类似邻域的方法生成新的合成数据样本。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/31cba5d616fe048624db6fdd1df574e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*fvY3riBeDtisVa76fuWrnw.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Image from the internet.</figcaption></figure><p id="c094" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">SMOTE使用样本之间的关系来创建新的合成样本，如最近邻样本。</p><p id="2afc" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">新的合成样本被放置在连接来自少数类的相邻样本的线上。样本的属性在某个邻域半径以下不会改变，因此它可以创建属于同一原始分布的样本。与带有替换的重采样相反，新的数据集将具有更高的方差，并且合适的分类器可以更好地找到更好的分离超曲面。SMOTE有80多种专门为各种类型的数据设计的变体，sci-kit learn的imblearn库提供了所有功能。</p><p id="9c79" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，让我们来解决这个问题。</p><p id="109c" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们可以使用前一个数据中相同的不平衡数据(X，y)来获得求解的数据集。</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="9095" class="ns mg it no b gy nt nu l nv nw">#SMOTE<br/>from imblearn.over_sampling import SMOTE<br/>smote = SMOTE(random_state = 1000)<br/>X_resampled, y_resampled = smote.fit_sample(X, y)</span></pre><h1 id="2cdf" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated"><strong class="ak">图像数据集中的类别倾斜</strong></h1><p id="e8d0" class="pw-post-body-paragraph kf kg it kh b ki nd kk kl km ne ko kp kq nf ks kt ku ng kw kx ky nh la lb lc im bi translated">我最近参考了名为GTSRB(德国交通标志识别基准)的图像数据集，该数据集包含43种不同类别/类型的交通标志。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/bb01be44857811ad7893dcac82f750cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vjqeT_j_RcNL5nR2RVg8cQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">43 different types of sign classes in the GTSRB dataset. (Image from internet)</figcaption></figure><p id="aea6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但是，一些类包含更多的2010图像，而其他一些类包含210图像，如下所示。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/09c6c40bef0c0649f88ccb8e8a8fd1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fExw06g3suIjbEKZD92sOg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Class skew in the GTSRB dataset. (image from <a class="ae ob" href="https://medium.com/@thomastracey/recognizing-traffic-signs-with-cnns-23a4ac66f7a7" rel="noopener">here</a>)</figcaption></figure><p id="cc4b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在影像数据集的情况下，解决类倾斜并不容易。我们需要找到一些有效的技术，而不是重新采样等。</p><p id="d521" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">图像数据增强是解决这一问题的一种方法。</p><p id="31dc" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在图像数据扩充中，我们从可用图像中提取一幅图像，应用一些变换技术，如右移、左移和缩放。在此过程中，创建训练数据集中与原始图像属于同一类的图像的变换版本。</p><p id="1af5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">应谨慎选择转换，否则数据集可能会出局。例如，水平翻转猫的照片可能是有意义的，因为照片可能是从左边或右边拍摄的。垂直翻转猫的照片没有意义，并且可能不合适，因为模型不太可能看到颠倒的猫的照片。因此，必须在训练数据集和问题领域知识的背景下，仔细选择用于训练数据集的特定数据扩充技术。</p><p id="2924" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">数据扩充中使用的技术有:</p><p id="d65e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">图像偏移(宽度偏移和高度偏移)。</p><p id="c693" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">图像翻转(水平和垂直)。</p><p id="0840" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">旋转。</p><p id="a59e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">亮度调节。</p><p id="e9c5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">缩放。</p><p id="8746" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">噪声添加。</p><p id="a0be" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">数据扩充是通过使用Keras的图像预处理模块的ImageDataGenerator类来完成的。</p><p id="20c7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们将对下面的交通标志图像进行各种操作，以使样本相乘。(其实这个不是来自数据集，而是为了更好的可视化，用了网上的这个。)</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/69de597bbbe4e40d89d68f93582304dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rjj0ZJU4iLwSHKLzvEhRiw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">image from the internet.</figcaption></figure><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="8407" class="ns mg it no b gy nt nu l nv nw">import matplotlib.pyplot as plt #For plotting<br/>from keras.preprocessing.image import ImageDataGenerator #image data generator.<br/>from numpy import expand_dims<br/>from keras.preprocessing.image import load_img<br/>from keras.preprocessing.image import img_to_array<br/>import cv2<br/>from PIL import Image<br/>%matplotlib inline</span><span id="b256" class="ns mg it no b gy nx nu l nv nw">image = Image.open('gdrive/My Drive/Colab Notebooks/sign1.jpg')<br/>plt.imshow(image)<br/>plt.show()</span></pre><p id="4eff" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">所以首先，我们应用<strong class="kh iu">“随机水平移动”</strong>变换。</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="baab" class="ns mg it no b gy nt nu l nv nw">datagen = ImageDataGenerator()<br/>#Random horizontal shift</span><span id="854b" class="ns mg it no b gy nx nu l nv nw"><br/>data = img_to_array(image)<br/>samples = expand_dims(data, 0)<br/>datagen = ImageDataGenerator(width_shift_range=[-200,200])<br/>it = datagen.flow(samples, batch_size=1)<br/>for i in range(9):<br/>  plt.subplot(330 + 1 + i)<br/>  batch = it.next()<br/>  image1 = batch[0].astype('uint8')<br/>  plt.imshow(image1)<br/>plt.show()</span></pre><p id="f9b5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这之后，我们得到一些水平移动的图像如下。</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/bd71081bd706ab06e7c92c76004d678d.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*1A7VK6ffFhq3__uNk2CD_Q.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Horizontally shifted images.</figcaption></figure><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/ec2ed9f0141d76a31e850f4732d850e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*NRXeCSs72cXpn9sIVyHMvg.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Horizontally shifted image.</figcaption></figure><p id="4031" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后我们应用另一个操作叫做<strong class="kh iu">“随机垂直移位”。</strong></p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="0ff2" class="ns mg it no b gy nt nu l nv nw">#Vertical shift</span><span id="eb17" class="ns mg it no b gy nx nu l nv nw">data = img_to_array(image)<br/>samples = expand_dims(data, 0)<br/>datagen = ImageDataGenerator(height_shift_range=0.5)<br/>it = datagen.flow(samples, batch_size=1)<br/>for i in range(9):<br/>  plt.subplot(330 + 1 + i)<br/>  batch = it.next()<br/>  image2 = batch[0].astype('uint8')<br/>  plt.imshow(image2)<br/>plt.show()</span></pre><p id="88b3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后我们得到这样的样本:</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/1375a85e7b7e613d86ef1187b888cd0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*QIrCOxTq9K2ZNat0l7dSFg.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Vertically shifted images.</figcaption></figure><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/624db825104d065d1e579f161c1561ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*4KK4ZtRXU_8J96O97htUPQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">vertically shifted sample.</figcaption></figure><p id="fb21" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">接下来的操作是<strong class="kh iu">“随机旋转”。</strong></p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="686a" class="ns mg it no b gy nt nu l nv nw">#Rotation</span><span id="d818" class="ns mg it no b gy nx nu l nv nw">data = img_to_array(image)<br/>samples = expand_dims(data, 0)<br/>datagen = ImageDataGenerator(rotation_range=90)  #Specify angle of rotation<br/>it = datagen.flow(samples, batch_size=1)<br/>for i in range(9):<br/>  plt.subplot(330 + 1 + i)<br/>  batch = it.next()<br/>  image4 = batch[0].astype('uint8')<br/>  plt.imshow(image4)<br/>plt.show()</span></pre><p id="a87e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">输出将类似于:</p><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ba08e4484930d938b0ef337d3351b3aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*7eBGfZ6snWMlMpDY2uzJ3A.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Randomly rotated images.</figcaption></figure><p id="47ee" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">另一个变换是<strong class="kh iu">“亮度调节”</strong>如下:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="bba3" class="ns mg it no b gy nt nu l nv nw">#brightness adjustment</span><span id="91f5" class="ns mg it no b gy nx nu l nv nw">data = img_to_array(image)<br/>samples = expand_dims(data, 0)<br/>datagen = ImageDataGenerator(brightness_range=[0.2,1.0]) <br/>it = datagen.flow(samples, batch_size=1)<br/>for i in range(9):<br/>  plt.subplot(330 + 1 + i)<br/>  batch = it.next()<br/>  image5 = batch[0].astype('uint8')<br/>  plt.imshow(image5)<br/>plt.show()</span></pre><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/747c4362af0dc3f1363d90117fa3561a.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*e7Y_pbhtE1M2rTZVrVh_dQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Brightness adjusted samples.</figcaption></figure><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/fe685d3fa600b29cb20ea0a0855f1c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*9HR-6Y0pW6LHqB8-7UjYMQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Brightness adjusted sample.</figcaption></figure><p id="7d8b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后我们做一些<strong class="kh iu">【缩放】</strong>变换。</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="4239" class="ns mg it no b gy nt nu l nv nw">#Zooming</span><span id="96a7" class="ns mg it no b gy nx nu l nv nw">data = img_to_array(image)<br/>samples = expand_dims(data, 0)<br/>datagen = ImageDataGenerator(zoom_range=[0.5,1.0]) <br/>it = datagen.flow(samples, batch_size=1)<br/>for i in range(9):<br/>  plt.subplot(330 + 1 + i)<br/>  batch = it.next()<br/>  image6 = batch[0].astype('uint8')<br/>  plt.imshow(image6)<br/>plt.show()</span></pre><figure class="nj nk nl nm gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/7155d661c3d76aa83e9d6fcdc54150c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*QvXzzqjaDraU0W05MaNGEA.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Randomly zoomed images.</figcaption></figure><p id="9cee" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这个数据扩充过程之后，我们可以将数据集转换成一个没有类偏差的平衡的数据集。</p><p id="7c35" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="me">注意:对数据样本应用所有这些转换并不复杂。因为对交通信号应用一些“随机垂直翻转”不会给出合理的输出。垂直翻转的交通标志不是机器学习模型可以从中推断信息的东西。因此，根据您的数据集明智地应用这些转换。</em></p><p id="e126" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">数据扩充技术不仅用于图像数据集，也用于其他类型的数据，如表格数据和文本数据。NLP(自然语言处理)中的数据扩充就是一个例子。<em class="me">从</em><a class="ae ob" href="https://neptune.ai/" rel="noopener ugc nofollow" target="_blank"><em class="me">Neptune . ai</em></a><em class="me">这里的</em><a class="ae ob" href="https://neptune.ai/blog/data-augmentation-nlp" rel="noopener ugc nofollow" target="_blank"><em class="me"/></a><em class="me">看NLP中数据增强的一个有趣的阅读。</em></p><p id="1b2e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">参考文献:</strong></p><ol class=""><li id="3bc6" class="of og it kh b ki kj km kn kq oh ku oi ky oj lc ok ol om on bi translated">奥莱利图书公司。</li><li id="9987" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.resample.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . utils . resample . html</a></li><li id="d9da" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="https://www.kaggle.com/rafjaa/resampling-strategies-for-imbalanced-datasets" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/RAF jaa/sampling-strategies-for-unbalanced-datasets</a>。</li><li id="ae3b" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="https://medium.com/@thomastracey/recognizing-traffic-signs-with-cnns-23a4ac66f7a7" rel="noopener">https://medium . com/@ Thomas Tracey/recogniting-traffic-signs-with-CNNs-23 a4 AC 66 f 7a 7</a></li><li id="275e" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="https://en.wikipedia.org/wiki/Histogram_equalization" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Histogram_equalization</a></li><li id="283b" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="https://www.pyimagesearch.com/2019/07/08/keras-imagedatagenerator-and-data-augmentation/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2019/07/08/keras-imagedata generator-and-data-augmentation/</a></li><li id="ca54" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="http://benchmark.ini.rub.de/?section=gtsrb&amp;subsection=news" rel="noopener ugc nofollow" target="_blank">http://benchmark.ini.rub.de/?section=gtsrb&amp;分段=新闻</a></li><li id="68a7" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated"><a class="ae ob" href="https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/</a></li><li id="6391" class="of og it kh b ki oo km op kq oq ku or ky os lc ok ol om on bi translated">【https://neptune.ai/blog/data-augmentation-nlp T4】</li></ol><p id="4fc5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我要感谢我的项目指导Mithun Haridas T. P .先生，我从他那里开始学习从基础到高级的概念；我要感谢Shameer Khader博士，在见到他之后，我已经做出了许多改变；我还要感谢Asharaf博士，他最近在我的大学(CUSAT)发表了一次演讲，激励我开始写关于medium.com的文章。</p><p id="67bb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">非常感谢来到这里，阅读我的第一篇关于人工智能和机器学习的文章，在medium.com。</p><p id="d56a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">请使用下面的评论框</strong>，让我知道您的更正、建议和反馈。</p><p id="ec7f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">再次感谢！。</p><figure class="nj nk nl nm gt ju"><div class="bz fp l di"><div class="ot ou l"/></div></figure></div></div>    
</body>
</html>