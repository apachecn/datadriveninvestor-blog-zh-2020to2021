<html>
<head>
<title>Scrape Twitter Without Limits Using Twint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Twint无限制地抓取Twitter</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/scrape-twitter-without-limits-using-twint-92509f2503cd?source=collection_archive---------1-----------------------#2020-11-29">https://medium.datadriveninvestor.com/scrape-twitter-without-limits-using-twint-92509f2503cd?source=collection_archive---------1-----------------------#2020-11-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bfb8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">忘记Tweepy和Twitter API吧…</h2></div><p id="d456" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我一直在使用<a class="ae le" href="http://tweepy.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Tweepy </a>，这是一个很棒的Python库，允许你连接到Twitter API并使用不同的服务，比如搜索或流媒体。如果您以前使用过这个库，您可能知道它很快就达到了一个极限，使您的数据收集工作大打折扣。</p><p id="f3b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你访问Twitter开发者门户，你可以了解这些<a class="ae le" href="https://developer.twitter.com/en/docs/twitter-api/v1/rate-limits" rel="noopener ugc nofollow" target="_blank">费率限制</a>。它们适用于POST和GET请求。过去困扰我个人的还有每个用户3200条推文的限制和每个给定搜索的7天历史限制。但是现在已经是旧时代了，因为镇上来了一个新玩家。</p><h1 id="7b57" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">Twint: Twitter智能工具</h1><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi lx"><img src="../Images/d46432a071260593d03852729a9bcd50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01cwnBuUiii7WQkKnHsUBg.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Image by the author</figcaption></figure><p id="aaa8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://github.com/twintproject/twint/" rel="noopener ugc nofollow" target="_blank"> Twint </a>是一个用Python开发的抓取工具，用于提取和抓取特定用户的推文以及关于特定话题、标签、地理位置、语言等的推文。Twint还能更容易获得用户的关注、喜欢和转发。</p><p id="3967" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最重要的是，Twint具有以下<strong class="kk iu">主要优势:</strong></p><ul class=""><li id="292e" class="mn mo it kk b kl km ko kp kr mp kv mq kz mr ld ms mt mu mv bi translated"><strong class="kk iu">没有费率限制。它可以获取几乎所有的推文。当我对收集关于新冠肺炎的推文感兴趣时，我设法在很长一段时间内(也许3或5个月)收集了大约150万条推文。这是在短短几个小时内收集的</strong></li><li id="6549" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><strong class="kk iu"> Twint不需要任何预先设置</strong>。与使用Tweepy不同，您不需要创建一个Twitter应用程序(并等待Twitter的批准)</li><li id="3f53" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated">Twint可以匿名使用<strong class="kk iu"/>,因为它不会要求你连接到你的账户或者输入你的API证书</li></ul><p id="fa90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您有兴趣了解更多关于Twint的内容，并观看代码的现场演示，请查看我的视频教程。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Scraping Twitter with Twint — video by the author</figcaption></figure><h1 id="7a1a" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">如何在Python中使用Twint</h1><p id="2975" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">首先，通过克隆repo并使用master分支来安装它。到目前为止，安装带有PIP的Twint会导致运行搜索时出现问题。</p><pre class="ly lz ma mb gt ni nj nk nl aw nm bi"><span id="7803" class="nn lg it nj b gy no np l nq nr">git clone --depth=1 https://github.com/twintproject/twint.git<br/>cd twint<br/>pip3 install . -r requirements.txt</span></pre><p id="6880" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有两种方法可以使用Twint:</p><p id="e621" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 1 —从命令行(CLI) <br/> </strong> Twint可通过不同选项从终端调用:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ns"><img src="../Images/ee0fc15e0d60a7feef971fdba5d03b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2P2liI9GfN8HOQW4UyuMtA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Twint parameters — screenshot by the user</figcaption></figure><p id="bf8e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最重要的(至少对我来说，当我使用它的时候)是</p><ul class=""><li id="ff6f" class="mn mo it kk b kl km ko kp kr mp kv mq kz mr ld ms mt mu mv bi translated"><code class="fe nt nu nv nj b">u</code>或<code class="fe nt nu nv nj b">username</code>:你抓取的账户的用户名</li><li id="49c1" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><code class="fe nt nu nv nj b">s</code>或<code class="fe nt nu nv nj b">search</code>:你正在追踪的搜索关键词或短语</li><li id="c6ff" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><code class="fe nt nu nv nj b">l</code>或<code class="fe nt nu nv nj b">lang</code>:推文的语言(“en”翻译成英语，“fr”翻译成法语，等等)</li><li id="4606" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><code class="fe nt nu nv nj b">json</code>:将导出设置为JSON格式</li><li id="c9ac" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><code class="fe nt nu nv nj b">csv</code>:将导出设置为CSV格式</li><li id="aab6" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><code class="fe nt nu nv nj b">limit</code>:推文的数量</li></ul><p id="2139" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">文档是不言自明的，您可以组合这些过滤器并发挥创造力💡。</p><p id="cf1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是我在收集关于新冠肺炎和疫苗的推文时运行的一些例子。</p><p id="c7ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我对讨论新冠肺炎疫苗的法国推特感兴趣，更准确地说，是发生在巴黎的推特。在这种情况下，使用<strong class="kk iu"> lang </strong>和<strong class="kk iu"> geo </strong>选项非常有用。</p><pre class="ly lz ma mb gt ni nj nk nl aw nm bi"><span id="7329" class="nn lg it nj b gy no np l nq nr"><strong class="nj iu">twint -s "covid vaccin" --lang fr --json --output data/tweets.json</strong></span><span id="a41b" class="nn lg it nj b gy nw np l nq nr"><strong class="nj iu">twint -s "covid vaccin" -g="48.880048,2.385939,5km" --json</strong></span></pre><p id="bada" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> - g="48.880048，2.385939，5km" </strong>过滤巴黎周围5km半径范围内的推文。</p><h2 id="9919" class="nn lg it bd lh nx ny dn ll nz oa dp lp kr ob oc lr kv od oe lt kz of og lv oh bi translated"><strong class="ak"> 2 —在python脚本中</strong></h2><p id="c907" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">Twint也可以从python脚本中调用。您只需要将在终端中传递的参数定义为配置对象的属性。</p><p id="e5c0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是如何做到的:</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="oi nc l"/></div></figure><p id="f930" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很简单，对吧？</p><p id="bdfc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你启动这个脚本，你将会看到被拉的tweets在屏幕上滚动。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi oj"><img src="../Images/fe4e78b8b9e086e463a0fafe0f11b90b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IVzVCdGEnRCKMT_TW7DVUA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Pulled tweets — screenshot by the author</figcaption></figure><p id="e5a5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">几秒钟后脚本运行完毕，您可以通过将下载的文件加载到pandas dataframe中来检查它。因此，您可以先检查它的形状，以及刮刀拖动的不同列(或元数据)。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ok"><img src="../Images/636202f25da03a3a1918477b1cf4dcc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kdaaq39nsTvConxaBBSEGA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Inspecting the pulled tweets — screenshot by the author</figcaption></figure><p id="a9eb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们收到了300条推文，这就是我们所要求的。</p><p id="a2a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过检查数据，我们还注意到，我们不仅获得了每条推文的文本，还获得了额外的元数据，如推文的<strong class="kk iu"> use_id、</strong>language<strong class="kk iu">和</strong>creation _ date等</p><p id="5d3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通常会从API中获得相同的信息，尽管我们在这里没有使用它。很神奇，对吧？</p><h1 id="e165" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">将Twint用于数据科学项目的最佳方式</h1><p id="4baf" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">像任何其他数据科学项目一样，成功伴随着伟大的工作流。我通常是这样做的。欢迎在评论中分享你的最佳实践:</p><h2 id="4beb" class="nn lg it bd lh nx ny dn ll nz oa dp lp kr ob oc lr kv od oe lt kz of og lv oh bi translated">1-定义搜索范围</h2><p id="9bb3" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">如果你在关注某个特定市场的新闻或趋势，Twint会很有帮助。通过正确定义搜索参数(关键词、标签、日期范围、语言和地理范围),您可以立即设置搜索参数以满足您的搜索需求。</p><h2 id="0c54" class="nn lg it bd lh nx ny dn ll nz oa dp lp kr ob oc lr kv od oe lt kz of og lv oh bi translated"><strong class="ak"> 2 —将数据存储在全文搜索数据库中</strong></h2><p id="01a6" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">您可以安排Twint定期运行——每天或每周，并更新数据库。您可以手动创建这个数据库，或者调用<code class="fe nt nu nv nj b">elasticsearch</code>选项为您的数据创建一个特定的<a class="ae le" href="https://www.elastic.co/fr/downloads/elasticsearch" rel="noopener ugc nofollow" target="_blank"> Elasticsearch </a>索引。</p><p id="ab01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建一个Elasticsearch数据库是存储文本数据最有效的方式，因为它使全文查询运行得非常快。</p><h2 id="9b75" class="nn lg it bd lh nx ny dn ll nz oa dp lp kr ob oc lr kv od oe lt kz of og lv oh bi translated">3-添加分析图层</h2><p id="f695" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">这一部分通常与前一部分同时进行。</p><p id="6d98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从Twitter中提取原始数据而不进行任何转换很少会产生可操作的结果。以下是我推荐的建立额外见解的方法。</p><ul class=""><li id="22b0" class="mn mo it kk b kl km ko kp kr mp kv mq kz mr ld ms mt mu mv bi translated">对推文执行<strong class="kk iu">文本分类:例如，这可以是情感分析，坦白地说，这是任何人在抓取推文时都能想到的自动任务。但你不必局限于此。你可以训练自己的分类器(假新闻检测器、话题检测器、讽刺识别器)并将其应用到你的推文中</strong></li><li id="e224" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated">应用<strong class="kk iu">主题抽取技术</strong> s:从LDA或NMF作为基线开始。在第二阶段探索文档嵌入和聚类方法</li><li id="82ec" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><strong class="kk iu">从推文中提取命名实体</strong>。这可能是有帮助的:想想人们的名字、组织或位置。将这些实体与推文或其主题的情感联系起来是很有趣的</li><li id="770c" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><strong class="kk iu">翻译推文</strong>:作为预处理步骤，这很有帮助</li><li id="8df1" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated"><strong class="kk iu">找出发微博最多的账户</strong>。这些会给你的数据带来偏差。分别处理它们，或者在分析中忽略它们。这些帐户的典型例子可能是共享公共关系通信或广告的公司帐户</li><li id="6814" class="mn mo it kk b kl mw ko mx kr my kv mz kz na ld ms mt mu mv bi translated">提取推文的<strong class="kk iu">地理位置</strong>并进行聚类</li></ul><h2 id="1f4c" class="nn lg it bd lh nx ny dn ll nz oa dp lp kr ob oc lr kv od oe lt kz of og lv oh bi translated">4 —可视化数据</h2><p id="fdea" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">处理和存储数据后的自然步骤是可视化。</p><p id="1ea6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你正在使用Elasticsearch作为一个数据库，那你就再幸运不过了:Elasticsearch与一个名为Kibana的可视化工具无缝集成，可以让你轻松构建许多图表。</p><h2 id="257d" class="nn lg it bd lh nx ny dn ll nz oa dp lp kr ob oc lr kv od oe lt kz of og lv oh bi translated"><strong class="ak"> 5 —刷新并监控输入结果</strong></h2><p id="f538" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">在构建了一个抓取和数据处理管道并设置了Kibana来可视化结果之后，您的项目现在可以以半自治的方式运行了。</p><p id="0e65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将semi放在autonomous之前，因为您仍然需要监控结果，比如您的分类器或主题检测器的性能:这些人工制品通常需要随着时间的推移进行再培训。</p><h1 id="5ac8" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">结论</h1><p id="69a9" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">Twint是一个很好的软件包，可以构建社交媒体监控应用程序，而不会受到Twitter API及其速率限制的阻碍。</p><p id="aacb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结合自然语言处理技术和可视化，Twint也可以成为您下一个数据科学项目的解决方案。为什么不试一试呢？😉</p><p id="2674" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">黑客快乐！</p></div></div>    
</body>
</html>