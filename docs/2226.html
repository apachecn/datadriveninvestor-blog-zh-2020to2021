<html>
<head>
<title>Write your own Dog-breed Classifier in just 10 Minutes!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在10分钟内编写你自己的狗品种分类器！</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/write-your-own-dog-breed-classifier-in-just-7-minutes-8d74db2c785?source=collection_archive---------6-----------------------#2020-04-20">https://medium.datadriveninvestor.com/write-your-own-dog-breed-classifier-in-just-7-minutes-8d74db2c785?source=collection_archive---------6-----------------------#2020-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9cc7" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">内部人工智能</h2><div class=""/><div class=""><h2 id="279a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用深度学习模型预测任何狗的品种。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3f00401e4aeeb0e1995ec775bf03bac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A9McAp8tblH803gO-SWwpw.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@jamie452?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jamie Street</a> on <a class="ae lh" href="https://unsplash.com/s/photos/dog?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e68b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">又来了。这一次，我们将开发自己的狗品种分类器。我们的模型将能够自动检测照片中的狗，并预测它的品种。听起来棒极了！让我们开始吧…..！</p><blockquote class="me mf mg"><p id="399f" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">注意:如果你似乎不理解文章中讨论的任何观点或想法，试着把整篇文章读一遍，然后回来再读一遍。希望这能有点意义，因为一切都是相互关联的。</p></blockquote><ul class=""><li id="cd25" class="ml mm it lk b ll lm lo lp lr mn lv mo lz mp md mq mr ms mt bi translated">使用的架构:CNN的</li><li id="490d" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">编程语言、库、框架:Python、NumPy、Pandas、Matplotlib、cv2、<strong class="lk jd">Keras【tensor flow back end】</strong></li><li id="14a2" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">专业水平:中等水平</li></ul><h2 id="02b2" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">我们的战略:-</h2><p id="0b7e" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">预测狗的品种是一项相当具有挑战性的任务，但我会为你分解它。首先，模型应该能够检测出图像中是否有狗。然后它就能预测那只狗的品种。但是现在，让我们把重点放在检测图像中的狗的问题上。有许多方法可以解决这个问题。使得:-</p><ul class=""><li id="f366" class="ml mm it lk b ll lm lo lp lr mn lv mo lz mp md mq mr ms mt bi translated">训练神经网络来检测图像中是否有狗。然后使用这个训练好的模型和<a class="ae lh" href="http://wiki.fast.ai/index.php/Fine_tuning" rel="noopener ugc nofollow" target="_blank">微调</a>来预测那只狗的品种。</li><li id="7af8" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">使用端到端的深度学习方法。这样，不用检测狗，然后分别预测它的品种，只需向CNN提供狗的品种数据集，让它同时学习这两个特征。</li><li id="886d" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">使用预先训练好的模型，即VGG-19、例外、RESNET，然后使用<a class="ae lh" href="https://en.wikipedia.org/wiki/Transfer_learning" rel="noopener ugc nofollow" target="_blank">迁移学习</a>来预测狗的品种。</li></ul><p id="d100" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，考虑第二种方法，这种类型的方法只有在我们有庞大的数据集时才有效，但在这种情况下，我们只有大约6680幅训练图像。所以这种做法行不通。<br/>第二种和第三种方法非常相似；唯一的区别是，在第一种方法中，我们在对狗品种数据集进行微调之前，先训练我们自己的狗检测器，而在第三种方法中，我们利用<strong class="lk jd">迁移学习</strong>来预测狗的品种。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/82446d7333a592bcc619835f958464c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6cNhSSMwdPIo7NYGTo5t5w.jpeg"/></div></div></figure><p id="df94" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">显然，第三种方法更好，因为这些模型是在ImagNet数据集上训练的，并且在图像分类中达到了人类水平的性能。那么，为什么不利用这一点呢？<br/>这些模型在多个GPU上训练了数周，为什么不利用这些模型为我们带来优势呢。此外，在接下来的章节中，你会发现为什么这些模型在解决预测犬种的问题上给了我们相当大的优势。<br/>所以，迁移学习会照顾到第一步。</p><div class="nx ny gp gr nz oa"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">认知计算——一套被广泛认为是……</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo lb oa"/></div></div></a></div><p id="3bd9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，进入第二步。在第一步中，我们使用预先训练的模型来检测狗的存在，但我们可以使用迁移学习来实现更重要的东西。这就是特征提取。如果您熟悉CNN及其工作原理，那么您可能熟悉特征提取的概念。如果没有，参考<em class="mh"> </em> <a class="ae lh" href="https://machinelearningmastery.com/promise-of-deep-learning-for-computer-vision/" rel="noopener ugc nofollow" target="_blank"> <em class="mh">这个</em> </a>。由于像Xception和ResNet这样的模型在图像分类方面已经达到了人类水平的性能，它们是非常好的特征提取器，我们可以利用这一点。因此，下面是我们将如何解决这个问题的快速概述</p><ul class=""><li id="1771" class="ml mm it lk b ll lm lo lp lr mn lv mo lz mp md mq mr ms mt bi translated">导入数据集。</li><li id="3fa4" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">预处理数据集。</li><li id="b9f7" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">导入预训练模型。</li><li id="4a40" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">实施迁移学习。</li><li id="edd0" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">可视化一些结果。</li><li id="b6c2" class="ml mm it lk b ll mu lo mv lr mw lv mx lz my md mq mr ms mt bi translated">比较性能。</li></ul><p id="36e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这项任务，我们将使用两种不同的预训练模型制作模型，然后使用迁移学习。我们将使用的模型是:- <br/> -例外<br/> - RESNET152V2</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/11aecc2d7d187f09e4beb24e32978139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2IK6KuL450qBnACeHwr0MA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">credits: Pinterest</figcaption></figure><p id="e0cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这两个模型都非常强大和深入，特别是第二个。</p><blockquote class="me mf mg"><p id="eee6" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated"><strong class="lk jd">注:- </strong> <br/> <strong class="lk jd">我知道你们大多数人都没有机会接触到强大的机器。别担心。我们将从谷歌获得帮助。一如既往！</strong>。你可能熟悉google colab，它为你提供了一个运行jupyter笔记本的环境。Colab笔记本在谷歌的云服务器上执行代码，这意味着你可以利用谷歌硬件的力量，包括GPU和TPU。</p><p id="c36b" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">在开始实现模型之前，如果您希望在本地机器上运行这个模型，请确保您的系统/计算机/笔记本电脑满足以下要求。<br/> - GPU <br/> -大约24GB内存<br/> -大约40 GB可用空间</p></blockquote><p id="ac31" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以，你不用担心这个。就去<a class="ae lh" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"><em class="mh">colab.research.google.com</em></a><em class="mh">。加载或创建一个新的笔记本，你就可以开始了。你可以通过<a class="ae lh" href="https://www.youtube.com/watch?v=inN8seMm7UI" rel="noopener ugc nofollow" target="_blank"> Google </a>观看这个视频来入门。</em></p><blockquote class="me mf mg"><p id="43c9" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated"><strong class="lk jd">注意:强烈建议在阅读如何实施之前打开我的笔记本。可以在这里找到</strong> <a class="ae lh" href="https://github.com/Mahyar-Ali/Dog-Breed-Classifier/blob/master/Dog-breed%20Classifier.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">原笔记本(Github)。</strong> </a> <strong class="lk jd">和</strong> <a class="ae lh" href="https://colab.research.google.com/drive/1ZQy3GKKu9cioluUMz69BSo7LjLwC4yyA" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> Colab版本</strong> </a> <strong class="lk jd">【推荐】。</strong></p></blockquote><div class="nx ny gp gr nz oa"><a href="https://github.com/Mahyar-Ali/Dog-Breed-Classifier/blob/master/Dog-breed%20Classifier.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">mahyar-Ali/犬种分类器</h2><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com犬种分类器</p></div></div><div class="oj l"><div class="oq l ol om on oj oo lb oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a href="https://colab.research.google.com/drive/1ZQy3GKKu9cioluUMz69BSo7LjLwC4yyA" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">谷歌联合实验室</h2><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">colab.research.google.com犬种分类器</p></div></div><div class="oj l"><div class="or l ol om on oj oo lb oa"/></div></div></a></div><h2 id="09ab" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">导入和加载数据集:-</h2><p id="0eb8" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">对于这个问题，我们没有任何预处理数据。所以要自己预处理。点击从<em class="mh">下载数据集。压缩文件包含三个文件夹:培训、测试和验证。所有这些文件夹都包含不同狗品种的图片，按字母顺序排列在不同的文件夹中。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/101dd4936816feb2a78fe42fcd5c4ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*PJbBOHvYA3f-wZI81aJqew.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">A Cropped Snapshot</figcaption></figure><p id="7551" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我们必须存储每张狗图片的文件路径及其品种。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="70a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来:-</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="37f0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe ov ow ox oy b">load_dataset()</code>函数用于读取和存储数据集中每个图像的地址及其标签。因为我们有133个狗品种，所以我们的一个热编码器的长度将是133。我们可以直接读取图像并将它们存储为NumPy数组，但是在这种情况下，我们可能会丢失关于每张狗图像的类别的信息。现在，创建图像名称及其目标标签的数据库。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="26b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我们创建与每个图像相关联的目标向量时，该向量处于一个热点表示中。这对计算机来说是合理的，但是我们想知道哪只狗属于人类语言中的哪一个品种。所以我们必须列出数据集中所有可用的狗品种。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="f21d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我刚刚使用了前面的函数，并将其修改为只返回图像的路径，而不返回目标标签。从图像名称中，我们可以提取不同狗的品种，因为所有的图像都以一种模式存储，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/8325d85d58a25020cd0e591224510a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*G9DcbtHPDBcJ2tCUnS1ldA.png"/></div></figure><p id="584a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe ov ow ox oy b">set</code>用于消除所有多余的名字。现在我们有了所有狗的品种，让我们按照它们在数据集中的排列顺序排列它们。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="cab1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们把结果可视化。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/46ab4d36325b9a69ec99c7ecb0a6c572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*SD3TYFKKOJR3NBe2M_ljPw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Category and breed are the same things.</figcaption></figure><p id="382b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们已经准备好了数据库，让我们从数据库中可视化一些图像。通过运行这个单元，你会看到八幅狗的图像。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><h2 id="ecda" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">2.预处理数据集:-</h2><p id="9ee4" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">现在，我们必须使用创建的数据库读取图像，然后将它们存储为3d数组。与此同时，我们必须将所有的图像调整到相同的形状，因为Xception和ResNet分别只接受<code class="fe ov ow ox oy b">299x299</code>和<code class="fe ov ow ox oy b">224x224</code>。由于我们有两个模型，首先考虑例外网络，并根据该模型处理我们的图像。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">This function will return a NumPy array of the images found in the dataset and will also resize them.</figcaption></figure><p id="ca4b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了输入形状约束，这些模型还有一些其他预处理步骤，但我们不必担心这一点。Keras为我们提供了这样的功能。我一会儿会谈到那件事。</p><h2 id="55af" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">3.导入预训练模型:-</h2><p id="a54f" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">首先，我们将使用异常模型。该模型在ImageNet数据集上被训练以检测1000类图像。所以模型的最后一层有1000个单位。但是我们不需要识别1000个物体。我们想要预测狗的品种，总共有133个类别[狗的品种]。所以，为了预测狗的品种，我们将移除Xception模型的最后一层，并用133个感知(单位)的层来代替它。为了导入这个模型。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="d728" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们有了没有最后1000感知层的模型。我们有两个选择，要么在这个模型的末尾添加一个新层，要么使用所谓的瓶颈，以便节省计算。让我解释一下，如果我们在这个模型的末尾添加新的层[133感知]，并将除了最后一个[133感知者]之外的所有其他层设置为不可训练，那么在向前传播的每一步中，我们必须将图像从输入层一直传递到输出层100次[由于历元或训练周期的数量]。所以这是一个非常多余的计算。因此，我们将把所有的图像传递给e Xception模型[last layer removed],只传递一次，并将存储与这些图像相关的该模型的倒数第二层的输出。然后，我们将创建一个新的模型，并将这些输出作为输入提供给新创建的具有输出的模型[133感知层]。我们没有做任何改变，只是将模型分成两个模型以减少计算量。</p><p id="bd4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面通过一个图片做个小解释。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/9152d9f093867f3fb9a4ce4038a5330e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*JJIogDO-NiXq7NSeCBwDmg.jpeg"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">credits: Slide Share</figcaption></figure><p id="ae0b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">把它当作例外模型，而不是先入为主。请注意，我们将第一个模型的输出作为第二个模型的输入(我们将创建第二个模型来预测狗的品种)。第一个模型将创建每个图像的编码，这对确定狗的品种至关重要。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="a911" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe ov ow ox oy b">preprocess_input</code>函数将根据模型[记住键:1](即归一化)对图像进行预处理，并将其提供给异常模型，异常模型又将输出作为必要的编码返回。请注意，我们已经删除了最后一层，因此输出将是形状<code class="fe ov ow ox oy b">10x10x248</code>，这是Xception模型的倒数第二层。</p><h2 id="5dcf" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">4.实施迁移学习:-</h2><p id="463f" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">现在让我们创建一个只有一层的模型，它可以预测狗的品种。它将从先前模型的输出中获取输入(<code class="fe ov ow ox oy b">10x10x248)</code>)。但是在将这个输出连接到我们的层之前，我们将定义一个中间层，它将把<code class="fe ov ow ox oy b">10x10x248</code>转换成<code class="fe ov ow ox oy b">248</code>感知层。为此，我们将使用<code class="fe ov ow ox oy b">GlobalAveragePoolingLayer()</code>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="1599" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们已经准备好了模型。是时候编译和运行我们的模型了。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><h2 id="a878" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">5.可视化结果</h2><p id="89de" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">在训练该模型50个时期之后，该模型在训练集上实现了大约99%的准确度，在验证集上实现了大约90%的准确度，在测试集上实现了87.5%的准确度。哇！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/af4fad31cd4d22c325b04b1633e10cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9w5xSMiO-yD5rBibRduH3A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">[green] The Model guessed the right breed. Refer to the notebook for the code.</figcaption></figure><p id="94f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些都是很好的结果。很明显，训练集有些过拟合。这是因为Exception是一个非常强大的模型，我们也没有太多的训练数据，而且测试图像的分布差异很大。但就目前而言，这是一项出色的成就。您可以阅读我的笔记本，了解我如何获得测试集准确性的代码。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/21700b35d02943c4b9dd791db70247b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*iZciIM904WLF02K85j5sTg.png"/></div></figure><p id="dc00" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该笔记本还包含可视化的一些结果和用你自己的图像测试的功能。</p><p id="8477" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我从网上下载了一张图片，在我的模型上测试了一下。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/c404cf77b2ecf98cdf9ffae7fba3ec76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*nXXhYOKQFAM_TLR2PWy_EA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Yes, you are right.!</figcaption></figure><h2 id="d589" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">6.比较型号:-</h2><p id="fa97" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">我使用相同的过程用InceptionV3创建了第二个模型。但是在那个模型中，我不得不在<code class="fe ov ow ox oy b">GlobalAveragePoolingLayer()</code>之后加入一个额外的层，因为盗梦空间模型比异常要深得多。所以我不得不调整不同的参数来解决过度拟合问题，因为如果没有任何适当的调整，模型很快就在<strong class="lk jd">训练集</strong>上达到了100%的准确性。我不得不花很多时间尝试不同的选择。笔记本的末尾有一个总结。可以从<a class="ae lh" href="https://github.com/Mahyar-Ali/Dog-Breed-Classifier/blob/master/Dog-breed%20Classifier.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> GitHub </strong> </a>或者<a class="ae lh" href="https://colab.research.google.com/drive/1ZQy3GKKu9cioluUMz69BSo7LjLwC4yyA" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">Google Colab</strong></a><strong class="lk jd">打开笔记本。</strong></p><p id="273b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是由于过度拟合，该模型不能超过由Xception模型实现的精度。但是我也设法在这个模型上获得了81%的准确率。您可以随时根据需要调整超参数。</p><p id="ce19" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以，正如承诺的那样，你有自己的狗品种分类器。</p><p id="6e9a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢阅读。该系列的下一个将是<strong class="lk jd">“皮肤癌检测”，</strong>，这是最具挑战性和最重要的深度学习模型之一。希望我们能够拯救一些生命。</p><p id="8204" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你有任何建议，请写下来回应这篇文章。</p><p id="4242" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">向马赫亚尔·阿里先生致意</p><p id="dd70" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">进入专家视图— </strong> <a class="ae lh" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>