<html>
<head>
<title>Overview of JMS API and AMQP API with real-world use cases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JMS API和AMQP API概述，包含真实使用案例</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/overview-of-jms-api-and-amqp-api-with-real-world-use-cases-c811ad18a11f?source=collection_archive---------1-----------------------#2020-07-20">https://medium.datadriveninvestor.com/overview-of-jms-api-and-amqp-api-with-real-world-use-cases-c811ad18a11f?source=collection_archive---------1-----------------------#2020-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d9419239b880ae124b31018cecc5e86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yP0lLYF_-eOgFxFoqKNOKQ.jpeg"/></div></div></figure><p id="f28f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我将解释JMS和AMQP API，比较这两种机制，当然还有这些标准的真实用例。</p><h1 id="fbf5" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">什么是JMS和AMQP？</h1><p id="f2f1" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">首先，我们来了解一下这些专业术语是什么意思。JAVA消息服务的JMS 标准，它是一个面向消息的中间件API，用于两个或更多服务之间的通信。JMS是专门为java语言设计的，它基于Java EE。</p><p id="385e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> AMQP </strong>标准为<strong class="ka ir">高级消息队列协议</strong>，是面向消息中间件的应用层协议。</p><h1 id="02a7" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">JMS vs AMQP</h1><p id="f171" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">AMQP是一个协议！！而JMS是一个API规范。</p><p id="9462" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实现JMS API的JMS客户机可以使用它需要的任何协议。同样，JMS可以使用AMQP作为与消息代理通信的协议。因此，比较JMS和AMQP没有任何意义。我们应该比较的是JMS APIs和AMQP API。</p><p id="e0d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这两种机制都用于两个或多个客户端之间的消息服务。但是这两种机制是有区别的。您可以找到很多关于JMS和AMQP比较的文章，所以这里我将只强调这两种机制之间的主要区别。</p><h2 id="d280" class="lz kx iq bd ky ma mb dn lc mc md dp lg kj me mf lk kn mg mh lo kr mi mj ls mk bi translated">1.多语言支持</h2><p id="1a35" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">JMS只能用于java应用程序，因为它基于Java EE，但是对于AMQP API，您可以找到多语言(c、c++、python、ruby、Java等)API实现。</p><h2 id="0d44" class="lz kx iq bd ky ma mb dn lc mc md dp lg kj me mf lk kn mg mh lo kr mi mj ls mk bi translated">2.消息传递模型</h2><p id="4352" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在消息解析中，JMS API publisher可以直接将消息发送到队列/交换，而使用者可以直接订阅特定的队列/交换并使用消息。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/e9698e986900b08deaf38eab1b56a60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DGQEBZx_sBHd3C_Wtyno6Q.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Pub/Sub model in JMS</figcaption></figure><p id="b046" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是在AMQP API中，发布者应该用路由密钥将消息发送给交换。然后，AMQP使用者应该首先创建一个队列，并需要将其绑定到特定的交换来使用消息。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/708ea53e2eafa6e5542ca06dae676511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8ucu9C-P0XLfeHLHCdIOA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">AMQP messaging model</figcaption></figure><p id="c439" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mv"> JMS消息传递模型</em> </strong></p><p id="e51b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在JMS中，支持两种消息传递模块。那些是<strong class="ka ir">点对点消息传递</strong>模型和<strong class="ka ir">发布-订阅消息传递</strong>模型。</p><ul class=""><li id="5ec5" class="mw mx iq ka b kb kc kf kg kj my kn mz kr na kv nb nc nd ne bi translated"><strong class="ka ir">点对点消息传递</strong>模式——一条消息只传递给一个消费者。</li><li id="e336" class="mw mx iq ka b kb nf kf ng kj nh kn ni kr nj kv nb nc nd ne bi translated"><strong class="ka ir">发布-订阅消息传递</strong>模型——一条消息被发送给所有订阅了特定主题的订阅者。</li></ul><p id="d356" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mv"> AMQP API消息模型</em> </strong></p><p id="27b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">AMQP支持四种消息传递模块。生产者使用路由密钥将消息发布到交换，队列使用绑定密钥绑定到交换。以下四种消息传递模型取决于路由密钥和绑定密钥</p><ul class=""><li id="9bd3" class="mw mx iq ka b kb kc kf kg kj my kn mz kr na kv nb nc nd ne bi translated"><strong class="ka ir">直接交换— </strong>发布者发布带有路由关键字的消息后，交换机将消息发送到队列中，队列为r <strong class="ka ir"> outing key == binding key </strong>。</li><li id="bb1d" class="mw mx iq ka b kb nf kf ng kj nh kn ni kr nj kv nb nc nd ne bi translated"><strong class="ka ir">扇出交换— </strong>简单地忽略路由键，将消息发送给所有已经订阅交换的队列。</li><li id="b6d2" class="mw mx iq ka b kb nf kf ng kj nh kn ni kr nj kv nb nc nd ne bi translated"><strong class="ka ir">主题交换— </strong>允许部分匹配关键字。如果路由关键字是“动物”。* "并且绑定关键字是“animal.dog ”,交换仍然将消息发送到队列。</li><li id="fd03" class="mw mx iq ka b kb nf kf ng kj nh kn ni kr nj kv nb nc nd ne bi translated"><strong class="ka ir">报头交换— </strong>使用消息报头代替路由关键字。</li></ul><p id="4699" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到目前为止，我已经解释了你需要了解的关于JMS和AMQP的理论知识。但是我们为什么需要这种面向消息传递的中间件，以及真实世界的用例是什么。让我们来了解一下。</p><h1 id="1e08" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">为什么我们需要JMS和AMQP？</h1><p id="7ea4" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果您使用过分布式系统，这种消息传递机制对于组件之间的通信非常有用。大多数JMS和AMQP代理提供可靠的性能，包括持久性、交付确认、发布者确认和高可用性。</p><h1 id="9680" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">真实世界的用例</h1><p id="40fd" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">让我们考虑一下WSO2 API管理器。它包括几个组件，分别是流量管理器、API网关、密钥管理器、API发布器、商店和管理仪表板。</p><p id="fe03" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">WSO2 API管理器使用JMS和AMQP机制来解析流量管理器和API网关之间的节流事件。我将使用下图对此进行进一步解释。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/a4134c6050b11d669cdf194b947dab43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tbFGG7185WET4vHgjvdoxQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Traffic Manager and API Gateway</figcaption></figure><p id="fb33" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可能对API网关有所了解。简单地说，它是一种中间层，为我们的API提供安全功能和速率限制特性。</p><p id="ff74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">流量管理器是处理所有API请求的地方。在这种情况下，在处理请求之后，它得到节流决定(节流决定意味着如果请求计数的数量超过定义的限制，它决定停止对服务的访问)。然后节流决定被发布到主题。所有网关都订阅了节流主题。然后，它可以使用节流决策，并相应地处理请求。</p><p id="a76c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了实现负载平衡，WSO2 API管理器可以将多个网关连接到同一个流量管理器。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/c69b418320820d5a9799d717e44d29c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jaj_RP8I7dYrKgrJThilGw.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Traffic Manager with multiple gateways</figcaption></figure><p id="0822" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，网关可以使用不同的语言实现，如Java、Ballerina、c++。使用AMQP API，我们可以毫无问题地订阅节流主题的所有网关。</p><p id="8985" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与上面的用例一样，这种消息传递机制对于分布式系统非常有用。</p><p id="eff7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用AMPQ的另一个著名用例是物联网平台。这种消息机制用于向物联网平台中的物联网设备发送数据。想象一个智能房子，它有一个温度传感器。它将温度信息发布到服务器，订阅特定主题的设备可以获得温度信息。</p><p id="e94c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过考虑上述用例，您可以了解JMS和AMQP技术在现实应用程序中是如何使用的。我希望你能清楚地了解JMS和AMQP，在我的下一篇文章中，我将向你解释我们如何用AMQP API消费者实现JMS API发布者。干杯:)！！</p></div></div>    
</body>
</html>