<html>
<head>
<title>How To Set Up Your Automated Trading System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何设置你的自动交易系统</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-set-up-an-automated-trading-strategy-67ad9f8c0a5f?source=collection_archive---------1-----------------------#2020-12-19">https://medium.datadriveninvestor.com/how-to-set-up-an-automated-trading-strategy-67ad9f8c0a5f?source=collection_archive---------1-----------------------#2020-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="46b6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Bollinger Bands策略、Telegram bot和Wayscript作为托管服务，接收投资股票最佳时机的通知。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a7c74b383d720c64672225013e0aea51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CDTxhXM82QoqIkHHtwHJOQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by Author</figcaption></figure><p id="7784" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你像我一样，你会花很多时间看数据、曲线和投资的好时机。或者，也许你正在决定用什么策略来尽可能缩短时间。</p><p id="5115" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用本文中的<a class="ae lr" href="https://danielcarlander.medium.com/how-to-implement-bollinger-bands-in-python-1106b90da8d1" rel="noopener">实现的策略，我们将为Telegram建立一个通知系统，每当需要投资或转移资产时，该系统将获取这些信息并生成一个经过策划的消息。</a></p><p id="f212" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">免责声明:</strong>我建立了一个通知系统，因为我用来购买基金的经纪人是不可自动化的。否则，我也会自动投资这些钱。</p><div class="ls lt gp gr lu lv"><a href="https://danielcarlander.medium.com/how-to-implement-bollinger-bands-in-python-1106b90da8d1" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">如何在Python中实现交易的布林线</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">利用熊猫和Plotly来实施一个美丽的布林线策略。</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">danielcarlander.medium.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><h1 id="5b65" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">生成消息</h1><p id="dd44" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">使用我们实现的布林线<a class="ae lr" href="https://danielcarlander.medium.com/how-to-implement-bollinger-bands-in-python-1106b90da8d1" rel="noopener">代码</a>，我们需要生成一个可理解的消息发送给我们的机器人。</p><p id="3522" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">概括地说，我们创建了一个名为bb的数据框架，其中包含以下信息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/aeaf13341197bb8f5519e07b5f576e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*OldRvneQg0_Mc5k3wFak8A.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">DataFrame (By Author)</figcaption></figure><p id="2a22" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ni">收盘</em>栏是股票的实际价值，上下，代表布林线模型的波段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3e3035b323d05a4fd44d2ca7529dac5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*b1V3j8jP_Ay3K14E_6tUEw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by Author</figcaption></figure><p id="2f88" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有了这些信息，我们需要创建一个警报，当图像中的绿点或红点出现时，就会发出警报。这些是模型中的买卖指标。</p><p id="852a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，每次我们运行脚本时，我们都需要获取最后的日期，并计算股票的当前价值是否在范围之外</p><p id="185b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这可以通过下面几行代码来完成:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="32c4" class="np ml iq nl b gy nq nr l ns nt">current_value = bb['Close'][-1]</span><span id="e2cb" class="np ml iq nl b gy nu nr l ns nt">upper_bound = bb['upper'][-1]<br/>lower_bound = bb['lower'][-1]</span><span id="fb16" class="np ml iq nl b gy nu nr l ns nt">if current_value &gt; upper_bound:<br/>    message = 'Sell indicator'<br/>elif current_value &lt; lower_bound:<br/>    message = 'Buy indicator'<br/>else:<br/>    message = False</span></pre><p id="555f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以生成任何你想要的信息。我包括了股票每日的百分比变化，但是你可以在这里查看<a class="ae lr" href="https://github.com/danicrg/stocks-bot" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="b5e3" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">发送消息</h1><p id="c440" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">为了发送信息，我们将使用电报。为此，我们需要创建一个新的机器人。为了做到这一点，在电报中我们去<a class="ae lr" href="https://t.me/botfather" rel="noopener ugc nofollow" target="_blank">父亲</a>。在那里，我们输入命令并设置新bot的名称，直到我们获得bot令牌。我们将使用这个令牌来发送消息。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="d213" class="np ml iq nl b gy nq nr l ns nt">BOT_TOKEN = &lt;bottoken&gt;</span></pre><p id="5897" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要在不创建服务器的情况下发送消息，您需要知道与机器人聊天的id。为此，你需要向机器人发送一条消息，然后转到<a class="ae lr" href="https://api.telegram.org/bot&lt;tokenhere&gt;/getUpdates" rel="noopener ugc nofollow" target="_blank">https://api.telegram.org/bot&lt;机器人令牌&gt;/获取更新</a>，用你的实际令牌替换&lt;机器人令牌&gt;。</p><p id="16f1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在那里，您可以找到您的chat_id，并将其保存到您的脚本中:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="49f2" class="np ml iq nl b gy nq nr l ns nt">chat_id = 11033399</span></pre><p id="7fe6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，用这一行简单的代码传达出这样的信息:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="d753" class="np ml iq nl b gy nq nr l ns nt">from twx.botapi import TelegramBot</span><span id="182d" class="np ml iq nl b gy nu nr l ns nt">bot.send_message(chat_id, message, parse_mode='Markdown')</span></pre><p id="be6c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很神奇，对吧？只用三行代码就能做什么。当然，你需要用pip安装这些库(<em class="ni"> pip install twx.botapi </em>)。</p><p id="0894" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是我们如何让它每天运行来给我们发送这个通知呢？</p><h1 id="9d2d" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">自动化脚本的执行</h1><p id="04a0" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">现在我们有了一个运行脚本。我用的剧本是<a class="ae lr" href="https://github.com/danicrg/stocks-bot" rel="noopener ugc nofollow" target="_blank">这个</a>。你可以使用任何你喜欢的托管服务，但我喜欢使用Wayscript，因为你不必管理服务器或任何东西，它只是专注于代码。</p><p id="e7ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要设置我们的代码定期运行，我们需要遵循以下步骤:</p><ol class=""><li id="19d3" class="nv nw iq kx b ky kz lb lc le nx li ny lm nz lq oa ob oc od bi translated">创建一个帐户。</li><li id="73fd" class="nv nw iq kx b ky oe lb of le og li oh lm oi lq oa ob oc od bi translated">点击<strong class="kx ir">新建脚本。</strong></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/cb1c62279ce8835eba48ef914988c372.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*31i1KrBB-dK3SmxOmXKYfQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">New Script (By Author)</figcaption></figure><p id="9aa0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.点击<strong class="kx ir">添加触发器</strong>并选择<strong class="kx ir">时间触发器。</strong>您可以在这里为每天设置一个触发器，也可以像我一样使用crontab只在工作日执行，因为股市在周末关闭。如果您不熟悉crontab，您可以使用<a class="ae lr" href="https://crontab.guru" rel="noopener ugc nofollow" target="_blank">工具</a>来生成该行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e6cdb490ecd629f75b205a2ecf9567af.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*KaeYCZTuk_m0-mJbRelg_w.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Crontab (By Author)</figcaption></figure><p id="6e80" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.然后，你点击<strong class="kx ir">添加步骤</strong>，进入<em class="ni"> Python。</em>在这里，您可以在文本编辑器中复制并粘贴代码。您还需要在<em class="ni"> requirements.txt </em>文件中包含依赖关系。</p><p id="fc5b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">给你。您的屏幕应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/e6ebd12562f1a5fd6b4af356c98993bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*GrS7ikPkBv5NfxEMKsj0rw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Wayscript (By Author)</figcaption></figure><p id="7aa8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要测试和调试代码，你只需点击蓝色的播放按钮，你应该会在你的电报机器人上看到一条消息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/13ae9ba353654d5005a948ec5048ace2.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*BOnisAF3Q1GvWhXYsbcm8w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Telegram Message (By Author)</figcaption></figure><h1 id="bb05" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">概述</h1><p id="437c" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">首先，我们实现了生成消息并发送消息的代码。我们将这段代码合并成一个. py文件，你可以在这里访问<a class="ae lr" href="https://github.com/danicrg/stocks-bot" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="20ac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们将这个脚本上传到Wayscript，并包含一个带有crontab的调度程序，用于在每个工作日向我们发送消息。</p></div></div>    
</body>
</html>