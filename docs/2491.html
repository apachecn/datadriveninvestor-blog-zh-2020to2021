<html>
<head>
<title>Automated Exploratory Data Analysis: Test Driving MS Excel’s ‘Ideas’ Feature</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化探索性数据分析:测试MS Excel的“Ideas”功能</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/automated-exploratory-data-analysis-test-driving-ms-excels-ideas-feature-514f34d944e8?source=collection_archive---------0-----------------------#2020-05-03">https://medium.datadriveninvestor.com/automated-exploratory-data-analysis-test-driving-ms-excels-ideas-feature-514f34d944e8?source=collection_archive---------0-----------------------#2020-05-03</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="eb05" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">Microsoft Excel的自动化探索性数据(EDA)分析工具“Ideas”的测试和审查</h2></div><p id="a234" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">TLDR:这篇文章测试了微软Excel提供的自动化EDA工具。在一次试驾之后，对我来说，继续寻找一个最喜欢的一站式自动化EDA工具。我管理我的期望。</p><h1 id="5199" class="lf lg iu bd lh li lj lk ll lm ln lo lp ka lq kb lr kd ls ke lt kg lu kh lv lw bi translated">介绍</h1><p id="9cad" class="pw-post-body-paragraph kj kk iu kl b km lx jv ko kp ly jy kr ks lz ku kv kw ma ky kz la mb lc ld le in bi translated">探索性数据分析(EDA)是数据科学中的一个重要课题。任何处理来自研究人员、分析师、商业智能专业人士等的数据的人都会花时间来完成这项任务。根据《哈佛商业评论》的一篇文章，数据科学家花费80%的时间来寻找、清理和组织数据。</p><figure class="me mf mg mh gu mi gi gj paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gi gj md"><img src="../Images/3dd9f7238029fa25f059eb6d511abb79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l7zzHXzREECg9pRx2s_nmQ.jpeg"/></div></div><figcaption class="mp mq gk gi gj mr ms bd b be z dk">Image Source: <a class="ae mc" href="http://www.wallpaperflare.com" rel="noopener ugc nofollow" target="_blank">www.wallpaperflare.com</a>.</figcaption></figure><p id="f251" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">微软Excel提供了一个名为“Ideas”的自动化EDA工具。在熟练的、有洞察力的分析师手中，这可以很好地补充一个或多个广泛可用的工具。</p><p id="4caf" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">为了测试“想法”，我把我最喜欢的演示数据集之一<a class="ae mc" href="https://towardsdatascience.com/three-datasets-i-often-use-as-examples-c70ec5b2f793" rel="noopener" target="_blank">加载到Excel中，并给这个自动化的EDA加了一把劲。<em class="mt">因为这是一次‘试驾’,所以我使用了著名的汽车数据集。</em>在本文中，我使用了汽车数据集，该数据集包含74个与汽车相关的观察值，包括价格、燃油效率、重量、尺寸、维修记录、制造产地和其他相关信息。我之前已经写过这个数据源</a>。</p><h1 id="f323" class="lf lg iu bd lh li lj lk ll lm ln lo lp ka lq kb lr kd ls ke lt kg lu kh lv lw bi translated">汽车数据集</h1><p id="8d22" class="pw-post-body-paragraph kj kk iu kl b km lx jv ko kp ly jy kr ks lz ku kv kw ma ky kz la mb lc ld le in bi translated">为了设置该数据集，我使用了以下代码为自己准备了该数据的本地副本，然后可以在Excel中打开:</p><pre class="me mf mg mh gu mu mv mw mx aw my bi"><span id="77f6" class="mz lg iu mv b gz na nb l nc nd">import pandas as pd</span><span id="6cd0" class="mz lg iu mv b gz ne nb l nc nd">auto = 'http://www.stata-press.com/data/r15/auto2.dta'<br/>df = pd.read_stata(auto)</span><span id="e0ec" class="mz lg iu mv b gz ne nb l nc nd">df.to_csv('auto2.csv')</span></pre><p id="e731" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">在Excel中，数据显示如下:</p><figure class="me mf mg mh gu mi gi gj paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gi gj nf"><img src="../Images/3b9d69be64e98de065b3ae7ee33f257c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uUh0irTYzzntkMg8G9QF2w.png"/></div></div><figcaption class="mp mq gk gi gj mr ms bd b be z dk">Image Credit: Author’s screen capture of data from stata-press.com.</figcaption></figure><p id="ace5" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">首先要注意的是，包含车辆维修记录信息的列(rep78)包含一些缺失的数据。我将关注Excel的自动化EDA是否以及如何处理丢失的数据。另一项需要注意的是，price看起来像一个整数，没有任何东西(除了列的标题)表明price与货币相关。</p><div class="ng nh gq gs ni nj"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fp"><div class="nl ab nm cl cj nn"><h2 class="bd iv gz z fq no fs ft np fv fx it bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="nq l"><h3 class="bd b gz z fq no fs ft np fv fx dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="nr l"><p class="bd b dl z fq no fs ft np fv fx dk translated">www.datadriveninvestor.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx mn nj"/></div></div></a></div><p id="10a9" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">下一步，单击下面红框中显示的Excel的“创意”按钮。只有74次观察，结果很快就回来了。</p><figure class="me mf mg mh gu mi gi gj paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gi gj ny"><img src="../Images/2a351b14300496456f3c2a46296aef95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gYaGtafmRk9yx_AhPO9_8g.png"/></div></div><figcaption class="mp mq gk gi gj mr ms bd b be z dk">Image Credit: Author’s screen capture from Microsoft Excel.</figcaption></figure><h2 id="f856" class="mz lg iu bd lh nz oa dn ll ob oc dp lp ks od oe lr kw of og lt la oh oi lv oj bi translated">结果</h2><p id="e62b" class="pw-post-body-paragraph kj kk iu kl b km lx jv ko kp ly jy kr ks lz ku kv kw ma ky kz la mb lc ld le in bi translated">第一个结果是一个折线图，将<em class="mt">价格</em>放在<em class="mt"> y </em>轴上，将<em class="mt">制造</em>放在<em class="mt"> x </em>轴上。我认为这种可视化的有用性很低。它既没有揭示有用的见解，也没有激发任何其他想法。</p><figure class="me mf mg mh gu mi gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/6d35842ce65aa1d12e045773e53fa759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*VlhEaCz24Vyk-tY392tfpA.png"/></div><figcaption class="mp mq gk gi gj mr ms bd b be z dk">Image Credit: Author’s screen capture from Microsoft Excel.</figcaption></figure><p id="1d72" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">第二个可视化(技术上是一个列表)是维修记录(rep78)、车辆品牌(make)和车辆长度(length)的三向枢纽。这些数据的一个我有时会忽略的方面是，这些数据将关于车辆品牌和型号的信息合并到品牌列中。</p><p id="a318" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">由于篇幅限制，这里我没有展示可视化。为了更好地理解第二个可视化效果，可以用Python生成一个等价的可视化效果，代码如下:</p><pre class="me mf mg mh gu mu mv mw mx aw my bi"><span id="79ed" class="mz lg iu mv b gz na nb l nc nd">df.pivot_table(index=['rep78','make'], aggfunc='sum')['length']</span></pre><p id="0342" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我对这种可视化的有用性评价很低。然而，它确实提醒了我make列需要一些数据清理。在进行进一步的EDA(自动化或其他方式)之前，我将确保使用类似于下面的代码来清理该数据列:</p><pre class="me mf mg mh gu mu mv mw mx aw my bi"><span id="6cfe" class="mz lg iu mv b gz na nb l nc nd"># Create a new column to contain vehicle model data<br/>df[‘model’] = df[‘make’].apply(lambda x: x.split()[1] <br/>                               if len(x.split()) &gt; 1 else x)</span><span id="2c9d" class="mz lg iu mv b gz ne nb l nc nd"># Create a new column to contain only make data<br/>df['make2'] = df['make'].apply(lambda x: x.split()[0])</span></pre><p id="88f9" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">第二次和第三次可视化也令人失望:</p><figure class="me mf mg mh gu mi gi gj paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gi gj ol"><img src="../Images/7989b0cb98b094b4880df38ef45e42da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7eVwcjRgkeAUFjKbEkVlwg.png"/></div></div><figcaption class="mp mq gk gi gj mr ms bd b be z dk">Image Credit: Author’s screen capture from Microsoft Excel.</figcaption></figure><p id="73d4" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">左侧显示的分析表明，较大的行李箱容量似乎与具有“一般”维修记录的车辆相关。右边显示的是一项分析，表明大部分的累积行李箱空间是在国内车辆。有用吗？见解深刻？</p><h2 id="6878" class="mz lg iu bd lh nz oa dn ll ob oc dp lp ks od oe lr kw of og lt la oh oi lv oj bi translated">最后看一眼</h2><p id="ca58" class="pw-post-body-paragraph kj kk iu kl b km lx jv ko kp ly jy kr ks lz ku kv kw ma ky kz la mb lc ld le in bi translated">为了帮助Excel的自动化EDA执行得更好，我用一个“干净”版本的make列重新加载了一个新的数据集。我还将价格的数字类型转换为美元。我把丢失的数据条目修改为“无数据”对数据稍加清理后，新的结果更有希望。</p><p id="20f0" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">Excel的自动化EDA生成了直方图、散点图、线图和表格。这些分析说明了潜在的相关性、聚类和异常值。39个自动化EDA可视化中的一些包括以下内容:</p><figure class="me mf mg mh gu mi gi gj paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gi gj om"><img src="../Images/f37c073575d9d8d9a2ae166295f3fb9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48PtkhlHoW09ZX5Vqo9fZw.png"/></div></div><figcaption class="mp mq gk gi gj mr ms bd b be z dk">Image Credit: Author’s screen capture from Microsoft Excel.</figcaption></figure><div class="ng nh gq gs ni nj"><a href="https://adamrossnelson.medium.com/membership" rel="noopener follow" target="_blank"><div class="nk ab fp"><div class="nl ab nm cl cj nn"><h2 class="bd iv gz z fq no fs ft np fv fx it bi translated">加入我的介绍链接媒体-亚当罗斯纳尔逊</h2><div class="nq l"><h3 class="bd b gz z fq no fs ft np fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nr l"><p class="bd b dl z fq no fs ft np fv fx dk translated">adamrossnelson.medium.com</p></div></div><div class="ns l"><div class="on l nu nv nw ns nx mn nj"/></div></div></a></div><h1 id="b905" class="lf lg iu bd lh li lj lk ll lm ln lo lp ka lq kb lr kd ls ke lt kg lu kh lv lw bi translated">最终分析</h1><p id="d0d2" class="pw-post-body-paragraph kj kk iu kl b km lx jv ko kp ly jy kr ks lz ku kv kw ma ky kz la mb lc ld le in bi translated">继续寻找最喜欢的一站式自动化EDA工具。我可以再次使用Excel的EDA，但我也可能会将它与Pandas Profiling结合使用，后者已在Medium上多次讨论过(<a class="ae mc" href="https://towardsdatascience.com/speed-up-your-exploratory-data-analysis-with-pandas-profiling-88b33dc53625" rel="noopener" target="_blank">使用Pandas-profiling加速您的探索性数据分析</a>，<a class="ae mc" href="https://towardsdatascience.com/a-better-eda-with-pandas-profiling-e842a00e1136" rel="noopener" target="_blank">使用Pandas-Profiling实现更好的EDA</a>，以及<a class="ae mc" href="https://towardsdatascience.com/exploratory-data-analysis-with-pandas-profiling-de3aae2ddff3" rel="noopener" target="_blank">使用Pandas Profiling进行探索性数据分析</a>)。我最喜欢的另一个EDA工具是久经考验的联合图、配对图，甚至是我在<a class="ae mc" href="https://seaborn.pydata.org/examples/index.html" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>中试图执行的有争议的小提琴图。</p><p id="40a3" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">当谈到可以有效地自动化EDA的任何部分的工具时，我管理我的期望。从Excel中的这些例子可以看出，在将数据交给算法之前，仍然有必要查看数据。</p><ul class=""><li id="7dce" class="oo op iu kl b km kn kp kq ks oq kw or la os le ot ou ov ow bi translated">Excel没有识别丢失的数据。</li><li id="9f9f" class="oo op iu kl b km ox kp oy ks oz kw pa la pb le ot ou ov ow bi translated">如果没有额外的设置和配置，Excel无法理解至少两个最重要的数据列的性质。</li><li id="75d0" class="oo op iu kl b km ox kp oy ks oz kw pa la pb le ot ou ov ow bi translated">大多数建议的可视化提供了很少有意义的见解。</li><li id="c26d" class="oo op iu kl b km ox kp oy ks oz kw pa la pb le ot ou ov ow bi translated">一些可视化启发了我以后用其他工具实现的其他可视化和分析。</li></ul><h1 id="26f2" class="lf lg iu bd lh li lj lk ll lm ln lo lp ka lq kb lr kd ls ke lt kg lu kh lv lw bi translated">感谢阅读</h1><p id="e6f8" class="pw-post-body-paragraph kj kk iu kl b km lx jv ko kp ly jy kr ks lz ku kv kw ma ky kz la mb lc ld le in bi translated">感谢阅读。把你的想法和主意发给我。你可以写信只是为了说声嗨。如果你真的需要告诉我是怎么错的，我期待着尽快和你聊天。Twitter:<a class="ae mc" href="https://twitter.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">@ adamrossnelson</a>LinkedIn:<a class="ae mc" href="https://www.linkedin.com/in/arnelson/" rel="noopener ugc nofollow" target="_blank">亚当罗斯尼尔森</a>。</p><figure class="me mf mg mh gu mi"><div class="bz fq l di"><div class="pc pd l"/></div></figure></div></div>    
</body>
</html>