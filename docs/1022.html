<html>
<head>
<title>Creating Pods Using YAML File</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用YAML文件创建窗格</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/creating-pods-using-yaml-file-7737e456c9de?source=collection_archive---------10-----------------------#2020-02-27">https://medium.datadriveninvestor.com/creating-pods-using-yaml-file-7737e456c9de?source=collection_archive---------10-----------------------#2020-02-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/31c8679823d8ce88f8444939264e7658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dZq-THThMZOdVT8G"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">(Photo By Simon Migaj on Unsplsh)</figcaption></figure><p id="57e6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在之前的博文<a class="ae la" href="https://medium.com/@adityamohanty/importance-of-pods-in-kubernetes-7ff838dc1e9c" rel="noopener">https://medium . com/@ adityamohanty/importance-of-pods-in-kubernetes-7ff 838 DC 1e 9 c</a>中，我们已经讨论了kubernetes中pod的重要性。在这篇文章中，我们将看到如何使用YAML文件创建一个pod。</p><h2 id="bb63" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">YAML文件:</h2><p id="9a33" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated"><em class="lz"> YAML </em>代表专用于配置文件的“<strong class="ke ir"> YAML不是标记语言</strong>”。它是一种数据序列化语言，用于将数据结构转换成可以存储的格式。YAML在kubernetes中特别有用，它允许轻松地创建复杂的结构，而不是依赖命令行。</p><div class="ma mb gp gr mc md"><a href="https://www.datadriveninvestor.com/2019/03/26/agile-management-the-good-the-bad-and-the-downright-ugly/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">敏捷管理:好的、坏的、丑陋的|数据驱动的投资者</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">公司不断重塑自己，以获得或保持竞争优势和市场份额。这是…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr jw md"/></div></div></a></div><h2 id="a981" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">YAML为一个POD文件:</h2><p id="a5e2" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">让我们了解一下yaml文件的基本部分。一般来说，pod可能由以下部分组成。</p><p id="3d05" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> apiVersion </strong>:这描述了yaml文件中使用的kubernetes api版本。</p><p id="583b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">种类:</strong>该字段显示yaml文件描述的资源类型。</p><p id="6f2e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">元数据:</strong>这包括关于pod的各种信息，如名称、标签、名称空间等。</p><p id="38c4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">规格:</strong>显示pod内容的描述，如pod的容器、体积和其他数据。</p><p id="da3b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">状态:</strong>包含正在运行的pod的信息。比如每个集装箱的描述和状态。</p><p id="61d7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将看到如何为pod创建yaml文件。让我们看看下面创建pod的文件。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="f735" class="lb lc iq mx b gy nb nc l nd ne">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/> name: mypod<br/>spec:<br/> containers:<br/> — image: newpod<br/>   name: firstpod<br/> ports:<br/> — containerPort: 8080<br/>   protocol: TCP</span></pre><p id="8aa6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上面的代码片段显示了一个非常简单的yaml文件。第一行显示了kubernetes api的版本v1。同样，第二行显示了我们所指的资源类型，这里是<strong class="ke ir"> Pod。</strong>元数据的子节点<em class="lz">名称</em>表示Pod的名称。pod有一个名为<em class="lz"> firstpod的容器。</em>集装箱在8080港口运行。</p><h2 id="e79f" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">使用kubectl创建pod:</h2><p id="c3f7" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">为了从yaml文件创建pod，我们将使用kubectl命令。例如，可以在终端中使用以下命令从yaml文件创建Pod。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="5064" class="lb lc iq mx b gy nb nc l nd ne">$ kubectl create -f mypod.yaml</span></pre><p id="b3cf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要了解pod列表，我们可以借助以下命令。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4299" class="lb lc iq mx b gy nb nc l nd ne">$ kubectl get pods</span></pre><h2 id="2539" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">标签:</h2><p id="8728" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">当创造圆荚体时，圆荚体的数量可能会增加很多。如果没有一个合适的机制，组织这些舱会非常困难。这将导致一个彻底的混乱。因此，我们需要一种机制来以适当的方式组织它们，以便我们可以知道哪个pod属于哪个组或类。因此，这种组织豆荚的任务是通过标签完成的。<strong class="ke ir">标签</strong>有助于组织各种kubernetes资源。我们将每个资源存储在一个键值对中，稍后使用<strong class="ke ir"> <em class="lz">标签选择器</em> </strong>来选择资源。我们可以为每个资源设置多个标签，只要它们是唯一的。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="5978" class="lb lc iq mx b gy nb nc l nd ne">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/> name: label-demo<br/> labels:<br/>   type: demo<br/>   env: prod<br/>spec:<br/> containers:<br/> — image: new<br/> name: label<br/> ports:<br/> — containerPort: 8080<br/> protocol: TCP</span></pre><p id="16f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上面的代码片段显示了一个yaml文件的结构，该文件使用label来组织pod。作为标签，我们有<em class="lz">类型</em>和<em class="lz">环境。为了了解创建的标签，我们将使用以下命令。</em></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8dea" class="lb lc iq mx b gy nb nc l nd ne">$kubectl get po — show-labels</span></pre><p id="d2ff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了选择某些标签，我们可以利用标签选择器根据某些条件来选择资源，比如它是否包含带有某个键或某个键和值的标签等。</p><p id="76e8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">假设我们想要列出所有带有<em class="lz"> env=prod </em>的pod，我们将使用以下命令。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="23b3" class="lb lc iq mx b gy nb nc l nd ne">$kubectl get po -l env=prod</span></pre><h2 id="759d" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">特定节点的调度窗格:</h2><p id="41df" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">假设我们希望将pod调度到一个可以访问GPU的特定节点。为了做到这一点，我们将使用以下代码。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="5434" class="lb lc iq mx b gy nb nc l nd ne">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/> name: mypod<br/>spec:<br/> nodeSelector:<br/>   gpu: “true”<br/> containers:<br/> — image: newpod<br/>   name: demo</span></pre><p id="d3ba" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此处<strong class="ke ir">节点选择器</strong>添加在<em class="lz">规格</em>部分下。这将使我们能够选择支持gpu的节点。</p><p id="a19d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这篇文章中，我们看到了使用YAML文件的各种方法。在下一篇博客中，我们将看到复制。</p><figure class="ms mt mu mv gt jr"><div class="bz fp l di"><div class="nf ng l"/></div></figure></div></div>    
</body>
</html>