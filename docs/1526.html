<html>
<head>
<title>Rank top 10 in competition with this tip: Hyper-Parameter Tuning with Hyperas for Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">排名前10的竞争与此技巧:超参数调整与Hyperas的神经网络</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/rank-top-10-in-competition-with-this-tip-hyper-parameter-tuning-with-hyperas-for-neural-networks-96e2d347ffab?source=collection_archive---------1-----------------------#2020-03-21">https://medium.datadriveninvestor.com/rank-top-10-in-competition-with-this-tip-hyper-parameter-tuning-with-hyperas-for-neural-networks-96e2d347ffab?source=collection_archive---------1-----------------------#2020-03-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c150fcb6ae54535756660bef922b4047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAdePJ42JnocHRffHHA33g.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/@franckinjapan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Franck V.</a> on <a class="ae jg" href="https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><blockquote class="kg kh ki"><p id="c28f" class="kj kk kl km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在XGBoost超参数调整之后，现在轮到CNN和通用神经网络了。</p></blockquote><p id="6b15" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">虽然给出源代码可能已经很有用了，但是我要做的是一部分一部分地解释我写的代码，这样你就可以调整选项并自己调试。</p><p id="d041" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">以下是完整的源代码:</p><figure class="ll lm ln lo gt iv"><div class="bz fp l di"><div class="lp lq l"/></div></figure><h1 id="9159" class="lr ls jj bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">研究案例介绍</h1><p id="9685" class="pw-post-body-paragraph kj kk jj km b kn mp kp kq kr mq kt ku li mr kx ky lj ms lb lc lk mt lf lg lh im bi translated">CNN模型的目标是将裁剪后的图片分为4类，即:</p><pre class="ll lm ln lo gt mu mv mw mx aw my bi"><span id="5407" class="mz ls jj mv b gy na nb l nc nd">['Attire','Decorationandsignage','Food','misc']</span></pre><p id="907d" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">这个数据集来源于黑客地球<a class="ae jg" href="https://www.hackerearth.com/en-us/challenges/competitive/hackerearth-deep-learning-challenge-auto-tag-images-gala/problems/" rel="noopener ugc nofollow" target="_blank">挑战赛</a>的Gala检测。在我们的笔记本中，我们对数据集进行了简单的数据分析。(如果你碰巧感兴趣，请写信给我，我可以寄给你)</p><p id="0e36" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">Hyperas方法的完整代码由两部分组成，即数据准备和CNN模型:</p><h1 id="b5c2" class="lr ls jj bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">数据准备(都在我们稍后将调用的函数中)</h1><p id="2a28" class="pw-post-body-paragraph kj kk jj km b kn mp kp kq kr mq kt ku li mr kx ky lj ms lb lc lk mt lf lg lh im bi translated">在这一部分，我们需要把所有的数据加载，在这个函数的数据预处理，使其输出可以立即馈入神经网络。</p><figure class="ll lm ln lo gt iv"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="1cb2" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">注意事项:</p><ul class=""><li id="2b9f" class="ne nf jj km b kn ko kr ks li ng lj nh lk ni lh nj nk nl nm bi translated">全局变量也需要放在data()函数中，您可能在笔记本上工作，并认为可以在作用域上找到以前分配的变量，但事实并非如此。</li><li id="c98b" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">幸运的是，data()函数在给优化函数时只被调用一次。</li></ul><h1 id="0d29" class="lr ls jj bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">CNN模型:特定于Hyperas</h1><p id="fce2" class="pw-post-body-paragraph kj kk jj km b kn mp kp kq kr mq kt ku li mr kx ky lj ms lb lc lk mt lf lg lh im bi translated">这是CNN模型的一个样本/版本。架构的快速描述，我们这里有:</p><ul class=""><li id="c033" class="ne nf jj km b kn ko kr ks li ng lj nh lk ni lh nj nk nl nm bi translated">输入层具有形状(48，48，1)</li><li id="26e4" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">4到5个卷积层(使用过滤器(3×3)和(5×5))(与归一化相结合)</li><li id="5a3f" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">2个最大池(2D)和2个密集层</li><li id="0240" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">我们只在隐藏层使用ReLu激活，在输出层使用softmax</li><li id="b7fd" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">我们也尝试了不同的神经网络优化器，如亚当，SGD等…</li></ul><figure class="ll lm ln lo gt iv"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="3967" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">通过这些设置，我们正在尝试的超参数将会是:</p><ul class=""><li id="9f32" class="ne nf jj km b kn ko kr ks li ng lj nh lk ni lh nj nk nl nm bi translated">从Dropout(0.25)我们将其更改为Dropout({{uniform(0，1)}}):这允许以随机方式在区间[0，1]中找到列车损失的最佳参数(这意味着我们采样并且不尝试0和1之间的每个单个值)</li><li id="c474" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">从密集(256)到密集({{choice([256，512，1024]}}):这允许我们针对该FC层的列车损耗再次挑选最佳参数。</li><li id="94d4" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">在optimizer字段中输入optimizer={{choice(['rmsprop '，' adam '，' sgd'])}}将得到这3个选项中的最佳优化器。</li><li id="ca14" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated">batch_size={{choice([64，128])}}的工作方式与前面的类似</li></ul><p id="4be2" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我们决定优化这些参数，但显然你可以尝试修改其他超参数。</p><h1 id="2d93" class="lr ls jj bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">优化和拟合</h1><p id="ced4" class="pw-post-body-paragraph kj kk jj km b kn mp kp kq kr mq kt ku li mr kx ky lj ms lb lc lk mt lf lg lh im bi translated">模型现在设定，让我们优化所有先前陈述的超参数。</p><figure class="ll lm ln lo gt iv"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="011f" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">函数minimize()将模型函数和数据函数作为参数。为了获得最佳的超参数值，您只需执行print(best_run))。</p><h1 id="3637" class="lr ls jj bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">根据您的设置，实施过程中可能会出现错误</h1><p id="7517" class="pw-post-body-paragraph kj kk jj km b kn mp kp kq kr mq kt ku li mr kx ky lj ms lb lc lk mt lf lg lh im bi translated">这里有一些你可能会遇到的错误和处理方法。</p><ul class=""><li id="9f6f" class="ne nf jj km b kn ko kr ks li ng lj nh lk ni lh nj nk nl nm bi translated"><strong class="km jk">类型错误:需要字符串标签| </strong>您需要将您的代码包装在一个<code class="fe ns nt nu mv b">def create_model(...): ...</code>函数中，然后像示例中一样从<code class="fe ns nt nu mv b">optim.minimize(model=create_model,...</code>调用它。</li><li id="b276" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated"><strong class="km jk">类型错误:“生成器”对象不可订阅</strong> |只需运行pip install networkx==1.11</li><li id="cfc8" class="ne nf jj km b kn nn kr no li np lj nq lk nr lh nj nk nl nm bi translated"><strong class="km jk">“没有这样的文件或目录”或OSError，Err22 | </strong>在optim.minimize中添加以下代码，就像我们对代码所做的那样:notebook _ name = ' { your _ notebook _ name } '</li></ul><p id="1632" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">如果你想了解更多关于Hyperas的知识，我强烈建议你查看它的原始<a class="ae jg" href="https://github.com/maxpumperla/hyperas" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="7eb0" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">感谢阅读，记得评论你是否喜欢我的文章。下面是另一篇<a class="ae jg" href="https://medium.com/swlh/xgboost-hyperparameters-optimization-with-scikit-learn-to-rank-top-20-44ea528efa58" rel="noopener">文章</a>关于机器学习模型优化的实现。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="e887" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">你可以在这里找到我的博客，那里有其他的文章和产品。</p><p id="cde4" class="pw-post-body-paragraph kj kk jj km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">此外，点击这个<a class="ae jg" href="https://direct-link.net/91830/aitechfordummies" rel="noopener ugc nofollow" target="_blank">链接</a>(指向加盟计划)真的会帮我解决问题！您只需完成一些快速任务(只需等待和激活通知)，所有这些将真正帮助我了解更多未来的硬件相关内容！</p></div></div>    
</body>
</html>