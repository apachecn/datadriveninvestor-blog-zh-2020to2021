<html>
<head>
<title>Mathematics for Machine Learning Part-1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的数学第一部分</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/mathematics-for-machine-learning-part-1-5e210c138a12?source=collection_archive---------11-----------------------#2021-01-05">https://medium.datadriveninvestor.com/mathematics-for-machine-learning-part-1-5e210c138a12?source=collection_archive---------11-----------------------#2021-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="200e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">数学是万能的</em> </strong> <em class="kl">。机器学习是建立在</em> <strong class="jp ir"> <em class="kl">线性代数、</em> </strong> <em class="kl">等数学前提之上的。现在，我们将看到使用Python实现这些先决条件中的基本数学概念。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/2faf3c2aea60e081d5a81a4357e4f1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47TlrDSO7LEpgO015bQYqA.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Image Source: Pinterest (Edited)</figcaption></figure><h1 id="657e" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">线性代数</h1><p id="accd" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">数学的一个分支，研究在<em class="kl">加法</em>和<em class="kl">标量乘法</em>运算下闭合的数学结构，包括线性方程组、矩阵、行列式、向量空间和线性变换的理论——来源: <a class="ae mf" href="https://www.merriam-webster.com/dictionary/linear%20algebra" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">韦氏词典</em> </strong> </a></p><p id="8344" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">如果你还没有经历— </em> <a class="ae mf" href="https://medium.com/analytics-vidhya/getting-familiar-with-numpy-854fc60ac497" rel="noopener"> <strong class="jp ir"> <em class="kl">熟悉Numpy</em></strong></a><strong class="jp ir"><em class="kl"/></strong><em class="kl">一定要经历！我们将需要Numpy来实现大多数数学概念！</em></p><h2 id="0700" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">内容</h2><ul class=""><li id="6c2c" class="ms mt iq jp b jq ma ju mb jy mu kc mv kg mw kk mx my mz na bi translated"><em class="kl">矩阵乘法</em></li><li id="3847" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">矩阵异能</em></li><li id="255f" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">转置</em></li><li id="5ee5" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">逆</em></li><li id="3b8d" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">追踪</em></li><li id="8058" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">行列式</em></li><li id="e72a" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">特征多项式和凯莱-汉密尔顿定理</em></li><li id="cc0f" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">预测</em></li><li id="cebe" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">线性系统</em></li><li id="4e5a" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">高斯消去法</em></li><li id="8945" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">初等行运算</em></li><li id="e74e" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">逆</em></li><li id="8fe5" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><em class="kl">求解一个系统</em></li></ul><h2 id="5e8c" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">入门指南</h2><p id="6722" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">本教程需要导入的库—<a class="ae mf" href="https://medium.com/analytics-vidhya/getting-familiar-with-numpy-854fc60ac497" rel="noopener"><strong class="jp ir"><em class="kl">Numpy</em></strong></a><strong class="jp ir"><em class="kl">，</em></strong><a class="ae mf" href="https://medium.com/analytics-vidhya/data-visualization-using-python-part-i-19f9b76d43dc" rel="noopener"><strong class="jp ir"><em class="kl">Matplotlib</em></strong></a><strong class="jp ir"><em class="kl">和Scipy </em> </strong></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="ef8b" class="mg ld iq nh b gy nl nm l nn no">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import scipy.linalg as la<br/>%matplotlib inline</span></pre><p id="a59f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">让我们为— </em>计算<strong class="jp ir"><em class="kl">2I+3A AB</em></strong><em class="kl">(I是大小为2的单位矩阵)</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/95e66d2d298dadcca7cf1537225a0c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*8mbLZ0cK_lRebkcn17UdTw.png"/></div></figure><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="098d" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,3],[-1,7]])<br/>print(A)</span><span id="d4bd" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1  3]<br/> [-1  7]]</span><span id="025f" class="mg ld iq nh b gy nq nm l nn no">B = np.array([[5,2],[1,2]])<br/>print(B)</span><span id="f6b7" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[5 2]<br/> [1 2]]</span><span id="9137" class="mg ld iq nh b gy nq nm l nn no">I = np.eye(2)<br/>print(I)</span><span id="2397" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1. 0.]<br/> [0. 1.]]</span><span id="c4af" class="mg ld iq nh b gy nq nm l nn no">2*I + 3*A - A@B</span><span id="7147" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[-3.,  1.],<br/>       [-5., 11.]])</span></pre><h2 id="9bce" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">矩阵幂</h2><p id="9770" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">没有矩阵幂的符号，所以我们必须从子包<code class="fe nr ns nt nh b">numpy.linalg</code>中导入函数<code class="fe nr ns nt nh b">matrix_power</code>。</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="6e3e" class="mg ld iq nh b gy nl nm l nn no">from numpy.linalg import matrix_power as mpow</span><span id="2aa3" class="mg ld iq nh b gy nq nm l nn no">M = np.array([[3,4],[-1,5]])<br/>print(M)</span><span id="4ff4" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 3  4]<br/> [-1  5]]</span><span id="4299" class="mg ld iq nh b gy nq nm l nn no">mpow(M,2)</span><span id="9f0c" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 5, 32],<br/>       [-8, 21]])</span><span id="971f" class="mg ld iq nh b gy nq nm l nn no">mpow(M,5)</span><span id="a725" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[-1525,  3236],<br/>       [ -809,    93]])</span></pre><p id="bcb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">与矩阵乘法运算符比较:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="f440" class="mg ld iq nh b gy nl nm l nn no">M @ M @ M @ M @ M</span><span id="3da6" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[-1525,  3236],<br/>       [ -809,    93]])</span></pre><h2 id="2d0a" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">移项</h2><p id="b896" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><em class="kl">我们可以用</em> <code class="fe nr ns nt nh b">.T</code> <em class="kl">属性:</em>取转置</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="7a43" class="mg ld iq nh b gy nl nm l nn no">print(M)</span><span id="d237" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 3  4]<br/> [-1  5]]</span><span id="bde4" class="mg ld iq nh b gy nq nm l nn no">print(M.T)</span><span id="29c6" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 3 -1]<br/> [ 4  5]]</span></pre><p id="34d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注意M.MT是一个对称矩阵:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="bb8f" class="mg ld iq nh b gy nl nm l nn no">M @ M.T</span><span id="22e1" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[25, 17],<br/>       [17, 26]])</span></pre><h2 id="3aa9" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">相反的</h2><p id="ec74" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><em class="kl">我们可以用函数</em> <code class="fe nr ns nt nh b">scipy.linalg.inv</code>求逆:</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="619c" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,2],[3,4]])<br/>print(A)</span><span id="eb34" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1 2]<br/> [3 4]]</span><span id="7d68" class="mg ld iq nh b gy nq nm l nn no">la.inv(A)</span><span id="8510" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[-2. ,  1. ],<br/>       [ 1.5, -0.5]])</span></pre><h2 id="6f40" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">找到；查出</h2><p id="2756" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><em class="kl">我们可以使用</em> <code class="fe nr ns nt nh b">numpy.trace</code>函数找到一个矩阵的迹:</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="b86c" class="mg ld iq nh b gy nl nm l nn no">np.trace(A)</span><span id="1017" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>5</span></pre><h2 id="a245" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">决定因素</h2><p id="b2d5" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><em class="kl">我们用函数</em> <code class="fe nr ns nt nh b">scipy.linalg.det</code>找到行列式:</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="7857" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,2],[3,4]])<br/>print(A)</span><span id="65e4" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1 2]<br/> [3 4]]</span><span id="737f" class="mg ld iq nh b gy nq nm l nn no">la.det(A)</span><span id="76c3" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>-2.0</span></pre><h2 id="27eb" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">特征多项式和Cayley-Hamilton定理</h2><p id="57bb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">2乘2方阵A 的特征多项式为</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/ec2a0dab541c96364347c20f680b71cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*aqGedc0R0scX4m7BfAWNiA.png"/></div></figure><p id="dbd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mf" href="https://en.wikipedia.org/wiki/Cayley%E2%80%93Hamilton_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl"> Cayley-Hamilton定理</em> </strong> </a>陈述任意方阵满足其特征多项式。</p><blockquote class="nv nw nx"><p id="a9b9" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">对于大小为2的矩阵A，这意味着</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/d670f088a9a5c744e5a0da02ae304c5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*4uWXt34K2dFoJhoO4wXfKQ.png"/></div></figure><p id="7bc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">让我们针对几个不同的矩阵来验证</em> <strong class="jp ir"> <em class="kl"> Cayley-Hamilton定理</em></strong><em class="kl">—</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="984c" class="mg ld iq nh b gy nl nm l nn no">print(A)</span><span id="43b6" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1 2]<br/> [3 4]]</span><span id="e503" class="mg ld iq nh b gy nq nm l nn no">trace_A = np.trace(A)<br/>det_A = la.det(A)<br/>I = np.eye(2)<br/>A @ A - trace_A * A + det_A * I</span><span id="f6b1" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[0., 0.],<br/>       [0., 0.]])</span></pre><h2 id="ba9b" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">预测</h2><p id="0f53" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><em class="kl">将矢量v投影到矢量w </em>上的公式是—</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/fcb3f12861cdfd0c6cf6ee6946e492bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*aNr0ngH3VQkIWYJZEYbNeQ.png"/></div></figure><p id="6e3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">让我们用一个叫做</em> <code class="fe nr ns nt nh b">proj</code> <em class="kl">的函数来计算v到w的投影:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="4087" class="mg ld iq nh b gy nl nm l nn no">def <strong class="nh ir">proj</strong>(v,w):<br/>    '''Project vector v onto w.'''<br/>    v = np.array(v)<br/>    w = np.array(w)<br/>    return np.sum(v * w)/np.sum(w * w) * w  # or (v @ w)/(w @ w) * w</span><span id="175d" class="mg ld iq nh b gy nq nm l nn no">proj([1,2,3],[1,1,1])</span><span id="85c3" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([2., 2., 2.])</span></pre><h2 id="b735" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">求解线性系统</h2><h2 id="2423" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">线性系统</h2><p id="a43d" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">一个<a class="ae mf" href="https://en.wikipedia.org/wiki/System_of_linear_equations" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">线性方程组</em> </strong> </a>是线性方程组的集合</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b76e0b800d7cd2d8d9fae2cfc4c7966e.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*oJ5BxHAmA44JxtoqtsaLlw.png"/></div></figure><p id="3b6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在矩阵符号中，一个线性系统是<strong class="jp ir"> <em class="kl"> Ax=b </em> </strong>其中</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oe"><img src="../Images/50453742294d440af5c3e8be66089f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6EuQbnn_L5dsgAm1fC7p6A.png"/></div></div></figure><h2 id="a608" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">高斯消去法</h2><p id="57b4" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">求解线性方程组的一般程序称为<a class="ae mf" href="https://en.wikipedia.org/wiki/Gaussian_elimination" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">高斯消去</em> </strong> </a>。其思想是执行基本的行操作，将系统简化为行梯队形式，然后求解。</p><h2 id="5735" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">初等行运算</h2><p id="99b2" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae mf" href="https://en.wikipedia.org/wiki/Elementary_matrix#Elementary_row_operations" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">初等行操作</em> </strong> </a>包括:</p><ol class=""><li id="7787" class="ms mt iq jp b jq jr ju jv jy of kc og kg oh kk oi my mz na bi translated"><em class="kl">将k乘以第j行加到第I行</em></li><li id="a439" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk oi my mz na bi translated"><em class="kl">将第I行乘以标量k </em></li><li id="171f" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk oi my mz na bi translated"><em class="kl">切换第I行和第j行</em></li></ol><p id="2bfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个基本行操作都是矩阵乘以基本矩阵的结果。为了将矩阵A中的第I行的k乘以第j行的j相加，我们将A乘以矩阵E，其中E等于单位矩阵，除了I，j项是e i，j=k</p><blockquote class="nv nw nx"><p id="329f" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">例如，如果A是3乘3，我们想将第2行的3倍加到第0行(使用0索引),那么—</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/e40c99e746417d9174e00becdd16b97b.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*4kfXYeaZ386nF3w5zjo9MA.png"/></div></figure><p id="1a37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我们来验证一下计算:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="20d8" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,1,2],[-1,3,1],[0,5,2]])<br/>print(A)</span><span id="87d2" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:</strong><br/>[[ 1  1  2]<br/> [-1  3  1]<br/> [ 0  5  2]]</span><span id="c44b" class="mg ld iq nh b gy nq nm l nn no">E1 = np.array([[1,0,3],[0,1,0],[0,0,1]])<br/>print(E1)</span><span id="88c7" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1 0 3]<br/> [0 1 0]<br/> [0 0 1]]</span><span id="a170" class="mg ld iq nh b gy nq nm l nn no">E1 @ A</span><span id="9572" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 1, 16,  8],<br/>       [-1,  3,  1],<br/>       [ 0,  5,  2]])</span></pre><p id="7461" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了<em class="kl">将矩阵A中的k乘以行i </em>，我们<em class="kl">将A乘以矩阵E </em>其中E等于单位矩阵<em class="kl">除了I，j </em>条目是<strong class="jp ir"> <em class="kl"> Ei，i=k. </em> </strong></p><blockquote class="nv nw nx"><p id="1cab" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">例如，如果A是3乘3，我们想将第1行乘以-2，那么—</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/697c7c5a29982b4ace2e78deaf3f8977.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*s2y5AEEcP5WgenlBaiExkQ.png"/></div></figure><p id="56cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我们来验证一下计算:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="9412" class="mg ld iq nh b gy nl nm l nn no">E2 = np.array([[1,0,0],[0,-2,0],[0,0,1]])<br/>print(E2)</span><span id="0ca3" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:</strong><br/>[[ 1  0  0]<br/> [ 0 -2  0]<br/> [ 0  0  1]]</span><span id="d018" class="mg ld iq nh b gy nq nm l nn no">E2 @ A</span><span id="c800" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 1,  1,  2],<br/>       [ 2, -6, -2],<br/>       [ 0,  5,  2]])</span></pre><p id="307a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，为了<em class="kl">切换矩阵A中的第I行和第j行</em>，我们<em class="kl">将A乘以矩阵E </em>其中E等于单位矩阵<em class="kl">除了</em> <strong class="jp ir"> <em class="kl"> Ei，i=0 </em> </strong> <em class="kl">，</em> <strong class="jp ir"> <em class="kl"> Ej，j=0 </em> </strong> <em class="kl">，</em> <strong class="jp ir"> <em class="kl"> Ei，j=1 </em> </strong>和</p><blockquote class="nv nw nx"><p id="d73a" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">例如，如果A是3乘3，我们想交换第1行和第2行，那么—</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ol"><img src="../Images/99260e1e7c40542acf59e90ee8a8ee7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*R1swykYiZwg5B8B4y5AmDQ.png"/></div></div></figure><p id="80aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我们来验证一下计算:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="c625" class="mg ld iq nh b gy nl nm l nn no">E3 = np.array([[1,0,0],[0,0,1],[0,1,0]])<br/>print(E3)</span><span id="6b7f" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1 0 0]<br/> [0 0 1]<br/> [0 1 0]]</span><span id="0c37" class="mg ld iq nh b gy nq nm l nn no">E3 @ A</span><span id="c745" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 1,  1,  2],<br/>       [ 0,  5,  2],<br/>       [-1,  3,  1]])</span></pre><h2 id="8e56" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">履行</h2><p id="6be3" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">现在让我们编写函数来实现<strong class="jp ir"> <em class="kl">初等行操作。</em></strong></p><p id="8946" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果<strong class="jp ir"> <em class="kl"> i=j </em></strong></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="4d33" class="mg ld iq nh b gy nl nm l nn no">def <strong class="nh ir">add_row</strong>(A,k,i,j):<br/>    "Add k times row j to row i in matrix A."<br/>    n = A.shape[0]<br/>    E = np.eye(n)<br/>    if i == j:<br/>        E[i,i] = k + 1<br/>    else:<br/>        E[i,j] = k<br/>    return E @ A</span></pre><p id="c9cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">让我们测试一下我们的功能:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="8cdf" class="mg ld iq nh b gy nl nm l nn no">M = np.array([[1,1],[3,2]])<br/>print(M)</span><span id="43a3" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1 1]<br/> [3 2]]</span><span id="de9a" class="mg ld iq nh b gy nq nm l nn no">add_row(M,2,0,1)</span><span id="c4ac" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[7., 5.],<br/>       [3., 2.]])</span></pre><p id="6465" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们编写一个名为<code class="fe nr ns nt nh b">scale_row</code>的函数，它接受3个输入参数<em class="kl"> A、k和i </em>，并返回矩阵A中由<em class="kl"> k乘以第I行</em>得到的矩阵。</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="6d59" class="mg ld iq nh b gy nl nm l nn no">def <strong class="nh ir">scale_row</strong>(A,k,i):<br/>    "Multiply row i by k in matrix A."<br/>    n = A.shape[0]<br/>    E = np.eye(n)<br/>    E[i,i] = k<br/>    return E @ A</span></pre><p id="b4da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">让我们测试一下我们的功能:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="d790" class="mg ld iq nh b gy nl nm l nn no">M = np.array([[3,1],[-2,7]])<br/>print(M)</span><span id="12f7" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 3  1]<br/> [-2  7]]</span><span id="c657" class="mg ld iq nh b gy nq nm l nn no">scale_row(M,3,1)</span><span id="8040" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 3.,  1.],<br/>       [-6., 21.]])</span></pre><p id="413b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们编写一个名为<code class="fe nr ns nt nh b">switch_rows</code>的函数，它接受3个输入参数<em class="kl"> A、I和j </em>，并返回由<em class="kl">切换矩阵A中的行I和j </em>得到的矩阵</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="edea" class="mg ld iq nh b gy nl nm l nn no">def <strong class="nh ir">switch_rows</strong>(A,i,j):<br/>    "Switch rows i and j in matrix A."<br/>    n = A.shape[0]<br/>    E = np.eye(n)<br/>    E[i,i] = 0<br/>    E[j,j] = 0<br/>    E[i,j] = 1<br/>    E[j,i] = 1<br/>    return E @ A</span></pre><p id="1e83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">让我们测试一下我们的功能:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="f4d3" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,1,1],[1,-1,0]])<br/>print(A)</span><span id="897c" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1  1  1]<br/> [ 1 -1  0]]</span><span id="06c9" class="mg ld iq nh b gy nq nm l nn no">switch_rows(A,0,1)</span><span id="05fb" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 1., -1.,  0.],<br/>       [ 1.,  1.,  1.]])</span></pre><h2 id="4e03" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">例子</h2><h2 id="a146" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">求逆</h2><p id="3c58" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们将我们的函数应用于<strong class="jp ir"> <em class="kl">增广矩阵</em></strong><em class="kl">【M | I】</em>来寻找矩阵M的<strong class="jp ir"> <em class="kl">逆</em> </strong>:</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="0dba" class="mg ld iq nh b gy nl nm l nn no">M = np.array([[5,4,2],[-1,2,1],[1,1,1]])<br/>print(M)</span><span id="1891" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 5  4  2]<br/> [-1  2  1]<br/> [ 1  1  1]]</span><span id="3f8c" class="mg ld iq nh b gy nq nm l nn no">A = np.hstack([M,np.eye(3)])<br/>print(A)</span><span id="74bd" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 5.  4.  2.  1.  0.  0.]<br/> [-1.  2.  1.  0.  1.  0.]<br/> [ 1.  1.  1.  0.  0.  1.]]</span><span id="f258" class="mg ld iq nh b gy nq nm l nn no">A1 = switch_rows(A,0,2)<br/>print(A1)</span><span id="d908" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.  1.  1.  0.  0.  1.]<br/> [-1.  2.  1.  0.  1.  0.]<br/> [ 5.  4.  2.  1.  0.  0.]]</span><span id="e5db" class="mg ld iq nh b gy nq nm l nn no">A2 = add_row(A1,1,1,0)<br/>print(A2)</span><span id="0d44" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1. 1. 1. 0. 0. 1.]<br/> [0. 3. 2. 0. 1. 1.]<br/> [5. 4. 2. 1. 0. 0.]]</span><span id="79d9" class="mg ld iq nh b gy nq nm l nn no">A3 = add_row(A2,-5,2,0)<br/>print(A3)</span><span id="844e" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.  1.  1.  0.  0.  1.]<br/> [ 0.  3.  2.  0.  1.  1.]<br/> [ 0. -1. -3.  1.  0. -5.]]</span><span id="8003" class="mg ld iq nh b gy nq nm l nn no">A4 = switch_rows(A3,1,2)<br/>print(A4)</span><span id="b27b" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.  1.  1.  0.  0.  1.]<br/> [ 0. -1. -3.  1.  0. -5.]<br/> [ 0.  3.  2.  0.  1.  1.]]</span><span id="4011" class="mg ld iq nh b gy nq nm l nn no">A5 = scale_row(A4,-1,1)<br/>print(A5)</span><span id="7792" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.  1.  1.  0.  0.  1.]<br/> [ 0.  1.  3. -1.  0.  5.]<br/> [ 0.  3.  2.  0.  1.  1.]]</span><span id="959f" class="mg ld iq nh b gy nq nm l nn no">A6 = add_row(A5,-3,2,1)<br/>print(A6)</span><span id="b59b" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[  1.   1.   1.   0.   0.   1.]<br/> [  0.   1.   3.  -1.   0.   5.]<br/> [  0.   0.  -7.   3.   1. -14.]]</span><span id="f4bc" class="mg ld iq nh b gy nq nm l nn no">A7 = scale_row(A6,-1/7,2)<br/>print(A7)</span><span id="c920" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          1.          1.          0.          0.          1.        ]<br/> [ 0.          1.          3.         -1.          0.          5.        ]<br/> [ 0.          0.          1.         -0.42857143 -0.14285714  2.        ]]</span><span id="8c30" class="mg ld iq nh b gy nq nm l nn no">A8 = add_row(A7,-3,1,2)<br/>print(A8)</span><span id="f8b7" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          1.          1.          0.          0.          1.        ]<br/> [ 0.          1.          0.          0.28571429  0.42857143 -1.        ]<br/> [ 0.          0.          1.         -0.42857143 -0.14285714  2.        ]]</span><span id="5402" class="mg ld iq nh b gy nq nm l nn no">A9 = add_row(A8,-1,0,2)<br/>print(A9)</span><span id="d87a" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          1.          0.          0.42857143  0.14285714 -1.        ]<br/> [ 0.          1.          0.          0.28571429  0.42857143 -1.        ]<br/> [ 0.          0.          1.         -0.42857143 -0.14285714  2.        ]]</span><span id="5c31" class="mg ld iq nh b gy nq nm l nn no">A10 = add_row(A9,-1,0,1)<br/>print(A10)</span><span id="1f01" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          0.          0.          0.14285714 -0.28571429  0.        ]<br/> [ 0.          1.          0.          0.28571429  0.42857143 -1.        ]<br/> [ 0.          0.          1.         -0.42857143 -0.14285714  2.        ]]</span></pre><p id="2119" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">验证一下我们找到M逆是否正确:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="0ca2" class="mg ld iq nh b gy nl nm l nn no">Minv = A10[:,3:]<br/>print(Minv)</span><span id="a1cd" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 0.14285714 -0.28571429  0.        ]<br/> [ 0.28571429  0.42857143 -1.        ]<br/> [-0.42857143 -0.14285714  2.        ]]</span><span id="8b06" class="mg ld iq nh b gy nq nm l nn no">result = Minv @ M<br/>print(result)</span><span id="ebdd" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.00000000e+00  4.44089210e-16  2.22044605e-16]<br/> [-6.66133815e-16  1.00000000e+00 -2.22044605e-16]<br/> [ 0.00000000e+00  0.00000000e+00  1.00000000e+00]]</span></pre><p id="9fff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">成功！如果四舍五入到小数点后15位，我们可以更清楚地看到结果:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="12cf" class="mg ld iq nh b gy nl nm l nn no">np.round(result,15)</span><span id="fed8" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[ 1.e+00,  0.e+00,  0.e+00],<br/>       [-1.e-15,  1.e+00, -0.e+00],<br/>       [ 0.e+00,  0.e+00,  1.e+00]])</span></pre><h2 id="3c64" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">求解一个系统</h2><p id="5d1f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们使用我们的函数来执行<em class="kl">高斯消去</em>并求解一个线性方程组 <strong class="jp ir"> <em class="kl"> Ax=b. </em> </strong></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="aa74" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[6,15,1],[8,7,12],[2,7,8]])<br/>print(A)</span><span id="33f2" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 6 15  1]<br/> [ 8  7 12]<br/> [ 2  7  8]]</span><span id="4403" class="mg ld iq nh b gy nq nm l nn no">b = np.array([[2],[14],[10]])<br/>print(b)</span><span id="b22d" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 2]<br/> [14]<br/> [10]]</span></pre><p id="2f8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">形成</em> <strong class="jp ir"> <em class="kl">增广矩阵</em> </strong> <em class="kl"> M: </em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="9c07" class="mg ld iq nh b gy nl nm l nn no">M = np.hstack([A,b])<br/>print(M)</span><span id="6a0b" class="mg ld iq nh b gy nq nm l nn no">[[ 6 15  1  2]<br/> [ 8  7 12 14]<br/> [ 2  7  8 10]]</span></pre><p id="1048" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">执行行操作:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="854b" class="mg ld iq nh b gy nl nm l nn no">M1 = scale_row(M,1/6,0)<br/>print(M1)</span><span id="7283" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          2.5         0.16666667  0.33333333]<br/> [ 8.          7.         12.         14.        ]<br/> [ 2.          7.          8.         10.        ]]</span><span id="5ece" class="mg ld iq nh b gy nq nm l nn no">M2 = add_row(M1,-8,1,0)<br/>print(M2)</span><span id="eb50" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:</strong><br/>[[  1.           2.5          0.16666667   0.33333333]<br/> [  0.         -13.          10.66666667  11.33333333]<br/> [  2.           7.           8.          10.        ]]</span><span id="8d65" class="mg ld iq nh b gy nq nm l nn no">M3 = add_row(M2,-2,2,0)<br/>print(M3)</span><span id="16af" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[  1.           2.5          0.16666667   0.33333333]<br/> [  0.         -13.          10.66666667  11.33333333]<br/> [  0.           2.           7.66666667   9.33333333]]</span><span id="ef6f" class="mg ld iq nh b gy nq nm l nn no">M4 = scale_row(M3,-1/13,1)<br/>print(M4)</span><span id="1d99" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          2.5         0.16666667  0.33333333]<br/> [ 0.          1.         -0.82051282 -0.87179487]<br/> [ 0.          2.          7.66666667  9.33333333]]</span><span id="6b20" class="mg ld iq nh b gy nq nm l nn no">M5 = add_row(M4,-2,2,1)<br/>print(M5)</span><span id="8178" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          2.5         0.16666667  0.33333333]<br/> [ 0.          1.         -0.82051282 -0.87179487]<br/> [ 0.          0.          9.30769231 11.07692308]]</span><span id="419d" class="mg ld iq nh b gy nq nm l nn no">M6 = scale_row(M5,1/M5[2,2],2)<br/>print(M6)</span><span id="2507" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          2.5         0.16666667  0.33333333]<br/> [ 0.          1.         -0.82051282 -0.87179487]<br/> [ 0.          0.          1.          1.19008264]]</span><span id="e822" class="mg ld iq nh b gy nq nm l nn no">M7 = add_row(M6,-M6[1,2],1,2)<br/>print(M7)</span><span id="8d34" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1.         2.5        0.16666667 0.33333333]<br/> [0.         1.         0.         0.1046832 ]<br/> [0.         0.         1.         1.19008264]]</span><span id="8882" class="mg ld iq nh b gy nq nm l nn no">M8 = add_row(M7,-M7[0,2],0,2)<br/>print(M8)</span><span id="9461" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1.         2.5        0.         0.13498623]<br/> [0.         1.         0.         0.1046832 ]<br/> [0.         0.         1.         1.19008264]]</span><span id="4512" class="mg ld iq nh b gy nq nm l nn no">M9 = add_row(M8,-M8[0,1],0,1)<br/>print(M9)</span><span id="397e" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1.          0.          0.         -0.12672176]<br/> [ 0.          1.          0.          0.1046832 ]<br/> [ 0.          0.          1.          1.19008264]]</span></pre><p id="7755" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">成功了！</em><strong class="jp ir"><em class="kl">Ax = b</em></strong><em class="kl">的解是</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="10ca" class="mg ld iq nh b gy nl nm l nn no">x = M9[:,3].reshape(3,1)<br/>print(x)</span><span id="561b" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[-0.12672176]<br/> [ 0.1046832 ]<br/> [ 1.19008264]]</span></pre><p id="3595" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，我们可以用简单的方法来做</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="5f36" class="mg ld iq nh b gy nl nm l nn no">x = la.solve(A,b)<br/>print(x)</span><span id="ad5c" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[-0.12672176]<br/> [ 0.1046832 ]<br/> [ 1.19008264]]</span></pre><h2 id="5d25" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><code class="fe nr ns nt nh b">scipy.linalg.solve</code></h2><p id="3416" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们最感兴趣的是存在唯一解x的线性系统<strong class="jp ir"> Ax=b </strong>当A是方阵<em class="kl">(m = n)</em><em class="kl">det(A)≠0时就是这种情况。</em>解决这样一个系统，我们可以使用函数<code class="fe nr ns nt nh b"><a class="ae mf" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.solve.html" rel="noopener ugc nofollow" target="_blank">scipy.linalg.solve</a></code>。</p><p id="8196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">该函数返回方程组Ax=b的解。例如:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="389a" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,1],[1,-1]])<br/>print(A)</span><span id="0a04" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1  1]<br/> [ 1 -1]]</span><span id="a0af" class="mg ld iq nh b gy nq nm l nn no">b1 = np.array([2,0])<br/>print(b1)</span><span id="7c73" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[2 0]</span></pre><p id="61da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">并求解:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="e4f3" class="mg ld iq nh b gy nl nm l nn no">x1 = la.solve(A,b1)<br/>print(x1)</span><span id="3451" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[1. 1.]</span></pre><p id="1089" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，当向量b(右侧)作为<em class="kl"> 1D数数组输入时，输出x作为<em class="kl"> 1D数数组</em>返回。</em>如果我们输入b作为一个<em class="kl"> 2D数数组</em>，那么输出就是一个<em class="kl"> 2D数数组</em>。</p><p id="e343" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">例如:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="7954" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,1],[1,-1]])<br/>b2 = np.array([2,0]).reshape(2,1)<br/>x2 = la.solve(A,b2)<br/>print(x2)</span><span id="00f8" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1.]<br/> [1.]]</span></pre><p id="421c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，如果右手边b是一个矩阵，那么输出是一个同样大小的矩阵。是当b是矩阵时Ax=b的解。</p><p id="e8c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">例如:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="af22" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[1,1],[1,-1]])<br/>b3 = np.array([[2,2],[0,1]])<br/>x3 = la.solve(A,b3)<br/>print(x3)</span><span id="afc2" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[1.  1.5]<br/> [1.  0.5]]</span></pre><h2 id="07e3" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">简单的例子</h2><p id="7907" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们计算方程组的解</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/5f5b350f2d32098c3e890204080bdc4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*zBTYdDGI5L2yDtul5rgCUw.png"/></div></figure><p id="2adb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">创建系数矩阵:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="54ca" class="mg ld iq nh b gy nl nm l nn no">A = np.array([[2,1],[1,1]])<br/>print(A)</span><span id="f867" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[2 1]<br/> [1 1]]</span></pre><p id="dc31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">和矢量b: </em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="25f5" class="mg ld iq nh b gy nl nm l nn no">b = np.array([1,-1]).reshape(2,1)<br/>print(b)</span><span id="ef5a" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1]<br/> [-1]]</span></pre><p id="43e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">并求解:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="c0c6" class="mg ld iq nh b gy nl nm l nn no">x = la.solve(A,b)<br/>print(x)</span><span id="951e" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 2.]<br/> [-3.]]</span></pre><p id="89c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我们可以通过计算A的逆来验证解:</em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="ab38" class="mg ld iq nh b gy nl nm l nn no">Ainv = la.inv(A)<br/>print(Ainv)</span><span id="4de2" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 1. -1.]<br/> [-1.  2.]]</span></pre><p id="ea3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">并乘A逆和b求x: </em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="97b4" class="mg ld iq nh b gy nl nm l nn no">x = Ainv @ b<br/>print(x)</span><span id="9ce3" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>[[ 2.]<br/> [-3.]]</span></pre><p id="ccf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到同样的结果。成功！</p><h2 id="5b51" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">求逆或求解</h2><p id="ff89" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">如果<em class="kl"> A很大</em>用一个逆来解Ax=b是个馊主意。<strong class="jp ir"> <em class="kl">计算量太大。</em> </strong></p><blockquote class="nv nw nx"><p id="3f87" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">让我们创建一个大的随机矩阵A和向量b，用两种方法计算解x——</p></blockquote><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="13d7" class="mg ld iq nh b gy nl nm l nn no">N = 1000<br/>A = np.random.rand(N,N)<br/>b = np.random.rand(N,1)</span></pre><p id="425b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">检查第一个条目A: </em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="d67f" class="mg ld iq nh b gy nl nm l nn no">A[:3,:3]</span><span id="2647" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[0.35754719, 0.63135432, 0.6572258 ],<br/>       [0.18450506, 0.14639832, 0.23528745],<br/>       [0.27576474, 0.46264005, 0.26589724]])</span></pre><p id="8c25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">而对于b: </em></p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="5b61" class="mg ld iq nh b gy nl nm l nn no">b[:4,:]</span><span id="eb67" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>array([[0.82726751],<br/>       [0.96946096],<br/>       [0.31351176],<br/>       [0.63757837]])</span></pre><p id="86f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">现在我们比较一下</em> <code class="fe nr ns nt nh b">scipy.linalg.solve</code> <em class="kl">与</em> <code class="fe nr ns nt nh b">scipy.linalg.inv</code>的速度:</p><pre class="kn ko kp kq gt ng nh ni nj aw nk bi"><span id="7e20" class="mg ld iq nh b gy nl nm l nn no">%%timeit<br/>x = la.solve(A,b)</span><span id="5c53" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>2.77 s ± 509 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span><span id="7894" class="mg ld iq nh b gy nq nm l nn no">%%timeit<br/>x = la.inv(A) @ b</span><span id="d685" class="mg ld iq nh b gy nq nm l nn no"><strong class="nh ir">Out:<br/></strong>4.46 s ± 2.04 s per loop (mean ± std. dev. of 7 runs, 1 loop each)</span></pre><p id="771b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">用</em> <code class="fe nr ns nt nh b">scipy.linalg.solve</code> <em class="kl">求解大约快一倍！</em></p><blockquote class="nv nw nx"><p id="fa20" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">这就是第一部分的全部内容！我知道一下子很难接受。但是你坚持到了最后！恭喜你。别忘了看看这篇文章的其他部分——<a class="ae mf" href="https://tp6145.medium.com/mathematics-for-machine-learning-part-2-fa36b6154dec" rel="noopener"><strong class="jp ir">第二部分</strong></a><a class="ae mf" href="https://tp6145.medium.com/mathematics-for-machine-learning-part-3-4acbc355fb03" rel="noopener"><strong class="jp ir">第三部分</strong></a><a class="ae mf" href="https://tp6145.medium.com/mathematics-for-machine-learning-part-4-8032bec2aa3d" rel="noopener"><strong class="jp ir">第四部分</strong> </a>和<a class="ae mf" href="https://tp6145.medium.com/mathematics-for-machine-learning-part-5-8df72392ec10" rel="noopener"> <strong class="jp ir">第五部分</strong> </a>！</p></blockquote><p id="83e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">访问专家视图— </strong> <a class="ae mf" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">订阅DDI英特尔</strong> </a></p><h1 id="149a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">其他资源和参考</h1><blockquote class="nv nw nx"><p id="103d" class="jn jo kl jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">如果你仍然有兴趣从这个主题中获得最大收益，还有很多其他的好资源—</p></blockquote><div class="on oo gp gr op oq"><a href="https://www.math.ubc.ca/~pwalls/math-python/" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">数学Python</h2><div class="ox l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">www.math.ubc.ca</p></div></div></div></a></div><div class="on oo gp gr op oq"><a href="https://en.wikipedia.org/wiki/Linear_algebra" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">线性代数</h2><div class="oy l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">线性代数是数学的一个分支，它涉及线性方程，如:线性映射，如:线性代数是…</h3></div><div class="ox l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">en.wikipedia.org</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kw oq"/></div></div></a></div><p id="163c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">要了解完整的实现，请查看我的GitHub库— </em> </strong></p><div class="on oo gp gr op oq"><a href="https://github.com/tanvipenumudy/Winter-Internship-Internity/blob/main/Day%2006/Day-6%20Notebook-1%20%28Linear%20Algebra-I%29.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">tanvipenumudy/Winter-实习-实习</h2><div class="oy l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">存储库跟踪每天分配的工作-tanvipenumudy/Winter-实习-实习</h3></div><div class="ox l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">github.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe kw oq"/></div></div></a></div></div></div>    
</body>
</html>