<html>
<head>
<title>An Illustration of Targeted Promotions with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习进行目标促销的示例</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/an-illustration-of-targeted-promotions-with-machine-learning-ab9523eb064a?source=collection_archive---------1-----------------------#2020-05-08">https://medium.datadriveninvestor.com/an-illustration-of-targeted-promotions-with-machine-learning-ab9523eb064a?source=collection_archive---------1-----------------------#2020-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="5d5e" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">机器学习</h2><div class=""/><p id="d8e2" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这篇文章将有助于你的业务前所未有的增长。</p><p id="b6ee" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi ku translated">你最近收到过Myntra的折扣券吗？或者你的购物钱包里有没有收到过促销余额/奖励积分？如果答案是肯定的，那么你很可能是促销活动的接收者。</p><p id="e2e4" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><em class="ld">针对性促销:对一定会购买该产品的顾客进行促销。</em></p><p id="f29c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">因为在商业策略中，对所有客户进行促销是非常冒险的。这背后有两个令人信服的主要原因。<br/> 1)促销/优惠券会给公司带来很大一笔费用。<br/> 2)在收入方面会有经营亏损的风险。<br/>如果顾客在收到优惠券之前就已经计划购买产品，那该怎么办？那么零售商通过赠送优惠券会产生更少的利润。这也是公司的一种损失。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/0e91e045b7447225cf870f7e62d5ec8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WFGjyL5SbqfEf8kxZKx7BA.jpeg"/></div></div></figure><p id="ff9e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">因此，通过使用机器学习技术，我们可以优化促销成本。</p><p id="1437" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们来看一个场景，你有客户的数据，根据他们的id，是否给予促销？是否购买了产品？还有很多其他的功能。</p><p id="da7a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">抓紧了！我要讨论的是星巴克数据科学家招聘过程中被问到的问题。你可以在这里看到他们给了候选人什么。</p><h1 id="8d65" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">星巴克</h1><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mp"><img src="../Images/383a3187759ba405276ac6699d5a1026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8EpXcHu9fqrERcjLiQrcpg.png"/></div></div></figure><blockquote class="mq mr ms"><p id="e168" class="jw jx ld jy b jz ka kb kc kd ke kf kg mt ki kj kk mu km kn ko mv kq kr ks kt ij bi translated">顺便说一句，他们的肉桂卷星冰乐混合咖啡非常美味。你应该试试。</p></blockquote><p id="7adf" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">首先，我们应该了解星巴克提供的文件中的数据是如何组织的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/edab1a7c4891e78fa0a8cf7183a86198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*SGwHeOZY48Dc7Sjyx1oTRg.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk">First five lines of Training data</figcaption></figure><p id="2f6b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">正如我前面说过的，V1到V7有七个抽象特征。所以我们应该注意数据是如何相互关联的。</p><blockquote class="mq mr ms"><p id="c051" class="jw jx ld jy b jz ka kb kc kd ke kf kg mt ki kj kk mu km kn ko mv kq kr ks kt ij bi translated">另请阅读:<a class="ae lq" href="https://medium.com/@prashantjadiya/offer-optimization-using-machine-learning-46a1f5d1b59b" rel="noopener">星巴克优惠优化流程</a></p></blockquote><p id="2c03" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">此外，他们还定义了两个指标。<br/> 1) <strong class="jy ja">递增响应率(IRR):<br/></strong>【IRR】描述了与未接受促销相比，有多少客户购买了促销产品。在数学上，它是促销组中的购买者人数与购买者组中的客户总数的比率(<em class="ld">处理</em>)减去非促销组中的购买者人数与非促销组中的客户总数的比率(<em class="ld">控制</em>)。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nb"><img src="../Images/2f72bee36cc79ff6fad7a05955dc1288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tN03_fRGvWSsD1U3UNsYnw.jpeg"/></div></div></figure><p id="1c5d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja"> 2)净增量收入(NIR):<br/></strong>【NIR】描述通过发送促销获得(或损失)了多少收入。从数学上来说，这等于收到促销的购买者总数的10倍减去发出的促销次数的0.15倍，再减去没有得到促销的购买者人数的10倍。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nc"><img src="../Images/8857ac4e5418b56d949bf43a7a0e794b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KojY8-z5jEihiP19vyXG-w.jpeg"/></div></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="2e18" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我做过一个实验，在没有做任何数据处理的情况下，我把数据输入到像逻辑回归和随机森林这样的分类器中。尽管如此，这并不富有成效。(它给出的内部收益率为0，NRR为-1132.00，因此这对一家公司来说是巨大的损失。)</p><p id="a6fb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">但在做了一些数据操作和预处理后，我发现很少有顾客会购买。事实上，80%的人甚至没有购买过促销产品，只有20%的人购买过咖啡(或任何产品)。</p><p id="f2a8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在主要的逻辑开始了，我搜索了一些技术来解决不平衡数据的问题。我开始了解上采样(从现有数据中获取更多数据点)。我选择了SMOTE(合成少数过采样技术),下面是它的工作原理。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nk"><img src="../Images/086b15a29710a54f0b58c428aca7b228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3I1xsf1Gc0W9exeg8geT2Q.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk">Creation of new points in the minority class</figcaption></figure><p id="13eb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我创建了一个名为response的新特性列，其中包含1(客户购买了促销产品)和0(表示其他)。</p><p id="0240" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">上采样和创建新要素的过程使我的数据集增加了一倍。之后，我认为现在可以向模型提供数据了。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="2e96" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我选择了sklearn管道的随机森林分类器，因为它的最优性和可靠性，它给了我0.0173的IRR和168.40的NRR。但是我对结果不满意。</p><blockquote class="mq mr ms"><p id="8d9a" class="jw jx ld jy b jz ka kb kc kd ke kf kg mt ki kj kk mu km kn ko mv kq kr ks kt ij bi translated">Sklearn Pipeline:在调整超参数时，组装几个可以交叉验证的转换。这可以节省我们获得最佳超参数的时间，同时减少代码行数。</p></blockquote><p id="d370" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在这个过程中，我了解到XGBoost算法非常适合不平衡的数据，因此我决定将它应用于sklearn的管道中的相同数据。但不幸的是，我不能用管道来运行它，我尝试了一整夜，但它不能。</p><p id="10bb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">是的，我在验证数据上获得了92%的AUC_SCORE。此外，我测试了我对内部收益率和NRR的预测，它给出了0.0214的内部收益率和313.25的NRR。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/897f79b4d59dadfa7c78c8b16825856a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*hFs4x-Exc-POLqczH_ug-A.png"/></div></figure><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="9abd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">好哇，当我得到这些结果的时候，我欣喜若狂。因为星巴克本身的模型不太精确(IRR: 0.0188，NRR: 189.45)。然而，我从许多资源中获得了帮助，其中一些在博客的末尾有所提及。</p><blockquote class="mq mr ms"><p id="b907" class="jw jx ld jy b jz ka kb kc kd ke kf kg mt ki kj kk mu km kn ko mv kq kr ks kt ij bi translated">注意:你可以在这里访问本博客<a class="ae lq" href="https://github.com/prashantjadiya/Starbucks-Promotion" rel="noopener ugc nofollow" target="_blank">附带的代码。</a></p></blockquote><p id="974e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这种方法对你的生意也很有用。通过有针对性的促销来吸引更多的顾客。</p><p id="0fe7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">参考资料:<br/>1)<a class="ae lq" href="https://www.kdnuggets.com/2017/06/7-techniques-handle-imbalanced-data.html" rel="noopener ugc nofollow" target="_blank">https://www . kdnugges . com/2017/06/7-techniques-handle-unbalanced-data . html</a><br/>2)【https://rikunert.com/SMOTE_explained】<br/>3)<a class="ae lq" href="https://www.quora.com/In-classification-how-do-you-handle-an-unbalanced-training-set/answers/1144228?srid=h3G6o" rel="noopener ugc nofollow" target="_blank">https://www . quora . com/In-class ification-how-do-you-handle-an-unbalanced-training-set/answers/1144228？srid=h3G6o </a></p><blockquote class="no"><p id="db4c" class="np nq iq bd nr ns nt nu nv nw nx kt dk translated">谢谢大家！我希望你喜欢这篇文章，并学到一些新的东西。如果你喜欢，你可以在这里鼓掌，我也渴望在LinkedIn上与你们联系。如果你有比这更有效的方法，请在下面回复。</p></blockquote></div></div>    
</body>
</html>