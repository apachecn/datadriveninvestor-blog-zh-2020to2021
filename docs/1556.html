<html>
<head>
<title>Implementation of Multi-label vs Multi-class classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多标签与多类别分类的实现</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/implementation-of-multi-label-vs-multi-class-classification-5dc60ada8804?source=collection_archive---------3-----------------------#2020-03-23">https://medium.datadriveninvestor.com/implementation-of-multi-label-vs-multi-class-classification-5dc60ada8804?source=collection_archive---------3-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><blockquote class="jx jy jz"><p id="af89" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将要讨论的内容是什么</p><p id="ed5e" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">1-简介</p><p id="05fd" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2-数据探索</p><p id="da4b" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">3-定义您的Keras模型架构</p><p id="8970" class="ka kb kc kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">4-结论</p></blockquote><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/822f1f6d8094c6afe2472384d89db5a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*TPA20os1zZ_OvCr1BiWrxg.jpeg"/></div></figure><h1 id="6951" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">介绍</h1><p id="ce47" class="pw-post-body-paragraph ka kb it kd b ke mf kg kh ki mg kk kl mh mi ko kp mj mk ks kt ml mm kw kx ky im bi translated">在开始写代码之前，首先让我们理解多标签和多类之间的区别。</p><p id="b935" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">让我们通过一个例子来理解，有一种产品，我们总共给出了四个标签，如产品、价格、交付、包装和三个类别，如阳性、阴性和中性。</p><p id="d235" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">让我们更清楚地表明，有一个文本给出“这台电脑是宏伟的，它的捆绑也是可以接受的，但成本超过了我的财务限制。”</p><div class="mn mo gp gr mp mq"><a href="https://www.datadriveninvestor.com/2019/01/23/deep-learning-explained-in-7-steps/" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">深度学习用7个步骤解释-更新|数据驱动的投资者</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">在深度学习的帮助下，自动驾驶汽车、Alexa、医学成像-小工具正在我们周围变得超级智能…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne lf mq"/></div></div></a></div><p id="dbaf" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">产出-产品-正，包装-正，价格-负，交付-中性</p><p id="a489" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">通过阅读这个例子，我很确定你清楚这两者之间的区别。</p><h1 id="7ee5" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">数据探索</h1><p id="b24a" class="pw-post-body-paragraph ka kb it kd b ke mf kg kh ki mg kk kl mh mi ko kp mj mk ks kt ml mm kw kx ky im bi translated">让我们理解我们的数据</p><p id="fa6d" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">我们的数据集包含4列和263394行。列名是描述、分类、类别和严重性。</p><p id="d657" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">我们的目标是为分类、类别和严重性建立一个分类器。</p><p id="4cde" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">我们总共需要执行4个步骤</p><h2 id="d05b" class="nf li it bd lj ng nh dn ln ni nj dp lr mh nk nl lv mj nm nn lz ml no np md nq bi translated">步骤1-探索性数据分析</h2><p id="46e9" class="pw-post-body-paragraph ka kb it kd b ke mf kg kh ki mg kk kl mh mi ko kp mj mk ks kt ml mm kw kx ky im bi translated">打开main.py并插入以下代码</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="44ea" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated"><strong class="kd iu">第1–24行</strong>导入我们的包。Enchant用于检查拼写，pandas用于加载数据集，numpy用于数组操作，sklearn用于编码标签并将数据集分为训练和测试，matplotlib用于绘图，re用于处理正则表达式模式，snowball用于设计词干算法，我们还使用keras api进行深度学习任务。</p><p id="1eaa" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">1.2-下一步是加载数据集，同时加载快速文本单词嵌入文件。</p><p id="109a" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">嵌入文件的链接是<a class="ae nt" href="https://fasttext.cc/docs/en/pretrained-vectors.html" rel="noopener ugc nofollow" target="_blank">这个</a>。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c7bf" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">1.3-现在检查数据集中缺失的值。如果存在任何缺失值，则将其删除。</p><p id="89d4" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">1.4-分类列中有一些值，其格式为1，234。我们需要把它转换成整数或浮点数。</p><p id="26b4" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">1.5-现在统计分类、类别和严重性中的独特标签。</p><p id="0cd7" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">在分类栏中，总共有65个不同的标签，在分类栏中有719个标签，在严重性栏中有10个不同的标签。</p><p id="37ca" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">1.6-现在让我们想象一下列的唯一值</p><p id="6789" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在将数据集分为训练和测试两部分。</p><h2 id="5169" class="nf li it bd lj ng nh dn ln ni nj dp lr mh nk nl lv mj nm nn lz ml no np md nq bi translated">步骤2-数据预处理，或者在我们的例子中是文本预处理</h2><p id="67e2" class="pw-post-body-paragraph ka kb it kd b ke mf kg kh ki mg kk kl mh mi ko kp mj mk ks kt ml mm kw kx ky im bi translated">这一步是清理数据的一个非常重要的方面。</p><p id="6693" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在，我们在先前加载的嵌入文件中索引每个单词。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="aaad" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">下一步是执行拼写检查，并用最合适的单词替换它。</p><p id="f09b" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">向前移动，现在删除所有的数字和空格</p><p id="afc6" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在替换所有的ip地址和网址</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="e8db" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在定义一个函数来完成所有的文本处理任务，包括清理文本、将单词转换成小写字母以及用词干缩短单词。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="7474" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">之后，我们初始化一个空数组，并在train_x中运行一个文本循环，然后像test_x一样向其中添加或附加所有干净的单词。</p><p id="13cd" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在我们对句子进行标记，并使其适合文本。之后，我们将每个文本转换成一个整数序列。</p><p id="bf56" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在，我们使用tokenizer.word_index函数打印唯一令牌的数量。之后，我们在训练和测试数据中填充序列。我们应用这个是因为它确保了列表中的所有序列都有相同的长度</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9852" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">在我们的数据集中，有不同类型的预测</p><p id="4aa3" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">1-分类:a)分类。b)类别</p><p id="faa2" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">2-连续:a)严重性</p><p id="9d8d" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">我们需要两种模型，一种是回归模型，另一种是分类模型。在分类中，分类列有不同类型的标签。因此，首先我们需要对这些标签进行编码，然后将它们转换为一次性编码。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a3c4" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">以下函数执行这些任务</p><p id="5ebf" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在我们的下一步是准备嵌入矩阵。它是从原始空间到实值空间的线性映射，其中实体可以具有有意义的关系。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h1 id="c481" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">定义您的Keras模型架构</h1><p id="39e1" class="pw-post-body-paragraph ka kb it kd b ke mf kg kh ki mg kk kl mh mi ko kp mj mk ks kt ml mm kw kx ky im bi translated">我们将创建两个模型，一个用于连续变量，另一个用于分类变量。</p><p id="fadb" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated"><strong class="kd iu">回归模型架构:</strong></p><p id="6e8f" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">下一步是使用Keras定义我们的神经网络架构。这里我们将使用一个有一个输入层，两个隐藏层和一个输出层的网络</p><p id="5b7d" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">一旦我们定义了我们的神经网络架构，下一步就是编译它。我们使用nadam优化器编译我们的模型，以平均绝对误差作为损失函数，并将学习率设置为0.001。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4e3b" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated"><strong class="kd iu">分类模型架构:</strong></p><p id="3f0f" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">在这个模型中，我们将使用一个具有一个输入层、一个隐藏层和一个输出层的网络。</p><p id="bbae" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">一旦我们定义了我们的神经网络架构，下一步就是编译它。我们使用具有二进制交叉熵的nadam优化器作为损失函数来编译我们的模型，并且设置学习率等于0.001。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="f6c3" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated"><strong class="kd iu">根据数据拟合你的Keras模型</strong></p><p id="8d63" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">现在我们称这两种模型为回归和分类。</p><p id="532a" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">最后，我们可以将模型保存到磁盘上，这样我们就可以在以后重用它，而不必重新训练它:</p><p id="4cc2" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">既然我们的Keras模型已经编译好了，我们就可以用我们的训练数据来拟合它了</p><p id="a462" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">之后，我们在测试数据上测试这两个模型，然后打印这两个模型的损失和准确性</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h1 id="0f5e" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">结论</h1><p id="5318" class="pw-post-body-paragraph ka kb it kd b ke mf kg kh ki mg kk kl mh mi ko kp mj mk ks kt ml mm kw kx ky im bi translated">在这篇博客中，我们开始了解多类和多标签分类之间的区别。我们使用两个模型，一个是连续变量的回归模型，另一个是分类变量的分类模型。这个模型可以通过使用K-Fold交叉验证和进行一些特征工程来进一步改进。</p><p id="96de" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">如果你想了解更多关于令人敬畏的深度学习库的信息，那么请阅读这个<a class="ae nt" href="https://medium.com/@abhisheksingh007226/top-4-libraries-you-must-know-before-diving-into-any-deep-learning-projects-61904286478d" rel="noopener">链接</a>上的惊人博客。</p><p id="4b6b" class="pw-post-body-paragraph ka kb it kd b ke kf kg kh ki kj kk kl mh kn ko kp mj kr ks kt ml kv kw kx ky im bi translated">这篇文章的完整代码可以在<a class="ae nt" href="https://github.com/abhisingh007224/Multilabel-vs-Multiclass/tree/master/multilabel-multiclass-classifcation-master" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。如果你有任何问题，请随意评论。关注我们更多即将推出的博客。</p><h1 id="8fed" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">你可能想读一些其他的博客文章是</h1><ul class=""><li id="31fe" class="nu nv it kd b ke mf ki mg mh nw mj nx ml ny ky nz oa ob oc bi translated"><a class="ae nt" href="https://www.dataspoof.info/post/real-time-notifications-for-covid-19-cases-using-python" rel="noopener ugc nofollow" target="_blank">使用python实时通知新冠肺炎病例</a></li><li id="e505" class="nu nv it kd b ke od ki oe mh of mj og ml oh ky nz oa ob oc bi translated"><a class="ae nt" href="https://www.dataspoof.info/post/facial-recognition-in-python-and-opencv" rel="noopener ugc nofollow" target="_blank">如何制作面部识别webapp </a></li><li id="e27c" class="nu nv it kd b ke od ki oe mh of mj og ml oh ky nz oa ob oc bi translated"><a class="ae nt" href="https://www.dataspoof.info/post/time-series-analysis" rel="noopener ugc nofollow" target="_blank">python中的时间序列分析第一部分</a></li><li id="5d76" class="nu nv it kd b ke od ki oe mh of mj og ml oh ky nz oa ob oc bi translated"><a class="ae nt" href="https://www.dataspoof.info/post/time-series-analysis-in-python-coding" rel="noopener ugc nofollow" target="_blank">python中的时间序列预测实例</a></li></ul><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="oi ns l"/></div></figure></div></div>    
</body>
</html>