<html>
<head>
<title>Weighted K-Means Clustering of GPS Coordinates — Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GPS坐标的加权K均值聚类Python。</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/weighted-k-means-clustering-of-gps-coordinates-python-7c6270846163?source=collection_archive---------0-----------------------#2020-04-13">https://medium.datadriveninvestor.com/weighted-k-means-clustering-of-gps-coordinates-python-7c6270846163?source=collection_archive---------0-----------------------#2020-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7178bf04f61f2289fbc1f52a02f05c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ljzcOWgr1aCIazKW.jpg"/></div></div></figure><p id="b43d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我上一篇帖子的延续— <a class="ae kw" href="https://medium.com/@joseph.magiya/clustering-gps-co-ordinates-forming-regions-4f50caa7e4a1" rel="noopener">用Python </a>聚类GPS坐标并形成区域。对GPS坐标进行聚类后，下一个问题是其他变量如何影响聚类。如果您正在处理销售数据，我们如何根据销售额和位置对区域进行聚类。</p><p id="303c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，我还使用了来自<a class="ae kw" href="https://www.kaggle.com/c/zillow-prize-1/data" rel="noopener ugc nofollow" target="_blank"> kaggle的Zillow Prize: Zillow的房屋价值预测(Zestimate) </a>的数据。我用的是‘properties _ 2016 . CSV’。<strong class="ka ir">还是大！</strong></p><p id="5767" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我们将基于以平方英尺为单位的地块面积来形成坐标。</p><p id="7500" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们上次看到的星团看起来像:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/3bd70111341688db8815889170197df9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*RTsH8DdAwmTUkwWm.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">K-Means Clustering of GPS Coordinates — unweighted.</figcaption></figure><p id="9fbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">计算K-Means——看下面的图片，我们可以传递权重和2个变量作为x。所以我们将传递纬度和经度。</p><p id="ebe9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于重量，我们可以传递批量大小</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/6d30901b701531df7bf1d45a383b2756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xSLG0-lIL0LaE8nCiM_wKg.png"/></div></div></figure><p id="97af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了计算聚类中心和预测每个数据点的聚类，我们仍然可以使用权重和坐标。</p><div class="lh li gp gr lj lk"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab fo"><div class="lm ab ln cl cj lo"><h2 class="bd ir gy z fp lp fr fs lq fu fw ip bi translated">认知计算——一套被广泛认为是……</h2><div class="lr l"><h3 class="bd b gy z fp lp fr fs lq fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="ls l"><p class="bd b dl z fp lp fr fs lq fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="lt l"><div class="lu l lv lw lx lt ly jw lk"/></div></div></a></div><h1 id="ece1" class="lz ma iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">为了比较这种差异，我们需要使用3(未加权的最佳聚类数)</h1><pre class="ky kz la lb gt mx my mz na aw nb bi"><span id="49ce" class="nc ma iq my b gy nd ne l nf ng">kmeans = KMeans(n_clusters = 3, max_iter=1000, init ='k-means++')</span><span id="9353" class="nc ma iq my b gy nh ne l nf ng">lat_long = X_weighted[X_weighted.columns[1:3]]<br/>lot_size = X_weighted[X_weighted.columns[3]]<br/>weighted_kmeans_clusters = kmeans.fit(lat_long, sample_weight = lot_size) # Compute k-means clustering.<br/>X_weighted['cluster_label'] = kmeans.predict(lat_long, sample_weight = lot_size)</span><span id="7889" class="nc ma iq my b gy nh ne l nf ng">centers = kmeans.cluster_centers_ # Coordinates of cluster centers.</span><span id="6305" class="nc ma iq my b gy nh ne l nf ng">labels = X_weighted['cluster_label'] # Labels of each point</span><span id="23db" class="nc ma iq my b gy nh ne l nf ng">X_weighted.plot.scatter(x = 'latitude', y = 'longitude', c=labels, s=50, cmap='viridis')<br/>plt.scatter(centers[:, 0], centers[:, 1], c='black', s=200, alpha=0.5)<br/>plt.title('Clustering GPS Co-ordinates to Form Regions - Weighted',fontsize=18, fontweight='bold')</span></pre><p id="8c18" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们比较一下结果，看看是否有什么不同</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/730bec424ea9676075f24ba9defe2659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8BbchwOYtkXKXocSpeh8w.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Unweighted vs Weighted v1.</figcaption></figure><p id="30f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">集群中显然存在差异。</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><h1 id="bb12" class="lz ma iq bd mb mc nq me mf mg nr mi mj mk ns mm mn mo nt mq mr ms nu mu mv mw bi translated">计算加权聚类的最佳数量-肘形曲线</h1><p id="4e0f" class="pw-post-body-paragraph jy jz iq ka b kb nv kd ke kf nw kh ki kj nx kl km kn ny kp kq kr nz kt ku kv ij bi translated">对于集群，我们需要将纬度和经度作为X传递，将批量大小作为sample_weight传递。</p><pre class="ky kz la lb gt mx my mz na aw nb bi"><span id="2028" class="nc ma iq my b gy nd ne l nf ng">K_clusters = range(1,10)</span><span id="2282" class="nc ma iq my b gy nh ne l nf ng">kmeans = [KMeans(n_clusters=i) for i in K_clusters]</span><span id="8d5f" class="nc ma iq my b gy nh ne l nf ng">lat_long = X_weighted[X_weighted.columns[1:3]]<br/>lot_size = X_weighted[X_weighted.columns[3]]</span><span id="95f1" class="nc ma iq my b gy nh ne l nf ng">sample_weight = lot_size</span><span id="e4ea" class="nc ma iq my b gy nh ne l nf ng">score = [kmeans[i].fit(lat_long, sample_weight = lot_size).score(lat_long) for i in range(len(kmeans))]</span><span id="05ac" class="nc ma iq my b gy nh ne l nf ng">plt.plot(K_clusters, score)<br/>plt.xlabel('Number of Clusters')</span><span id="ee45" class="nc ma iq my b gy nh ne l nf ng">plt.ylabel('Score')</span><span id="bce0" class="nc ma iq my b gy nh ne l nf ng">plt.title('Elbow Curve = Weighted')</span><span id="7af1" class="nc ma iq my b gy nh ne l nf ng">plt.show()</span></pre><p id="493c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个结果和我们在没有任何权重的情况下对经纬度进行聚类时看到的结果不同。让我们把这些结果和前一个比较一下。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/1cefc8c9805b519ebafef69c533bbf55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UiRA7STB8mpfP7UYQLZGyg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Elbow Curve — Weighted vs Unweighted</figcaption></figure></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><h1 id="31c4" class="lz ma iq bd mb mc nq me mf mg nr mi mj mk ns mm mn mo nt mq mr ms nu mu mv mw bi translated">使用最佳聚类的加权聚类</h1><pre class="ky kz la lb gt mx my mz na aw nb bi"><span id="a2b1" class="nc ma iq my b gy nd ne l nf ng">kmeans = KMeans(n_clusters = 3, max_iter=1000, init ='k-means++')</span><span id="de09" class="nc ma iq my b gy nh ne l nf ng">lat_long = X_weighted[X_weighted.columns[1:3]]<br/>lot_size = X_weighted[X_weighted.columns[3]]<br/>weighted_kmeans_clusters = kmeans.fit(lat_long, sample_weight = lot_size) # Compute k-means clustering.<br/>X_weighted['cluster_label'] = kmeans.predict(lat_long, sample_weight = lot_size)</span><span id="9403" class="nc ma iq my b gy nh ne l nf ng">centers = kmeans.cluster_centers_ # Coordinates of cluster centers.</span><span id="8cac" class="nc ma iq my b gy nh ne l nf ng">labels = X_weighted['cluster_label'] # Labels of each point</span><span id="e528" class="nc ma iq my b gy nh ne l nf ng">X_weighted.plot.scatter(x = 'latitude', y = 'longitude', c=labels, s=50, cmap='viridis')<br/>plt.scatter(centers[:, 0], centers[:, 1], c='black', s=200, alpha=0.5)<br/>plt.title('Clustering GPS Co-ordinates to Form Regions - Weighted',fontsize=18, fontweight='bold')</span></pre><p id="7472" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们比较一下结果</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/f0d3bc3ef2fc37187f81a6a409177bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Soy5KT84boBzk8e-TLpW2g.png"/></div></div></figure><h1 id="cdcc" class="lz ma iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">将结果与数据合并</h1><pre class="ky kz la lb gt mx my mz na aw nb bi"><span id="1c93" class="nc ma iq my b gy nd ne l nf ng">X_weighted = X_weighted[['parcelid','cluster_label']]</span><span id="d19c" class="nc ma iq my b gy nh ne l nf ng">clustered_data = df.merge(X_weighted, left_on='parcelid', right_on='parcelid')</span></pre><p id="20bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://github.com/JosephMagiya/Weighted-Location-Clustering" rel="noopener ugc nofollow" target="_blank">这是Github回购的链接</a></p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><h1 id="1366" class="lz ma iq bd mb mc nq me mf mg nr mi mj mk ns mm mn mo nt mq mr ms nu mu mv mw bi translated">感谢您的阅读——祝您好运！</h1><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure></div></div>    
</body>
</html>