<html>
<head>
<title>Why Can’t We Use Accelerator Data To Measure Distances using Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我们不能使用Android的加速器数据来测量距离</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/why-cant-we-use-accelerator-data-to-measure-distances-using-android-74601c5588e6?source=collection_archive---------2-----------------------#2020-05-25">https://medium.datadriveninvestor.com/why-cant-we-use-accelerator-data-to-measure-distances-using-android-74601c5588e6?source=collection_archive---------2-----------------------#2020-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0884" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当事情没有按计划进行时会发生什么…</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/af4f8a84cb32cbe436331534579356c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*46c4IEtmq6BeCvvJrVDGjw.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">Image Generated From Graphing Calculator</figcaption></figure><p id="21ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我有一个想法，设计一个android应用程序来测量长度，只需将你的手机放在两边，并使用加速度值来计算位移。<strong class="jp ir">简单的运动学！！</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/bf02001ee34cac2577bb0c317bfb4d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*vc5YVQmem-EOANlRafEb_w.png"/></div></figure><p id="94b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">于是我打开Android Studio，开始在<em class="kx"> activity_main.xml </em>中设置GUI</p><pre class="km kn ko kp gt ky kz la lb aw lc bi"><span id="a1ec" class="ld le iq kz b gy lf lg l lh li"><em class="kx">&lt;?</em><strong class="kz ir">xml version="1.0" encoding="utf-8"</strong><em class="kx">?&gt;<br/></em>&lt;<strong class="kz ir">LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    android:orientation="vertical"<br/>    android:padding="30sp"<br/>    tools:context=".MainActivity"</strong>&gt;<br/><br/>    &lt;<strong class="kz ir">TextView<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:id="@+id/xVal"</strong>/&gt;<br/>    &lt;<strong class="kz ir">TextView<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:id="@+id/yVal"<br/>        android:layout_marginTop="30sp"</strong>/&gt;<br/>    &lt;<strong class="kz ir">TextView<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:id="@+id/zVal"<br/>        android:layout_marginTop="30sp"</strong>/&gt;<br/>    &lt;<strong class="kz ir">TextView<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:id="@+id/dVal"<br/>        android:layout_marginTop="30sp"</strong>/&gt;<br/><br/>    &lt;<strong class="kz ir">Button<br/>        android:id="@+id/start"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:text="Start Measure" </strong>/&gt;<br/><br/>    &lt;<strong class="kz ir">Button<br/>        android:id="@+id/clear"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:text="Take Measure" </strong>/&gt;<br/><br/>&lt;/<strong class="kz ir">LinearLayout</strong>&gt;</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/153c06445878d060387d69e56925efd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*2agJ7DN-JwY5k7uRK2_p-g.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">The GUI</figcaption></figure><p id="0372" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后回到Kotlin代码，首先定义了加速度计传感器。</p><pre class="km kn ko kp gt ky kz la lb aw lc bi"><span id="94aa" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">val </strong>sensorManager = getSystemService(Context.<em class="kx">SENSOR_SERVICE</em>) <strong class="kz ir">as </strong>SensorManager<br/><strong class="kz ir">val </strong>acclerometer: Sensor? = sensorManager.getDefaultSensor(Sensor.<em class="kx">TYPE_LINEAR_ACCELERATION</em>)<br/><br/>sensorManager.registerListener(<strong class="kz ir">this</strong>,acclerometer, SensorManager.<em class="kx">SENSOR_DELAY_NORMAL</em>)</span></pre><p id="f58c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我定义了onSensorChanged函数并编写了动力学代码。首先，用加速度计采集数据，并计算速度。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lk"><img src="../Images/0fda26aafdd769528a06ac46cd8f5f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qfJlRS90GxVeeKZKH0JL3w.jpeg"/></div></div></figure><pre class="km kn ko kp gt ky kz la lb aw lc bi"><span id="c36a" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">override fun </strong>onSensorChanged(event: SensorEvent?) {<br/>    <strong class="kz ir">if </strong>(event != <strong class="kz ir">null</strong>) {<br/>        Log.d(<strong class="kz ir">TAG</strong>, <strong class="kz ir">"on Sensor Change X: " </strong>+ event.<strong class="kz ir">values</strong>[0] + <strong class="kz ir">" Y: " </strong>+ event.<strong class="kz ir">values</strong>[1] + <strong class="kz ir">" Z: " </strong>+ event.<strong class="kz ir">values</strong>[2])<br/><br/><br/>        <strong class="kz ir">if </strong>(<strong class="kz ir">flag</strong>==1) {<br/>            <strong class="kz ir">var </strong>t= ((SystemClock.elapsedRealtimeNanos()) - <strong class="kz ir">t1</strong>).toDouble()<br/>            <strong class="kz ir">t1 </strong>= SystemClock.elapsedRealtimeNanos()<br/>            t= t/1000000000<br/>  <br/>            <strong class="kz ir">xs</strong>.add(((<strong class="kz ir">xvel</strong>.<em class="kx">takeLast</em>(1)).get(0) * t).toDouble() + (0.5 * (event.<strong class="kz ir">values</strong>[0].toDouble())  * t * t).toDouble())<br/>            <strong class="kz ir">ys</strong>.add(((<strong class="kz ir">yvel</strong>.<em class="kx">takeLast</em>(1)).get(0) * t).toDouble() + (0.5 * (event.<strong class="kz ir">values</strong>[1].toDouble())  * t * t).toDouble())<br/>            <strong class="kz ir">zs</strong>.add(((<strong class="kz ir">zvel</strong>.<em class="kx">takeLast</em>(1)).get(0) * t).toDouble() + (0.5 * (event.<strong class="kz ir">values</strong>[2].toDouble())  * t * t).toDouble())</span><span id="3a8b" class="ld le iq kz b gy lp lg l lh li">            <strong class="kz ir">xvel</strong>.add((0.5 * (event.<strong class="kz ir">values</strong>[0].toDouble()) * a).toDouble())<br/>            <strong class="kz ir">yvel</strong>.add((0.5 * (event.<strong class="kz ir">values</strong>[1].toDouble()) * a).toDouble())<br/>            <strong class="kz ir">zvel</strong>.add((0.5 * (event.<strong class="kz ir">values</strong>[2].toDouble()) * a).toDouble())<br/>}</span></pre><p id="dd3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我计算了所有小位移矢量的和。然后计算出位移的大小。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/d1238807dae4dd670dcc58fb430851c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*IAYvHTa6vbe1AzDAundRSA.png"/></div></figure><p id="0fc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我终于有了工作申请。我拿去测试了。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/264ce37626869018d9cc051fe2194153.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*ZWFWTRlPABnO6p09np8nCw.jpeg"/></div></figure><p id="cb0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">测试时，它很好，看起来一切正常，但它…</p><h2 id="5069" class="ld le iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">就是不起作用</h2><p id="b091" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">它给出了不正确的措施。虽然我很沮丧，但我更困惑的是为什么它会给出随机阅读。我检查了代码中的错误。我寻找更多的答案和改进。</p><p id="8b08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本质上，android手机中的加速度计噪音非常大。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/b11398771bcf706e30d399cedb667420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/0*pimxfuSUcwsiedzL.png"/></div></figure><p id="bb4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另外，位移是加速度的二重积分。如果积分产生漂移，二重积分产生可怕的漂移。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/570b4b6f4a6347b975979702b90bf0aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*F-EnrpZjW1-v2_aGlx5oDg.png"/></div></figure><p id="ac41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当噪音被整合时会产生巨大的差异。<strong class="jp ir">其急矣！</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mq"><img src="../Images/a861006b44ae40ba91645d5f2634adbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*06AJaHQ4h05X0-hzxGMIwg.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">Double Integral for small noise</figcaption></figure><h2 id="ed85" class="ld le iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated"><strong class="ak">其他技术如何工作</strong></h2><p id="4df3" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">用于游戏和AR/VR的技术被称为传感器融合，它使用加速度计、陀螺仪和磁力计的数据。有些人在加速度计上使用高通滤波器。</p><p id="a8f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了测量步数，使用计步器算法，它识别每一步并计算它。</p><p id="8a23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当事情没有按计划发展时会发生什么，一个人必须这样公布，其他人不会做出同样的假设和错误。</p></div></div>    
</body>
</html>