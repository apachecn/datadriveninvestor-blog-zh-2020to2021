<html>
<head>
<title>Dealing with Outliers.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理异常值。</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/dealing-with-outliers-90475e3535c2?source=collection_archive---------10-----------------------#2020-05-06">https://medium.datadriveninvestor.com/dealing-with-outliers-90475e3535c2?source=collection_archive---------10-----------------------#2020-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="58db" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在我们之前的文章reg ' <a class="ae kf" href="https://medium.com/analytics-vidhya/outliers-in-data-and-ways-to-detect-them-1c3a5f2c6b1e" rel="noopener"> outliers </a>'中，我们概述了它们是什么以及检测它们的各种方法。</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/dc24a9cc434e14585344f93ca311519d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vzl5oW-AJOKf5Z67"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@jeroendenotter?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jeroen den Otter</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dca2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">众所周知，异常值确实会扰乱我们的分析，因为所有的统计测量，如均值、标准差和基于这些的所有其他统计推断，都对异常值高度敏感。</p><p id="7cf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们有必要处理它们。</p><p id="df58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">所以，今天，我将深入探讨这个话题，并讨论处理异常值的各种方法。</strong></p><p id="24db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">先决条件:</strong>我正在使用的数据集是‘XYZ corp _ bank lending’。(来源:Kaggle)。</p><p id="e0b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开始之前，我们已经了解了各种方法，如可视化技术(散点图、箱线图、直方图)、Z分数、IQR、假设检验来检测异常值。</p><p id="26fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，我刚刚遇到了一些额外的简单方法来快速了解数据集中异常值的存在。</p><div class="ls lt gp gr lu lv"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kq lv"/></div></div></a></div><p id="a65b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中之一是<strong class="ky ir"> Df.describe() </strong>函数，该函数使用非常广泛，可以帮助我们很好地了解数据集中哪些要素可能存在异常值。</p><p id="5383" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> df.describe()为我们提供了所有定量变量的统计测量。</strong></p><p id="ba60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如:在下面的截图中，每个特征的平均值、最小值和最大值给了我们一种直觉，知道它们中的哪些可能有异常值。</p><p id="3e9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如:列“dti”的平均值为18.122165，最小值为0.000000，最大值为9999.000000，这清楚地表明最大值9999.000000是一个异常值。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mk"><img src="../Images/48f01ec09dc385c740c1eb31e5ec1a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SWuZFXv1V5q7pTGxCzPxQ.png"/></div></div></figure><p id="9677" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">另一种检测异常值存在的方法是检查数据的偏斜度。</strong></p><p id="ccb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般来说，偏斜度应该在1到-1之间，任何偏离它的变化都表明存在极值，也就是异常值，这也意味着数据不是正态分布的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/b4e597afdf7221eb3a4ab964a8ad10d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*axP0GtC9a9V7HcCFbMcdEQ.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">The above figure indicates that most of the features don’t have the skewness measure in the range of -1 to 1.</figcaption></figure><p id="89b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">最广泛使用的技术是IQR评分，任何不在(Q1-1.5 iqr)和(Q3+1.5IQR)范围内的都是异常值。</strong></p><p id="e6bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码给出了数据集的IQR值。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/33d8d50d91ac45eeaa28e85195317566.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*S_96howVAsMYo8LdfiTE7g.png"/></div></figure><p id="c420" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果我们想列出可能是异常值的记录，以便我们可以交叉验证，下面的简单方法总是很方便。</p><p id="fdf0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，让我们看看异常值低于较低围栏(第一个四分位数-列的IQR的1.5倍)的记录，以及异常值高于较高围栏(第三个四分位数+列的IQR的1.5倍)的记录。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mn"><img src="../Images/ff392e134c668571b6764c4ba714d946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkfFYCtmEYpwh48cpcnsUQ.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Gives us a glimpse of all the outlier records.</figcaption></figure><h1 id="edfb" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">异常值处理。</h1><p id="81c6" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">既然我们已经认识到了具有异常值的特征，并且已经查看了具有可能极值的记录，现在是时候关注本文的主要议程了，即处理它们。然而，有多种方法可以帮助我们，如下所述。</p><ul class=""><li id="d2b6" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">如果我们知道异常值是被错误记录的，我们就可以丢弃它们。假设我们正在查看几个学生的数学成绩，我们发现一个学生的分数是1000，而其他学生的分数都低于100。因此，在这种情况下，我们知道1000输入错误，我们可以删除这个记录。</li><li id="9094" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><strong class="ky ir">我们还可以对倾斜的数据进行变换</strong>或<strong class="ky ir">，比如对特征</strong>进行对数或平方根变换，以获得平衡分布。</li></ul><p id="6573" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，这种方法并不总是非常准确，因为它并没有公正地对待所有的特征。我尝试对我们的数据进行平方根转换，正如我们在下面看到的，一些列的偏斜度仍然在1以上，而偏斜度应该在-1到1之间。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/262bfc380dd48a05cc16d4d640234b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*trMKMwfb3Eb9PYm8wScvGA.png"/></div></figure><ul class=""><li id="8206" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">因此，我发现最有效、透明和简单的方法是用最接近离群值的四分位数来限制离群值。</li></ul><p id="807f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如:下围栏以下的异常值(第一个四分位数-列的IQR的1.5倍)可以用第一个四分位数代替。</p><p id="aa2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并且可以用第三个四分位数替换较高围栏(第三个四分位数+该列的IQR的1.5倍)之上的离群值。</p><p id="7bd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上可以通过我下面使用的简单函数来实现:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/27bfff5db307e6b12e8e7664cd432caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*1oE8iTmrKeoTmfDwBWmqQg.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">The above function caps all the outlier records with either Q1(first quartile) or Q3(third quartile) based on their values.</figcaption></figure><p id="5313" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，为了验证是否正确处理了所有异常值，我们可以在封顶之前和之后绘制箱线图，这是可视化异常值及其处理的最简单方法。</p><p id="1290" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是因为我在本文中使用了偏度来检测异常值，所以将使用相同的技术来重新检查异常值处理。</p><p id="ae57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，正如我们在下面看到的，几乎所有记录的偏斜度现在都在-1到1的范围内，这表明我们已经成功地处理了异常值。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/6c037785dcbc7c301e9320d68db3a9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*KMCePbVYJa3qGbvrb0CeFQ.png"/></div></figure><ul class=""><li id="d09b" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated"><strong class="ky ir">我们还可以处理异常值</strong>，用第10个百分位数替换较低围栏下方的<strong class="ky ir"> </strong>，用第90个百分位数替换较高围栏上方的异常值。</li></ul><p id="d4eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我想得出结论，有各种方法来处理这部分数据预处理，尽管选择最终取决于处理它的个人，这取决于数据类型、问题陈述和简单有效的适用策略。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oc od l"/></div></figure></div></div>    
</body>
</html>