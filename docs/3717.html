<html>
<head>
<title>Self Driving Cars: Finding Road Lanes is the first step</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动驾驶汽车:寻找道路车道是第一步</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/self-driving-cars-finding-road-lanes-is-the-first-step-bd049914bdb9?source=collection_archive---------7-----------------------#2020-07-03">https://medium.datadriveninvestor.com/self-driving-cars-finding-road-lanes-is-the-first-step-bd049914bdb9?source=collection_archive---------7-----------------------#2020-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/642ed4e8cfe5946f5a2449879bc4df27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JVgDtaWSx0XahNrI"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@ort?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Bram Van Oost</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="23ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">识别道路的车道是人类驾驶员执行的非常常见的任务。这对于保持车辆在车道的限制内是很重要的。这也是自动驾驶汽车执行的一项非常关键的任务。车道检测是自主导航的一个重要方面。这是使车辆能够可视化并理解其环境的第一步。</p><p id="9b15" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个项目的目标是创建一个在道路上寻找车道线的管道。</p><h1 id="6afa" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">1.我的方法</h1><ol class=""><li id="ac06" class="mc md it ki b kj me kn mf kr mg kv mh kz mi ld mj mk ml mm bi translated">将原始图像转换到HSV色彩空间。是的，HSV！不是灰度。</li></ol><h2 id="ed2d" class="mn lf it bd lg mo mp dn lk mq mr dp lo kr ms mt ls kv mu mv lw kz mw mx ma my bi translated">选择HSV而不是灰度的原因:</h2><p id="bc83" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">在灰度中，我们会丢失很多信息，尤其是当光线条件改变和颜色改变时。我们通常有白色车道和黄色车道，以及不同的光线条件，如阴影、强光或弱光等。</p><p id="0e44" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们通常在RGB色彩空间中表示大多数图像，以描述颜色并以数字方式保存它们。但是当光线条件改变时，这不是一个好的选择。</p><p id="82e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们必须选择一个对变化的光照条件更鲁棒的色彩空间。所以我选择了HSV色彩空间，因为色彩信息是在单通道h中编码的。这样，该通道中的信息不会随着照明条件的变化而变化。</p><div class="nc nd gp gr ne nf"><a href="https://www.datadriveninvestor.com/2018/11/02/who-is-legally-accountable-in-the-case-of-an-autonomous-vehicle-accident/" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">在自动驾驶汽车发生事故的情况下，谁应该承担法律责任？数据驱动的投资者</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">我仍然认为自动驾驶汽车是一种奢侈品，而不是必需品…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt jz nf"/></div></div></a></div><p id="e6c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">补充一点来支持我为什么选择HSV而不是灰度。请参考“色彩空间对跟踪鲁棒性的影响”一文，该文提出“……与灰度和RGB图像相比，YCbCr和HSV的色彩空间给出了更准确、更鲁棒的跟踪结果……”链接:<a class="ae kf" href="https://ieeexplore.ieee.org/document/4582971" rel="noopener ugc nofollow" target="_blank">https://ieeexplore.ieee.org/document/4582971</a></p><p id="a842" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">示例图像显示了阴影图像，左侧为黄色通道，右侧为HSV转换图像。</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/4afe91eef484ea2694cee495ae896f66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mbKndTl7Tl6aoIX3otGG6A.jpeg"/></div></div></figure><p id="d48a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.然后，我们获取上一步的输出，即转换到HSV色彩空间的原始图像，并应用GuassianBlur函数。</p><p id="8a1c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这有助于去除图像中的任何噪声。这是canny边缘检测的重要预处理步骤。</p><p id="11ec" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.黄色和白色的遮罩被应用到HSV图像以从图像中提取车道线。</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/464efea05d24dcdd600fe8f35f532f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mrx6IFwGDrMidTo9gOCuvg.jpeg"/></div></div></figure><h1 id="2c54" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">原因何在？</h1><p id="85d8" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">即使在转换到HSV颜色空间并应用高斯模糊后，图像中仍可能存在干扰车道线识别的噪声。解决这个问题的有效方法是在图像中寻找特定的颜色，过滤掉图像中的噪声。在我们的例子中，我们知道车道线主要是黄色和白色，我们可以利用这一信息在HSV图像上应用黄色和白色遮罩，并尝试删除除车道线以外的所有内容。</p><p id="df53" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.然后通过将平滑后的灰度图像传递到OpenCV的canny函数中来检测图像中的边缘。</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/b9976162fd81fcb9883c67066fda1739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-NGmwUmP3yIcyH6eQfh1g.png"/></div></div></figure><p id="8c2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.在检测到边缘之后，只有图像中具有道路车道线的那部分需要被考虑用于进一步处理。所以我们做了一个4边的多边形，它覆盖了我们感兴趣的区域。该区域在下图中高亮显示。接下来，我只关注我们在步骤4中得到的图像输出中的那个区域。结果显示在右边。</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/9969c3b563ddfc08b58000dd91d0c65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9iWfpreUtHBXzf_u1r9uqw.jpeg"/></div></div></figure><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/ea9d8b34e9e663cc003eabdc7e930806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cWwsQ9aFTx5vB81_kOqjhQ.png"/></div></div></figure><p id="dd58" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.现在，图像只有车道线部分的canny边缘，其余部分被涂黑，我们可以在这些检测到的边缘上绘制hough线。这是车道的高亮部分。</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/30a9212156779669447e6557e7e7026c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pmDarcPFt7VkE0UB3K_qiA.png"/></div></div></figure><p id="b4cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从检测到的边缘画线是这个项目最重要的方面之一。对于要在边缘上绘制的两条单线，车道的每条线一条(左和右)，draw_line()函数以下列方式修改:</p><h1 id="919b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">画线算法</h1><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/dacea82ad77ec42c232c36cd2d0ccf1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_-W-ReaHEMaKJvhhfJ2hA.jpeg"/></div></div></figure><p id="e83b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我做了一个外推算法，考虑到左车道和右车道，在图像上绘制外推线。以下是实现这一目标的步骤:</p><p id="c1ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">a.为了外推从霍夫线返回的线并创建两条单线，两个端点(x_min，y_min，x_max。y_max)为双车道线及其对应的</p><p id="e937" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">需要斜率值(正斜率、负斜率)和截距(正截距、负截距)。这形成了算法的问题陈述。</p><p id="20c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b.对从hough_lines()函数返回的线的数组进行迭代，对于每条线，计算斜率并存储在正负斜率的单独数组中。</p><p id="7104" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">c.从斜率是正还是负可以推断出该线属于车道的左线还是右线。</p><p id="689a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">d.为了移除不属于任何车道但仍在车道区域内的边缘上的噪声线，为算法可接受的斜率值定义阈值。</p><p id="680f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">e.对于每条线，截距也被计算和存储。</p><p id="0573" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">f.两条车道线的y_max是图像底部的点，也是这些线的起点。</p><p id="2618" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">g.两条线的斜率值可以通过取相应的正斜率值和负斜率值的平均值来计算。这也有助于消除斜率值上的一些噪声。</p><p id="dc93" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">h.类似地，两条车道线的截距可以通过取存储截距的平均值来计算。</p><p id="1f2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一、y_min可以通过比较所有行中的所有y值，取最小值求出。</p><p id="3654" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">j.现在，x_min和x_max可以通过将所有之前找到的参数拟合到该直线的一个方程中来找到。</p><p id="6740" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">k.现在可以在车道线上画线。</p><p id="762a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">7.该图像现在与原始图像相结合，并且返回的图像将是原始图像，算法生成的车道线绘制在其上。</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/e6ca6110b2a148b0422e5344b975977d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q6G45hiFnfHhOjvH6m5MLg.jpeg"/></div></div></figure><p id="c287" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">8.最终结果如下所示:</p><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/e584586eaa574c69df6bbb80026fd70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1YzlpWYSXTnA_2YJYOdKCQ.jpeg"/></div></div></figure><h1 id="0688" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">2.反光</h1><p id="53b9" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">转换到HSV色彩空间使管道对变化的光照条件具有鲁棒性，但线条仍然有点抖动。可以对draw_line算法进行改进，以便在处理时更好地利用来自视频的先前帧的信息。</p><h1 id="7266" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">3.结论:</h1><p id="cb55" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">给定的任务已经完成，项目符合给定的标准。您也可以在我的GitHub repo上找到该项目:</p><p id="c68b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://github.com/harivamsi9/Finding-Lane-Lines-using-OpenCV-for-Self-Driving-Cars" rel="noopener ugc nofollow" target="_blank">https://github . com/harivamsi 9/Finding-Lane-Lines-using-OpenCV-for-Driving-Cars</a></p><h2 id="835e" class="mn lf it bd lg mo mp dn lk mq mr dp lo kr ms mt ls kv mu mv lw kz mw mx ma my bi translated">关于作者:</h2><figure class="nv nw nx ny gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oh"><img src="../Images/2c2055adccb1c10f37f2fb7e9695bead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9NNfdy1umnTS_f-qbQqufw.jpeg"/></div></div></figure><p id="fc65" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">哈里·瓦姆西·雅达瓦利</strong>，韦洛尔VIT大学的计算机科学预科生，是自动驾驶汽车、人工通用智能、数据科学、深度学习、机器人过程自动化、机器人、量子计算和量子物理领域的未来研究人员。</p><p id="f1f5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对创业、创业、黑客马拉松、金融、区块链、家庭自动化和股票市场感兴趣。</p><h2 id="4c4a" class="mn lf it bd lg mo mp dn lk mq mr dp lo kr ms mt ls kv mu mv lw kz mw mx ma my bi translated"><strong class="ak">访问专家视图— </strong> <a class="ae kf" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">订阅DDI英特尔</strong> </a></h2></div></div>    
</body>
</html>