<html>
<head>
<title>Tensorflow 2.0 — from preprocessing to serving (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tensorflow 2.0 —从预处理到服务(第1部分)</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/tensorflow-2-0-from-preprocessing-to-serving-part-1-52e81fdcd46d?source=collection_archive---------14-----------------------#2020-03-01">https://medium.datadriveninvestor.com/tensorflow-2-0-from-preprocessing-to-serving-part-1-52e81fdcd46d?source=collection_archive---------14-----------------------#2020-03-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/067c703dcd62285c9a9fd588dd309849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wq2aYucpHvzue1f3gtJ8og.png"/></div></div></figure><p id="b013" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">欢迎来到tensorflow及其keras API教程的第一部分。我们将讨论深度学习的一切——从如何预处理输入数据开始，然后建模你的神经网络来编码你的数据并处理输出。</p><p id="9cbd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在你开始阅读这篇文章及其后继者之前，你应该了解以下主题的基础知识，以便在阅读时不会感到慌张:<br/> 1。微积分<br/> 2。线性代数<br/> 3。神经网络<br/> 4。熊猫，熊猫</p><p id="4b4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您可能已经从主题中推断出的那样，这是一篇编程文章，因此它可能有助于了解一些python方面的经验。</p><p id="242b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">建议您使用Spyder(Anaconda的代码编辑器)进行编码，因为它具有选择性执行功能，这对于理解变量转换非常有帮助。</p><div class="kw kx gp gr ky kz"><a href="https://www.datadriveninvestor.com/2019/01/23/deep-learning-explained-in-7-steps/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">深度学习用7个步骤解释-更新|数据驱动的投资者</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">在深度学习的帮助下，自动驾驶汽车、Alexa、医学成像-小工具正在我们周围变得超级智能…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><p id="76f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有GPU，最好在Google Colab上完成这项工作——Colaboratory是一个免费的Jupyter笔记本环境，不需要设置，完全在云中运行。</p><p id="7f4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">借助Colaboratory，您可以编写和执行代码、保存和共享您的分析，以及访问强大的计算资源，所有这些都可以从浏览器中免费获得。</p><p id="f3b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在这里使用的数据集是<code class="fe lo lp lq lr b">Fashion-MNIST</code>。<code class="fe lo lp lq lr b">Fashion-MNIST</code>是一个由<a class="ae ls" href="https://jobs.zalando.com/tech/" rel="noopener ugc nofollow" target="_blank"> Zalando </a>的文章图像组成的数据集——由60，000个样本的训练集和10，000个样本的测试集组成。每个示例都是28x28灰度图像，与10个类别的标签相关联。我们打算<code class="fe lo lp lq lr b">Fashion-MNIST</code>作为原始<a class="ae ls" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST数据集</a>的直接替代，用于机器学习算法的基准测试。它共享训练和测试分割的相同图像大小和结构。</p><p id="a750" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据集的一个范例是:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/6d69f990be0234a75d9805f76ef8672e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNLB2jtcfb_xTqgQd9ntJA.png"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk">Sample from the Fashion MNIST Dataset (<em class="mc">each class takes three-rows</em>)</figcaption></figure><p id="e8ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你们可能对MNIST的手写数字数据集有过经验，但我们不会在这里使用它，因为有两个非常好的理由。MNIST的网络设计太简单了，即使你使用密集的网络，你也可以达到98%的准确率。<br/> 2。它被过度使用了，我们想要学习新的东西，而不是重复旧的内容。</p><p id="f634" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">说到这里，我们可以开始有趣的部分了:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/ccc9833ffd678bd47875dccbc503e07c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdKrwGL1Ix0J-VnxIwlspg.png"/></div></div></figure><p id="a835" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文的第一部分中，我们将进行预处理，通俗地说就是准备原始数据集，使其与网络的输入图层兼容。</p><p id="8a29" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们导入我们将在实践中使用的基本库——NumPy，它是使用Python和Matplotlib进行科学计算的基础包，Matplotlib是Python 2D绘图库，它以各种硬拷贝格式和跨平台的交互环境生成出版物质量数据。</p><p id="4228" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后但肯定不是最不重要的——tensor flow，这是一个用于机器学习的端到端开源平台。它有一个全面、灵活的工具、库和社区资源的生态系统，让研究人员推动ML的最新发展，让开发人员轻松构建和部署ML驱动的应用程序。</p><p id="9f73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如本文的主题所建议的，我们将使用tensor flow——具体来说，它是稳定的2.0版本，用于我们从现在开始执行的几乎所有任务。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/72ab9aec2abdb0f6a5eaff49eb2562e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FE5JT2tuPNEqkn85k-8REg.png"/></div></div></figure><p id="edf5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您从tf.keras.datasets加载数据，其中包含许多有用的数据集供您练习。</p><p id="4853" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还对像素值进行归一化或缩放，将每个像素值除以255，这是一个像素的最大值，因此我们得到了一个值在0-1之间的三维矩阵。这将有助于我们将来的计算。</p><p id="ea55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查输入的形状也很重要，因为我们的神经网络只会接受特定的输入形状。</p><p id="bbd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将构建一个卷积神经网络或CNN，它只接受具有形状(batch_size，height，width，channels)的输入。我们的数据集在训练集中有60000张图片，在测试集中有10000张图片。每个图像的高度和宽度都是28，因为我们有一个灰度图像，通道数= 1。作为参考，彩色图像有三个通道，RGB。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/272674d9ee11188747a2d8f0d2dcb934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nboQt5ldSmrCGZufM41hoQ.png"/></div></div></figure><p id="29f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，为了纠正我们的输入中通道维度的缺失，我们扩展维度，以便我们的输入与神经网络的输入层兼容。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/bcb9934aa645698cbf9b32b50e9e2e62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cCmHZeIrE13D7FUxr48ejg.png"/></div></div></figure><p id="743b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还检查数据集中的类别数量，这将控制我们的输出层。</p><p id="0fc7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成这些之后，我们就完成了模型的预处理。</p><p id="da7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下一篇文章中，我们将讨论为预测特定图像所属的类别而设计的神经网络。</p><p id="34c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请点击此链接查看完整代码:</p><div class="kw kx gp gr ky kz"><a href="https://github.com/lordtt13/Medium-Articles/blob/master/tf2_pre_to_serve.py" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">Lord TT 13/中等-物品</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">我的Medium Articles-Lord tt13/Medium-Articles中引用的所有代码的配套报告</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="mh l lk ll lm li ln jw kz"/></div></div></a></div><p id="eecd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">也请给我的个人资料看看更多的内容，如机器学习，全栈开发等几个编程主题相关。</p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure></div></div>    
</body>
</html>