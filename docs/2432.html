<html>
<head>
<title>How to Django with MongoDB — The power of Djongo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用MongoDB来Django——Djongo的力量</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-django-with-mongodb-the-power-of-djongo-df92317f8714?source=collection_archive---------0-----------------------#2020-04-30">https://medium.datadriveninvestor.com/how-to-django-with-mongodb-the-power-of-djongo-df92317f8714?source=collection_archive---------0-----------------------#2020-04-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9478ff42bdc017b35cf1ae83c4df7cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBgkoY2ACxMd__3qTj6s5g.jpeg"/></div></div></figure><p id="3ef6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于大数据时代的兴起，NoSQL已经成为处理用于分析、实时应用和存储的数据的行业规范。NoSQL数据库允许数据的非关系存储，通过它可以以不同的方式方便地检索和存储数据。</p><p id="a154" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">SQL数据库有固体和酸的概念，而NoSQL没有这样的概念。</p><p id="e208" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">考虑到NoSQL的崛起，Django应该有MongoDB这样的NoSQL支持，但可悲的是MongoDB没有官方支持。很少有开源项目提供带有Django的MongoDB连接器。一个这样的连接器是djongo。</p><p id="99f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">djongo连接器不影响Django ORM框架的原始ORM。djongo连接器不仅将SQL查询翻译成MongoDB查询，还允许访问pymongo API，这是MongoDB对Python的官方支持。</p><p id="7814" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装Django </p><p id="3958" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它可以通过以下方式访问</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="cd2e" class="lf lg iq lb b gy lh li l lj lk">pip install djongo</span></pre><p id="d64c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将这些添加到Django项目的settings.py中</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="28b6" class="lf lg iq lb b gy lh li l lj lk">DATABASES = {<br/>       'default': {<br/>           'ENGINE': 'djongo',<br/>           'NAME': 'your-db-name',<br/>         <!-- --># 'HOST':'mongodb+srv://&lt;username&gt;:      &lt;password&gt;<a class="ae ll" href="http://twitter.com/cluster0" rel="noopener ugc nofollow" target="_blank">@</a>mongodb_atlas',<br/>         # 'USER': 'user',<br/>         # 'PASSWORD': 'pass',<!-- -->       <br/>}<br/>   }</span></pre><p id="fe0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">主机可以用来连接Django和MongoDB的云数据库，并提供该数据库的用户名和密码</p><p id="231e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行以下命令来生成MongoDB数据库的模式</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="9a23" class="lf lg iq lb b gy lh li l lj lk">python manage.py makemigrations &lt;app_name&gt;</span><span id="5343" class="lf lg iq lb b gy lm li l lj lk">python manage.py migrate</span></pre><p id="a7a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Djongo主要支持三种类型的数据字段，分别是<strong class="ka ir">嵌入字段</strong>、<strong class="ka ir">数组字段</strong>、<strong class="ka ir">数组引用字段</strong>，以及其他一些。点击<a class="ae ll" href="https://nesdis.github.io/djongo/using-django-with-mongodb-data-fields/" rel="noopener ugc nofollow" target="_blank">这里</a>查看</p><p id="9f0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，通过Django应用程序的管理页面访问元素，需要声明一个带有数据字段的表单，例如</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="2218" class="lf lg iq lb b gy lh li l lj lk">from djongo import models<br/>from django import forms<br/><br/>class Blog(models.Model):<br/>    name = models.CharField(max_length=100)<br/>    tagline = models.TextField()<br/><br/>    class Meta:<br/>        abstract = True<br/><br/>class BlogForm(forms.ModelForm):<br/>    class Meta:<br/>        model = Blog<br/>        fields = (<br/>            'name', 'tagline'<br/>        )<br/><br/><br/>class Entry(models.Model):<br/>    blog = models.EmbeddedField(<br/>        model_container=Blog,<br/>        model_form_class=BlogForm<br/>    )<br/>    <br/>    headline = models.CharField(max_length=255)    <br/>    objects = models.DjongoManager()</span></pre><p id="dcd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您想通过序列化器来序列化数据，那么您可以使用<strong class="ka ir"><em class="ln">rest _ meets _ djongo</em></strong>序列化器来实现，比如</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ce7d" class="lf lg iq lb b gy lh li l lj lk">from djongo import models<br/>from rest_meets_djongo import serializers<br/>from project.models import Entry</span><span id="1ca0" class="lf lg iq lb b gy lm li l lj lk">class EntrySerializer(serializers.DjongoModelSerializer):<br/>   class Meta:<br/>        model = Entry<br/>        fields = ['headline','blog']</span></pre><p id="d6c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要使用查询或子查询，需要以下语法:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="5630" class="lf lg iq lb b gy lh li l lj lk">inner_qs=Blog.objects.filter(name__contains='django').values('name')<br/>entries = Entry.objects.filter(blog__name__in=inner_qs)</span></pre><p id="5612" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，一个重要的方面是序列化这些模型，尽管序列化不是使用djongo的必要步骤，因为它可以使用pymongo包装器直接访问MongoDB中的值，可以通过将<em class="ln"> mongo_ </em>添加到pymongo中的每个命令来访问该包装器。以下是使用此方法的聚集示例:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="092b" class="lf lg iq lb b gy lh li l lj lk">query=[<br/>  {<br/>    "$unwind": "$comments"<br/>  },<br/>  {<br/>    "$group": {<br/>      "_id": {<br/>        "year": {<br/>          "$year": {<br/>            "$toDate": "$post_published"<br/>          }<br/>        },<br/>        "month": {<br/>          "$month": {<br/>            "$toDate": "$post_published"<br/>          }<br/>        },<br/>        "week": { "$week": { "$toDate": "$post_published" } }</span><span id="c552" class="lf lg iq lb b gy lm li l lj lk">,<br/>        "post_sentiment": "$comments.sentiment",<br/>      },<br/>      "count": {<br/>        "$sum": 1<br/>      }<br/>    }<br/>  },<br/>  {<br/>    "$sort": {<br/>      "_id": -1<br/>    }<br/>  }<br/>]</span><span id="dc64" class="lf lg iq lb b gy lm li l lj lk">#this is used in view.py in Django<br/>Posts.objects.mongo_aggregate(query)</span></pre><p id="a51b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然Django没有官方支持MongoDB作为web应用程序开发的框架，但是djongo和其他类似的项目有助于解决复杂的问题并加快开发周期。</p><p id="fb96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">免责声明</strong> : <strong class="ka ir"> <em class="ln"> Djongo不应用于生产级应用程序，除非对其进行完整的项目评估。</em> </strong></p><p id="21ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考文献</strong>:</p><div class="lo lp gp gr lq lr"><a href="https://nesdis.github.io/djongo/get-started/" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">Django和MongoDB连接器</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">Djongo专门用于最初的Django ORM和MongoDB。使用Django管理应用程序，您可以…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">nesdis.github.io</p></div></div><div class="ma l"><div class="mb l mc md me ma mf jw lr"/></div></div></a></div><div class="lo lp gp gr lq lr"><a href="https://github.com/nesdis/djongo" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">nesdis/djongo</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">使用MongoDB作为Django项目的后端数据库，不需要修改Django ORM。使用Django管理GUI来…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">github.com</p></div></div><div class="ma l"><div class="mg l mc md me ma mf jw lr"/></div></div></a></div></div></div>    
</body>
</html>