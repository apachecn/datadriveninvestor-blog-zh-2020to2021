<html>
<head>
<title>Review: IPCNN — Intra Prediction Convolutional Neural Network (HEVC Intra Prediction)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">综述:IPCNN —帧内预测卷积神经网络(HEVC帧内预测)</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/review-ipcnn-intra-prediction-convolutional-neural-network-hevc-intra-prediction-a8d00409156?source=collection_archive---------7-----------------------#2020-04-15">https://medium.datadriveninvestor.com/review-ipcnn-intra-prediction-convolutional-neural-network-hevc-intra-prediction-a8d00409156?source=collection_archive---------7-----------------------#2020-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="934c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">与HEVC参考软件HM-14.0相比，比特率降低了0.70%</h2></div><p id="9711" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di">在</span>这篇报道中，简要回顾了哈尔滨工业大学的<strong class="kh ir">基于卷积神经网络的HEVC帧内预测(IPCNN) </strong>。作者提到这是第一篇将CNN直接应用于HEVC的帧内预测的论文。我回顾这一点是因为我从事视频编码研究。这是一篇发表在<strong class="kh ir"> 2017 DCC </strong>的论文。(<a class="lk ll ep" href="https://medium.com/u/aff72a0c1243?source=post_page-----a8d00409156--------------------------------" rel="noopener" target="_blank"> Sik-Ho Tsang </a> @ Medium)</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="40fb" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">概述</h1><ol class=""><li id="a9fe" class="ml mm iq kh b ki mn kl mo ko mp ks mq kw mr la ms mt mu mv bi translated"><strong class="kh ir">视频编码的重要性</strong></li><li id="79d2" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la ms mt mu mv bi translated"><strong class="kh ir">传统HEVC帧内编码</strong></li><li id="2818" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la ms mt mu mv bi translated"><strong class="kh ir"> IPCNN网络</strong></li><li id="edac" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la ms mt mu mv bi translated"><strong class="kh ir">实验结果</strong></li></ol></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="772f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak"> 1。视频编码的重要性</strong></h1><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/34ac113bbc3fa7d0c90f18efeccf7b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/0*qQ14mdxbw17tpkLJ.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk"><strong class="bd lv">A video is composed of a sequence of frames</strong></figcaption></figure><ul class=""><li id="e985" class="ml mm iq kh b ki kj kl km ko nn ks no kw np la nq mt mu mv bi translated">视频编码/压缩是将原始视频编码成压缩的比特流以便存储，或者在通过互联网发送到解码器端之前。</li><li id="ff79" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir">视频由一系列帧组成</strong></li><li id="f078" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">在没有视频编码的情况下，假设有一个小时(t)的30FPS 1920(W)×1080 (H) RGB (C)视频，每个颜色分量(C)一个字节，则raw文件大小为:</li></ul><pre class="nc nd ne nf gt nr ns nt nu aw nv bi"><span id="3935" class="nw lu iq ns b gy nx ny l nz oa">W×H×C×FPS×t=1920×1080×3×30×(60×60)=625GB</span></pre><ul class=""><li id="b53c" class="ml mm iq kh b ki kj kl km ko nn ks no kw np la nq mt mu mv bi translated">对于普通用户来说，不可能存储如此大文件。</li><li id="c52c" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">或者如果发送出去，需要的时间长，数据计划将是昂贵的。</li><li id="9126" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">通过视频编码，这个一小时的视频可能只有1GB，视频质量已经很好了。</li><li id="2611" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">我们在YouTube/Twitch/Instagram上观看的每一个视频都已经被压缩了。</li><li id="2c05" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">当我们在互联网上观看时，图像通常是压缩的，例如PNG/JPG,除非我们正在对照片进行专业的照片编辑。</li><li id="29d6" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">深度学习的数据集通常是压缩的。</li><li id="0367" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">因此，视频编码/压缩至关重要，它每天都在我们身边出现。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="6c20" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">2.传统HEVC帧内编码</h1><h2 id="29ab" class="nw lu iq bd lv ob oc dn lz od oe dp md ko of og mf ks oh oi mh kw oj ok mj ol bi translated">2.1.HEVC视频编码</h2><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/34ac113bbc3fa7d0c90f18efeccf7b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/0*qQ14mdxbw17tpkLJ.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk"><strong class="bd lv">A video is composed of a sequence of frames</strong></figcaption></figure><ul class=""><li id="8bac" class="ml mm iq kh b ki kj kl km ko nn ks no kw np la nq mt mu mv bi translated">在H.264、HEVC和VVC等视频编码标准中，本文采用并改进了HEVC(高效视频编码)。</li><li id="906d" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">在HEVC，帧被分成不重叠的块，称为编码树单元(CTU)。每个CTU的大小为64×64。使用光栅扫描顺序从左上到右下对CTU进行编码。</li></ul><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="on oo di op bf oq"><div class="gh gi om"><img src="../Images/872a484339fef69809f9c3676f16f33e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p7hElog7kD11_A0M.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk"><strong class="bd lv">Quad-Tree Coding</strong></figcaption></figure><ul class=""><li id="4db3" class="ml mm iq kh b ki kj kl km ko nn ks no kw np la nq mt mu mv bi translated">对于每个CTU，应用四叉树编码将CTU分成4个更小的正方形编码单元(Cu ),从64×64，32×32，16×16到8×8。通过比较每个CU级别的CU的成本，选择不同大小的CU来编码每个CTU。</li><li id="6e4e" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">(8×8 Cu可以分成4个4×4预测单元(pu)，但这不是这个故事的重点。)</li><li id="ca04" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">每个CU通过不同的方法编码，例如帧内预测和帧间预测。</li><li id="b3ee" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">在本文中，作者只关注帧内预测。</li><li id="410d" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">(还有帧间预测，其中在帧中找到相似的块，以更有效的方式压缩帧，这也称为运动估计。)</li></ul><div class="or os gp gr ot ou"><a href="https://www.datadriveninvestor.com/2019/01/28/ai-creativity-deep-dream-comes-true/" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">人工智能与创造力:梦想成真|数据驱动的投资者</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">人工智能总是让我着迷。不仅作为一套有用的工具，不断发展，而且作为一个…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi nh ou"/></div></div></a></div><h2 id="0e72" class="nw lu iq bd lv ob oc dn lz od oe dp md ko of og mf ks oh oi mh kw oj ok mj ol bi translated">2.2.HEVC的35个帧内预测</h2><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="on oo di op bf oq"><div class="gh gi pj"><img src="../Images/2a7ef970f8c83ba6f393ba262d0b835e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qTXhfzhJNUfv_9DP.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk"><strong class="bd lv">35 Intra Predictions in HEVC (Left), Some Examples (Right)</strong></figcaption></figure><ul class=""><li id="4b12" class="ml mm iq kh b ki kj kl km ko nn ks no kw np la nq mt mu mv bi translated">对于帧内预测中的每个CU，如上所示有35个预测。</li><li id="c69e" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir">邻居参考样本用于预测当前CU。</strong></li><li id="195b" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir"> 0:平面</strong>，预测CU内平滑渐变。</li><li id="21ec" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir"> 1: DC </strong>，用平均值填入CU作为预测。</li><li id="2021" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir">2–34:角度</strong>，用不同的角度预测当前CU。</li><li id="ae35" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">一些例子显示在图的右边。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="88e9" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak"> 3。IPCNN网络</strong></h1><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="on oo di op bf oq"><div class="gh gi pk"><img src="../Images/f10e4b6d1b8fcabfa618677806aecb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKnjZfYj9d8c7SBMaKQ8fQ.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk"><strong class="bd lv">IPCNN Network (Left: Training, Right: Testing)</strong></figcaption></figure><h2 id="075e" class="nw lu iq bd lv ob oc dn lz od oe dp md ko of og mf ks oh oi mh kw oj ok mj ol bi translated">3.1.培养</h2><ul class=""><li id="2374" class="ml mm iq kh b ki mn kl mo ko mp ks mq kw mr la nq mt mu mv bi translated">通过HEVC帧内编码收集训练样本，该编码包括最佳8×8帧内预测块(粉红色)及其三个最近的8×8重构块(绿色)。</li><li id="45e2" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">IPCNN的输出是通过从输入块中减去原始块而产生的剩余块。</li><li id="ac1b" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">然而，作者在论文中没有提供网络体系结构的细节。</li></ul><h2 id="f7bc" class="nw lu iq bd lv ob oc dn lz od oe dp md ko of og mf ks oh oi mh kw oj ok mj ol bi translated">3.2.测试(帧内预测)</h2><ul class=""><li id="11e8" class="ml mm iq kh b ki mn kl mo ko mp ks mq kw mr la nq mt mu mv bi translated">包括当前块及其三个最近的8×8重构块的16×16上下文块被馈送到网络中。</li><li id="af71" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">网络的输出是剩余块。</li><li id="e5fe" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">同时，这三个最近的8×8重构块也可以被细化。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="3b5f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak"> 4。实验结果</strong></h1><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="on oo di op bf oq"><div class="gh gi pl"><img src="../Images/003866ccc384e28a185d734505a97e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKgQj_4xNw5v0EG-kQ9yTA.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk"><strong class="bd lv">Visual Quality</strong></figcaption></figure><ul class=""><li id="63cd" class="ml mm iq kh b ki kj kl km ko nn ks no kw np la nq mt mu mv bi translated"><strong class="kh ir"> (ai) </strong>:原始图像</li><li id="e32f" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir"> (bi) </strong>:原HEVC预测块</li><li id="119c" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated"><strong class="kh ir">(ci)</strong>:IPCNN预测的块</li><li id="27ee" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">IPCNN预测的区块优于HEVC预测的区块。</li><li id="d88f" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">最后，<strong class="kh ir">与HEVC参考软件HM-14.0相比，比特率降低了0.70%。</strong></li><li id="c351" class="ml mm iq kh b ki mw kl mx ko my ks mz kw na la nq mt mu mv bi translated">减少0.7%已经是视频编码的一大成就。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="854e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">参考</h1><p id="5aff" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko pm kq kr ks pn ku kv kw po ky kz la ij bi translated">【2017 DCC】【IPCNN】<br/><a class="ae pp" href="https://ieeexplore.ieee.org/document/7923719" rel="noopener ugc nofollow" target="_blank">基于卷积神经网络的HEVC帧内预测</a></p><h1 id="60cc" class="lt lu iq bd lv lw pq ly lz ma pr mc md jw ps jx mf jz pt ka mh kc pu kd mj mk bi translated">编解码器预测</h1><p id="52d3" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko pm kq kr ks pn ku kv kw po ky kz la ij bi translated">[<a class="ae pp" href="https://medium.com/@sh.tsang/review-ipcnn-intra-prediction-convolutional-neural-network-hevc-intra-prediction-a8d00409156" rel="noopener">IPCNN</a>][<a class="ae pp" href="https://medium.com/@sh.tsang/review-ipfcn-intra-prediction-using-fully-connected-network-hevc-intra-prediction-28de33dff3a5" rel="noopener">IPFCN</a>][<a class="ae pp" href="https://medium.com/@sh.tsang/review-nnip-neural-network-based-inter-prediction-for-hevc-hevc-inter-prediction-e11b43a15385" rel="noopener">NNIP</a>][<a class="ae pp" href="https://medium.com/@sh.tsang/review-li-tcsvt18-cnn-upsampling-for-hevc-intra-coding-hevc-intra-prediction-a3263c2be0d5" rel="noopener">李TCSVT'18 </a> ]</p><h1 id="658e" class="lt lu iq bd lv lw pq ly lz ma pr mc md jw ps jx mf jz pt ka mh kc pu kd mj mk bi translated"><a class="ae pp" href="https://medium.com/@sh.tsang/overview-my-reviewed-paper-lists-tutorials-946ce59fbf9e" rel="noopener">我之前的其他评论</a></h1><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="pv pw l"/></div></figure></div></div>    
</body>
</html>