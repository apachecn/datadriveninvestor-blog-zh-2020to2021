<html>
<head>
<title>How to not get caught while web scraping?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在抓取网页时不被抓到？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-not-get-caught-while-web-scraping-88097b383ab8?source=collection_archive---------0-----------------------#2020-02-02">https://medium.datadriveninvestor.com/how-to-not-get-caught-while-web-scraping-88097b383ab8?source=collection_archive---------0-----------------------#2020-02-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4ea445d2d59f094e4d2388dfa42284d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kiFWkQPR4AoPK24n"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@artnok?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nicolas Picard</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a488" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">说到数据源，在网站上，有一个巨大的有用数据的宇宙，任何人只要有互联网连接和一个基本的设备就可以访问。但是，网站没有为您提供保存这些数据供个人使用的功能，如果您仍然需要手动从数百个页面中复制/粘贴数据进行研究，这可能会令人沮丧。</p><p id="f992" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">目前，以编程方式从网站中提取您需要的数据，并在您的项目中充分利用它作为外部信息源，这是最热门的话题之一。这个过程通常被称为<strong class="ki iu">网络抓取</strong>，从非法/合法的角度来说，这是一个相反的话题。大网站大多使用反网页抓取工具来避免被网页抓取。</p><p id="57df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章的范围是关于<strong class="ki iu">如何在抓取网页时不被抓住的方法。在制造我们的机器人之前，我们需要理解它的逻辑。</strong></p><p id="8f1c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">网站可以跟踪你的IP信息，你用相同的IP访问的网页，你的用户代理信息，你的请求频率和许多其他指标。你可以认为IP是你的互联网身份，从同一个IP发送到一个网站的任何系统请求都可以很容易地被反网页抓取工具检测到，你将被禁止使用IP。</p><p id="7531" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的机器人应该模仿人类正常的上网行为，这样它就不会引起任何网站的注意或怀疑。更清楚地说:<strong class="ki iu">想象你自己在访问一个网站的页面，每次你改变页面时都使用免费的VPN服务。在两个页面之间等待一段随机时间，并从网站复制/粘贴数据</strong>。</p><h2 id="8a1f" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤:</h2><p id="e849" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated"><em class="mc"> 1-找到一个免费的代理提供商网站</em></p><p id="dc02" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> 2-刮去代理人</em></p><p id="5d90" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> 3-检查代理并保存工作中的代理</em></p><p id="78bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> 4-设计您的请求频率(尽量使其随机)</em></p><p id="29f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mc"> 5-动态轮换代理，并通过这些代理发送您的请求</em></p><p id="6a31" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6-自动化一切</p><h2 id="e01a" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">让我们找一个免费的代理提供商</h2><p id="4104" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这个练习中，我们使用<a class="ae kf" href="https://free-proxy-list.net/" rel="noopener ugc nofollow" target="_blank">https://free-proxy-list.net/</a>。如你所见，网站布局非常简单:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/0f70a600c763752477969f9172081e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DSEf9dW9jFWArR6yWBN4Cw.jpeg"/></div></div></figure><p id="3fd6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要动态地抓取这些数据(IP地址、端口和Https信息),并使用这些数据向我们真正感兴趣的其他站点发送请求。请记住，代理每10分钟更新一次，网站主页会显示20到80个条目。</p><h2 id="b786" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">抓取代理</h2><p id="7b89" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">让我们开始用Python开发，并试着好好利用<em class="mc">请求</em>和<em class="mc">美丽组</em>库。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mi mj l"/></div></figure><ul class=""><li id="49b7" class="mk ml it ki b kj kk kn ko kr mm kv mn kz mo ld mp mq mr ms bi translated">get _ proxies()函数向“<a class="ae kf" href="https://free-proxy-list.net/" rel="noopener ugc nofollow" target="_blank">https://free-proxy-list.net/</a>的主页面发送请求。</li><li id="3168" class="mk ml it ki b kj mt kn mu kr mv kv mw kz mx ld mp mq mr ms bi translated">返回主页的html代码并记录为<em class="mc">响应。</em></li><li id="c072" class="mk ml it ki b kj mt kn mu kr mv kv mw kz mx ld mp mq mr ms bi translated">用<em class="mc"> beautifulsoup </em>解析页面的html代码，在返回的IP地址中，干净地提取端口和Https数据</li><li id="8596" class="mk ml it ki b kj mt kn mu kr mv kv mw kz mx ld mp mq mr ms bi translated">还会检查代理是否与https网站兼容(https =是)。</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi my"><img src="../Images/766d862cf61f97d9710e0867984b54b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*fuGQ-dNEQINX1X_o318y2w.jpeg"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Scraped proxies from the main page</figcaption></figure><p id="a21f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们有来自网站主页的代理。我们现在需要再次检查它们是否真的在工作。</p><h2 id="6ba4" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">让我们检查代理，并得到工作的！</h2><p id="fd2e" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">为了获得有效的代理，我们将向一个名为“<a class="ae kf" href="https://httpbin.org/ip" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/ip</a>”的webiste发送一个请求。这个网站显示当前的IP，观众正在连接到互联网。你可以自己试试，找出自己的IP地址！</p><p id="fa41" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果对此网站的测试请求得到响应，代理将被保存到working _ proxies列表中。在这里，您可以找到实现这一点的Python代码:</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="33a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这两个函数(get _ proxies()、check _ proxies())，我们刚刚构建了一个API，它首先访问免费代理提供商的网站，然后抓取IP，之后通过发送一个请求来检查它们，并只返回有效的IP。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/ef48ae80bed1cb1c3c051facd4c2389c.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*VZ1x-Wo1uJwbTVkzAWTmjA.jpeg"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Tracking how it’s working</figcaption></figure><p id="f4e5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很明显，一些代理会引发连接错误。这主要是由免费代理造成的。API工作正常，但是如果你提取太多的数据，高级/付费代理服务应该是主要的选择。另一个选择可以是为你的代理搜索机器人实现一个人工智能来理解哪一个是最好的。</p><p id="40b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是组织<strong class="ki iu">请求频率</strong>并将我们的请求分发给我们真正感兴趣的网站。这种方法将使机器人更加匿名:</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h2 id="f294" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">使用领域</h2><ul class=""><li id="e145" class="mk ml it ki b kj lx kn ly kr na kv nb kz nc ld mp mq mr ms bi translated">定价研究</li><li id="0e46" class="mk ml it ki b kj mt kn mu kr mv kv mw kz mx ld mp mq mr ms bi translated">市场调查</li><li id="c04f" class="mk ml it ki b kj mt kn mu kr mv kv mw kz mx ld mp mq mr ms bi translated">市场规模</li><li id="90bc" class="mk ml it ki b kj mt kn mu kr mv kv mw kz mx ld mp mq mr ms bi translated">标杆管理</li></ul><p id="0d78" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Web抓取在合适的人手里，可以作为一个非常有用的工具来动态编译有意义的信息。在这样做的时候，永远记住不要损害网站或违反他们的条款。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="nd mj l"/></div></figure></div></div>    
</body>
</html>