<html>
<head>
<title>Machine Learning: Decision Trees Example in Real Life</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:现实生活中的决策树示例</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/machine-learning-decision-trees-example-in-real-life-b78865015b6f?source=collection_archive---------2-----------------------#2020-10-18">https://medium.datadriveninvestor.com/machine-learning-decision-trees-example-in-real-life-b78865015b6f?source=collection_archive---------2-----------------------#2020-10-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ad48f26bd29247455f7e928279189bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tl-lu9IviMxDRWg8.png"/></div></div></figure><p id="f6ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如树是人类生活的重要组成部分一样，基于树的算法是机器学习的重要组成部分。树的结构给了开发算法的灵感，并将其输入到机器中，以学习我们希望它们学习的东西，并解决现实生活中的问题。这些基于树的学习算法被认为是最好的和最常用的监督学习方法之一。决策树、随机森林、梯度推进等方法在各种数据科学问题中得到了广泛应用。因此，对于每个机器学习的初学者来说，学习这些算法并将其用于建模是非常重要的。</p><h1 id="11e7" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">什么是决策树？</h1><p id="2712" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">决策树是一个树状图形，节点代表我们选择属性和提出问题的位置；边代表问题的答案，叶子代表实际输出或类标签。它们用在具有简单线性决策表面的非线性决策中。</p><p id="0fd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">决策树通过从根到某个叶节点对示例进行排序来对示例进行分类，叶节点为示例提供分类。树中的每个节点都充当某个属性的测试用例，从该节点开始向下延伸的每条边都对应于测试用例的一个可能答案。这个过程本质上是递归的，并且对以新节点为根的每个子树重复这个过程。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/8169a5c49e4e32db1d2d919623ea19bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*c6dMc4GPdg-6n-qKFiUQ_Q.jpeg"/></div></figure><p id="c5e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">现实生活中的决策树</strong></p><p id="a6c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能在自己的生活中使用过决策树来做决定。让我们举一个关于你是否想在某一天和你的孩子打网球的决定的例子。</p><p id="4983" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这可能取决于各种因素，如你是否能准时离开办公室，是否能足够早地离开，是否能在晚上6点前到家，这取决于交通状况或你的孩子当天是否有其他活动已经安排好；在所有情况下，你和你儿子出去打网球的决定主要取决于你和你的孩子在那一天是否有空以及外面的天气。</p><p id="fb45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果天气很好，你从办公室出来并按时回家，而你的孩子没有其他课，你可能想和他一起去网球场。如果你准时到达，但他那天已经有其他活动安排了，你可能只想在家放松，看些电影。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/d0b4ecd15dbdeb77e17948130ea3b66e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8LafH9Au_BeGAn-cOMmrrw.png"/></div></div></figure><p id="7e33" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是<em class="mf">现实生活中决策树</em>的一个明显例子。我们已经建立了一个树来模拟一组<strong class="ka ir">顺序的、</strong>层级的决策，这些决策最终会导致一些最终的结果。请注意，我们还选择了相当“高层次”的决策，以保持树小。例如，如果我们为<em class="mf">设置许多</em>可能的天气选项，如25度晴天、25度雨天、26度晴天、26度雨天、27度晴天……等等，我们的树会很大！确切的温度真的不太相关，我们只想知道在室外是否可以。</p><p id="407a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，你计算过去几天的所有这些因素，并形成一个类似下面的查找表。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi gj"><img src="../Images/39587dfb6359c5123edaa992073e9b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWnkgzl0sijRIMyp2MJi3w.png"/></div></div></figure><p id="eac7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">决策树算法是如何工作的？</strong></p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/1756750520f2d9607e5e7bd4ad8394cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vI3ogpH2mIg-47Imsf5cfw.jpeg"/></div></div></figure><p id="61f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任何决策树算法背后的基本思想如下:</p><ol class=""><li id="1adf" class="mh mi iq ka b kb kc kf kg kj mj kn mk kr ml kv mm mn mo mp bi translated">使用属性选择度量(ASM)选择最佳属性来拆分记录。</li><li id="c916" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">使该属性成为决策节点，并将数据集分成更小的子集。</li><li id="c8da" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mm mn mo mp bi translated">通过对每个孩子递归地重复该过程来开始树构建，直到其中一个条件匹配:</li></ol><ul class=""><li id="4941" class="mh mi iq ka b kb kc kf kg kj mj kn mk kr ml kv mv mn mo mp bi translated">所有的元组属于相同的属性值。</li><li id="a621" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mv mn mo mp bi translated">没有更多的剩余属性。</li><li id="a34a" class="mh mi iq ka b kb mq kf mr kj ms kn mt kr mu kv mv mn mo mp bi translated">没有更多的实例。</li></ul><p id="e704" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ASM通过解释给定的数据集为每个特征(或属性)提供一个等级。最佳分数属性将被选为分割属性()。在连续值属性的情况下，分支的分割点也需要定义。最受欢迎的选择指标是<strong class="ka ir">信息增益</strong>、<strong class="ka ir">增益比率、</strong>和<strong class="ka ir">基尼指数</strong>。</p><h2 id="32d6" class="mw kx iq bd ky mx my dn lc mz na dp lg kj nb nc lk kn nd ne lo kr nf ng ls nh bi translated"><strong class="ak">什么是信息增益，如何衡量？</strong></h2><p id="9265" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">信息增益是一种统计属性，用于衡量给定属性根据目标分类将训练样本分开的程度。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b3008bdee664c1c18e1b3ce37615963c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*PEW2vXZB2s5DTEKLMmTd-A.png"/></div></figure><p id="8ced" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">信息增益是熵(随机性)的减少。它根据给定的属性值计算数据集分割前的熵和分割后的平均熵之差。计算熵的基本公式是:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/9ba47b3294a442f42119c1de671b62b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*bKafllCHgmZ9T3YRu2UvNQ.png"/></div></figure><p id="6b2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中Pi是D中的任意元组属于类Ci的概率。</p><p id="8f24" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">信息增益计算如下:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/835c1836ca9fa3553536c80ed55eeac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*360RxUgycSf63SX_mSrOkg.png"/></div></figure><p id="3f01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们计算每个父节点和子节点的熵:</p><p id="ecc1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">e(父节点)= -[P(网球)log(base2)P(网球)</p><p id="70da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">+ P(Home)log(base2)P(Home)]</p><p id="72a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">=—[(1/2)log(base 2)(1/2)+(1/2)log(base 2)(1/2)]</p><p id="a6f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">= 1</p><p id="0658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为P(网球)= 1/2，P(家庭)= 1/2</p><p id="0ce9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们看看父节点是否通过第一个属性分裂，即<strong class="ka ir">天气</strong>。</p><p id="35ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们看到上面给定的数据，根据属性weather，我们会得到下面的值来决定玩还是不玩:</p><p id="09c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">雨天:呆在家里</p><p id="0292" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">桑妮:网球，网球，寄宿家庭</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/45b2ff5b155c9a4c11b3a0c64232a2b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsUNQk9wglwq9Ysi_AgYww.jpeg"/></div></div></figure><p id="02d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">右子节点熵:E(雨天):</p><p id="780e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">= -P(Home)log(base2)P(Home)</p><p id="769c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">=-1log(1)= 0</p><p id="160e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">左子节点熵:E(晴天):</p><p id="b9bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-[P(Home)log(base2)P(Home)</p><p id="97ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">+ P(网球)log(base2)P(网球)]</p><p id="a1b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">=-[(1/3)log(base 2)(1/3)+(2/3)log(base 2)(2/3)]= 0.9</p><p id="33c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，信息增益(天气)=熵(父项)——[(加权平均值*每个孩子的熵)之和]</p><p id="71f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">= 1 — [(3/4)*(0.9)+(1/4)*0] = 0.325</p><p id="ffc7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，我们计算了其他属性的熵和信息增益，得到以下结果:</p><p id="284b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">IG(工作计划)= 1</p><p id="71fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">IG(交通)= 0.325</p><p id="a2d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">IG(可用性)= 0.325</p><p id="faec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于属性的信息增益，“工作安排”是最高的，我们可以说预测你那天是否会打网球的最准确的属性是你的<strong class="ka ir">工作安排</strong>。</p><p id="8b86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">什么是基尼指数？</strong></p><p id="413b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">决策树算法CART(分类和回归树)使用基尼方法来创建拆分点。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/9f3032b7c5c181b82c7a28d5c8d93a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*3rdHg1murvr8y_hcrsPKxQ.png"/></div></figure><p id="6d5e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中pi是D中的元组属于类Ci的概率。</p><p id="bdea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">基尼系数(Gini Index)，也称为基尼系数，计算随机选择时某一特定属性被错误分类的概率。如果所有的元素都与一个类联系在一起，那么它可以被称为纯类。基尼指数考虑了每个属性的二元分裂。你可以计算每个分区的杂质的加权和。如果属性A上的二进制分割将数据D划分为D1和D2，则D的基尼系数为:</strong></p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a12417a0402913fb77c0bcabf717c2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*gTUwwgJ0RQX2CGrWa0bO9w.png"/></div></figure><p id="d535" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在离散值属性的情况下，给出所选属性的最小基尼指数的子集被选为分裂属性。在连续值属性的情况下，策略是选择每对相邻值作为可能的分割点，并选择基尼系数较小的点作为分割点。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/cf9c046baa20a7a2406000878adf4ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*X_fCNJRz1CUCpkjHNRGndw.png"/></div></figure><p id="2c63" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择具有最小基尼系数<strong class="ka ir">的属性作为分割属性。</strong></p><p id="e8d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们尝试根据属性来计算上述数据的基尼指数。<strong class="ka ir">天气</strong></p><p id="84ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基尼(Sunny)= 1—[(2/3)*(2/3)+(1/3)*(1/3)]= 4/9 = 0.444</p><p id="98de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基尼(雨天)= 1 — [(1/1)*(1/1)] = 0</p><p id="f07b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，基尼(天气)= (3/4) * 0.444 + (1/4) * 0 = 0.333</p><p id="3e37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据其他属性，基尼指数如下:</p><p id="3994" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基尼(交通)=(3/4)* { 1—[(1/3)*(1/3)+(2/3)*(2/3)]}+(1/4)* { 1-[(1/1)*(1/1)]} = 0.333</p><p id="3255" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基尼(作息时间)=(2/4)*[1—(1 * 1)]+(2/4)*[1—(1 * 1)]= 0</p><p id="f0bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基尼系数(可用性)= 0.333</p><p id="4ca4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，具有最小基尼指数的属性，即<strong class="ka ir">工作日程</strong>是这里用于决策的拆分属性。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="1972" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mf">原载于2020年10月18日https://www.numpyninja.com</em><a class="ae nw" href="http://numpyninja.com/post/decision-trees-example-in-machine-learning" rel="noopener ugc nofollow" target="_blank"><em class="mf"/></a><em class="mf">。</em></p></div></div>    
</body>
</html>