# 杰伊的 NoSQL 访谈的故事(设计基础)

> 原文：<https://medium.datadriveninvestor.com/story-of-jays-of-nosql-interview-design-fundamentals-a4f6650bc9ba?source=collection_archive---------7----------------------->

这是一个拥挤的一天，在大厅和杰伊等待电梯到达，他紧张地看了看手表的时间，他不想迟到，他有一个与罗伯特先生的数据库专家面试安排。杰伊努力通过前几轮面试。清除这一个，他将土地的立场，他渴望，但这不会在他说服罗伯特先生他的 NoSQL 技能，他研究了目前的项目是关于 NoSQL。电梯到了，杰伊匆匆进来。

杰伊到达时，罗伯特先生已经在他的船舱里等他了。你好，杰进来说，罗伯特先生指着他面前的椅子坐下。“我知道你在以前的采访中做得很好，在我们继续之前，我想和你谈谈 NoSQL，这对这个项目非常重要，”杰伊点头同意。

[](https://www.datadriveninvestor.com/2020/02/26/surviving-in-a-digital-age-of-instability/) [## 在不稳定的数字时代生存|数据驱动的投资者

### 如果你是一名计算机科学家，你可能已经注意到新的框架不断出现。编程…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2020/02/26/surviving-in-a-digital-age-of-instability/) 

“也许你应该先介绍一下 NoSQL 的概况。”罗伯特先生说,“当然”,然后继续解释并绘制图表,“NoSQL”这个词是一个广义的术语，指的是不以关系结构存储数据的一组数据库技术。随着不同种类的异构数据源的出现，需要以不同于传统的行、列和关系结构的方式存储数据。罗伯特先生看着杰伊说，你谈到了一种不同类型的数据存储，你能概述一些重要的吗？

杰伊说当然，

1.键值数据库

2.列存储

3.图形数据库

4.文档数据库

**键值数据库:**这是一种 NoSQL 数据库，它以键值对的形式存储数据，而键是惟一的，通常是数字、字符串、GUID 或类似的类型。值可以是简单的数据类型，如字符串、数字，也可以是复杂的数据类型，如 JSON 或二进制图像，每个表可以支持不同的数据集结构，例如一行可以有 5 个属性，而另一行可以有 3 个属性，这为存储非结构化和半结构化数据提供了极大的灵活性，可以使用唯一键快速检索这些数据。

![](img/49cdee2fcceb83f86a837ce415a7d551.png)

**列存储数据库:**这种类型的数据库允许将数据存储在一系列列和行中，这在进行聚合时尤其有效，因为列存储在一起，这种数据库的另一个变体也是 BigTable，它们支持嵌套列，提供良好的写入性能和轻松的横向扩展。

![](img/46477839615986e5de0155b5c65448c4.png)

**图形数据库:**这种数据库将数据组织成类似图形的结构，有节点和边(关系)，这种组织方式使得很多不同的图形算法能够提取信息。以这种结构存储数据的一个容易识别的应用是社交媒体，然而，这种数据库还有许多其他应用，如存储和理解半结构化信息，如语言和知识图。

![](img/92e077eb1f49b6da6b8c62db1556cbb1.png)

**文档数据库:**这些数据库像文档一样存储数据，通常是 JSON。这允许存储半结构化和嵌套的数据，并且能够在单个容器中存储不同的数据结构。最近，文档数据库受到了很多关注，因为它们是基于 JSON 的，因此与 rest 服务配合得很好。它易于扩展、查询和分区。

![](img/16830457da23fc1c6e984f6865f69441.png)

杰伊总结道。

罗伯特先生看着图纸说，看起来很准确，杰伊。我们对即将到来的项目的文档数据库非常感兴趣，所以让我给你一个 JSON 文档样本，交给他一张纸，

![](img/0406b6e260a36e4a5e5b42218dfff4bc.png)

罗伯特先生继续说道，我设计了一个这样的产品商店，你认为这是一个好的设计吗，如果你想改变它，你会做什么改变，为什么？

杰伊研究了 JSON 文件，并开始，看起来像一个很好的 NoSQL 设计，但我想做一些修改。第一件事是，我想把销售和评论部分移出产品文档，并像这样创建它们。

**产品**

![](img/9948b9f9b934ffdf8e3f5ac26fbc9190.png)

**销售**

![](img/2fad43fc05d81eff573fbb3ebb21a9d8.png)

**点评**

![](img/4ab001a0baf1949c3b635f424bce768c.png)

Roberts 先生看着松鸦说,"你不认为你正在向通常用于关系数据库的规范化结构发展吗?"

Jay 很快回答道,"乍一看是这样，但是我正在使用指导原则来确保一个可行的 NoSql 设计。"罗伯特先生问。Jay 继续说道，在单个文档中嵌入相关数据时，请考虑以下原则，

1.关系包含在实体之间。

2.一对几关系。

3.经常一起查询的数据。

4.不常改变的数据。

5.数据不会无限制地增长。

摘要、价格、页数的数据经常被收集在一起，所以我们需要将它们收集在一起，书评人与图书只有一对几的关系，也就是说，只有有限数量的书评人，而且一旦图书出版，他们就不会改变，所以这也是嵌入的一个很好的选择。另一方面，如果我们考虑评论，数据是不受限制的，这种数据可以无限制地增长，因此我们需要将它提取出来，并在存储中为每个评论保存一个文档。销售也可以无限制地增长，它也经常变化，每次销售发生时更新一个大文档是没有效率的，所以我们需要取出销售并在存储中有每次销售的文档。

罗伯特先生点头表示部分同意，并说，好吧，我们可以同意你的理性，让我多理解一点参考键，你能给我演示一下 publisher 文档是什么样子吗？

杰伊说，确定绘制出版商 JSON，

![](img/ce53c4c02e47a04a05e8db86312abd1f.png)

Jay 继续说道，管理引用键关系的规则如下，

1.一对多关系。

2.表示多对多关系。

3.数据经常变化。

4.引用的数据可以是无限的。

而图书与出版商是一对多的关系，因此可以被引用。罗伯特先生看着 JSON 说，虽然我总体上同意你所说的，但这种设计会导致多次访问服务器 1 以获取图书列表，然后多次访问其他服务器以获取图书详细信息，我们如何才能改善这种情况？

Jay 说，哦，是的，我们需要改进这一点，经常一起查询的数据可以存储在同一个文档中，即使它们对于更有效的读取来说是冗余的。

![](img/688cd3028b81c290a7959cfb9ce1850c.png)

罗伯特先生微笑着说，我们在这一点上是正确的，我仍然不满意你在产品文档中完全删除销售和评论的做法，本着 NoSql 的精神，我相信你可以找到更好的解决方案。

Jay 想了一会儿，回答说当然可以，Robert 先生，我们可以有一个混合模型，在引用和嵌入之间取得平衡。我们可以保留一个销售和平均评级的摘要，而不是完全移动销售和评论的数据，这使我们能够访问与这些实体相关的足够信息，而不必获取引用的文档。杰伊起草了如下的新产品文档:

![](img/381517f19a0ef360b78364d516581575.png)

罗伯特先生看了看解决方案，似乎很满意，他从座位上站起来说:看来我们已经找到了我们的人杰伊欢迎加入团队。杰伊非常高兴，因为他走出来充满信心。

**进入专家视角—** [**订阅 DDI 英特尔**](https://datadriveninvestor.com/ddi-intel)