<html>
<head>
<title>Transformers In Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的变形金刚</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/transformers-in-machine-learning-1f268fadb4c2?source=collection_archive---------6-----------------------#2020-09-02">https://medium.datadriveninvestor.com/transformers-in-machine-learning-1f268fadb4c2?source=collection_archive---------6-----------------------#2020-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0f7b16d85ff3946b076a467b1a942188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8MKYzLIV79uKH9CC"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@sp_studio_10?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Omar Gattis</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ad30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的车看起来不错吧！这就是变形金刚对我们的原始数据所做的。顾名思义，转换器是用来转换对象的。在机器学习中，转换器用于将数据转换成所需的格式。你是机器学习新手吗，可以看看这篇<a class="ae kc" href="https://medium.com/ai-in-plain-english/introduction-to-machine-learning-7697477a5e40" rel="noopener">文章</a>。转换器是处理和转换数据集的模型。这些转换器非常有用，因为我们的数据很少以直接输入机器学习模型的形式进行训练和预测。例如，当特征具有相似的尺度时，许多机器学习模型工作得最好。所有变压器都有相同的接口:</p><ul class=""><li id="bb9d" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">fit(X):将对象训练/拟合到特征矩阵X。</li><li id="34d0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">transform(X):使用学习到的任何参数对X应用变换</li><li id="a229" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">fit_transform(X):同时应用fit(X)和transform(X)。</li></ul><p id="636a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">转换器可能会也可能不会创建额外的要素，有些转换器甚至可以减少数据中的要素数量。机器学习中的转换器的例子是标准标量或规格化器、矢量器和记号化器、PCA等。标准标量、Mim-Max标量等变换不会改变要素的数量，而多项式要素是创建新要素的变换的一个示例，RFE、选择K最佳等可减少要素的数量。</p><p id="dd73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">目标</strong></p><p id="3273" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文结束时，您将能够:</p><ol class=""><li id="8359" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lp lh li lj bi translated">在sklearn中使用变压器</li><li id="fbdd" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lp lh li lj bi translated">在单个管道中使用多个变压器</li><li id="548e" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lp lh li lj bi translated">建立自己的自定义变形金刚mimmicks sklearn变形金刚。</li></ol><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/ec2a249adcee261b4e98924ff941c4b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/0*G-up0xr6GKO_MvRy.png"/></div></figure><p id="a6df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们继续之前，我想简单解释一下什么是Scikit Learn和。Scikit Learn是一个机器学习库，它由许多用于浅层学习问题的算法组成，如回归、分类、聚类等。Scikit Learn因其易于使用的结构而非常受欢迎。</p><p id="a36e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们开始吧。</p><p id="7852" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">首先</strong>，让我们把原始数据转换成数据帧，为了简单起见，我将使用sklearn中的数据。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/802f611f898b850e708669945426870e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p06vCkwFckAcP0qL.png"/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/d3678fe6679282add8154b56a494bbff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/0*XJ51HwXvBURA2LID.png"/></div></figure><p id="76c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第一幅图中，我首先导入我将用来从sklearn获取数据并将其转换为dataframe的库。然后我把数据转换成数据帧。查看数据，要素处于不同的比例，需要通过将所有要素转换为相同的比例来更改数据。因此，我将使用Scikit Learn的标准标量将数据转换为单位方差和零均值数据。请注意，方差可能不完全是1，平均值也可能不完全是0，但它们将分别接近1和0。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/313f408b6d18023652073118c6893888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rrHQIAKLQaD4NZHF.png"/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/9e98ee035e9d980e71fe06fc864f4527.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/0*U952hRtNNDriaqp1.png"/></div></figure><p id="f0cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就能够扩展我们的数据。</p><div class="ly lz gp gr ma mb"><a href="https://www.datadriveninvestor.com/2020/07/31/using-machine-learning-in-brain-computer-interfaces/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd ir gy z fp mg fr fs mh fu fw ip bi translated">在脑机接口中使用机器学习|数据驱动的投资者</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">神经技术是一个刚刚开始大步前进的前沿领域。有了所有的技术…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp jw mb"/></div></div></a></div><p id="9e47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">使用多个变压器</strong></p><p id="7e0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预处理是机器学习的一个关键特征，因为真实世界的数据不会干净，因此我们需要多个转换器。在这些数据中，我们可能需要执行以下操作:</p><ol class=""><li id="6909" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lp lh li lj bi translated">创建多项式特征，</li><li id="5a53" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lp lh li lj bi translated">缩放数据，</li><li id="c4a0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lp lh li lj bi translated">并使用PCA(主成分分析)降低数据的维度。你可以在这里阅读PCA<a class="ae kc" href="https://www.sciencedirect.com/science/article/pii/009830049390090R" rel="noopener ugc nofollow" target="_blank"/>。为了实现这一目标，我们可能需要:</li></ol><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/6d6d2c360a332ed281809fb1f7e76e14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vbXfwPAcEQbStNS3.png"/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/750ea56a46ff3c268e02ba579346b9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zStQLbwbaYL_tcSG.png"/></div></div></figure><p id="b570" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种技术是不可取的，因为我们需要跟踪以前的变量，而且也容易出错。如果我们要对数据进行多次转换，那么做这样的事情会很麻烦。</p><p id="f0e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">管道救援</strong>。随着我们的分析和工作流程变得越来越复杂，我们需要一个工具来帮助扩大规模。例如，您可能需要在数据准备好用于监督机器学习模型之前对其应用多种变换。您可以显式地应用转换，为转换后的数据创建中间变量。管道是一种方法，有助于避免跟踪中间转换，并有助于扩展我们的代码以进行更复杂的分析。管道由管道类构成。本质上，管道是一个估计器对象，它保存一系列带有或不带有最终估计器的转换器。除了管道之外，Scikit Learn还有列转换器和联合功能，它们完成类似的任务，只是不是按顺序完成的。</p><ul class=""><li id="8100" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">管线之于串联，如同特征联合之于并联。</li></ul><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/4ef4848b39661000c167e8e085c9f239.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/0*224fKavsjItWpwAJ.jpeg"/></div></figure><p id="70ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们用管道实现上面的转换:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/fa814e11fc54e0c072ffac89f8730589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dTNcYoAi7lXa1xvY.png"/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/2283688df503d17ac310df091f15cd5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ghod1QQvtYg44tCo.png"/></div></div></figure><p id="9d9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面的代码中，我们将一个元组列表传递给管道对象。每个元组有两个值一个字符串和一个transformer对象，字符串可以是任何东西，但必须是描述性的。我还使用了pipeline对象的<strong class="kf ir"> <em class="mt"> named_steps </em> </strong>方法来检查多项式特性对象。</p><p id="3eaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">打造定制变形金刚</strong>我们已经在Scikit Learn中看到了如何使用变形金刚。虽然scikit-learn提供了大量的机器学习模型和转换器，但它有时可能不会为我们提供我们的工作流程所需的特定模型或转换器。然而，通过继承的概念，我们可以构建一个与scikit-learn的基础设施兼容的定制估计器。例如，我们希望我们的定制模型具有适应性，并预测或转换方法。如果我们想在Pipeline和GridSearchCV类中使用我们的定制模型，那么遵从scikit-learn是必不可少的。在下面的例子中，我们将创建一个定制的转换器来选择我们想要使用的特性</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/85a8bf518da4b28e9b20c0f63746f771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SCky0Q_aQyAYJXB2.png"/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/d56bafa329371a3750d3007f027ab230.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/0*ZGbfTgtpCxZEstyb.png"/></div></figure><p id="5e21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该类从两个对象<strong class="kf ir"> BaseEstimator和TransformerMixin </strong>继承而来，这就是为什么我们在使用fit_transform方法之前不需要定义它，我们也可以在管道、特征联合等中使用该对象。在上面的例子中，我们在对象中创建了3个函数:</p><ol class=""><li id="5d9c" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lp lh li lj bi translated"><strong class="kf ir"> init </strong>用于初始化对象，因为我们正在使用OOP</li><li id="b17d" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lp lh li lj bi translated"><strong class="kf ir">适合</strong>也就是算法学习的地方，我们总是返回<strong class="kf ir"> self </strong>。请注意，即使我没有在那里添加任何东西(因为没有学习)，我仍然定义了它。</li><li id="34b2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lp lh li lj bi translated"><strong class="kf ir">转换</strong>转换发生的地方。注意:如果我们的任务需要的话，我们可以添加帮助函数，但是它们需要在transform方法中被调用，因为那是转换发生的地方。回到上面的第一个管道，我们将使用<strong class="kf ir"> DataframeSelector </strong>对象来选择一些列，这就是我们要转换的内容。</li></ol><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/d1bd21e9680bb08a3ee0d1a8aa892b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jb0TYy80vVVxeDYB.png"/></div></div></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/92f9d485c49cb5ea69648346e15ebd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4tr46xnFYMzwSHb7.png"/></div></div></figure><p id="ccf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">结论</strong></p><p id="63ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文向您介绍了如何在Scikit Learn中使用转换器，如何在管道中实现转换器，以及如何在Scikit Learn中构建自定义转换器。</p><p id="ea14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">快乐数据科学</strong></p><p id="48d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">访问专家视图— </strong> <a class="ae kc" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>