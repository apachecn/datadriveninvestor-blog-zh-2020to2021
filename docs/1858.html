<html>
<head>
<title>Detecting Heart Disease</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检测心脏病</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/heart-disease-machine-learning-9e2c877ea54a?source=collection_archive---------30-----------------------#2020-04-02">https://medium.datadriveninvestor.com/heart-disease-machine-learning-9e2c877ea54a?source=collection_archive---------30-----------------------#2020-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/88e2071e6c17f984fa0364e30483da7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0j_zfaNzVEbgyoPNKh4Lw.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">image: http://www.freepik.com&gt;Designed by Starline / Freepik</figcaption></figure><div class=""/><p id="fa8e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在所有之前的分析完成后，如果你没有读过它，你可以在这里阅读<a class="ae la" href="https://bit.ly/3bIxLiw" rel="noopener ugc nofollow" target="_blank"/>，我们终于开始了数据科学有趣的部分，至少对我来说，那就是创建算法来检测病人<strong class="ke jg">是否患有</strong>或<strong class="ke jg">没有</strong>心脏病。</p><p id="f211" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当然，我们将使用从<strong class="ke jg"> <em class="lb">克利夫兰诊所基金会</em> </strong>收集的分析中使用的相同数据，以及在<a class="ae la" href="https://archive.ics.uci.edu/ml/datasets/heart+Disease" rel="noopener ugc nofollow" target="_blank">知识库UCI <em class="lb">机器学习</em> </a> <em class="lb">中可用的数据。</em></p><p id="c4c3" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了记住我们的数据是如何组织的，这些是我们数据集中的前三行:</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/4db2e42664668fef949c772524a5e59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*u1082-lx23MAJFSlg6BtFA.png"/></div></figure><p id="504c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">看我们的数据，变量<code class="fe lh li lj lk b">num</code>指的是心脏病的诊断:如果是零表示没有心脏病，如果是一表示有心脏病。这正是我们想要发现的，所以我们的变量<code class="fe lh li lj lk b">num</code>将是我们的目标，其他变量将是我们的输入。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/9cf4e5c74cad501952b6fbb0cb7a701a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*bfd9MyFe1k0JWr_FrJjCrQ.png"/></div></figure><h2 id="06fc" class="lm ln jf bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">数据分割</h2><p id="696d" class="pw-post-body-paragraph kc kd jf ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">为了将我们的数据分为训练和测试，我们将使用scikit-learn工具来完成这项工作，我们还将在此过程中调整我们的数据，以减少方差，并确保我们的模型保持通用，减少过度拟合。该过程描述如下。默认情况下，我们的模型分为75%的培训和25%的测试，但我将改变这一点，并将测试规模设置为20%和80%的培训。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/3c1f949ba92901f6c21e3d48b00b8e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*fWX12kNWW_jQ5Nkp2uslxg.png"/></div></figure><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/32cc81cd7cc4d45d3a03b2420ca0af7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*7TB7TiJdbR1W3Vry5wGilA.png"/></div></figure><h1 id="16e6" class="mm ln jf bd lo mn mo mp lr mq mr ms lu mt mu mv lx mw mx my ma mz na nb md nc bi translated">逻辑回归</h1><p id="4da1" class="pw-post-body-paragraph kc kd jf ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">我们将在这个机器学习中使用的统计技术是逻辑回归。这种技术用于通过分类变量来预测一些事情(在我们的例子中是我们的二元变量<code class="fe lh li lj lk b">num</code>)。</p><p id="8a7e" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">同样，我们将导入scikit-learn工具来为我们处理这项工作。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/553537c6ae43a8983c030de237b8690a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*YMJPYfDGKtGvn5tPLl0Okw.png"/></div></figure><h2 id="fd87" class="lm ln jf bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">训练模型</h2><p id="a99a" class="pw-post-body-paragraph kc kd jf ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">通过使用fit()方法的一行代码，我们可以训练我们的机器学习模型，然后检查它的准确性。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/59fec11b60cbf2937e6df925c3787486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*rPhDE7vm6MI3nTV6CH04bA.png"/></div></figure><p id="326c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">哇，我们的模型有大约85%的准确率，太棒了！让我们通过计算来复查一下这个准确性…</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3e67e90d24f2fb9f168fcce2dd859969.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*IesRncRhzAA_7x_oXpjGQg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">accuracy double-checked</figcaption></figure><h1 id="93ea" class="mm ln jf bd lo mn mo mp lr mq mr ms lu mt mu mv lx mw mx my ma mz na nb md nc bi translated">测试模型</h1><p id="ae0e" class="pw-post-body-paragraph kc kd jf ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">我们的模型现在已经训练好了，所以我们要测试上面的模型。为了做到这一点，因为我们希望预测患者是否患有心脏病，我们评估了模型的测试准确性。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c8230e2b7fa2ca290ddca0f5eb694b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*sz0rU8uGsD3IokYOMPmNyg.png"/></div></figure><p id="5a79" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在测试准确性时，我们的模型得分几乎达到87%</p><p id="668c" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如你在上面看到的，我们还提取了每个类别的概率。顾名思义，变量y_pred是我们的算法所预测的，而y_prob是我们的模型预测0(左数)和1(右数)的概率</p><h2 id="156d" class="lm ln jf bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">混淆矩阵</h2><p id="dcd3" class="pw-post-body-paragraph kc kd jf ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">验证我们算法准确性的一个很好的方法是使用混淆矩阵。对于每一类，它告知实际值和来自我们模型的预测值。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/3ea038f7d97a13ad3548aa9b5ecdaddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qDqs7tJ9ngkttf5L.png"/></div></div></figure><p id="06d1" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这种方式可以快速识别:</p><ul class=""><li id="b180" class="ni nj jf ke b kf kg kj kk kn nk kr nl kv nm kz nn no np nq bi translated"><strong class="ke jg">真阳性— TP: </strong>比如当一个病人有心脏病，而我们的模型将其归类为有血管疾病。</li><li id="eba7" class="ni nj jf ke b kf nr kj ns kn nt kr nu kv nv kz nn no np nq bi translated"><strong class="ke jg">假阳性— FP: </strong>例如，当患者患有心脏病，而我们的模型分类为没有血管疾病时。</li><li id="2ef2" class="ni nj jf ke b kf nr kj ns kn nt kr nu kv nv kz nn no np nq bi translated"><strong class="ke jg">真阴性— TN: </strong>例如，当患者没有心脏病，而我们的模型将其归类为没有血管疾病时。</li><li id="35df" class="ni nj jf ke b kf nr kj ns kn nt kr nu kv nv kz nn no np nq bi translated"><strong class="ke jg">假阴性— FN: </strong>例如，当患者没有心血管疾病，而模型将其归类为有血管疾病时。</li></ul><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/093f20a41eee6596ab9cdf113639f36e.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*M_CwNnZ9mVSZ8Lwd9c77Bg.png"/></div></figure><p id="b459" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们还可以打印一份分类报告，如下图所示。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/12227f5ab887a087587afa101832c039.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*tGK0edCM0pA8-6TQJAJfeg.png"/></div></figure><ul class=""><li id="06bb" class="ni nj jf ke b kf kg kj kk kn nk kr nl kv nm kz nn no np nq bi translated"><strong class="ke jg">精度:</strong>正面预测的精度。</li><li id="e50b" class="ni nj jf ke b kf nr kj ns kn nt kr nu kv nv kz nn no np nq bi translated"><strong class="ke jg">回忆:</strong>被正确识别的阳性分数。</li><li id="8cb6" class="ni nj jf ke b kf nr kj ns kn nt kr nu kv nv kz nn no np nq bi translated"><strong class="ke jg"> F1-得分:</strong>是精确度和召回率的加权调和平均值，最好的得分是1.0，最差的是0.0</li></ul><h1 id="0a53" class="mm ln jf bd lo mn mo mp lr mq mr ms lu mt mu mv lx mw mx my ma mz na nb md nc bi translated">结论</h1><p id="e78e" class="pw-post-body-paragraph kc kd jf ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">这是进行<em class="lb">机器学习</em>模型<em class="lb">，</em>的一种方式，我们可以通过多种方式提高我们模型的准确性，例如获取更多数据、特征选择、评估指标等等。</p><div class="ip iq gp gr ir ny"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd jg gy z fp od fr fs oe fu fw je bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ix ny"/></div></div></a></div><p id="30d4" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你喜欢它！</p><p id="7719" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">查看<a class="ae la" href="https://bit.ly/39hVEMp" rel="noopener ugc nofollow" target="_blank">我的GitHub中的完整代码。</a></p><figure class="ld le lf lg gt is"><div class="bz fp l di"><div class="on oo l"/></div></figure></div></div>    
</body>
</html>