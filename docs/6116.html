<html>
<head>
<title>Building a Game With TypeScript. Team and Fleet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用TypeScript构建游戏。团队和车队</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/building-a-game-with-typescript-team-and-fleet-f223d39e9248?source=collection_archive---------1-----------------------#2020-10-13">https://medium.datadriveninvestor.com/building-a-game-with-typescript-team-and-fleet-f223d39e9248?source=collection_archive---------1-----------------------#2020-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6b7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">教程<a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-in-action-with-typescript-d29b913858e" rel="noopener">系列</a>中的第四章讲述了如何用TypeScript和本地浏览器API从头开始构建游戏</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/391e8bd52bfbe468c737489eb7e2e47a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iatP5H8XU9y9S6ofCPEInQ.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk"><a class="ae kl" href="https://www.freepik.com/free-photos-vectors/background" rel="noopener ugc nofollow" target="_blank">Background vector created by freepik</a></figcaption></figure><p id="7bf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好。欢迎回到如何用<strong class="jp ir"> TypeScript </strong>从头开始构建一个简单的回合制游戏的系列教程！在本教程中，我们仅使用<strong class="jp ir">原生浏览器API </strong>和<strong class="jp ir">增量</strong>添加新功能，这要归功于<strong class="jp ir">坚实的</strong> <strong class="jp ir">原则</strong>和常见的<strong class="jp ir">模式</strong>。</p><p id="a28b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-colors-and-layers-337b0e4d71f" rel="noopener">的前一篇文章</a>中，我们为<code class="fe lc ld le lf b">Ships</code>准备了一个舞台:创建了<code class="fe lc ld le lf b">Color</code>工具并设置了<code class="fe lc ld le lf b">foreground</code>画布层。今天我们要谈论<em class="lg">友情</em>和<em class="lg">对立</em>并介绍我们幸福家庭的三位新成员:<code class="fe lc ld le lf b">Team</code>、<code class="fe lc ld le lf b">Fleet</code>，当然还有<code class="fe lc ld le lf b">Ship</code>。</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="667a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第四章“船”中，我们正在实现回合制游戏中最重要的令牌:我们正在抽取<code class="fe lc ld le lf b">Ships</code>。玩家会用它们来攻击其他玩家。失去所有船只意味着输掉游戏。你可以在这里找到这个系列的其他章节<em class="lg"> : </em></p><ul class=""><li id="5ea6" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk lt lu lv lw bi translated"><a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-in-action-with-typescript-d29b913858e" rel="noopener">简介</a></li><li id="6255" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated"><a class="ae kl" href="https://medium.com/@gregsolo/entity-component-system-in-action-with-typescript-f498ca82a08e" rel="noopener">第一章实体组件系统</a></li><li id="76b1" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第二章。游戏循环(<a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-with-typescript-game-loop-part-1-2-699919bb9b71" rel="noopener">第一部分</a>，<a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-in-action-with-typescript-game-loop-2-2-c0d57a8e5ec2" rel="noopener">第二部分</a>)</li><li id="fbdd" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第三章。绘制网格(<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-grid-1-5-aaf68797a0bb" rel="noopener">第一部分</a>、<a class="ae kl" href="https://medium.com/javascript-in-plain-english/building-a-game-with-typescript-drawing-grid-2-5-206555719490" rel="noopener">第二部分</a>、<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-grid-3-5-1fb94211c4aa" rel="noopener">第三部分</a>、<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-iii-drawing-grid-4-5-398af1dd638d" rel="noopener">第四部分</a>、<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-grid-5-5-49454917b3af" rel="noopener">第五部分</a>)</li><li id="d0ae" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第四章。船舶(<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-colors-and-layers-337b0e4d71f" rel="noopener">第1部分</a>，第2部分<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-ship-14e6c19caa38" rel="noopener">，第3部分</a>，<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-ship-and-locomotion-4f5969675993" rel="noopener">第4部分</a>)</li><li id="da78" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第五章输入系统(<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-input-system-1-3-46d0b3dd7662" rel="noopener">第一部分</a>、<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-input-system-2-3-cd419e36027c" rel="noopener">第二部分</a>、<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-input-system-3-3-8492552579f1" rel="noopener">第三部分</a></li><li id="39cc" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第六章。寻路与移动(<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-17-introduction" rel="noopener ugc nofollow" target="_blank">第一部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-27-highlighting-locomotion-range" rel="noopener ugc nofollow" target="_blank">第二部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-37-graph-and-priority-queue" rel="noopener ugc nofollow" target="_blank">第三部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-47-pathfinder" rel="noopener ugc nofollow" target="_blank">第四部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-57-finding-the-path" rel="noopener ugc nofollow" target="_blank">第五部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-6-instant-locomotion" rel="noopener ugc nofollow" target="_blank">第六部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/pathfinding-and-movement-7-animated-locomotion" rel="noopener ugc nofollow" target="_blank">第七部分</a>)</li><li id="dd68" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第七章。玛奇纳州</li><li id="0682" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第八章。攻击系统:生命和伤害</li><li id="6aa5" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第九章。比赛的输赢</li><li id="917e" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第十章敌人AI</li></ul><blockquote class="mc md me"><p id="662b" class="jn jo lg jp b jq jr js jt ju jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj kk ij bi translated">随意切换到<a class="ae kl" href="https://github.com/soloschenko-grigoriy/gamedev-patterns-ts" rel="noopener ugc nofollow" target="_blank">库</a>的<code class="fe lc ld le lf b">ships-1</code>分支。它包含了前几篇文章的工作成果，是这篇文章的一个很好的起点。</p></blockquote></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="d92b" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">目录</h1><ol class=""><li id="7757" class="lo lp iq jp b jq ng ju nh jy ni kc nj kg nk kk nl lu lv lw bi translated">介绍</li><li id="3958" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk nl lu lv lw bi translated">团队</li><li id="51da" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk nl lu lv lw bi translated">你的舰队，舰长！</li><li id="e3b7" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk nl lu lv lw bi translated">测试车队</li><li id="297e" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk nl lu lv lw bi translated">第一艘船</li><li id="5787" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk nl lu lv lw bi translated">结论</li></ol></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="6569" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">团队</h1><p id="5bde" class="pw-post-body-paragraph jn jo iq jp b jq ng js jt ju nh jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">许多游戏都以这样或那样的方式围绕着冲突展开。玩家努力克服障碍和挑战。玩家对抗环境障碍，与AI和其他玩家战斗，解决谜题和谜语。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi np"><img src="../Images/132e1783391fe1c9c51d2f65817356ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7dwljK9MZ41NLpUBH-2Ug.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk"><a class="ae kl" href="https://www.freepik.com/vectors/background" rel="noopener ugc nofollow" target="_blank">Background vector created by freepik — www.freepik.com</a></figcaption></figure><p id="4213" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们想到团队时，我们的第一个联想可能是“协作”，“一起工作”。但是“团队”概念还有另一面。是<strong class="jp ir">反对派</strong>。为什么这样不是反义词吗？嗯，是也不是。人们组织成一个团队去做一些事情。合作，一起工作。更快/更有效/更容易达到目的。当我们谈论游戏时，团队合作克服<strong class="jp ir">冲突</strong>。他们一起打<em class="lg">对抗</em>什么的，甚至可能是另一支球队。</p><p id="9bd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这个角度来看，我们可以把一个“团队”看成一个“方”:“我的一方”vs“他们的一方”。团队中实际有多少人是次要的。重要的是对抗:一个队和另一个队比赛。</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nq"><img src="../Images/381a40e821f1a16be315fd6fc47c1473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H6p-X7vkxUZL5XGVKybhJw.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk"><a class="ae kl" href="https://www.freepik.com/vectors/frame" rel="noopener ugc nofollow" target="_blank">Frame vector created by dgim-studio — www.freepik.com</a></figcaption></figure><p id="04c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们这个简单的游戏中，我们有两个团队，每个团队只有一个玩家。我们可以使用“玩家”这个概念，根本不用担心“团队”。但是谁知道呢，也许将来我们会扩展并允许玩家在团队的保护伞下加入他们的势力呢？让我们<em class="lg">保留我们的选择</em>，这通常是一个好策略。</p><p id="97fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们该如何称呼我们的团队？“蓝”队和“红”队呢？但是如果我们想要不同的颜色呢？有了这样一个名字，我们无意中将<em class="lg">逻辑</em>与<em class="lg">表示</em>联系起来。这几乎总是一个坏主意。</p><p id="f75f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或许“我的”对“敌人”？其中一个玩家显然是“我的”团队中的<em class="lg"/>，对吗？嗯，这里有一个问题。如果我们在未来的迭代中引入多人游戏，并且所有的团队都属于真正的玩家，那会怎么样？他们中的哪一个应该算是“我的”？</p><p id="695f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我建议我们使用非常通用的命名:A队对B队。这样，我们就不会将团队的命名与任何功能捆绑在一起。团队只代表一件事:反对派。</p><div class="nr ns gp gr nt nu"><a href="https://www.datadriveninvestor.com/2019/09/17/work-begins-on-java-14-as-java-13-set-to-launch/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">Java 14工作开始，Java 13即将发布|数据驱动投资者</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">随着Java 13准备于2019年9月17日上线，科技公司更令人兴奋的发展已经开始了…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kw nu"/></div></div></a></div><p id="6c7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个实现可能有多种形式，我将使用一个简单的枚举:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="5c21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和桶文件:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="676a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">游戏的最终目标是击沉所有对手的船只。<code class="fe lc ld le lf b">Team A</code>会尝试击沉属于<code class="fe lc ld le lf b">Team B</code>的船只。因为我们有不止一艘船，所以建立某种集合结构来处理对它们的批量操作是有意义的。姑且称之为<code class="fe lc ld le lf b">Fleet</code>。</p><h1 id="bc4e" class="mi mj iq bd mk ml ol mn mo mp om mr ms mt on mv mw mx oo mz na nb op nd ne nf bi translated">你的舰队，舰长！</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oq"><img src="../Images/e41ae7dd62410d6b086f487a3412d930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ns2_UNtgUKoeqPWHwhgBGg.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Business vector created by dooder — <a class="ae kl" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">www.freepik.com</a></figcaption></figure><p id="4383" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这支舰队是又一只<code class="fe lc ld le lf b">Entity</code>:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="0d86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">传统上，我们不要忘记桶文件:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="50c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个队都有自己的舰队。车队一经创建就被分配给团队，并且永远不会改变:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h2 id="ecf7" class="or mj iq bd mk os ot dn mo ou ov dp ms jy ow ox mw kc oy oz na kg pa pb ne pc bi translated">边注</h2><p id="c596" class="pw-post-body-paragraph jn jo iq jp b jq ng js jt ju nh jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated"><em class="lg">如果eslint/IDE抱怨没有使用</em> <code class="fe lc ld le lf b"><em class="lg">Team</em></code> <em class="lg">变量，你就成了已知eslint插件bug的受害者。要“修复”它，您可以关闭对该行的检查:</em></p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="ffce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lg">或者您可以使用别名:</em></p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="e954" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将采用第一种方法，因为当一个合适的错误修正到来时，删除这一行会更容易。</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="3441" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像任何其他实体一样，<code class="fe lc ld le lf b">Fleet</code>必须在层级中找到自己的位置。让它直接成为游戏的孩子:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="c9b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们实例化了两个车队，每个车队一个。然后我们将它们添加到游戏实体的数组中。</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="2bfa" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">测试车队</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pd"><img src="../Images/3a142930b16ab4bd22eccad0e590617f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*drfBGhugLv-ZMzTgSLhCrw.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk"><a class="ae kl" href="https://www.freepik.com/vectors/infographic" rel="noopener ugc nofollow" target="_blank">Infographic vector created by katemangostar — www.freepik.com</a></figcaption></figure><p id="e442" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们应该更新我们的测试来反映这些变化:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="9d62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些应该看起来很熟悉:我们只是简单地窥探了一下<code class="fe lc ld le lf b">Fleet</code>的原型，因为我们没有直接访问实例的权限。然后我们验证<code class="fe lc ld le lf b">Awake</code>和<code class="fe lc ld le lf b">Update</code>只有在调用了<code class="fe lc ld le lf b">Game</code>各自的方法后才被调用。</p><p id="0952" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">厉害！就像其他的<code class="fe lc ld le lf b">Entity</code>一样，我们要测试<code class="fe lc ld le lf b">Fleet</code>。现在它几乎是空的，所以让我们验证至少我们没有破坏任何父组件的功能:我们仍然正确地使用了<code class="fe lc ld le lf b">Awake</code>和<code class="fe lc ld le lf b">Update</code>组件:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="33a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">方法与所有其他实体相同:我们创建假组件，将它们附加到<code class="fe lc ld le lf b">Fleet</code>，执行<code class="fe lc ld le lf b">Awake</code>和<code class="fe lc ld le lf b">Update</code>来查看组件是否确实被唤醒和更新:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="80dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不错！将来，我们可能会改变<code class="fe lc ld le lf b">Fleet</code>的签名，换句话说，改变它的构造函数。为了让生活简单一点，让我们为<code class="fe lc ld le lf b">Fleet</code>定义一个专用的<code class="fe lc ld le lf b">mock</code>:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="32e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并更新桶以反映该变化:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="d11c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以在任何需要引用<code class="fe lc ld le lf b">Fleet</code>的地方使用模拟:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><blockquote class="mc md me"><p id="1814" class="jn jo lg jp b jq jr js jt ju jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj kk ij bi translated">这种方法的好处是我们现在有了一个针对所有测试的中央模拟。如果签名改变了，我们只需在一个地方改变模拟，不管有多少测试使用它。</p></blockquote><p id="be5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，我们的代码应该通过<code class="fe lc ld le lf b">npm start</code>成功编译，并且所有测试应该通过<code class="fe lc ld le lf b">npm t</code>:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pe"><img src="../Images/a46db3eb39ea59cf6ba63ebfd7ef8523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pi_qPi-nldA6cEynU1ioDA.png"/></div></div></figure></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="f6ef" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">第一艘船</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pf"><img src="../Images/9d5ccffa448a1ce8ea99c666c60fa333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tVQMFnI4islVUwP-vv00Fg.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk"><a class="ae kl" href="https://www.freepik.com/vectors/background" rel="noopener ugc nofollow" target="_blank">Background vector created by freepik — www.freepik.com</a></figcaption></figure><p id="a607" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了！但是<code class="fe lc ld le lf b">Fleet</code>没有船就没有任何意义！是时候创造一些了！</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="f2b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个<code class="fe lc ld le lf b">Ship</code>都应该属于某个<code class="fe lc ld le lf b">Fleet</code>:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="3e5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太棒了。现在<code class="fe lc ld le lf b">Fleet</code>可以初始化<code class="fe lc ld le lf b">Ships</code>并管理它们。怎么会？和其他<code class="fe lc ld le lf b">Entity</code>一样！在孩子们的帮助下:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="8689" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就像<code class="fe lc ld le lf b">Game</code>处理<code class="fe lc ld le lf b">Fleet</code>和<code class="fe lc ld le lf b">Grid</code>一样，<code class="fe lc ld le lf b">Fleet</code>处理<code class="fe lc ld le lf b">Ships</code>。首先，我定义了一个私有数组来跟踪所有船只。然后我构造并唤醒三个<code class="fe lc ld le lf b">Ships</code>。最后，我确保每个<code class="fe lc ld le lf b">Ship</code>都在<code class="fe lc ld le lf b">Fleet</code>更新时得到更新。</p><p id="77a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是为什么我们要制造三艘飞船呢？这是一个合理的问题，可能我们无法回答。应该是一个<strong class="jp ir">可配置的设置</strong>，游戏设计师可以微调。让我们把它移到一个合适的地方:<code class="fe lc ld le lf b">Settings</code>！</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="2020" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不错！车队规模现在是全球配置的一部分！我在<code class="fe lc ld le lf b">Settings</code>内准备了一个专门的区域<code class="fe lc ld le lf b">ships</code>，我们以后肯定会需要大量的船只配置！</p><p id="57e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在代码中使用这个新的车队规模设置:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="ce1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，我们应该给<code class="fe lc ld le lf b">fleet.spec.ts</code>增加一些测试来反映最近的变化:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="6e73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们验证所有船只都已被唤醒并正确更新。此时，我们的代码应该可以用<code class="fe lc ld le lf b">npm start</code>成功编译，并且所有的测试都应该通过<code class="fe lc ld le lf b">npm t</code>:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pg"><img src="../Images/42ee25e8f41955f8123984ae0d8ad4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEJfIkbmhdOiwIkYsoyhjQ.png"/></div></div></figure><blockquote class="mc md me"><p id="0165" class="jn jo lg jp b jq jr js jt ju jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj kk ij bi translated">你可以在<a class="ae kl" href="https://github.com/soloschenko-grigoriy/gamedev-patterns-ts" rel="noopener ugc nofollow" target="_blank">库</a>的<code class="fe lc ld le lf b">ships-2</code>分支中找到这篇文章的完整源代码。</p></blockquote></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="4969" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">结论</h1><p id="8791" class="pw-post-body-paragraph jn jo iq jp b jq ng js jt ju nh jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">做得好！在本教程中，我们讨论了<code class="fe lc ld le lf b">Team</code>的概念，甚至在游戏中建立了两个团队。我们还创建了我们自己的<code class="fe lc ld le lf b">Fleet,</code>即<code class="fe lc ld le lf b">Ships</code>集合。我们终于完成了准备工作！本章的下一部分将致力于在屏幕上绘制<code class="fe lc ld le lf b">Ship</code>。</p><p id="c07a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我真的很想听听你的想法！如果你有任何<strong class="jp ir">的评论</strong>、<strong class="jp ir">的建议</strong>、<strong class="jp ir">的问题</strong>，或者任何其他<strong class="jp ir">的反馈</strong>，不要犹豫给我发私信或者在下面留下评论！如果你喜欢这篇文章，请与他人分享。感谢您的阅读，我们下次再见！</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="786f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lg">这是系列教程</em> <strong class="jp ir"> <em class="lg">用TypeScript </em> </strong> <em class="lg">构建游戏的第四章。其他章节可点击此处:</em></p><ul class=""><li id="842e" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk lt lu lv lw bi translated"><a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-in-action-with-typescript-d29b913858e" rel="noopener">简介</a></li><li id="6480" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated"><a class="ae kl" href="https://medium.com/@gregsolo/entity-component-system-in-action-with-typescript-f498ca82a08e" rel="noopener">第一章实体组件系统</a></li><li id="d12e" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第二章。游戏循环(<a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-with-typescript-game-loop-part-1-2-699919bb9b71" rel="noopener">第一部分</a>，<a class="ae kl" href="https://medium.com/@gregsolo/gamedev-patterns-and-algorithms-in-action-with-typescript-game-loop-2-2-c0d57a8e5ec2" rel="noopener">第二部分</a>)</li><li id="6193" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第三章。绘制网格(<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-grid-1-5-aaf68797a0bb" rel="noopener">第一部分</a>、<a class="ae kl" href="https://medium.com/javascript-in-plain-english/building-a-game-with-typescript-drawing-grid-2-5-206555719490" rel="noopener">第二部分</a>、<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-grid-3-5-1fb94211c4aa" rel="noopener">第三部分</a>、<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-iii-drawing-grid-4-5-398af1dd638d" rel="noopener">第四部分</a>、<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-grid-5-5-49454917b3af" rel="noopener">第五部分</a>)</li><li id="e4b3" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第四章。船舶(<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-colors-and-layers-337b0e4d71f" rel="noopener">第1部分</a>，第2部分<a class="ae kl" href="https://medium.com/@gregsolo/building-a-game-with-typescript-drawing-ship-14e6c19caa38" rel="noopener">，第3部分</a>，<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-ship-and-locomotion-4f5969675993" rel="noopener">第4部分</a>)</li><li id="e271" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第五章输入系统(<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-input-system-1-3-46d0b3dd7662" rel="noopener">第一部分</a>、<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-input-system-2-3-cd419e36027c" rel="noopener">第二部分</a>、<a class="ae kl" href="https://gregsolo.medium.com/building-a-game-with-typescript-input-system-3-3-8492552579f1" rel="noopener">第三部分</a>)</li><li id="320c" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第六章。寻路与移动(<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-17-introduction" rel="noopener ugc nofollow" target="_blank">第一部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-27-highlighting-locomotion-range" rel="noopener ugc nofollow" target="_blank">第二部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-37-graph-and-priority-queue" rel="noopener ugc nofollow" target="_blank">第三部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-47-pathfinder" rel="noopener ugc nofollow" target="_blank">第四部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-57-finding-the-path" rel="noopener ugc nofollow" target="_blank">第五部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/building-a-game-with-typescript-pathfinding-and-movement-6-instant-locomotion" rel="noopener ugc nofollow" target="_blank">第六部分</a>、<a class="ae kl" href="https://blog.gregsolo.me/articles/pathfinding-and-movement-7-animated-locomotion" rel="noopener ugc nofollow" target="_blank">第七部分</a>)</li><li id="ef8a" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第七章。玛奇纳州</li><li id="6ca3" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第八章。攻击系统:生命和伤害</li><li id="5222" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第九章。比赛的输赢</li><li id="30af" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">第十章敌人AI</li></ul><h2 id="6481" class="or mj iq bd mk os ot dn mo ou ov dp ms jy ow ox mw kc oy oz na kg pa pb ne pc bi translated">访问专家视图— <a class="ae kl" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank">订阅DDI英特尔</a></h2></div></div>    
</body>
</html>