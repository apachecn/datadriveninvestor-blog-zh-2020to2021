<html>
<head>
<title>Facial Expression Recognition: Are the World Leaders telling us the truth about the Coronavirus?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面部表情识别:世界领导人在告诉我们冠状病毒的真相吗？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/facial-expression-recognition-are-the-world-leaders-telling-us-the-truth-about-the-coronavirus-b975ad810da8?source=collection_archive---------1-----------------------#2020-03-19">https://medium.datadriveninvestor.com/facial-expression-recognition-are-the-world-leaders-telling-us-the-truth-about-the-coronavirus-b975ad810da8?source=collection_archive---------1-----------------------#2020-03-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/7c9600828a89fdbbfe2950773b2c6c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o7mr6f82UZL6Ufss-Gp4Bw.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">(rights: own image)</figcaption></figure><div class=""/><blockquote class="kf kg kh"><p id="f1ee" class="ki kj kk kl b km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg im bi translated">让我们来分析一下世界领导人在公开声明中的表情。</p></blockquote><p id="d71c" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">最近，多位世界领导人对冠状病毒的威胁采取了立场。虽然大多数人认为冠状病毒是一种实际的危险，但其他一些人确实怀疑它的可信度，并想知道高层是否对我们隐瞒了真相。</p><p id="c427" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">在这篇文章中，我们将使用在Kaggle数据集上训练的自定义CNN来分析他们的面部表情(架构如下所示)，希望我们能够从中了解更多情况。</p><h2 id="4a62" class="lk ll ji bd lm ln lo dn lp lq lr dp ls lh lt lu lv li lw lx ly lj lz ma mb mc bi translated">第1部分:人脸检测</h2><p id="8a82" class="pw-post-body-paragraph ki kj ji kl b km md ko kp kq me ks kt lh mf kw kx li mg la lb lj mh le lf lg im bi translated">我们应用于人脸检测的方法是haarCascade，这是一种使用弱分类器和我们称之为Haar模式的增强技术。</p><p id="5567" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">下面是源代码和示例图片(图1)(你可以在<a class="ae mi" href="https://github.com/miki998/FacialExpressionRecognition" rel="noopener ugc nofollow" target="_blank"> github repo </a>中找到)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="aae5" class="lk ll ji mo b gy ms mt l mu mv">face_clf = cv2.CascadeClassifier('haarcascade_frontalface_default.xml')<br/>font = cv2.FONT_HERSHEY_SIMPLEX</span><span id="0971" class="lk ll ji mo b gy mw mt l mu mv">def process_image(path2file):<br/>  img = cv2.imread(path2file)<br/>  gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)<br/>  faces = face_clf.detectMultiScale(gray, 1.3, 5)</span><span id="1530" class="lk ll ji mo b gy mw mt l mu mv">for (x, y, w, h) in faces:<br/>  fc = gray[y:y+h, x:x+w]<br/>  cv2.rectangle(img,(x,y),(x+w,y+h),(255,0,0),2)</span><span id="2d06" class="lk ll ji mo b gy mw mt l mu mv">cv2.imwrite(path2file[:-4]+'out.jpg',img) #This is somehow hardcoded</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/74ec627fc97140686a8e7a58062dbecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VqPL9LIbvG73-3l5xHmaPQ.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">fig.1 (rights: <a class="ae mi" href="https://edition.cnn.com/2020/03/12/politics/donald-trump-coronavirus-europe-travel/index.html" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><h2 id="a1a4" class="lk ll ji bd lm ln lo dn lp lq lr dp ls lh lt lu lv li lw lx ly lj lz ma mb mc bi translated">第二部分:面部表情推断</h2><p id="caad" class="pw-post-body-paragraph ki kj ji kl b km md ko kp kq me ks kt lh mf kw kx li mg la lb lj mh le lf lg im bi translated">首先，让我们介绍一下我们正在使用的FER(面部表情识别)模型。神经网络的目标是将一张脸分为7类，代表不同的情绪(0 =愤怒，1 =厌恶，2 =恐惧，3 =快乐，4 =悲伤，5 =惊讶，6 =中性)。这是它粗略的架构。</p><ul class=""><li id="ca23" class="my mz ji kl b km kn kq kr lh na li nb lj nc lg nd ne nf ng bi translated">尺寸为(48x48x1)的输入图层:灰度</li><li id="789e" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">4个过滤器卷积(3×3)或(5×5 ),每个卷积后都有一个最大池(2×2)</li><li id="4ce4" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">2个尺寸为256和512的完全连接层(按此顺序)</li><li id="cb54" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">大小为(7x1)的输出层，用于情感的7个标签</li></ul><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/fc8ef120c0ef03d3288cd076af09013c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFHePr9fj-5UyHQ9Gd-RCg.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">fig.1 (rights: own image)</figcaption></figure><p id="1ace" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">激活函数也是ReLu，除了输出激活函数是Softmax(很适合分类，给出1个概率的总和)。</p><p id="4269" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">备注:</p><ul class=""><li id="ace3" class="my mz ji kl b km kn kq kr lh na li nb lj nc lg nd ne nf ng bi translated">CNN的计算量不是很大，因为增加了漏失层，加上输入大小不是很大。</li><li id="8954" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">由于比较浅，培训时间也不会很长。</li><li id="6e8b" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">过滤器不大，一直只用(3x3)和(5x5)，没有(7x7)也没有(9x9)这对推理和训练时间有帮助。</li></ul><p id="f069" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">下面是CNN的实现代码(图2)。</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="nn no l"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">fig.2 (rights: own image)</figcaption></figure><h2 id="204b" class="lk ll ji bd lm ln lo dn lp lq lr dp ls lh lt lu lv li lw lx ly lj lz ma mb mc bi translated">第3部分:表达式编码</h2><p id="694e" class="pw-post-body-paragraph ki kj ji kl b km md ko kp kq me ks kt lh mf kw kx li mg la lb lj mh le lf lg im bi translated">现在，从这些基本的情绪中，我们可以找到数据集来训练我们的网络，我们将结合这些简单的情绪来创建任意更复杂的情绪，以便将它们应用到我们现有的图片上。我们想出的复杂情绪有‘自信’、‘紧张’、‘好玩’、‘中性’。我们用两种最可能的基本情绪来定义它们。</p><p id="7ab5" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">以下是我们用来将一幅图像与一种复杂的情绪联系起来的规则:</p><ul class=""><li id="296d" class="my mz ji kl b km kn kq kr lh na li nb lj nc lg nd ne nf ng bi translated">自信:[开心，中立]</li><li id="a7f7" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">紧张:[恐惧，任何]</li><li id="d4b8" class="my mz ji kl b km nh kq ni lh nj li nk lj nl lg nd ne nf ng bi translated">中立:[中立，任何]</li></ul><p id="76b8" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">请记住，这些类别是任意定义的，由于主观性和数据的缺乏，这些复杂的情绪很难用受过训练的CNN来确定。</p><p id="f0cb" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">这是一个映射到复杂情绪的基本表达的例子(图3)。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/49e605f97082e0a7476a2933c0cb537b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*NOSWj-NT_YdMUiBQkv-HCA.jpeg"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">fig.3 (rights: <a class="ae mi" href="https://nypost.com/2018/09/17/senators-delay-kavanaugh-vote-set-public-hearing-with-accuser/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><h2 id="0f37" class="lk ll ji bd lm ln lo dn lp lq lr dp ls lh lt lu lv li lw lx ly lj lz ma mb mc bi translated">第4部分:结果和分析</h2><p id="4d28" class="pw-post-body-paragraph ki kj ji kl b km md ko kp kq me ks kt lh mf kw kx li mg la lb lj mh le lf lg im bi translated">埃马纽埃尔·马克龙总统先生的例子(视频1)</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/31c73db7be08d0203de3beab6abef9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Buv6sCpo5xxVsTzWs-R_NQ.gif"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">vid.1 (rights: own gif)</figcaption></figure><p id="bde1" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">爱德华·菲利普总理先生的例子(视频2)</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/5bd88da9f2f8e7db8477f6b4e834a64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*_Vp0pDuOsaRqo57dpGCZ_Q.gif"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">vid.2 (rights: own gif)</figcaption></figure><p id="3c2e" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">vid.1和vid.2的这两个演讲都是我们谈论对抗冠状病毒的措施的演讲。</p><p id="ce12" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">如你所知，我们看到大多数时候法国的两位领导人在他们的演讲中都带着明显的“悲伤”和“紧张”。这两个人都是百分百认真的，显然都认为冠状病毒是一种威胁。从这个简单的分析中，我们确实看到，至少在这个特定的案例中，共谋的想法似乎是无效的。</p><p id="39b4" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">可以进一步进行更深入的分析，以查明与给定说明相匹配的特定时刻。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="b9b2" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">你可以联系我以获得我所使用的准确的源代码。非常感谢您的阅读！如果你喜欢，请看看我的其他文章，因为你可能会发现有趣的话题！</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="3dc4" class="pw-post-body-paragraph ki kj ji kl b km kn ko kp kq kr ks kt lh kv kw kx li kz la lb lj ld le lf lg im bi translated">你可以在这里找到我的博客，那里有其他的文章和产品。</p></div></div>    
</body>
</html>