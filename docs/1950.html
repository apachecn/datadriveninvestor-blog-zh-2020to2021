<html>
<head>
<title>The Best Portfolio Mix — withstanding the Coronavirus Black Swan</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最佳投资组合——抵御冠状病毒黑天鹅</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/the-best-portfolio-mix-withstanding-the-covid-19-black-swan-1178911bffc5?source=collection_archive---------4-----------------------#2020-04-07">https://medium.datadriveninvestor.com/the-best-portfolio-mix-withstanding-the-covid-19-black-swan-1178911bffc5?source=collection_archive---------4-----------------------#2020-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="449a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对不同投资的比较表明，现在比以往任何时候都更需要一些比特币敞口。包括结果和代码。</h2></div><p id="36a4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们得出的资产配置:</p><ul class=""><li id="830d" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">过去6年中表现最好的<strong class="kk iu"/></li><li id="5165" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">在<strong class="kk iu">新冠肺炎</strong>危机期间显示<strong class="kk iu">损失有限</strong></li><li id="bd33" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="kk iu">是否未被管理</strong>(每月仅进行一次简单的重新平衡)</li><li id="a042" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">仅投资于<strong class="kk iu"> S &amp; P 500指数、比特币、</strong>和<strong class="kk iu">黄金</strong></li></ul><p id="777d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">结果:</strong></p><p id="bedf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就风险调整回报率而言，6年前，你应该将你的启动资金(10万美元)按以下权重分配到上述资产中:</p><ol class=""><li id="0b22" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld ls lk ll lm bi translated">S&amp;P 500:12.500-20.000美元</li><li id="8429" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated"><strong class="kk iu">比特币</strong>:7.000-9.000美元</li><li id="af67" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated"><strong class="kk iu">黄金</strong>:15.000-20.000美元</li></ol><p id="658e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">加上53.500-66.500美元的无风险资产——部分是为了<strong class="kk iu">补偿来自比特币配置的更高风险</strong>。乍一看，这听起来有点傻，但是读下去，你就会明白为什么这行得通！</p><blockquote class="lt lu lv"><p id="392e" class="ki kj lw kk b kl km ju kn ko kp jx kq lx ks kt ku ly kw kx ky lz la lb lc ld im bi translated">顺便说一句——有人可能会问，为什么我们选择了过去6年的<strong class="kk iu"/><strong class="kk iu"/>而不是10年或5年？原因在于比特币的价格历史。在我们开始的前一年，BTC取得了最后的辉煌成就，这种情况今后不会再发生了。因此，我们希望至少尽可能多地惩罚加密货币投资。但是没有成功；)</p></blockquote><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/d99f3853b9003eb332687422bb1781bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KRX2cLD5RjC_0wggSKj_eA.png"/></div></div></figure></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="dee7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有以下情况，请继续阅读:</p><ul class=""><li id="4111" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">有兴趣了解<strong class="kk iu">更多详情</strong></li><li id="92b0" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">想自己做一些类似<strong class="kk iu">的计算</strong></li></ul></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="0dc2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个故事使用编程语言<strong class="kk iu"> Python </strong>通过所有必要的步骤得出结果。此外，我们将对我们找到的解决方案给出一些见解。我们经历的步骤是:</p><ol class=""><li id="1add" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld ls lk ll lm bi translated">导入历史资产价格</li><li id="7424" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated">做一个基本图表[+什么是杠杆？]</li><li id="45fb" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated">为每月重新平衡的投资组合建立框架</li><li id="1359" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated">所有资产分配组合的回溯测试</li><li id="da82" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated">表现最佳的投资组合</li></ol><h1 id="c1ac" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">1.导入历史资产价格</h1><p id="064b" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">包<em class="lw"> pandas-datareader </em>包括<em class="lw"> DataReader </em>，它实现了对几十个不同数据API的导入。我们将使用雅虎获得股票指数、加密货币、比特币和T42黄金价格。</p><p id="346f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还从<a class="ae nq" href="https://fred.stlouisfed.org/" rel="noopener ugc nofollow" target="_blank"> FRED </a>处进口了<strong class="kk iu"> 3个月期美国国债</strong>，因为我们需要一项无风险资产来支付未分配的现金。导入助手功能是:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="92fe" class="nw mu it ns b gy nx ny l nz oa">import pandas as pd<br/>from pandas_datareader.data import DataReader</span><span id="116a" class="nw mu it ns b gy ob ny l nz oa">def get_close_prices(ticker, name, start, end):<br/>    if(ticker == 'TB3MS'):<br/>        data = DataReader(ticker, 'fred', start, end)<br/>    else:<br/>        data = DataReader(ticker, 'yahoo', \<br/>            start, end)[['Adj Close']]<br/>    data.columns = [name]<br/>    return data</span></pre><p id="5787" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这个简单的函数，我们导入过去<strong class="kk iu"> 6年</strong>的<strong class="kk iu">每日收盘价</strong>。由此产生的四个<em class="lw">数据帧</em>然后被合并成一个…</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="928d" class="nw mu it ns b gy nx ny l nz oa">assets = {'SP':'^GSPC', 'BTC':'BTCUSD=X', 'G':'GC=F', 'RF':'TB3MS'}<br/>dfs = [get_close_prices(ticker, name, '2014-03-30', '2020-03-31') \<br/>    for name, ticker in assets.items()]</span><span id="a428" class="nw mu it ns b gy ob ny l nz oa">data = reduce(lambda df1, df2: df1.join(df2, how="outer"), dfs)<br/>data = data.sort_index(ascending=True)<br/>data</span></pre><p id="be2b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到目前为止，数据集仍然包括多个缺失值(<em class="lw"> NaN的)</em>。为了得到一个干净的数据集，我们只使用最多有一个缺失值的行。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi oc"><img src="../Images/1708d0cb357f4077515649bcd3d7ebfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFomDplDqmA9CqdwywPSZg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">The imported DataFrame before any cleaning. The risk-free asset has only 1 value per month.</figcaption></figure><p id="107e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于我们在任何给定时间都只能以下一个可用价格<strong class="kk iu">进行交易，因此我们会向后</strong>填充缺失价格<strong class="kk iu">('<em class="lw">b填充</em>')。</strong></p><p id="3ab1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于国库券(RF栏<em class="lw">和</em>)，我们只有月度数据。因此我们向前填充它的缺失值(<em class="lw">ffill</em>’)。这里是这些操作的代码，下面是已清理数据的快照:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="2bba" class="nw mu it ns b gy nx ny l nz oa">atMostOneNA = data[['SP','BTC','G']].isna().sum(axis=1) &lt;= 1<br/>data = data.loc[atMostOneNA, :]</span><span id="b587" class="nw mu it ns b gy ob ny l nz oa">data.loc[:, ('SP','BTC','G')] = \<br/>    data.loc[:, ('SP','BTC','G')].fillna(method='bfill')<br/>data.loc[:,'RF'] = data.loc[:,'RF'].fillna(method='ffill')</span></pre><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi oh"><img src="../Images/9d28dbe364a78cd6dd2a23000627001d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZncrEToDOaJAOc5ByC3UA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Data set after filling NaN values.</figcaption></figure><h1 id="a204" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">2.做一些基本的图表[+什么是杠杆？]</h1><p id="87f4" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">我们使用<a class="ae nq" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"> Python包<em class="lw"> plotly </em> </a>创建S &amp; P 500、比特币和黄金的价格图表:</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi oi"><img src="../Images/e8e22f146c57f3d96ccd75fee013a4a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwqx2SLbfv15h_CTwmag_Q.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Price history of S&amp;P 500, Bitcoin and Gold.</figcaption></figure><p id="7147" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">显然，这些资产在<a class="ae nq" href="https://en.wikipedia.org/wiki/Volatility_(finance)" rel="noopener ugc nofollow" target="_blank">波动性</a> (=每日回报的年化标准差)方面存在很大差异。黄金的波动性不到15%，而比特币的波动性是74%。</p><p id="4466" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们比较不同的情景，一个基础投资组合的股票(S &amp; P 500)配置比例为75 <strong class="kk iu"> % </strong>，无风险资产(如美国国债)配置比例为25%。也就是我们的<strong class="kk iu">基础杠杆是0.75 </strong>。</p><p id="9fd4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，为了<strong class="kk iu">使资产具有可比性</strong>，我们计算得到相似波动性所需的杠杆。这产生了:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="a8b4" class="nw mu it ns b gy nx ny l nz oa">volas = prices.apply(Annualized_Vola)<br/>result = pd.DataFrame( \<br/>    { 'volas':volas, 'leverage':0.75 * volas['SP'] / volas })<br/>result[result.index != 'RF']</span></pre><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi oj"><img src="../Images/380e42c8d0c465ad0ea611b9df38cda5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOCjcMftte5QYLoBZhcn2w.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Implied leverages to get a volatility comparable to the S&amp;P500.</figcaption></figure><p id="2dec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所见，比特币的杠杆必须比标准普尔500的杠杆小4倍以上(0.17比0.75)。因此，在比特币上投资10，000美元会导致与S&amp;P指数中40，000美元相似的风险敞口。</p><p id="8adb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在黄金方面，我们可以分配更多的资金来获得与S&amp;P股票指数相同的风险敞口。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="37b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在进入下一部分之前，我们<strong class="kk iu">将无风险利率转化为指数</strong>。假设利率全年为1.0%，我们希望指数从100.0开始，并在第一年上升到101.0，而不是使用百分比(即1.0%)。我们的代码有点花哨，也适用于每日汇率变化:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="f943" class="nw mu it ns b gy nx ny l nz oa">def get_index_from_rate(rates, dates, start=100):<br/>    delta_days = np.diff( \<br/>        (dates - datetime.utcfromtimestamp(0)).days)<br/>    delta_days = np.insert(delta_days, 0, 0) <br/>    index = np.cumprod((1 + rates/100) ** (delta_days / 365.25))<br/>    return np.multiply(start, index)</span><span id="fb2c" class="nw mu it ns b gy ob ny l nz oa">prices = data.copy()<br/>prices['RF'] = get_index_from_rate(prices['RF'], prices.index)</span></pre><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ok"><img src="../Images/6fbd105e491b8f579616016f8165a495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AcifRIMt67o7oATQg7wSTQ.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Risk-free rate as a percentage (blue) and implied index (red) starting with 100.</figcaption></figure><p id="9c30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该图显示了自2017年年中利率上升以来，该指数(红线)如何开始加速上升。</p><h1 id="4ea1" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">3.为每月重新平衡的投资组合建立框架</h1><p id="9f8e" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">酷毙了。下一步，我们要比较三种只做多的投资，每种投资都有相同的目标波动率:</p><ul class=""><li id="4417" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">75.0% SP 和25.0%无风险</li><li id="5f31" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="kk iu"> 17.5%比特币</strong>82.5%无风险</li><li id="aab7" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="kk iu"> 91.3%黄金</strong>8.7%无风险</li></ul><p id="78a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们希望<strong class="kk iu">每月</strong>重新平衡我们的投资组合，即我们对不断重新平衡的投资组合感兴趣。这是为了在6年的时间框架内保持<strong class="kk iu">稳定的敞口</strong>所必需的。然而，它肯定也有助于一年期投资。</p><p id="ecda" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用一个简单的<strong class="kk iu">例子</strong>来解释一下没有再平衡和有再平衡的情况。假设:</p><ul class=""><li id="7d33" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">启动资金10.000美元，投资于资产A(5.000美元)和资产B(5.000美元)。</li><li id="715d" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">1月收益→资产A: <strong class="kk iu"> +20% </strong>，资产B: <strong class="kk iu"> -20%。</strong></li><li id="47ac" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">2月收益→资产A: <strong class="kk iu"> -20% </strong>，资产B: <strong class="kk iu"> +20%。</strong></li></ul><ol class=""><li id="b80d" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld ls lk ll lm bi translated"><strong class="kk iu">未再平衡</strong>:<br/>1月底分配→ A: 6.000，B:4.000<br/>2月底分配→ A: 4.800，B:4.800<br/>2个月后资金:$9.600。</li><li id="507d" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld ls lk ll lm bi translated"><strong class="kk iu">带再平衡</strong> : <br/>一月底分配→ A: 6.000，B:4.000<br/>10.000的再分配→ A: 5.000，B: 5.000(又是50:50) <br/>二月底分配→ A: 4.000，B:6.000<br/>2个月后的资本:＄10.000。</li></ol></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="c946" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们创建Python函数<strong class="kk iu"> <em class="lw"> trading() </em> </strong>来<strong class="kk iu">计算任意资产分配的权益曲线</strong>，该曲线在特定时期(例如月初)重新平衡。为了简单起见，我们忽略了我们不能投资小数目的资产的事实(例如7.3 E-Mini期货或其他)。</p><p id="3683" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数<em class="lw"> trading() </em>计算所需资产的每日分配。每月开始时，根据参数<em class="lw"> target_weights </em>中的规定，重新分配当前资本。最后，函数<strong class="kk iu">返回</strong>一系列<strong class="kk iu">每日投资组合余额</strong> (' <em class="lw"> capital_daily </em>')，这些余额将用于绘图和业绩计算。</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="e620" class="nw mu it ns b gy nx ny l nz oa">def asset_allocation(capital, weights):<br/>    return np.multiply(capital, weights)</span><span id="f3fd" class="nw mu it ns b gy ob ny l nz oa">def trading(returns, start_capital, target_weights, timeframes):<br/>    capital_now = start_capital<br/>    capital_per_asset_daily = pd.DataFrame(columns=returns.columns)<br/>    for index in np.unique(timeframes):<br/>        capital_per_asset_now = asset_allocation(<br/>            capital_now, target_weights)        <br/>        r = returns.iloc[timeframes == index]<br/>        capital_per_asset_new = \<br/>            np.multiply((r + 1).cumprod(), capital_per_asset_now)<br/>        capital_per_asset_daily = <br/>            capital_per_asset_daily.append(capital_per_asset_new)<br/>        capital_now = sum(capital_per_asset_daily.iloc[-1])<br/>    capital_daily = capital_per_asset_daily.sum(axis=1)<br/>    return (capital_daily, capital_per_asset_daily)</span></pre><p id="41bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了调用这个函数，我们需要每日收益(价格变化百分比)以及一个具有周期(=月份)唯一标识符的数组。后者是提取分配不变的时间帧所必需的。</p><p id="be65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<em class="lw"> [1:] </em>我们省略了第一个日期，因为该行缺少%变化:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="78eb" class="nw mu it ns b gy nx ny l nz oa">returns = prices.pct_change()[1:] <br/>timeframes_monthly = prices.index[1:].strftime('%Y%m')</span></pre><p id="f03c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们运行上述3项投资的函数:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="4541" class="nw mu it ns b gy nx ny l nz oa">start_capital = 100000</span><span id="956b" class="nw mu it ns b gy ob ny l nz oa">## S&amp;P 500.<br/>leverage = result['leverage']['SP']<br/>target_weights = [leverage, 0, 0, 1.0 - leverage]<br/>(capital_daily_sp, _, Return, Vola, SR, MaxDD) = trading(returns, \<br/>    start_capital, target_weights, timeframes_monthly)</span><span id="333f" class="nw mu it ns b gy ob ny l nz oa">## Return:  4.43     Vola: 12.74     SR: 0.27     MDD: 26.09</span><span id="7adc" class="nw mu it ns b gy ob ny l nz oa">## Bitcoin.<br/>leverage = result['leverage']['BTC']<br/>target_weights = [0, leverage, 0, 1.0 - leverage]<br/>(capital_daily_btc, _, Return, Vola, SR, MaxDD) = trading(returns, \<br/>    start_capital, target_weights, timeframes_monthly)</span><span id="9b11" class="nw mu it ns b gy ob ny l nz oa">## Return: 13.89     Vola: 13.34     SR: 0.97     MDD: 23.46</span><span id="5274" class="nw mu it ns b gy ob ny l nz oa">## Gold.<br/>leverage = result['leverage']['G']<br/>target_weights = [0, 0, leverage, 1.0 - leverage]<br/>(capital_daily_g, _, Return, Vola, SR, MaxDD) = trading(returns, \<br/>    start_capital, target_weights, timeframes_monthly)</span><span id="45de" class="nw mu it ns b gy ob ny l nz oa">## Return:  3.54     Vola: 12.94     SR: 0.20     MDD: 19.73</span></pre><p id="0288" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可能已经注意到，我们的函数比上面的代码返回更多的值。如果您需要这些标准指标的计算细节，请随时联系我(回报、Vola、<a class="ae nq" href="https://www.investopedia.com/terms/s/sharperatio.asp" rel="noopener ugc nofollow" target="_blank">夏普比率</a>、<a class="ae nq" href="https://www.investopedia.com/terms/m/maximum-drawdown-mdd.asp" rel="noopener ugc nofollow" target="_blank">最大下降</a>)。</p><p id="fe1c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在有了分配的权益曲线。让我们使用<em class="lw"> plotly: </em>来绘制它们</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="24f3" class="nw mu it ns b gy nx ny l nz oa">fig = go.Figure()<br/>fig.add_trace(go.Scatter(x=prices.index, y=capital_daily_sp, \<br/>    mode='lines', name='SP'))<br/>## ... same for BTC and G.<br/>fig.update_layout(yaxis_type="log", ...)</span></pre><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ol"><img src="../Images/d11b9df08b71d8296ad1712f5c6cd148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zeEF_WIH9CaAfANUdOfmDA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Equity curves for Long-only investments. All three curves share nearly the same volatility (!).</figcaption></figure><blockquote class="om"><p id="f6af" class="on oo it bd op oq or os ot ou ov ld dk translated">我们看到，在风险调整的基础上，冠状病毒危机期间(2020年3月)标准普尔500股指的下降幅度远远大于比特币。</p></blockquote><p id="71fc" class="pw-post-body-paragraph ki kj it kk b kl ow ju kn ko ox jx kq kr oy kt ku kv oz kx ky kz pa lb lc ld im bi translated">这与<a class="ae nq" href="https://en.cryptonomist.ch/2020/04/05/china-coronavirus-bitcoin-failed-crisis/" rel="noopener ugc nofollow" target="_blank">媒体告诉</a>的有点不同。另一方面，有出版物显示比特币在最大化回报风险比方面的优势(例如，见<a class="ae nq" href="https://charts.woobull.com/bitcoin-risk-adjusted-return/" rel="noopener ugc nofollow" target="_blank"> Woobull </a>)。</p><h2 id="3a63" class="nw mu it bd mv pb pc dn mz pd pe dp nd kr pf pg nf kv ph pi nh kz pj pk nj pl bi translated">仅限标准普尔500的投资</h2><p id="54bc" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">让我们更深入地了解一下<strong class="kk iu">S&amp;P 500-only investment</strong>——杠杆率始终为75%的细节。三角形图(如下)显示了2014年第二季度至2020年第一季度之间所有可能子周期的平均回报。这提供了许多细粒度的洞察力。</p><p id="49d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">如何看这个图:</strong>在两个红色矩形的交叉点上你看到3.0。这是从2017年第一季度开始(右侧轴上的标签)到2018年第三季度结束(顶部轴上的标签)的平均年化回报率(以百分比表示)。</p><p id="d678" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，从左上角开始的最长对角线上的值是简单的一个月回报，而最后一列<strong class="kk iu">中的值</strong>对应于任何季度的平均回报，截止到今天(2020Q1)，这意味着它们包括冠状病毒危机的时间。</p><p id="621f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">顺便说一下，三角形图是通过微调函数<em class="lw"> plt_triangle </em>创建的(由<a class="ae nq" href="https://de.scalable.capital/quants-perspective/return-triangles#fig_ret_upper" rel="noopener ugc nofollow" target="_blank"> Scalable Capital GmbH </a>开源，MIT许可)。Thx)。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi pm"><img src="../Images/0090ab4ab3cbfcec61b428f2413df733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JVHfWAF26p7gC3TilbOQvw.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Return Triangle for the S&amp;P 500 investment with leverage 0.75 and monthly rebalancing. Cells show Quarters, from 2014-Q4 to 2020-Q1.</figcaption></figure><p id="3fbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到的标准普尔500:有一些大的下降(-10.4%和-15.1%)；此外，期限为4-5年的投资从1.0%到2.4%不等。</p><p id="13a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看看最后一栏底部的四个值:由于持续的COVIT-19危机，在过去12个月投资的人的平均回报率为-1.5%至-15.1%。</p><h2 id="d0e6" class="nw mu it bd mv pb pc dn mz pd pe dp nd kr pf pg nf kv ph pi nh kz pj pk nj pl bi translated">纯比特币投资</h2><p id="b1dd" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">接下来让我们检查比特币投资的相同三角形图，总是具有相同的风险暴露。我们仍然有一个略低于-10%的1个月回报，但有很多超过+10%的巨大回报。</p><p id="f679" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">期限为4-5年的投资的年化回报率在3.0%到5.4%之间。而且——非常重要:<strong class="kk iu">包括</strong>冠状病毒危机<strong class="kk iu">开始</strong> (2020Q1) <strong class="kk iu">的投资从来没有低于-1.9% </strong>。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi pm"><img src="../Images/4f08731e82c92fadf43400ac1e5fe0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWilZxQMNOFoZV2mieyKWg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Return Triangle for the Bitcoin investment with leverage 0.175 and monthly rebalancing. Cells show Quarters, from 2014-Q4 to 2020-Q1.</figcaption></figure><h1 id="74e7" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">4.组合的计算</h1><h2 id="7677" class="nw mu it bd mv pb pc dn mz pd pe dp nd kr pf pg nf kv ph pi nh kz pj pk nj pl bi translated">a.风险调整分配</h2><p id="5a8f" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">首先，我们不是将75%的资金投资在一项资产上，而是希望将风险平均分摊到三项资产上，即标准普尔500、BTC和黄金。这导致了上面使用的杠杆的1/3:</p><ul class=""><li id="0df4" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">标准普尔500: 0.750 / 3 = 0.250</li><li id="b072" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">比特币:0.174 / 3 = 0.058</li><li id="5977" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">黄金:0.913 / 3 = 0.304</li></ul><p id="214a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们计算权益曲线，得到以下结果:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="4693" class="nw mu it ns b gy nx ny l nz oa">target_weights = result['leverage'] / 3.0<br/>target_weights['RF'] = 1.0 - sum(target_weights[:-1])<br/>(capital_daily_g, _, Return, Vola, SR, MaxDD) = trading(returns, \<br/>     start_capital, target_weights, timeframes_monthly)</span><span id="cae5" class="nw mu it ns b gy ob ny l nz oa">## Return: 7.67      Vola: 7.52      SR: 0.89      MDD: 13.34</span></pre><p id="ace6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">听起来不错！与单一的S&amp;P或黄金投资相比，年回报率约为两倍。此外，多样化导致波动率下降了近50%。但是让我们经历更多的场景。</p><h2 id="dd06" class="nw mu it bd mv pb pc dn mz pd pe dp nd kr pf pg nf kv ph pi nh kz pj pk nj pl bi translated">b.计算分配权重网格</h2><p id="a2c8" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">让我们对此进一步展开。我们通过有意义的权重网格进行搜索，而不是固定的分配。我们允许每项资产的权重在上述权重的[-50%，+50%]的<strong class="kk iu">范围内。在对更漂亮的数字做了一些舍入之后，我们在测试<strong class="kk iu">中总结了包括这些权重</strong>在内的所有组合:</strong></p><ul class=""><li id="3a78" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">标准普尔500:12.5%至37.5%，增幅为2.5%</li><li id="4b98" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">比特币:3.0%至9.0%，涨幅为1.0%</li><li id="65f8" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">黄金:15.0%至45.0%，以5.0%的幅度递增</li></ul><p id="7c49" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面的嵌套循环遍历这些组合，并创建一个<em class="lw">数据框架</em>，其中包括所有可行资产权重组合的绩效指标:</p><pre class="mb mc md me gt nr ns nt nu aw nv bi"><span id="28cc" class="nw mu it ns b gy nx ny l nz oa">## Custom function to create an equally-spaced grid of values<br/>## within the specified range; plus some constraints.<br/>def my_linspace(cum_weight, step=0.05, min_weight=0, max_weight=1)<br/>## ... code omitted.</span><span id="f5d1" class="nw mu it ns b gy ob ny l nz oa">performance = []<br/>for wei_sp in \<br/>    my_linspace(0, min_weight=0.125, max_weight=0.375, step=0.025):<br/>    for wei_g in my_linspace(wei_sp, min_weight=0.15, \<br/>        max_weight=0.45, step=0.05):<br/>        for wei_btc in my_linspace(wei_sp + wei_g, \<br/>            min_weight=0.03, max_weight=0.09, step=0.01):<br/>            wei_tb3 = 1.0 - (wei_sp + wei_btc + wei_g)<br/>            target_weights = [wei_sp, wei_btc, wei_g, wei_tb3]<br/>            (_, _, Return, Vola, SR, MaxDD) = trading(returns, \<br/>                start_capital, target_weights, timeframes_monthly)<br/>            performance.append( \<br/>                target_weights + [Return, Vola, SR, MaxDD])</span><span id="f0e5" class="nw mu it ns b gy ob ny l nz oa">performance = pd.DataFrame(performance, columns=\<br/>    returns.columns.tolist() + ['Return', 'Vola', 'SR', 'MaxDD'])</span><span id="0fb0" class="nw mu it ns b gy ob ny l nz oa">performance.sort_values('SR', ascending=False).head(15)</span></pre><p id="f642" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结果如下(<strong class="kk iu">前15名</strong>):</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi pn"><img src="../Images/49355815706f15fed0e69afb303d8cf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8xZf02C03Ec0TDH1wYouLA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Top 15 asset allocations by means of the Sharpe Ratio.</figcaption></figure><p id="e4ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">非常相似，这15个最佳解决方案。标准普尔500和黄金大多处于其权重下限，比特币处于其权重上限(0.09)。然而，所有这些解决方案在称为<a class="ae nq" href="https://en.wikipedia.org/wiki/Sharpe_ratio" rel="noopener ugc nofollow" target="_blank">夏普比率</a>(风险/回报)的风险调整指标方面非常相似。</p><p id="8e5a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们<strong class="kk iu">从这15个场景中挑选2个场景</strong>——最好的一个，以及拥有更高股票投资份额(占标准普尔500指数的20%)的解决方案:</p><ul class=""><li id="133d" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">场景1 →权重= [0.125，0.090，0.150，0.635]</li><li id="cc11" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">场景2 →权重= [0.200，0.090，0.150，0.560]</li></ul><p id="7dc9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下图比较了单一资产投资与两种情景投资组合的表现(顺便说一句，所有5种投资每月重新平衡一次):</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi po"><img src="../Images/2fe6fbd0257e622a5cd118d10c4fd745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*140seyxBdtna8kl6FRbVlg.png"/></div></div></figure><p id="6ccf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然这两种情况都有不错的回报，但它们没有标准普尔500那样的风险。下降幅度要小得多。</p><p id="d879" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以得出这样的结论:一个只有少量股票和黄金投资的均衡投资组合在分析期内表现最佳。</p><p id="7e59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了完成这个故事，我还附上了两个场景的返回三角形。两者在2020年都有非常可容忍的下降——Q1:</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi pp"><img src="../Images/7da99e2889579ae102ef80b7ca40c659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ym-J4wHM_yS4UmsUAwKrgQ.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Return Triangle for scenario 1.</figcaption></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi pp"><img src="../Images/c8d599eda0c86dd928f27caf059de275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vtOz6RZ3VSR8to9P_p81OQ.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk">Return Triangle for scenario 2.</figcaption></figure><h1 id="8b6d" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">摘要</h1><p id="53ab" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">身处冠状病毒经济危机之中，我们扪心自问，我们的投资组合是否正确。巨大的损失已经过去了吗——或者还会有更多的损失？</p><p id="b8fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个故事中，我们比较了过去几年中不同的资产配置，包括2020年第一季度。结果令人惊讶:拥有大量比特币的投资组合回报率高得多，风险也更小。总是在加密货币投资与大约四倍于相同金额的无风险资产保持良好平衡的条件下[参见:杠杆]。</p><p id="09de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，没有人能保证历史会重演。通常不会。既不是股票回报的历史，也不是加密货币回报的过程。</p><p id="3ebc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只有一点永远是有利的:多元化！所以不要单纯投资股票，要分散风险，限制杠杆:)</p></div></div>    
</body>
</html>