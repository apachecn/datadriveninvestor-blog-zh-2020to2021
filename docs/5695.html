<html>
<head>
<title>Extracting relevant information from Telegram Groups and Making it Representable 😊</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从电报组中提取相关信息并使其具有代表性😊</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/extracting-relevant-information-from-telegram-groups-and-making-it-representable-1b70d4fe2d6f?source=collection_archive---------11-----------------------#2020-09-28">https://medium.datadriveninvestor.com/extracting-relevant-information-from-telegram-groups-and-making-it-representable-1b70d4fe2d6f?source=collection_archive---------11-----------------------#2020-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6616" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我曾经是一个名为“根除糖尿病”的电报小组的成员，该小组的宗旨是建议人们按照LCHF饮食，建议如何自然地降低血糖水平，过健康的生活。</p><p id="3d1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它以问题回答的形式提供了大量信息，这些问题是由名为“Raj”和“Tim”的两位专家提供的。还有很多聊天记录，食物图片和食谱。</p><p id="75fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">要求</strong></p><p id="7cbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要求是从该组中提取相关信息，并以问答对的形式获得一个. csv文件。</p><p id="a31b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这只是一个模糊的要求，在接下来的步骤中，您将看到我们是如何取得进展并朝着解决方案前进的。在前进的道路上，看到要求和挑战，是的，这是一个旅程。</p><p id="9a07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">解决步骤:</strong></p><p id="b8f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一步:</strong></p><p id="67f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">提取群组中的聊天记录。json格式</strong>。因为json格式很容易解析，所以我们将其归零。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/8cb747e288ae9960daa5a67c107c1086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iXmFFsT1KogyIbRq.png"/></div></div></figure><p id="3f33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:</strong></p><p id="da33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">用Python </strong>读取json文件，代码如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/65643d2947bd3602eda27eb3642dbcce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6m_md5bMqgETy04mWlv2Q.png"/></div></div></figure><p id="d44d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三步:</strong></p><p id="3267" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">识别对我们有用的数据</strong>。为此，我们尝试将数据帧df打印如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/04f240a4e723c5119b242263171f591b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*sDX6NRapDEEaal8yac1b5A.png"/></div></figure><p id="0bbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们观察到想要从中获取信息，所以我们写道:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/894cdb8e5bbe947108219bbb5d6108f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*hPhPi-jl4OHiPcBD7apvGw.png"/></div></figure><p id="e6f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了获得整个数据帧长度，我们可以说:</p><p id="4e9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Lendf =len(df['messages])。</p><p id="a08e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四步:</strong> <strong class="jp ir">识别相关字段建立逻辑。</strong></p><p id="f39a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果我们打开json文件，它的格式如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi la"><img src="../Images/afbe8b0615e2b9e7d0e2e63540daf578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIkdOCWy_nHkR51dyVFnEg.png"/></div></div></figure><p id="0500" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lb">我们要考虑的领域:</em> </strong></p><p id="d2a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1)'<strong class="jp ir">reply _ to _ message _ id ":</strong>每当有对某个问题的回复时，都会生成该id，它将用于提取答案。它具有消息id的值，该值包含向答案提问的问题。</p><p id="38ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2)<strong class="jp ir">‘id’:</strong>这是消息id，我们将使用它来定位提问的位置。</p><p id="5057" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3)<strong class="jp ir">‘文本’:</strong>与相关Id相关的消息。</p><p id="73fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4)<strong class="jp ir">‘from’:</strong>这个id是谁提问或回答的指示器，基本上是谁在聊天。</p><p id="f3d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第五步:</strong> <strong class="jp ir">制作逻辑提取相关数据。</strong></p><p id="c1e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，使用步骤4中的所有字段，我们制作了我们的逻辑。</p><p id="82e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">pf=df['消息']</p><p id="4d80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的代码过滤掉所有有“回复消息id”字段、有一些文本、有Tim或Raj我们的专家给出答案的消息。这将提取“Tim和Raj”给出的所有答案。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/96143ec92f12d92b9f0a0b1c93d0e9f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e9wUqB0C1CQSLnjIMi8myA.png"/></div></div></figure><p id="1890" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要提取所提出的问题，所以我们采用“回复消息id”字段中给出的id，并向上滚动到包含问题的消息id。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/65352b841d5f64a4c839b3b82c009265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zIenFpo5eJ6tHMI7RUYU7A.png"/></div></div></figure><p id="69e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于上面的逻辑，代码可以编写如下，这里添加的逻辑是，问题不应该来自Tim或Raj，因为我们只想从他们那里提取人们所提问题的答案。：</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/d2d2114aa95f4026b8b7b887ccfbe59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uSqa0_owxx753i7-xBOKsQ.png"/></div></div></figure><p id="9222" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成后，我们可以用下面的代码打印问题和答案:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/3d75ec82b444226e0bed0428e0a86076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZbbrCkbQXI_yF2xHgRPDIw.png"/></div></div></figure><p id="7357" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第六步:</strong> <strong class="jp ir">数据清理——删除不相关的。</strong></p><p id="f36f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们得到了所需的文件，但它有许多问题，如:</p><p id="7fbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1)多多早上好，回复祝福短信。</p><p id="de92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2)相关数据较少。</p><p id="da6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3)大量垃圾字符。</p><p id="28c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们必须以有意义的方式过滤掉这些。输出文件如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/b2d21d70730d21f6a41c751fb9bdbc9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*07fw6yO6nb-8RbJeyukHpQ.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/ec9ccf7f8ee2b606dc709e783f8b39cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LYwkJDZNkT7G1UaX7d4Fg.jpeg"/></div></div></figure><p id="1e4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lb"> a)为了得到相关的问题和答案</em> </strong>只有我们为问题设置了一个过滤器，那些包含关键字' can '、' what '、' where '、' when '、' how '、' which '、' who '、' why '、' suggest '的字符串才会被包含在问题中，其余的将被删除。</p><p id="a9dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你必须注意列表中每个单词后的空格，以确保我们捕捉到相关的单词，而不是与其他单词连接在一起，如“斜面，无论哪一个，无论是谁”等。)</p><p id="9259" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这段代码如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/8f6227289665eb1d0d35fed352195b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOaNu7Cr5KP86nzzb-I0LA.jpeg"/></div></div></figure><p id="4a28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lb"> b)要删除花括号和它之间的文本</em> </strong>，我们通过使用下面的代码来删除它:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/f10f00c3c510b73f17eda14b31a5aa6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*D6mZs1E1gtvsB4Qw5qRL4Q.png"/></div></figure><p id="dd41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用上面的代码，记住我们需要导入Python的正则表达式库。</p><p id="ea57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们得到的数据非常干净，只有相关的问题和答案。</p><p id="6b46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们必须删除“早上好”、“晚上好”消息，但是通过上面步骤a)中的方法，只有当它有问题时，我们才得到相关的问题答案和祝愿消息。这是一种不同的方法，但很有效😊。</p><p id="3a33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果需要删除表情符号，也可以通过python库使用“表情符号”来完成，并通过使用“表情符号”在文本中找到它。UNICODE_EMOJI。</p><p id="f691" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第六步:</strong></p><p id="118c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最后但同样重要的是，我们需要将聊天导出到csv文件</strong>，这可以通过以下代码轻松完成:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lk"><img src="../Images/179b00650a5e1484b698a39a93c2ba39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*78-ad2jFVdPO3UleQVhtaQ.png"/></div></div></figure><p id="ab81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用这个，记住我们需要导入操作系统、系统和子进程。</p><p id="f997" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="655a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lb">原载于2020年9月28日</em><a class="ae ls" href="https://www.numpyninja.com/post/extracting-relevant-information-from-telegram-groups-and-making-it-representable" rel="noopener ugc nofollow" target="_blank"><em class="lb">https://www.numpyninja.com</em></a>T22。</p></div></div>    
</body>
</html>