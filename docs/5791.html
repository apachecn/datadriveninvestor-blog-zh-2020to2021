<html>
<head>
<title>Black Friday: How much is the customer going to spend?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑色星期五:顾客打算花多少钱？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/black-friday-insights-and-prediction-16933b8a8bfb?source=collection_archive---------3-----------------------#2020-10-01">https://medium.datadriveninvestor.com/black-friday-insights-and-prediction-16933b8a8bfb?source=collection_archive---------3-----------------------#2020-10-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/4dfbbfa6ed96cb3a09883fd7f3f37c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDcf93PFu_gJb5bD2XEhVQ.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">source :- Google</figcaption></figure><div class=""/><h1 id="987c" class="kc kd jf bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">数据科学案例研究</h1></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><p id="2535" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg"> <em class="mf">您好👋，各位数据科学家和非数据科学家，</em> </strong></p><p id="0b11" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg"> <em class="mf">首先，我很高兴你在这里，这是我第一篇鼓励自己走向数据科学的文章。我不擅长写文章或英语。本文如有瑕疵，请见谅。</em> </strong></p><h1 id="56ef" class="kc kd jf bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">介绍</h1><p id="b687" class="pw-post-body-paragraph lh li jf lj b lk mg lm ln lo mh lq lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在本文中，我们将讨论黑色星期五，比如它对购物者和零售商有多重要，以及基于历史交易数据的见解。</p><p id="cd07" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在本案例研究中，我们将遵循<strong class="lj jg"> CRISP-DM流程(数据挖掘的跨行业流程)</strong>。以下是这个过程的各个阶段，</p><ol class=""><li id="ceec" class="ml mm jf lj b lk ll lo lp ls mn lw mo ma mp me mq mr ms mt bi translated"><strong class="lj jg">业务理解</strong></li><li id="3997" class="ml mm jf lj b lk mu lo mv ls mw lw mx ma my me mq mr ms mt bi translated"><strong class="lj jg">数据理解</strong></li><li id="19ad" class="ml mm jf lj b lk mu lo mv ls mw lw mx ma my me mq mr ms mt bi translated"><strong class="lj jg">准备数据</strong></li><li id="3236" class="ml mm jf lj b lk mu lo mv ls mw lw mx ma my me mq mr ms mt bi translated"><strong class="lj jg">数据建模</strong></li><li id="62a7" class="ml mm jf lj b lk mu lo mv ls mw lw mx ma my me mq mr ms mt bi translated"><strong class="lj jg">评估结果</strong></li><li id="a02f" class="ml mm jf lj b lk mu lo mv ls mw lw mx ma my me mq mr ms mt bi translated"><strong class="lj jg">部署</strong></li></ol><p id="2f7b" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们将涵盖除部署之外的所有阶段。</p><p id="c423" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好吧，但首先让我们谈谈这个非常特殊的日子。</p><blockquote class="mz na nb"><p id="f0da" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated"><strong class="lj jg">什么是黑色星期五？</strong></p><p id="f40f" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">很可能你们都知道，这是一个典型的充满特别购物交易和大折扣的日子，被认为是假日购物季的开始。这个季节对经济至关重要，尤其是对零售商而言。</p><p id="2f7a" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">你等了整整一年才在网络平台和实体店抢到最好的<strong class="lj jg">优惠/折扣</strong>。😉</p><p id="d453" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">但是你可能不知道黑色星期五的由来，</p><p id="7a5d" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">那么为什么取这个名字呢？有人说这一天被称为“黑色星期五”,因为“黑色”一词指的是有利可图，这源于旧的簿记惯例，用黑色墨水记录利润，用红色墨水记录损失。这个想法是，零售企业在本周五卖出足够多的商品，让自己在今年剩下的时间里“盈利”。</p></blockquote></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="d66e" class="kc kd jf bd ke kf nf kh ki kj ng kl km kn nh kp kq kr ni kt ku kv nj kx ky kz bi translated">1.商业理解</h1><p id="680a" class="pw-post-body-paragraph lh li jf lj b lk mg lm ln lo mh lq lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">零售商花了整整一年来计划他们的黑色星期五销售。他们利用这一天为积压的存货提供尽可能低的价格，并为季节性商品、电子产品、装饰品等提供打折优惠。</p><p id="ae03" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">由于大折扣和大优惠，消费者也要等一整年才能在黑色星期五购物。黑色星期五广告的内容通常被寄予厚望，以至于零售商竭尽全力确保他们事先不会公开失败。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/21b325b279af90205cc4fcc75dccda97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-CPed4MK6HwI-G4XxSdjg.png"/></div></div></figure><p id="a36b" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">根据<strong class="lj jg"> 2018 </strong>数据，全球对黑色星期五销售的平均兴趣增长为<strong class="lj jg"> 117% </strong>。这就是为什么今天对零售业来说是一个关键且有利可图的日子。这也为零售商创造了新的竞争，为了跟上这种竞争，零售商需要更深入地研究先进的黑色星期五营销策略。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/81c65f200b85bce21cf2be799aeb15e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rqWPw4EvCnNezJVDcV35Tw.png"/></div></div></figure><p id="217e" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">零售商需要适当的数字和更好的洞察消费者在黑色星期五的历史交易数据，以了解消费者的购物特征和趋势产品。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/df955a8e858985fee5fb189ead3b0f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0InNiuas5s9_TWTGJwsatQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">This report was created based on data provided by Picodi.com — a global discount provider existing since <strong class="bd ke">2010</strong>. Black-Friday.Global — dedicated to Black Friday deals — was created by Picodi.com. <strong class="bd ke">12,000</strong> participants from <strong class="bd ke">55</strong> countries took part in the survey.</figcaption></figure><p id="0071" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在此基础上，他们可以针对不同类型的客户实施和应用不同类型的营销策略，并提供折扣来吸引他们。</p><p id="1ad6" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好了，现在我们知道了黑色星期五及其重要性。那么，让我们从数据开始。😊</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="1edc" class="kc kd jf bd ke kf nf kh ki kj ng kl km kn nh kp kq kr ni kt ku kv nj kx ky kz bi translated">2.数据理解</h1><p id="5d13" class="pw-post-body-paragraph lh li jf lj b lk mg lm ln lo mh lq lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="lj jg">数据采集</strong>:</p><p id="f292" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">对于这个案例研究，我们将从<a class="ae np" href="https://www.kaggle.com/sdolezel/black-friday" rel="noopener ugc nofollow" target="_blank"> Kaggle(黑色星期五)</a>下载数据集。这个数据集有两个文件<strong class="lj jg"> train.csv </strong>和<strong class="lj jg"> test.csv. </strong>，因为我们没有参加比赛，所以我们将只使用<strong class="lj jg"> train </strong>数据。</p><p id="79a7" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg">数据可视化:</strong></p><p id="69fb" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们显示前5行训练数据和所有字段的一些基本信息，</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="2052" class="nv kd jf nr b gy nw nx l ny nz">train_df = pd.read_csv("./kaggle/input/black-friday/train.csv")<br/>train_df.head()</span></pre><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/2516d7a43825f797d70b469d3eefbb98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRTtycLSNXcS2QUeUnKMoA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Every row has unique pair of (User_ID, Product_ID)</figcaption></figure><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/9bb156487a293278b2862c7e44cf43f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQjqDZUNXsTnNFNWm4lMEA.png"/></div></div></figure><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="c04a" class="nv kd jf nr b gy nw nx l ny nz">Total Transactions -&gt; 550068<br/>Total unique users -&gt; 5891<br/>Total unique products -&gt; 3631</span></pre><p id="b2ba" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">查看数据，我们可以得出这样的结论:我们总共有12个列的<strong class="lj jg">，总共有550058个</strong>交易行的<strong class="lj jg">，<strong class="lj jg"> 5891个</strong>唯一用户，以及<strong class="lj jg"> 3631个</strong>唯一产品。我们有7个数字变量和5个对象变量。除了两列<strong class="lj jg"> Product_category_2 </strong>和<strong class="lj jg"> Product_category_3，我们没有任何缺失值。</strong>我们会在后面的数据预处理部分处理。</strong></p><p id="0607" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们还将计算与数据框列相关的统计数据汇总。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/22cbb3348b1b6cd823468088dcd37a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VVuT2XBcfzIOhGP4v0RixQ.png"/></div></div></figure><p id="1353" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在上图中，如果您尝试查看<strong class="lj jg">职业</strong>字段，它的所有四分位数(最小值、25%、50%、75%和最大值)都是整数，同样的情况也适用于<strong class="lj jg">婚姻状态</strong>、<strong class="lj jg">产品类别1、产品类别2和产品类别3 </strong>列。显然<strong class="lj jg">、职业</strong>和<strong class="lj jg">婚姻状况</strong>必须被认为<strong class="lj jg"> </strong>为<strong class="lj jg">分类</strong>列。但是我想知道剩下的3列🤔，比如它们包含实际值还是只是不同类别的标签？😕。我们很快就会知道了😎。</p><p id="3aae" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好了，现在我们对数据有了一个大概的了解。那么，让我们从一些与事务总数count相关的问题开始。</p><blockquote class="mz na nb"><p id="fb17" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated"><strong class="lj jg">问题:- </strong></p><p id="5908" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">1.哪个年龄段做的交易比较多？<br/> 2。男性比女性做的交易多吗？<br/> 3。用户的职业与交易次数有关系吗？<br/> 4。在城市居住1年以上的用户是否做了更多的交易？<br/> 5。城市类别对购买数量有影响吗？<br/> 6。婚姻状况与黑色星期五购买价值有关联吗？</p></blockquote><p id="af8c" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">为了得到上述问题的答案，我们需要特定领域的计数图。我们将使用<strong class="lj jg"> seaborn </strong>库来创建很酷的图表。这是一个很棒的图书馆。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/2694ac90989a258f5e00418787714f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-M0JEmKDCrmQZoYRqwjwHw.png"/></div></div></figure><blockquote class="mz na nb"><p id="b3cf" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated"><strong class="lj jg">答案:- </strong></p><p id="f157" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">1.在图1中，26-35岁年龄段的人进行了更多的交易。<br/> 2。在图2中，男性用户完成了更多的交易。<br/> 3。在图3中，职业为0和4的用户进行了更多的交易。<br/> 4。在图4中，在当前城市停留1年的用户完成了更多的交易。<br/> 5。在图5中，B类城市的用户完成了更多的交易。<br/> 6。在图6中，尚未结婚的用户进行了更多的交易。</p></blockquote><p id="165f" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">哦，现在越来越有趣了。🎃</p><p id="6ed4" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们也来谈谈<strong class="lj jg">总采购金额</strong>。👍</p><blockquote class="mz na nb"><p id="698b" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated"><strong class="lj jg">问题:- </strong></p><p id="0670" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">1.哪个年龄段的人在黑色星期五花费更多？<br/> 2。女性比男性花费更多吗？<br/> 3。用户的职业和黑色星期五花钱有关系吗？<br/> 4。在城市居住1年以上的用户是否花了更多的钱？<br/> 5。城市类别对总购买量有影响吗？<br/> 6。婚姻状况与黑色星期五购买价值有关联吗？</p></blockquote><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/1dc78040659a02fedbf59b79fe9ea06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZW7pXTifndM9GKsChm_Cg.png"/></div></div></figure><blockquote class="mz na nb"><p id="63eb" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated"><strong class="lj jg">答案:- </strong></p><p id="fe66" class="lh li mf lj b lk ll lm ln lo lp lq lr nc lt lu lv nd lx ly lz ne mb mc md me ij bi translated">1.在图1中，26-35岁年龄段的人花了更多的钱。<br/> 2。在图2中，男性用户花了更多的钱。<br/> 3。在图3中，职业为0和4的用户花了更多的钱。<br/> 4。在图4中，在当前城市停留1年的用户花了更多的钱。<br/> 5。在图5中，B类城市的用户花了更多的钱。<br/> 6。在图6中，还没有结婚的用户花了更多的钱。</p></blockquote><p id="164c" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">嗯，我想你可能想知道为什么我们对这两个问题有相同的答案，为了消除这种困惑😕我们需要对<strong class="lj jg">平均购买金额</strong>做同样的练习。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/0c9b085fa20c0065cd124365fbe0a7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0sy-xaAHnR0_Ja3Ymk9bfA.png"/></div></div></figure><p id="e6bd" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">从上面的数字，我们可以得出结论，我们的怀疑是正确的。因为每个类别在每个领域都有几乎相同高度的横条。这消除了困惑。</p><p id="42b5" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好了，再加一个组性别，看看会得到什么见解。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/5283fafc5c614142cadc728f99f8072f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iim2Tw9WD07YJjFCdqFgDw.png"/></div></div></figure><p id="8177" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好吧，这件事我无能为力。但是根据数据显示，男性平均花费比女性多。所有的领域都是一样的。</p><p id="204f" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">下一个是令人兴奋的，是结对图😉。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/515f6571f0080785fde60865a83cbe3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PO0cUuCoM3EzkvhUxYbtKA.png"/></div></div></figure><p id="b4aa" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">远远高于Pair-plot并没有给出关于数值字段之间的相关性的更好的见解。另外，查看所有三个产品类别字段。这有点令人困惑🤔。下一阶段我们一起想办法。👍</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="9016" class="kc kd jf bd ke kf nf kh ki kj ng kl km kn nh kp kq kr ni kt ku kv nj kx ky kz bi translated">3.数据预处理</h1><p id="af1f" class="pw-post-body-paragraph lh li jf lj b lk mg lm ln lo mh lq lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">现在，我们对数据有了理解，也有了一些见解，但我们需要一个经过训练的<strong class="lj jg">机器学习模型</strong>，它可以预测消费者将花费多少钱，为了训练机器学习模型，我们需要一个格式良好、结构化和干净的数据。</p><p id="8517" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">将原始数据清理、结构化并丰富为所需格式的过程被称为<strong class="lj jg">数据角力</strong>，有时也被称为<strong class="lj jg"> <em class="mf">数据角力</em> /清理。</strong>这个过程花费了数据科学项目大约80%的时间。这就像做饭一样，我们需要准备好所有的材料，这需要太多的时间。</p><p id="eca0" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">首先，我们需要处理缺失的值。所以，让我们检查缺失值的百分比，</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/4d193d19306fd0e4929a7e23e397fea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zW6jNo6y9kVv7fB3bOK6nw.png"/></div></div></figure><p id="42c0" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如您所见，我们只有两个字段缺少值。<strong class="lj jg"> Product_Category_3 </strong>带<strong class="lj jg"> 69.67% </strong>和<strong class="lj jg"> Product_Category_2 </strong>带<strong class="lj jg"> 31.57% </strong>缺失值。</p><p id="044d" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们可以使用几种估算方法来填补缺失值。因此，我们可以使用mean方法来填充<strong class="lj jg"> Product_Category_2中的值。</strong>但是对于<strong class="lj jg"> Product_Category_3 </strong>，我们讨论的是70%的缺失值。在我们估算任何东西之前，我们需要澄清我们的困惑。这样我们就可以看到唯一的product_ID = " <strong class="lj jg"> P00265242 </strong>的所有交易数据。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="0e9e" class="nv kd jf nr b gy nw nx l ny nz">train_df.loc[<br/>train_df.Product_ID=="P00265242",["User_ID","Product_ID","Product_Category_1","Product_Category_2","Product_Category_3"]<br/>]</span></pre><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/5df19e0d34ebee7df7aa59e8ff921599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0VRWQ9L25eI09s8E2J72w.png"/></div></div></figure><p id="fe45" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">看到最后一个查询的结果后，我可以看到所有三个产品类别字段都包含标签，而不是实际值。让我们为这三个字段创建计数图。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/af8ad732be25130d347cd87757c2991a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krbDSKzlp2vi3UDnqTaDtA.png"/></div></div></figure><p id="844c" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">因此，我们不能仅仅使用平均法来估算这些值。还有，中位数/众数也会让数据有些偏差。我们能做的是创建另一个标签，它将代替<strong class="lj jg"> Nan </strong>值。让我们使用0.0作为缺失值，将其输入到两个字段中，并再次检查缺失值的百分比。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/b3a430ee27f6c196475b3fa3f531b1f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18-Q_PIGFQQOMdnA7udQHg.png"/></div></div></figure><p id="d1a6" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">所以我们有所有的值，不再有丢失的值。现在，我们可以转换我们的数据，以便我们可以将数据输入到机器学习模型中进行训练。</p><p id="ac1b" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">对于数据转换，我们需要分别处理分类列和数字列。如果我们再看看数据。我们不需要<strong class="lj jg"> User_ID </strong>和<strong class="lj jg"> Product_ID </strong>，因为<strong class="lj jg"> </strong>这些只是识别号，不会给我们任何信息。所以首先我们必须删除这些列。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="4d44" class="nv kd jf nr b gy nw nx l ny nz">train_df = train_df.drop(['User_ID', 'Product_ID'],axis=1)</span></pre><p id="f67b" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在，我们只剩下所有的分类字段，几乎所有的字段都有数字标签，除了<strong class="lj jg">年龄</strong>、<strong class="lj jg">停留_当前_城市_年数、城市_类别、</strong>和<strong class="lj jg">性别。</strong>为了将字符串值转换为标签，我们将使用名为<strong class="lj jg"> LabelEncoder </strong>的<strong class="lj jg"> scikit-learn的预处理</strong>方法，对于一键编码，我们将使用pandas内置方法<strong class="lj jg"> pandas.get_dummies </strong>方法。我们将使用LabelEncoder拟合和转换前三列的值，使用get_dummies方法拟合和转换性别列的值。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="5c1e" class="nv kd jf nr b gy nw nx l ny nz">le = LabelEncoder()</span><span id="d9e2" class="nv kd jf nr b gy oi nx l ny nz">train_df["Age"] = le.fit_transform(train_df["Age"])</span><span id="a0ef" class="nv kd jf nr b gy oi nx l ny nz">train_df["Stay_In_Current_City_Years"] = le.fit_transform(train_df["Stay_In_Current_City_Years"])</span><span id="4776" class="nv kd jf nr b gy oi nx l ny nz">train_df["City_Category"] = le.fit_transform(train_df["City_Category"])</span><span id="0bdd" class="nv kd jf nr b gy oi nx l ny nz">train_df = pd.get_dummies(train_df, prefix=["Gender"])</span></pre><p id="f42d" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">转换后所有字段之间的相关性是什么？</p><p id="5f7d" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们创建一个相关值的热图。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oj"><img src="../Images/57be337cd4d4c591b7a99fec013eeb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yj6ImUsV8P-veqVbU2NcFw.png"/></div></div></figure><p id="bd76" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">根据热图，我们在购买和产品类别之间有一些关联。<br/>现在我们已经有了格式良好且干净的数据。因此，让我们创建两个数据框，一个用于所有独立字段，另一个用于相关字段(目标字段)。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="a9df" class="nv kd jf nr b gy nw nx l ny nz">X = train_df.drop(columns='Purchase')<br/>y = train_df['Purchase'].values</span><span id="e163" class="nv kd jf nr b gy oi nx l ny nz">Input shape -&gt; (550068, 11)<br/>Output shape -&gt; (550068,)</span></pre><p id="05ce" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">下一步是数据建模。</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="d648" class="kc kd jf bd ke kf nf kh ki kj ng kl km kn nh kp kq kr ni kt ku kv nj kx ky kz bi translated">4.数据建模和<strong class="ak">评估结果</strong></h1><p id="804a" class="pw-post-body-paragraph lh li jf lj b lk mg lm ln lo mh lq lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在这个阶段，我假设你已经很了解机器学习及其工作原理。所以，我们不打算在这篇文章中讨论这个理论。我们直接去训练几个<strong class="lj jg">有监督的机器学习</strong>模型，逐个评估结果。</p><p id="a6a2" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在此之前，我们将使用<strong class="lj jg"> train_test_split </strong>方法将我们所有的数据分成两组:训练集和测试集。训练集将用于适应我们的模型。训练数据总是用于学习、调整模型参数以及最小化输出误差。其余的数据(测试集)将用于评估结果。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="caa9" class="nv kd jf nr b gy nw nx l ny nz">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)</span></pre><p id="075b" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们将数据分为训练和测试，70%训练，30%测试。两个数据集形状是，</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="ab0c" class="nv kd jf nr b gy nw nx l ny nz">Input train shape -&gt; (385047, 11)<br/>Input test shape -&gt; (165021, 11)</span></pre><p id="ec3b" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg">机器学习模型:</strong></p><p id="9e65" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们照常从线性回归开始😅,</p><ol class=""><li id="112e" class="ml mm jf lj b lk ll lo lp ls mn lw mo ma mp me mq mr ms mt bi translated"><strong class="lj jg">线性回归</strong></li></ol><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="6d9c" class="nv kd jf nr b gy nw nx l ny nz">lr = LinearRegression(n_jobs=-1)<br/>train_and_evaluate(lr,X_train,y_train,X_test,y_test)</span></pre><p id="0e63" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在上面的代码片段中，我使用了<strong class="lj jg"> train_and_evaluate </strong>，这是我自己创建的一个方法。在该方法中，模型被输入训练数据，在模型被训练后，我们使用两个指标<strong class="lj jg"> R-2得分</strong>和<strong class="lj jg"> RMSE </strong>误差来评估模型的结果/性能。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="b146" class="nv kd jf nr b gy nw nx l ny nz">Train R-2 Score -&gt; 0.1530319738650423<br/>Test R-2 Score -&gt; 0.1502225848000539<br/><br/>=============================================<br/><br/>Train RMSE  -&gt; 4623.897758674754<br/>Test RMSE  -&gt; 4627.777465694635</span></pre><p id="72ff" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好吧，这个结果很糟糕。没想到这么低。让我们看看接下来会发生什么。</p><p id="d422" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg"> 2。KNN回归量</strong></p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="8365" class="nv kd jf nr b gy nw nx l ny nz">knnreg = KNeighborsRegressor(n_neighbors = 6)<br/>train_and_evaluate(knnreg,X_train,y_train,X_test,y_test)</span></pre><p id="fbf9" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">结果呢，</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="ab3f" class="nv kd jf nr b gy nw nx l ny nz">Train R-2 Score -&gt; 0.6867254458886132<br/>Test R-2 Score -&gt; 0.584082218078744<br/><br/>=============================================<br/><br/>Train RMSE  -&gt; 2812.1421834752146<br/>Test RMSE  -&gt; 3237.603187280763</span></pre><p id="b90c" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">这是好的，它比线性回归高得多，但在训练和测试R-2得分之间仍有如此大的差异。</p><p id="032a" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg"> 3。决策树回归器</strong></p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="5fb9" class="nv kd jf nr b gy nw nx l ny nz">dtr = DecisionTreeRegressor(max_depth=8,<br/>                            min_samples_split=5,<br/>                           max_leaf_nodes=10,<br/>                            min_samples_leaf=2,<br/>                            random_state=142)<br/>train_and_evaluate(dtr,X_train,y_train,X_test,y_test)</span></pre><p id="04af" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们用树回归器试试。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="a90c" class="nv kd jf nr b gy nw nx l ny nz">Train R-2 Score -&gt; 0.620705208649921<br/>Test R-2 Score -&gt; 0.6151249212697111</span><span id="0dc7" class="nv kd jf nr b gy oi nx l ny nz">=============================================</span><span id="1675" class="nv kd jf nr b gy oi nx l ny nz">Train RMSE  -&gt; 3094.305250315925<br/>Test RMSE  -&gt; 3114.4385769651567</span></pre><p id="2e12" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在，我们在训练和测试R-2分数之间的差异非常小。但是，它只有61%的准确性。</p><p id="433e" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg"> 4。随机森林回归器</strong></p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="87fb" class="nv kd jf nr b gy nw nx l ny nz">rf = RandomForestRegressor(max_depth=8,<br/>    min_samples_split=4,<br/>    min_samples_leaf=2,<br/>    random_state=142)<br/>train_and_evaluate(rf,X_train,y_train,X_test,y_test)</span></pre><p id="8ce9" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们试试森林回归器，因为树回归器没有给我们好的结果。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="cf5c" class="nv kd jf nr b gy nw nx l ny nz">Train R-2 Score -&gt; 0.6562463716226338<br/>Test R-2 Score -&gt; 0.6491769152142575<br/><br/>=============================================<br/><br/>Train RMSE  -&gt; 2945.7667802369456<br/>Test RMSE  -&gt; 2973.4727049991225</span></pre><p id="14ce" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在，我们得到了65%的准确率，这比树回归。</p><p id="57fd" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="lj jg"> 5。XGBoost回归器</strong></p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="5ffe" class="nv kd jf nr b gy nw nx l ny nz"># Various hyper-parameters to tune<br/>xgbr = XGBRegressor()<br/>parameters = {<br/>              'objective':['reg:squarederror'],<br/>              'learning_rate': [.03, 0.05, .07], #so called `eta` value<br/>              'max_depth': [5, 6, 7],<br/>              'min_child_weight': [4],<br/>              'subsample': [0.7],<br/>              'colsample_bytree': [0.7],<br/>              'n_estimators': [500]}</span><span id="f5f5" class="nv kd jf nr b gy oi nx l ny nz">xgb_grid = GridSearchCV(xgbr,<br/>                        parameters,<br/>                        cv = 5,<br/>                        n_jobs = -1,<br/>                        verbose=True)</span><span id="9e3d" class="nv kd jf nr b gy oi nx l ny nz">fitted_xgb = train_and_evaluate(xgb_grid,X_train,y_train,X_test,y_test)</span></pre><p id="1ae3" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们还将使用XGBRegressor的超参数调优方法，对超参数进行一些排列和组合。</p><pre class="nl nm nn no gt nq nr ns nt aw nu bi"><span id="0ef2" class="nv kd jf nr b gy nw nx l ny nz">Train R-2 Score -&gt; 0.6907706227786307<br/>Test R-2 Score -&gt; 0.6723572398432<br/><br/>=============================================<br/><br/>Train RMSE  -&gt; 2793.9272127493064<br/>Test RMSE  -&gt; 2873.5592924067096</span></pre><p id="f4a8" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">嗯，这一个突出的是好的。我们在测试数据中取得了67%的成绩。我们仍然可以实现更多，但在下一章。</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="c07e" class="kc kd jf bd ke kf nf kh ki kj ng kl km kn nh kp kq kr ni kt ku kv nj kx ky kz bi translated"><strong class="ak">结论</strong></h1><p id="8aad" class="pw-post-body-paragraph lh li jf lj b lk mg lm ln lo mh lq lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">机器学习可以用于各种任务。在这篇文章中，我们使用了一种机器学习算法来预测客户在黑色星期五可能会花费的金额。</p><p id="d5fe" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们几乎经历了<strong class="lj jg"> CRISP_DM </strong>的所有阶段，我们执行了探索性的数据分析，以从数据集中找到有趣的趋势，并用不同类型的机器学习模型训练模型。</p><p id="3986" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">所以，现在的问题是零售商能从这一切中得到什么？</p><p id="2cff" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">零售商现在有分析报告和经过训练的模型，这将帮助他们对消费者进行聚类，并根据聚类的特征提供各种类型的折扣。这是他们吸引消费者并达到目标的方式。</p><p id="5379" class="pw-post-body-paragraph lh li jf lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">你可以在这里找到笔记本<a class="ae np" href="https://github.com/EagleDangar/BlackFriday-prediction" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="ea1d" class="nv kd jf bd ke ok ol dn ki om on dp km ls oo op kq lw oq or ku ma os ot ky ou bi translated">谢谢你</h2></div></div>    
</body>
</html>