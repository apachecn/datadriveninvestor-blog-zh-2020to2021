# 多标签与多类别分类的实现

> 原文：<https://medium.datadriveninvestor.com/implementation-of-multi-label-vs-multi-class-classification-5dc60ada8804?source=collection_archive---------3----------------------->

> 我们将要讨论的内容是什么
> 
> 1-简介
> 
> 2-数据探索
> 
> 3-定义您的 Keras 模型架构
> 
> 4-结论

![](img/822f1f6d8094c6afe2472384d89db5a1.png)

# 介绍

在开始写代码之前，首先让我们理解多标签和多类之间的区别。

让我们通过一个例子来理解，有一种产品，我们总共给出了四个标签，如产品、价格、交付、包装和三个类别，如阳性、阴性和中性。

让我们更清楚地表明，有一个文本给出“这台电脑是宏伟的，它的捆绑也是可以接受的，但成本超过了我的财务限制。”

[](https://www.datadriveninvestor.com/2019/01/23/deep-learning-explained-in-7-steps/) [## 深度学习用 7 个步骤解释-更新|数据驱动的投资者

### 在深度学习的帮助下，自动驾驶汽车、Alexa、医学成像-小工具正在我们周围变得超级智能…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2019/01/23/deep-learning-explained-in-7-steps/) 

产出-产品-正，包装-正，价格-负，交付-中性

通过阅读这个例子，我很确定你清楚这两者之间的区别。

# 数据探索

让我们理解我们的数据

我们的数据集包含 4 列和 263394 行。列名是描述、分类、类别和严重性。

我们的目标是为分类、类别和严重性建立一个分类器。

我们总共需要执行 4 个步骤

## 步骤 1-探索性数据分析

打开 main.py 并插入以下代码

**第 1–24 行**导入我们的包。Enchant 用于检查拼写，pandas 用于加载数据集，numpy 用于数组操作，sklearn 用于编码标签并将数据集分为训练和测试，matplotlib 用于绘图，re 用于处理正则表达式模式，snowball 用于设计词干算法，我们还使用 keras api 进行深度学习任务。

1.2-下一步是加载数据集，同时加载快速文本单词嵌入文件。

嵌入文件的链接是[这个](https://fasttext.cc/docs/en/pretrained-vectors.html)。

1.3-现在检查数据集中缺失的值。如果存在任何缺失值，则将其删除。

1.4-分类列中有一些值，其格式为 1，234。我们需要把它转换成整数或浮点数。

1.5-现在统计分类、类别和严重性中的独特标签。

在分类栏中，总共有 65 个不同的标签，在分类栏中有 719 个标签，在严重性栏中有 10 个不同的标签。

1.6-现在让我们想象一下列的唯一值

现在将数据集分为训练和测试两部分。

## 步骤 2-数据预处理，或者在我们的例子中是文本预处理

这一步是清理数据的一个非常重要的方面。

现在，我们在先前加载的嵌入文件中索引每个单词。

下一步是执行拼写检查，并用最合适的单词替换它。

向前移动，现在删除所有的数字和空格

现在替换所有的 ip 地址和网址

现在定义一个函数来完成所有的文本处理任务，包括清理文本、将单词转换成小写字母以及用词干缩短单词。

之后，我们初始化一个空数组，并在 train_x 中运行一个文本循环，然后像 test_x 一样向其中添加或附加所有干净的单词。

现在我们对句子进行标记，并使其适合文本。之后，我们将每个文本转换成一个整数序列。

现在，我们使用 tokenizer.word_index 函数打印唯一令牌的数量。之后，我们在训练和测试数据中填充序列。我们应用这个是因为它确保了列表中的所有序列都有相同的长度

在我们的数据集中，有不同类型的预测

1-分类:a)分类。b)类别

2-连续:a)严重性

我们需要两种模型，一种是回归模型，另一种是分类模型。在分类中，分类列有不同类型的标签。因此，首先我们需要对这些标签进行编码，然后将它们转换为一次性编码。

以下函数执行这些任务

现在我们的下一步是准备嵌入矩阵。它是从原始空间到实值空间的线性映射，其中实体可以具有有意义的关系。

# 定义您的 Keras 模型架构

我们将创建两个模型，一个用于连续变量，另一个用于分类变量。

**回归模型架构:**

下一步是使用 Keras 定义我们的神经网络架构。这里我们将使用一个有一个输入层，两个隐藏层和一个输出层的网络

一旦我们定义了我们的神经网络架构，下一步就是编译它。我们使用 nadam 优化器编译我们的模型，以平均绝对误差作为损失函数，并将学习率设置为 0.001。

**分类模型架构:**

在这个模型中，我们将使用一个具有一个输入层、一个隐藏层和一个输出层的网络。

一旦我们定义了我们的神经网络架构，下一步就是编译它。我们使用具有二进制交叉熵的 nadam 优化器作为损失函数来编译我们的模型，并且设置学习率等于 0.001。

**根据数据拟合你的 Keras 模型**

现在我们称这两种模型为回归和分类。

最后，我们可以将模型保存到磁盘上，这样我们就可以在以后重用它，而不必重新训练它:

既然我们的 Keras 模型已经编译好了，我们就可以用我们的训练数据来拟合它了

之后，我们在测试数据上测试这两个模型，然后打印这两个模型的损失和准确性

# 结论

在这篇博客中，我们开始了解多类和多标签分类之间的区别。我们使用两个模型，一个是连续变量的回归模型，另一个是分类变量的分类模型。这个模型可以通过使用 K-Fold 交叉验证和进行一些特征工程来进一步改进。

如果你想了解更多关于令人敬畏的深度学习库的信息，那么请阅读这个[链接](https://medium.com/@abhisheksingh007226/top-4-libraries-you-must-know-before-diving-into-any-deep-learning-projects-61904286478d)上的惊人博客。

这篇文章的完整代码可以在 [Github](https://github.com/abhisingh007224/Multilabel-vs-Multiclass/tree/master/multilabel-multiclass-classifcation-master) 上找到。如果你有任何问题，请随意评论。关注我们更多即将推出的博客。

# 你可能想读一些其他的博客文章是

*   [使用 python 实时通知新冠肺炎病例](https://www.dataspoof.info/post/real-time-notifications-for-covid-19-cases-using-python)
*   [如何制作面部识别 webapp](https://www.dataspoof.info/post/facial-recognition-in-python-and-opencv)
*   [python 中的时间序列分析第一部分](https://www.dataspoof.info/post/time-series-analysis)
*   [python 中的时间序列预测实例](https://www.dataspoof.info/post/time-series-analysis-in-python-coding)