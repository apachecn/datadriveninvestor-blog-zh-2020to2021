<html>
<head>
<title>How to pick the best ML model ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何挑选最好的ML机型？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-to-pick-the-best-ml-model-69d1556763f4?source=collection_archive---------30-----------------------#2020-12-28">https://medium.datadriveninvestor.com/how-to-pick-the-best-ml-model-69d1556763f4?source=collection_archive---------30-----------------------#2020-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="57a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="http://becominghuman.ai" rel="noopener ugc nofollow" target="_blank">机器学习</a>模型建立在训练数据上，然后进行预测以解决业务问题。有很多模型(像SVM、决策树、随机森林、逻辑回归、朴素贝叶斯等。)其中可以内置<a class="ae kl" href="https://becominghuman.ai/machine-learning-concepts-every-data-scientist-should-know-4d70bed18a8a" rel="noopener ugc nofollow" target="_blank">机器学习</a>。</p><p id="bcbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择最佳模型有时颇具挑战性，因为我们需要找到具有最佳参数的正确模型。让我们考虑将SVM模型应用于特定数据集，为了优化该模型，我们必须决定核、C、γ等的参数。类似地，需要优化的其他模型也有不同的参数。优化的模型将给出最好的预测。这个优化超参数的过程被称为超参数调谐。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/f3b0dccd08893c4a07b72b0bcfb63e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*dAFqSXMmz35z21M6.jpg"/></div></figure><p id="acd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置这些参数和构建优化的模型是一个步骤，从这些模型中选择最佳模型是另一个步骤。让我们通过下面的例子来学习一种选择最佳模型的方法。</p><p id="1769" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本例中，我们将使用来自sk.learn的digits数据集，并构建逻辑回归、SVM、决策树分类器和随机森林分类器模型。让我们调整一些超参数，以获得优化的模型，并找到其中最好的。</p><p id="fe1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们用下面的代码获取数据</p><pre class="kn ko kp kq gt ku kv kw kx aw ky bi"><span id="cbdf" class="kz la iq kv b gy lb lc l ld le">from sklearn import datasets<br/>digits = datasets.load_digits()</span></pre><p id="9ee8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们导入构建上述模型所需的库。</p><pre class="kn ko kp kq gt ku kv kw kx aw ky bi"><span id="2307" class="kz la iq kv b gy lb lc l ld le">from sklearn import svm <br/>from sklearn.ensemble import RandomForestClassifier <br/>from sklearn.linear_model import LogisticRegression <br/>from sklearn.tree import DecisionTreeClassifier</span></pre><p id="4f2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们创建不同模型设置所需的配置字典，其中我们为digits数据集指定模型类型和这些模型的一些参数。</p><pre class="kn ko kp kq gt ku kv kw kx aw ky bi"><span id="d961" class="kz la iq kv b gy lb lc l ld le">model_parameters = {<br/>    <br/>    'logistic_regression' : {<br/>        'model': LogisticRegression(solver='liblinear',multi_class='auto'),<br/>        'params': {<br/>            'C': [1,5,10]<br/>        }<br/>    }, <br/>   <br/>    'svm': {<br/>        'model': svm.SVC(gamma='auto'),<br/>        'params' : {<br/>            'C': [1,10,20],<br/>            'kernel': ['rbf','linear','poly']<br/>        }  <br/>    },<br/>    <br/>    'decision_tree': {<br/>        'model': DecisionTreeClassifier(),<br/>        'params': {<br/>            'criterion': ['gini','entropy'],<br/>            <br/>        }<br/>     },<br/>     'random_forest': {<br/>        'model': RandomForestClassifier(),<br/>        'params' : {<br/>            'n_estimators': [1,10,20],<br/>            'criterion': ['gini','entropy'],<br/>            'bootstrap': ['True','False']<br/>        }<br/>    },<br/>}</span></pre><p id="26b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的字典中，我们为每个模型指定了几个参数。让我们看看其中的一些细节</p><p id="8f87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">逻辑回归</strong>:在逻辑回归中，我们将能够使用以下参数预测二元因变量。</p><ul class=""><li id="5f8e" class="lf lg iq jp b jq jr ju jv jy lh kc li kg lj kk lk ll lm ln bi translated"><em class="lo">解算器</em>是一个可用于最小化成本函数的参数。在这里，我们使用“liblinear”作为求解器的值，因为它是一个用于大型线性分类的库，并且在高维度下表现良好。</li><li id="bb61" class="lf lg iq jp b jq lp ju lq jy lr kc ls kg lt kk lk ll lm ln bi translated"><em class="lo"> Multi_class </em>默认设置为自动。c是正则化参数(到边距的距离)。</li><li id="a0a4" class="lf lg iq jp b jq lp ju lq jy lr kc ls kg lt kk lk ll lm ln bi translated"><em class="lo"> C参数</em>允许您决定要对错误分类的分数进行多少处罚。越低越好。默认情况下，该值为1。我们可以通过考虑不同的值来优化这一点。我用过1，5，10。</li></ul><p id="4abb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请记住，有许多其他参数的逻辑回归可以优化，但我只使用了几个，以简化解释。</p><p id="b513" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">【SVM】(支持向量</strong> <a class="ae kl" href="https://becominghuman.ai/machine-learning-using-logistic-regression-in-python-with-code-ab3c7f5f3bed" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">机器</strong> </a> <strong class="jp ir"> ) </strong>:有明显边距的分离数据是SVM。SVM有许多超参数。</p><ul class=""><li id="6ec3" class="lf lg iq jp b jq jr ju jv jy lh kc li kg lj kk lk ll lm ln bi translated"><em class="lo">内核</em>指定数据需要如何转换。选项可以是rbf(径向基函数)，线性，多项式。</li><li id="1497" class="lf lg iq jp b jq lp ju lq jy lr kc ls kg lt kk lk ll lm ln bi translated"><em class="lo"> C参数</em>允许您决定要对错误分类的分数进行多少处罚。默认情况下，该值为1。我们可以用1，10，20试试，看看哪个的分数更好。</li><li id="03e3" class="lf lg iq jp b jq lp ju lq jy lr kc ls kg lt kk lk ll lm ln bi translated"><em class="lo"> gamma </em>定义了单个训练样本的影响范围。如果值很低，那么它离边距很远。</li></ul><p id="a72f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">决策树</strong>:决策树有许多参数，我们可以通过这些参数指定分割标准，如基尼系数或熵、如何分割、扩展到什么程度、随机性等。如果我们不指定值，决策树分类器将选择缺省值。在这里，我使用了基尼系数和熵的标准。</p><div class="lu lv gp gr lw lx"><a href="https://www.datadriveninvestor.com/2020/11/19/how-machine-learning-and-artificial-intelligence-changing-the-face-of-ecommerce/" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab fo"><div class="lz ab ma cl cj mb"><h2 class="bd ir gy z fp mc fr fs md fu fw ip bi translated">机器学习和人工智能如何改变电子商务的面貌？|数据驱动…</h2><div class="me l"><h3 class="bd b gy z fp mc fr fs md fu fw dk translated">电子商务开发公司，现在，整合先进的客户体验到一个新的水平…</h3></div><div class="mf l"><p class="bd b dl z fp mc fr fs md fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml ks lx"/></div></div></a></div><p id="96b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">随机森林</strong>:这是一个估计器，它根据数据的各种子集拟合多个决策树，并对预测进行平均，从而提高准确性。该分类器将具有与决策树相似的参数，并且可以添加更少的参数。我们可以指定决策树的数量，使用什么标准(基尼或熵)，走多远(max_depth)。我们还可以指定bootstrap(是否使用bootstrap样本来构建树)，它可以是真或假等。在这里，我使用1，10，20作为n估计值，它指定考虑决策树的数量。标准是基尼系数或熵，自助法是真还是假。</p><p id="9870" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在指定了这个字典之后，我们可以迭代每个模型，并获得所有上述模型的准确度分数。为此，我们需要网格搜索cv，它可以从sklearn.model_selection导入。(下面的代码片段)</p><pre class="kn ko kp kq gt ku kv kw kx aw ky bi"><span id="f540" class="kz la iq kv b gy lb lc l ld le">from sklearn.model_selection import GridSearchCV<br/>import pandas as pd<br/>accuracy = []</span><span id="1694" class="kz la iq kv b gy mm lc l ld le">for model_name, mp in model_parameters.items():<br/>    clf =  GridSearchCV(mp['model'], mp['params'], cv=5, return_train_score=False)<br/>    clf.fit(digits.data, digits.target)<br/>    accuracy.append({<br/>        'model': model_name,<br/>        'best_accuracy': clf.best_score_,<br/>        'best_params': clf.best_params_<br/>    })<br/>    <br/>df = pd.DataFrame(accuracy,columns=['model','best_accuracy','best_params'])</span><span id="1d4b" class="kz la iq kv b gy mm lc l ld le">df.sort_values(by=['best_accuracy'],ascending=False)</span></pre><p id="c745" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码片段中，我使用交叉验证作为5。这意味着它每次预测时都使用不同的测试集，这样持续5次，得到所有测试集的平均值。在GridSearchCV被处理之后，我们得到了模型名称、最佳分数和最佳参数。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/1acde96fd62e02046c22292952df357b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bUQIpUex2DySPoFr.jpg"/></div></div></figure><p id="979a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们看看结果，从所有上述数字数据集模型，最好的模型是SVM，它给出了96%的准确性，最好的参数是C:1和内核:“聚”。</p><p id="69b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论:</strong></p><p id="a85a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种为优化模型而计算准确性分数的方法将为您提供基于数据的决策，以决定对您的业务问题应用何种模型。如果多个模型具有相同的精度，可以考虑计算资源和时间较少的模型。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="7d39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lo">原载于2020年12月27日</em><a class="ae kl" href="https://www.numpyninja.com/post/how-to-pick-the-best-ml-model" rel="noopener ugc nofollow" target="_blank"><em class="lo">【https://www.numpyninja.com】</em></a><em class="lo">。</em></p><p id="52b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获得专家视图— <a class="ae kl" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>