<html>
<head>
<title>Introduction to Machine Learning Algorithms-Multiple Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习算法介绍-多元线性回归</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/introduction-to-machine-learning-algorithms-multiple-linear-regression-a65c7ae8c2a6?source=collection_archive---------4-----------------------#2020-04-04">https://medium.datadriveninvestor.com/introduction-to-machine-learning-algorithms-multiple-linear-regression-a65c7ae8c2a6?source=collection_archive---------4-----------------------#2020-04-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ec3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于多元回归和如何构建多元回归，你需要知道的就是</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/30b2fd7b39cc7186135823a702df5c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mvc8H10UAodhU7yOe4vhQQ.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@vradenburg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Adam Vradenburg</a> on <a class="ae lb" href="https://unsplash.com/s/photos/lake?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="797d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的上一篇文章中，我讨论了如何处理只有一个因变量和一个自变量来预测模型的情况(线性回归)。你可以在下面找到这篇文章的链接</p><div class="lc ld gp gr le lf"><a href="https://medium.com/swlh/introduction-to-machine-learning-algorithms-linear-regression-39d422efa7dc" rel="noopener follow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">机器学习算法介绍-线性回归</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">人工智能(AI)使机器能够从经验中学习，适应新的输入并执行…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">medium.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt kv lf"/></div></div></a></div><p id="1c19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果有一个以上的独立变量怎么办，如果我们的模型需要一个以上的特征来预测结果呢？多元线性回归的概念来了。</p><div class="lc ld gp gr le lf"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">认知计算——一套被广泛认为是……</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">www.datadriveninvestor.c</p></div></div><div class="lo l"><div class="lu l lq lr ls lo lt kv lf"/></div></div></a></div><p id="a360" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多元线性回归也称为多元回归。这是线性回归分析最常见的形式。它解释了一个因变量和多个自变量之间的关系。</p><p id="6efc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回归的总体思想是检查两件事:</p><ol class=""><li id="e0fc" class="lv lw iq jp b jq jr ju jv jy lx kc ly kg lz kk ma mb mc md bi translated">具体来说，哪些变量/特征是结果变量的重要预测因素？</li><li id="789f" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">一组预测变量能很好地预测结果吗？</li></ol><p id="1ed6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多重回归由以下等式表示</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/d4ecf0f2602343385c8d5dc4e5bbc7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*XqF4psFNSL-_6GXgS1KG3Q.jpeg"/></div></figure><h1 id="32bd" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">监督学习</h1><p id="2bc1" class="pw-post-body-paragraph jn jo iq jp b jq ni js jt ju nj jw jx jy nk ka kb kc nl ke kf kg nm ki kj kk ij bi translated">监督式学习顾名思义是指作为老师的监督人的存在。训练数据将由与正确输出配对的输入组成。在训练期间，算法将在数据中搜索与期望输出相关的模式。在训练之后，它将接受新数据，该新数据将基于先前的训练数据来确定新输入将被分类为哪个标签。动机是预测新输入数据的正确标签。它可以写成</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/509554e05a5bbd918c9bdf86fb1869b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*Orc4ss6xB65KtflePlTYEQ.jpeg"/></div></figure><h1 id="56f2" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">我们来编码吧！</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="154e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们使用scikit-learn库来导入多元回归模型并直接使用它。在线上有许多数据集可用于线性回归。你可以在下面的链接中找到数据集和代码</p><div class="lc ld gp gr le lf"><a href="https://github.com/ajaymuktha/Machine-Learning" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">ajaymuktha/机器学习</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">在GitHub上创建一个帐户，为ajaymuktha/机器学习开发做贡献。</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="nq l lq lr ls lo lt kv lf"/></div></div></a></div><h1 id="32bf" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated"><strong class="ak">导入库</strong></h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr np l"/></div></figure><p id="20b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面几行代码中，我只是导入了这个过程中需要的所有库</p><p id="16f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Numpy →这是一个用于处理数组的库。</p><p id="6b01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Pandas →将数据文件作为Pandas数据框加载并分析数据。</p><p id="555d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Matplotlib →我已经导入pyplot来绘制数据的图形。</p><h1 id="5dbc" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated"><strong class="ak">导入数据</strong></h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr np l"/></div></figure><p id="9d7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的文件是CSV(逗号分隔值)格式，所以我们使用pandas导入文件。然后我们把数据分成因变量和自变量。x被认为是独立的，Y被认为是从属的。</p><p id="d91a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的数据集是关于创业公司的，包含五个特征</p><ol class=""><li id="b4a3" class="lv lw iq jp b jq jr ju jv jy lx kc ly kg lz kk ma mb mc md bi translated">花费在研发上的金额</li><li id="b78c" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">管理费用</li><li id="0298" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">营销费用</li><li id="b98e" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">创业的地点</li><li id="0685" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">创业获得的利润</li></ol><p id="3a7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们还将考虑因变量和自变量，根据上述特征，我们将利润视为因变量，其余视为自变量。</p><h1 id="d156" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">数据预处理</h1><p id="6b08" class="pw-post-body-paragraph jn jo iq jp b jq ni js jt ju nj jw jx jy nk ka kb kc nl ke kf kg nm ki kj kk ij bi translated">一切看起来还好吗？我不这么认为，我们需要在数据预处理方面下功夫。这里我们有一个分类变量，即位置。分类变量不能被机器处理，它应该被编码成一个数字。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr np l"/></div></figure><p id="061c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们使用LabelEncoder对文本进行编码，我们需要从scikit-learn导入Label Encoder包，为Label Encoder创建一个对象。位置的索引值是3，它属于X(自变量)，所以我们声明X[:，3]并且我们将使用fit_transform方法将文本转换为数字。</p><p id="ba78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，文本已经被数字所取代，如果有两个以上的类别，我们一直将整数分配给不同的类别，这会导致混乱。假设我们有四个类别，我们给第一个类别分配0，给最后一个类别分配3。但由于1大于0，3大于1，所以模型中的方程我们认为3比0优先级最高。为了解决这个问题，我们使用虚拟变量，其中n个类别有n个列，我们使用了<em class="ns"> OneHotEncoder </em>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/585d55be081ca6bb19d0e821d4d5c5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*XPBXymqjTSLHunDU33Jj3g.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">dummy variables</figcaption></figure><p id="3228" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我详细解释一下虚拟变量，上图是创建虚拟变量的例子。在图中，我们有三种不同类型的类别，所以我们为每个类别创建了每个列。当给定的类别等于相同的列类别时，我们分配一个或零。</p><p id="b343" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似于LabelEncoder，我们将为OneHotEncoder创建一个类，并为类别数赋值，在我们的问题中，我们有三个不同的类别，所以我们分配三个。</p><h1 id="0df1" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">训练装置和测试装置</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr np l"/></div></figure><p id="41fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从Sklearn的子库model_selection中，我已经导入了train_test_split，用于拆分训练集和测试集。我们可以使用train_test_split函数进行拆分。函数中的test_size = 0.2表示应该保留用于测试的数据的百分比。</p><h1 id="b4cc" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">现在让我们来拟合数据</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr np l"/></div></figure><p id="0ec5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从Sklearn的子库线性回归中，我们导入线性回归，并根据训练数据拟合模型。我们使用R2分数来衡量我们模型的准确性。</p><h1 id="a662" class="mk ml iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">预测测试结果</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr np l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/b624bb2ac37189b7b42a8e722468b40f.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*itKv7nZSxj1gLa3EhN3nWQ.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">R2-Score</figcaption></figure><p id="e982" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是我所做的总结。我已经加载了数据，将特征分为因变量和自变量，将分类数据编码为数字并创建虚拟变量，将数据分为训练集和测试集，将回归模型拟合到训练数据，基于该数据进行预测，并在测试数据上测试预测。</p><p id="c425" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个机器学习爱好者都必须了解回归，这也是想要学习机器学习的人的正确起点。暂时就这样吧！我希望你喜欢这篇文章。</p><p id="d7b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢</p><div class="lc ld gp gr le lf"><a href="https://www.superdatascience.com/blogs/the-ultimate-guide-to-regression-classification" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">回归和分类的终极指南-博客超级数据科学-大数据|分析…</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">欢迎来到回归和分类的第1部分——简单线性回归:第1步。你可能还记得这个概念…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">www.superdatascience.com</p></div></div><div class="lo l"><div class="nv l lq lr ls lo lt kv lf"/></div></div></a></div><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw np l"/></div></figure></div></div>    
</body>
</html>