<html>
<head>
<title>End To End Implementation of Data Science Pipeline in the Linear Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归模型中数据科学管道的端到端实现</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/end-to-end-implementation-data-science-pipeline-in-linear-regression-model-a2616fb5e251?source=collection_archive---------1-----------------------#2020-05-30">https://medium.datadriveninvestor.com/end-to-end-implementation-data-science-pipeline-in-linear-regression-model-a2616fb5e251?source=collection_archive---------1-----------------------#2020-05-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a83e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di"> H </span> ello世界！我的数据科学社区博客。在这里，我们将讨论线性回归的端到端实现。如果您对创建一个基本的端到端线性回归模型感兴趣，那么这篇文章非常适合您。</p><p id="5510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这一点开始，我们将实现一个逐步编码的例子，其思想是用python中最<strong class="jp ir">的原始</strong>编码风格和sklearn库实现回归。</p><p id="562b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文的步骤如下图所示:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ku"><img src="../Images/5764a06236e288dae759ccd712420635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qonehTPWqmCvqpdP7AtYag.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">End To End Pipeline of Linear Regression [‘Image Created By Dheeraj Kumar K’]</figcaption></figure><p id="3a6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在python中，相对较新的称为流水线的方法是通过将所有步骤结合在一起实现机器学习模型的经典方法。这里我们将讨论<strong class="jp ir">自行车共享需求回归</strong>数据集的端到端实现。</p><ol class=""><li id="e5d9" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated">加载数据集:这一步是数据连接层，我们必须从SQL、Excel、JSON、mongo等数据库中获取数据。</li></ol><p id="742d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">导入基本必需的库，</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="e186" class="ly lz iq lu b gy ma mb l mc md"># Import Libraries<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import warnings<br/>warnings.filterwarnings("ignore")</span><span id="2323" class="ly lz iq lu b gy me mb l mc md"># Load Dataset</span><span id="07bb" class="ly lz iq lu b gy me mb l mc md">df = pd.read_csv("E:\Downlload\Bike Sharing Dataset\hour.csv")<br/>df</span></pre><p id="10c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述代码将返回输出:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mf"><img src="../Images/b0b0828c830937a6825f8f5cca8190f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJI3dIV0541InaS1ynF-oA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Loaded Data Using Pandas as DataFrame</figcaption></figure><p id="8d88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。数据可视化:</strong>探索性数据分析被认为是机器学习建模中最重要的步骤，因为大多数问题都可以在良好的EDA的帮助下解决，我们可以从中获得巨大的洞察力。</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="12fc" class="ly lz iq lu b gy ma mb l mc md">def show_hist(x):<br/>    plt.rcParams["figure.figsize"] = 15,18<br/>    x.hist()<br/>show_hist(df)</span><span id="1501" class="ly lz iq lu b gy me mb l mc md">## The Above Code will return this output</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mg"><img src="../Images/b16f31681759692abc3794c5900adf78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uRMkha5Qb3rC6rtf7N06w.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Histogram [‘[‘Image Created By Dheeraj Kumar K’]’]</figcaption></figure><p id="b8ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个直方图中，我们可以看到大多数变量不是正态分布的，大多数数据科学家的重要主张或假设将是正态分布的。也许有时数据的性质可能是非正常的，这时我们可以不转换数据而继续进行。</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="69b6" class="ly lz iq lu b gy ma mb l mc md">def Show_PairPlot(x):<br/>    sns.pairplot(x)</span><span id="cc1c" class="ly lz iq lu b gy me mb l mc md">Show_PairPlot(df)<br/>## The Above Code will return this output</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mh"><img src="../Images/f5a638d52523ffe7d1cff97ece31b8c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s0ENMTA5GkmNzfTvwVH2FA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Pair plot [‘[‘Image Created By Dheeraj Kumar K’]’]</figcaption></figure><p id="f08c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结对图将让你了解变量之间的关系和分布。Pair Plot是识别趋势以进行后续分析的一种很好的技术，可以很容易地实现下面的代码。</p><div class="mi mj gp gr mk ml"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd ir gy z fp mq fr fs mr fu fw ip bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz le ml"/></div></div></a></div><p id="4909" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.<strong class="jp ir">数据预处理</strong>:数据清理是通过删除或修改不正确、不完整、不相关或格式不正确的数据，为分析准备数据的过程。数据科学中最重要的一步是数据清洗，在端到端数据科学项目中，60%的工作都与数据清洗有关。</p><p id="e68a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们做一些清洁工作，</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="7569" class="ly lz iq lu b gy ma mb l mc md"># Missing Values</span><span id="166b" class="ly lz iq lu b gy me mb l mc md">df.isna().sum()</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi na"><img src="../Images/feebb6f241b56221acc49e1351e2ae72.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*q0egT15gUpoBwfo8LgqAXQ.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">The output of checking Missing Values [‘Image Created By Dheeraj Kumar K’]</figcaption></figure><p id="6101" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一些，</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="40dd" class="ly lz iq lu b gy ma mb l mc md">df['Year'] = df['dteday'].str.split('-').str[0]<br/>df['Year'] = df['Year'].astype(int)</span><span id="86ea" class="ly lz iq lu b gy me mb l mc md">df['Month'] = df['dteday'].str.split('-').str[1]<br/>df['Month'] = df['Month'].astype(int)</span><span id="d962" class="ly lz iq lu b gy me mb l mc md">df['Date'] = df['dteday'].str.split('-').str[2]<br/>df['Date'] = df['Date'].astype(int)</span><span id="8f35" class="ly lz iq lu b gy me mb l mc md">df = df.drop(['dteday'],axis=1)<br/>df = df.drop(['yr'],axis=1)<br/>df = df.drop(['mnth'],axis=1)</span><span id="8007" class="ly lz iq lu b gy me mb l mc md">## The Above Code will return this output</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi nb"><img src="../Images/054f591bab6d35218e6ed25b2641a4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Gu24VraUVfrb7yz3uEdFQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">[‘Image Created By Dheeraj Kumar K’]</figcaption></figure><h2 id="a99d" class="ly lz iq bd nc nd ne dn nf ng nh dp ni jy nj nk nl kc nm nn no kg np nq nr ns bi translated">极端值</h2><p id="2f1f" class="pw-post-body-paragraph jn jo iq jp b jq nt js jt ju nu jw jx jy nv ka kb kc nw ke kf kg nx ki kj kk ij bi translated">从任何统计数据集中的归一化分布观测值中移除的统计观测值构成了异常值的要点。出现异常值的最常见原因包括测量或数据输入中的错误、损坏的数据以及超出正态分布的典型真实观察值。由于数据科学中数据集的本质，异常值的数学定义无法具体定义。</p><h2 id="8e26" class="ly lz iq bd nc nd ne dn nf ng nh dp ni jy nj nk nl kc nm nn no kg np nq nr ns bi translated">离群点检测</h2><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="f660" class="ly lz iq lu b gy ma mb l mc md">def outlier(x):<br/>    high=0<br/>    q1 = x.quantile(.25)<br/>    q3 = x.quantile(.75)<br/>    iqr = q3-q1<br/>    low = q1-1.5*iqr<br/>    high += q3+1.5*iqr<br/>    outlier = (x.loc[(x &lt; low) | (x &gt; high)])<br/>    return(outlier)</span><span id="1f72" class="ly lz iq lu b gy me mb l mc md">outlier(df['cnt']).count()</span><span id="3a72" class="ly lz iq lu b gy me mb l mc md">## The Above Code will return this output</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/31a81bd05bd7567083900fbc4ec90b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*MFIq6ClklKR_m1r1GMYkfA.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">The output of Outliers in Response Variable [‘Image Created By Dheeraj Kumar K’]</figcaption></figure><h2 id="d120" class="ly lz iq bd nc nd ne dn nf ng nh dp ni jy nj nk nl kc nm nn no kg np nq nr ns bi translated">剔除异常值</h2><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="ee68" class="ly lz iq lu b gy ma mb l mc md">q1 =df['cnt'].quantile(.25)<br/>q3 = df['cnt'].quantile(.75)<br/>iqr = q3-q1</span><span id="1c18" class="ly lz iq lu b gy me mb l mc md">df_new = df[~((df['cnt'] &lt; (q1 - 1.5 *iqr))  |  (df['cnt'] &gt; (q3+ 1.5 * iqr)))]</span></pre><h2 id="2d6e" class="ly lz iq bd nc nd ne dn nf ng nh dp ni jy nj nk nl kc nm nn no kg np nq nr ns bi translated">基本统计正态性检验</h2><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="de0f" class="ly lz iq lu b gy ma mb l mc md">from scipy.stats import anderson<br/>print('Anderson Darling Test :: ',anderson(df['cnt']))<br/>print('==============================================================================')</span><span id="9830" class="ly lz iq lu b gy me mb l mc md">from scipy.stats import shapiro<br/>print('Shapiro Wilk Test :: ',shapiro(df['cnt']))</span><span id="ac6f" class="ly lz iq lu b gy me mb l mc md">print('===============================================================================')</span><span id="a572" class="ly lz iq lu b gy me mb l mc md">from scipy.stats import kstest<br/>print('Kolmogorov–Smirnov Test :: ',kstest(df['cnt'],'norm'))</span><span id="79ee" class="ly lz iq lu b gy me mb l mc md">print('================================================================================')</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi nz"><img src="../Images/75c67e0148932845dfd5cd80656bb110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwI5cT21gMpc6kb0AWlmYA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Statistical Analysis Result [‘Image Created By Dheeraj Kumar K’]</figcaption></figure><p id="293a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。特性工程:</strong>什么是特性，为什么我们需要特性工程？所有机器学习算法都使用一些输入数据来创建输出。该输入数据包括特征，这些特征通常是结构化列的形式。算法需要具有某些特定特征的功能才能正常工作。这里，出现了对<strong class="jp ir">特征工程</strong>的需求。我认为特性工程的努力主要有两个目标:</p><ul class=""><li id="24e5" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk oa lq lr ls bi translated">准备适当的输入数据集，与机器学习算法要求兼容。</li><li id="1749" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk oa lq lr ls bi translated">提高机器学习模型的性能。</li></ul><p id="07e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们实现它，</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="5c0f" class="ly lz iq lu b gy ma mb l mc md">from scipy import stats<br/>import pylab<br/>from sklearn.preprocessing import PowerTransformer</span><span id="66c9" class="ly lz iq lu b gy me mb l mc md">pt = PowerTransformer(method='yeo-johnson', standardize=True,) <br/>df = pt.fit_transform(df)</span><span id="3a0e" class="ly lz iq lu b gy me mb l mc md">df = pd.DataFrame(df)</span><span id="6a9b" class="ly lz iq lu b gy me mb l mc md">df=df.rename(columns{0:'Intent',1:'Season',2:'hr',3:"holiday",4:"Weekday",5:"Workingday",6:"Weathersit",7:"hum",8:"Windspeed",9:"registered",10:"cnt",11:"year",12:"Month",13:"Date",14:"atemp",15:"Temp",16:"Cacual"})</span><span id="3bc2" class="ly lz iq lu b gy me mb l mc md">df<br/>## The Above Code will return this output</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi og"><img src="../Images/c269c6921ee5cb684244cbbdec982184.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzcaiO1HmZhvD6T7iizJqg.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">[‘Image Created By Dheeraj Kumar K’]</figcaption></figure><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="2fd0" class="ly lz iq lu b gy ma mb l mc md">def show_hist(x):<br/>    plt.rcParams["figure.figsize"] = 15,18<br/>    x.hist()<br/>show_hist(df)</span><span id="1687" class="ly lz iq lu b gy me mb l mc md">## The Above Code will return this output</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi oh"><img src="../Images/ddc7b363233258f296b4de8736252d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i1iQhXTpKMrDVF3EAaYjyw.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Histogram After Transformation [‘[‘Image Created By Dheeraj Kumar K’]’]</figcaption></figure><p id="a35e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的直方图中，与我们用原始数据绘制的直方图相比，您可以看到主要的正态分布差异。因此，正如我所说的，有时转换会起作用，有时可能不起作用，这取决于数据的性质。因为使用变换方法，这里不需要特征缩放，如果我们想这样做，没有问题，我们可以继续。</p><p id="e79c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.<strong class="jp ir">模型构建:</strong>当你在做一个模型，并且想要训练它的时候，你显然已经有了一个数据集。但是在训练之后，我们必须在一些测试数据集上测试该模型。为此，您将得到一个不同于之前使用的训练集的数据集。但是在开发阶段不可能总是有这么多的数据。</p><p id="002f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，显而易见的解决方案是将数据集分成两组，一组用于训练，另一组用于测试；在你开始训练你的模型之前，你要这样做。</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="7fe5" class="ly lz iq lu b gy ma mb l mc md">x = df.drop(['cnt'],axis=1)<br/>y = df['cnt']</span><span id="0f3f" class="ly lz iq lu b gy me mb l mc md">from sklearn.model_selection import train_test_split<br/>x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.30,random_state=40)</span></pre><p id="8d3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">建立统计模型，</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="3bc6" class="ly lz iq lu b gy ma mb l mc md">import statsmodels.api as sm<br/>model2 =sm.OLS(y_train,x_train).fit()</span><span id="09bf" class="ly lz iq lu b gy me mb l mc md">model2.summary()</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/811935b024289c8f16e941c6996d80e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*103wKEL6nXL6hKUjqTkDLQ.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">StatsModel Output [‘Image Created By Dheeraj Kumar K’]</figcaption></figure><h2 id="5d88" class="ly lz iq bd nc nd ne dn nf ng nh dp ni jy nj nk nl kc nm nn no kg np nq nr ns bi translated">线性回归模型</h2><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="cf7c" class="ly lz iq lu b gy ma mb l mc md">from sklearn.linear_model import LinearRegression<br/>lr = LinearRegression(copy_X=True, fit_intercept=True, n_jobs=0, normalize=False)</span><span id="554f" class="ly lz iq lu b gy me mb l mc md">LR =lr.fit(x_train,y_train)</span><span id="6037" class="ly lz iq lu b gy me mb l mc md">LR_Pred = lr.predict(x_test)</span><span id="3d18" class="ly lz iq lu b gy me mb l mc md">from sklearn import metrics<br/>print('ROOT EAN ERROR SQUARE:',np.sqrt(metrics.mean_squared_error(y_test,LR_Pred)))</span><span id="96cc" class="ly lz iq lu b gy me mb l mc md">from sklearn.metrics import r2_score<br/>print('R SQUARE:',r2_score(y_test,LR_Pred))</span><span id="202c" class="ly lz iq lu b gy me mb l mc md">import pickle<br/>pickle.dump(lr,open('LinearRegression.pkl','wb'))</span></pre><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi oj"><img src="../Images/dc32d1ad8b833c11ba4e173e1a41541e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SNjo1dWKxyw9J327FI1GA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Linear Regression Score [‘Image Created By Dheeraj Kumar K’]</figcaption></figure><h1 id="88eb" class="ok lz iq bd nc ol om on nf oo op oq ni or os ot nl ou ov ow no ox oy oz nr pa bi translated">烧瓶展开</h1><h1 id="ef9a" class="ok lz iq bd nc ol om on nf oo op oq ni or os ot nl ou ov ow no ox oy oz nr pa bi translated">烧瓶是什么？</h1><p id="3bc0" class="pw-post-body-paragraph jn jo iq jp b jq nt js jt ju nu jw jx jy nv ka kb kc nw ke kf kg nx ki kj kk ij bi translated">Flask是一个流行的Python web框架，这意味着它是一个用于开发web应用程序的第三方Python库。</p><h1 id="e39f" class="ok lz iq bd nc ol om on nf oo op oq ni or os ot nl ou ov ow no ox oy oz nr pa bi translated">为什么是烧瓶？</h1><ul class=""><li id="f45d" class="lk ll iq jp b jq nt ju nu jy pb kc pc kg pd kk oa lq lr ls bi translated">好用。</li><li id="dd7c" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk oa lq lr ls bi translated">内置的开发服务器和调试器。</li><li id="8022" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk oa lq lr ls bi translated">集成单元测试支持。</li><li id="a72c" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk oa lq lr ls bi translated">RESTful请求调度。</li><li id="b48e" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk oa lq lr ls bi translated">大量记录。</li></ul><h1 id="be76" class="ok lz iq bd nc ol om on nf oo op oq ni or os ot nl ou ov ow no ox oy oz nr pa bi translated">项目结构</h1><p id="0a3b" class="pw-post-body-paragraph jn jo iq jp b jq nt js jt ju nu jw jx jy nv ka kb kc nw ke kf kg nx ki kj kk ij bi translated">该项目有四个部分:</p><ol class=""><li id="6437" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated">model.py包含机器学习模型的代码，使用机器学习模型预测自行车共享需求。</li><li id="96e4" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk lp lq lr ls bi translated">app.py —它包含Flask APIs，这些API通过GUI或API调用接收预测细节，根据我们的模型计算预测值，并将其返回。</li><li id="7661" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk lp lq lr ls bi translated">request.py —它使用请求模块调用app.py中定义的API，并显示返回值。</li><li id="091c" class="lk ll iq jp b jq ob ju oc jy od kc oe kg of kk lp lq lr ls bi translated">HTML/CSS —它包含HTML模板和CSS样式，允许用户输入自行车共享的详细信息，并显示预测的需求。</li></ol><p id="b693" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先让我们用HTML和CSS编码</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="483a" class="ly lz iq lu b gy ma mb l mc md">&lt;html &gt;<br/>&lt;!--From <a class="ae pe" href="https://codepen.io/frytyler/pen/EGdtg--" rel="noopener ugc nofollow" target="_blank">https://codepen.io/frytyler/pen/EGdtg--</a>&gt;<br/>&lt;head&gt;<br/>  &lt;meta charset="utf-8"&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae pe" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"&gt;<br/>  &lt;script src="<a class="ae pe" href="https://ajax.googleapis.com/ajax/libs/jquery/4.4.1/jquery.min.js" rel="noopener ugc nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/jquery/4.4.1/jquery.min.js</a>"&gt;&lt;/script&gt;<br/>  &lt;script src="<a class="ae pe" href="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js</a>"&gt;&lt;/script&gt;<br/>  &lt;script src="<a class="ae pe" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js</a>"&gt;&lt;/script&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae pe" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css</a>"&gt;<br/>&lt;title&gt;Home&lt;/title&gt;<br/> &lt;!-- &lt;link rel="stylesheet" type="text/css" href="../static/css/styles.css"&gt; --&gt;<br/> &lt;link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css') }}"&gt;<br/>  <br/>&lt;/head&gt;<br/>&lt;style&gt;<br/>body { <br/> width: 100%;<br/> height:10%;<br/> font-family: 'Open Sans', sans-serif;<br/> background: #6b66b8;<br/> color: #fff;<br/> font-size: 28px;<br/> text-align:center;<br/> letter-spacing:1.2px;<br/> <br/>}<br/>&lt;/style&gt;<br/>&lt;style&gt;<br/>#ip4 {<br/>    border-radius: 15px 50px 30px;<br/>    border: 2px solid #609;<br/>    padding: 20px; <br/>    width: 300px;<br/>    height: 15px; <br/>}<br/>&lt;/style&gt;<br/>&lt;body&gt;<br/>&lt;div&gt;</span><span id="09e4" class="ly lz iq lu b gy me mb l mc md">&lt;!--navbar portion--&gt;<br/>  &lt;nav class="navbar navbar-expand-sm bg-dark fixed-top"&gt;<br/>  &lt;a class="navbar-brand" href="#"&gt;&lt;b&gt;Bike Sharing Demand Prediction&lt;/b&gt;&lt;/a&gt;<br/>  &lt;a class="navbar-brand" href="#"&gt;&lt;b&gt;&lt;font size="2"&gt;BY DHEERAJ KUMAR&lt;/font&gt;&lt;/b&gt;&lt;/a&gt;<br/>  &lt;ul class="navbar-nav" &gt;<br/>    &lt;li class="nav-item"&gt;<br/>    &lt;/li&gt;<br/>    &lt;li class="nav-item"&gt;<br/>    &lt;/li&gt;<br/>  &lt;/ul&gt;<br/>&lt;/nav&gt;<br/>&lt;br&gt;<br/>&lt;/div&gt;<br/>&lt;body&gt;<br/>&lt;br&gt;<br/> &lt;div class="login"&gt;<br/> &lt;h1&gt;Bike Sharing Demand Prediction&lt;/h1&gt;</span><span id="b4bc" class="ly lz iq lu b gy me mb l mc md">&lt;!-- Main Input For Receiving Query to our ML --&gt;<br/>    &lt;form action="{{ url_for('predict')}}"method="post"&gt;<br/>    &lt;input type="text" name="year" placeholder="year" required="required" id="ip4"/&gt;<br/>        &lt;input type="text" name="month" placeholder="month" required="required" id="ip4" /&gt;<br/>  &lt;input type="text" name="holiday" placeholder="holiday" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="weekday" placeholder="weekday" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="working day" placeholder="working day" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="weathersit" placeholder="weathersit" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="temp" placeholder="temp" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="atemp" placeholder="atemp" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="hum" placeholder="hum" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="windspread" placeholder="windspread" required="required" id="ip4"/&gt;<br/>                &lt;input type="text" name="registred" placeholder="registred" required="required" id="ip4"/&gt; <br/>                &lt;input type="text" name="hr" placeholder="hr" required="required" id="ip4"/&gt;<br/>&lt;br&gt;   <br/>&lt;br&gt;</span><span id="c31b" class="ly lz iq lu b gy me mb l mc md">&lt;input type="submit" class="btn-primary"value="predict"&gt;<br/>    &lt;/form&gt;</span><span id="e256" class="ly lz iq lu b gy me mb l mc md">&lt;br&gt;<br/>   &lt;br&gt;<br/>   {{ prediction_text }}</span><span id="68c8" class="ly lz iq lu b gy me mb l mc md">&lt;/div&gt;</span><span id="6339" class="ly lz iq lu b gy me mb l mc md">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="675a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们用FLASK编码</p><pre class="kv kw kx ky gt lt lu lv lw aw lx bi"><span id="6581" class="ly lz iq lu b gy ma mb l mc md">import numpy as np<br/>from flask import Flask, request, jsonify, render_template<br/>import pickle</span><span id="4fb0" class="ly lz iq lu b gy me mb l mc md">app = Flask(__name__)<br/>lr= pickle.load(open('LinearRegression.pkl', 'rb'))</span><span id="e65b" class="ly lz iq lu b gy me mb l mc md"><a class="ae pe" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/')<br/>def home():<br/>    return render_template('index.html')</span><span id="51df" class="ly lz iq lu b gy me mb l mc md"><a class="ae pe" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/predict',methods=['POST'])<br/>def predict():<br/>    '''<br/>    For rendering results on HTML GUI<br/>    '''<br/>    int_features = [int(x) for x in request.form.values()]<br/>    final_features = [np.array(int_features)]<br/>    prediction = lr.predict(final_features)</span><span id="c002" class="ly lz iq lu b gy me mb l mc md">output = round(prediction[0], 2)</span><span id="3542" class="ly lz iq lu b gy me mb l mc md">return render_template('index.html', prediction_text='Bike Sharing Demand Count should be  {}'.format(output))</span><span id="4f50" class="ly lz iq lu b gy me mb l mc md"><a class="ae pe" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/predict_api',methods=['POST'])<br/>def predict_api():<br/>    '''<br/>    For direct API calls trought request<br/>    '''<br/>    data = request.get_json(force=True)<br/>    prediction = lr.predict([np.array(list(data.values()))])</span><span id="9c22" class="ly lz iq lu b gy me mb l mc md">output = prediction[0]<br/>    return jsonify(output)</span><span id="ba06" class="ly lz iq lu b gy me mb l mc md">if __name__ == "__main__":<br/>    app.run(debug=True)</span></pre><h1 id="12ff" class="ok lz iq bd nc ol om on nf oo op oq ni or os ot nl ou ov ow no ox oy oz nr pa bi translated">输出</h1><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi pf"><img src="../Images/868b890e265c3c65c483e1e7c03bd553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OD_cNBNhF89k8JdmnKhIA.png"/></div></div></figure><h1 id="f9c3" class="ok lz iq bd nc ol om on nf oo op oq ni or os ot nl ou ov ow no ox oy oz nr pa bi translated">结论</h1><p id="0b01" class="pw-post-body-paragraph jn jo iq jp b jq nt js jt ju nu jw jx jy nv ka kb kc nw ke kf kg nx ki kj kk ij bi translated">在这篇博客中，我们从零开始实现了线性回归的实现。这个博客到此为止。完整的代码可以在这个GitHub <a class="ae pe" href="https://github.com/DheerajKumar97/Bike-Sharing-Demand-Dataset" rel="noopener ugc nofollow" target="_blank"> repo </a>中找到。此外，我们还没有涵盖文章中提到的统计部分。但是，我想，这有助于探索其他测试和方法。</p><p id="8288" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="pg">如果你喜欢这篇文章，请给我掌声，并帮助其他人找到它。</em></p><p id="bada" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，让我知道我是否错过了线性回归的端到端实现的任何东西。</p><p id="e016" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与我联系:- <a class="ae pe" href="https://www.linkedin.com/in/dheerajkumar1997/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><p id="c8c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与我联系:- <a class="ae pe" href="https://github.com/DheerajKumar97" rel="noopener ugc nofollow" target="_blank"> Github </a></p><figure class="kv kw kx ky gt kz"><div class="bz fp l di"><div class="ph pi l"/></div></figure></div></div>    
</body>
</html>