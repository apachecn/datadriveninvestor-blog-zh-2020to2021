<html>
<head>
<title>How Does DingTalk Cope with Traffic Spikes during the COVID-19 Outbreak Using ROS?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在新冠肺炎病毒爆发期间，DingTalk如何使用ROS应对流量高峰？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/how-does-dingtalk-cope-with-traffic-spikes-during-the-covid-19-outbreak-using-ros-31e1ae8ae4e5?source=collection_archive---------17-----------------------#2020-03-19">https://medium.datadriveninvestor.com/how-does-dingtalk-cope-with-traffic-spikes-during-the-covid-19-outbreak-using-ros-31e1ae8ae4e5?source=collection_archive---------17-----------------------#2020-03-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3a56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由ECS团队完成。</p><p id="223d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">DingTalk是阿里巴巴集团推出的面向企业的即时通讯软件，向企业用户提供在线组织、在线交流、在线协作、在线商务、在线生态系统等功能。DingTalk已经服务了超过1000万企业客户，最近还扩展到教育市场，提供丰富的远程课堂解决方案。到目前为止，DingTalk拥有超过2亿用户，是中国最大的移动办公应用。2020年2月5日，DingTalk在苹果的App Store中排名免费应用№1。其底层计算资源由阿里云计算提供。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/3f558319dac622627ce76da5027d5da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oxpWtertUZy71jSk.png"/></div></div></figure><h1 id="8b9f" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最近疫情爆发带来的新挑战</h1><p id="68fd" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">由于最近冠状病毒爆发导致的旅行限制，世界各地对在线教育和在线办公应用的需求不断增长，尤其是在Mainland China。许多企业首选的在线办公软件DingTalk的用户流量激增，尤其是对视频会议和直播有需求的用户。为了响应中国教育部门关于坚持在实体课堂之外学习的号召，DingTalk为老师们提供了免费试听的线上课堂。</p><p id="8f78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">丁谈的流量激增带来了资源规模扩大的技术挑战。当中小学生在网上发泄对DingTalk表现的愤怒，同时开玩笑说要给DingTalk一颗星的五星评级时，DingTalk陷入了困境。在网民的负面意见中，一条发人深省的评论出现在互联网上:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mb"><img src="../Images/982c0df9af720c81eb0c23864023c58c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fFu2enLmTVSqhSnw.png"/></div></div></figure><p id="6c74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自1月28日以来，来自视听会议和直播的访问流量成倍增长。在云上开发的DingTalk是阿里云最初努力资源规模化的目标，以卓越的体验满足在家办公和学习的用户需求。那么，DingTalk是如何做到这一点的呢？</p><div class="mc md gp gr me mf"><a href="https://www.datadriveninvestor.com/2020/03/11/cloud-made-simple-for-undecided-career-change-planners-the-fundamentals/" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">云让犹豫不决的职业生涯规划者变得简单:基础|数据驱动的投资者</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">尽管IT在当今的商业中扮演着重要的角色，但许多IT求职者都不愿意从事云计算职业…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt kw mf"/></div></div></a></div><h1 id="fc13" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">大规模扩张的两大挑战:效率和资源供应</h1><h1 id="9030" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">手动扩展的挑战:效率低</h1><p id="dacd" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">紧迫的最后期限。DingTalk技术团队必须在短短几天内解决流量激增的问题。自1月29日以来，DingTalk团队一直致力于阿里云的规模扩张。截至2月2日，资源仅扩大了几倍，从最初的20，000个vcpu增加到30，000个vcpu，严重不足以满足业务需求。</p><p id="5461" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复杂的购买和配置程序。与单个集群的<a class="ae mu" href="https://www.alibabacloud.com/product/ecs?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">弹性计算服务</a> (ECS)不同，DingTalk的系统架构包含了多种资源，包括<a class="ae mu" href="https://www.alibabacloud.com/product/server-load-balancer?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">服务器负载均衡器</a> (SLB)、用于MongoDB的<a class="ae mu" href="https://www.alibabacloud.com/product/apsaradb-for-mongodb?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">ApsaraDB</a>、用于Redis的<a class="ae mu" href="https://www.alibabacloud.com/product/apsaradb-for-redis?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">ApsaraDB</a>以及弹性IP (EIP)。这些资源需要单独购买，它们之间的关系需要手动配置。</p><p id="34e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">手动部署效率低下，错误率高。DingTalk拥有庞大的用户群。手动部署一个集群大约需要1个小时，一次只能同时运行3到4个集群。部署过程需要许多配置步骤，这很容易出错。</p><p id="f269" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复杂部署。集群服务功能是自我封闭的，可以无限制地扩展，但这会增加部署的复杂性。鼎谈的放大项目涉及8个地区和16个区。传统部署方法可能会降低纵向扩展效率，并增加大型群集管理的复杂性。为了让数以亿计的员工和学生能够在家工作和学习，DingTalk团队需要在短时间内扩展近1000个集群。管理一千个资源的关系是困难的，更不用说超过一百万的情况了。</p><p id="0095" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在手动部署模式下容错能力差，故障排除困难。不同集群之间经常会出现配置差异。例如，一个集群使用端口300作为SLB监听端口，而另一个集群出于相同目的使用端口3000。这使得故障排除变得困难。</p><p id="69c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">DingTalk团队还面临着创建和操作大规模集群的巨大技术挑战。</p><h1 id="f022" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">通过ROS快速自动部署</h1><p id="9fb4" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">在2月2日流量高峰出现之前，DingTalk使用阿里云<a class="ae mu" href="https://www.alibabacloud.com/product/ros?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">资源协调服务</a> (ROS)来提高集群部署效率，实现快速集群扩展。ROS在短短2小时内帮助DingTalk部署了超过10000个ECS实例，创下了阿里云快速规模化的新纪录。</p><h1 id="7d1e" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">ROS是什么？</h1><p id="34f8" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><a class="ae mu" href="https://www.alibabacloud.com/product/ros?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">阿里云ROS </a>是一个编排服务，帮助你自动创建、更新、删除云资源。ROS使用堆栈(一种逻辑集合)来集中管理分组的云资源。对于阿里云来说，栈就是一组阿里云资源。ROS允许您以资源栈的形式创建、删除和克隆云资源。通过在DevOps实践中使用ROS，您可以轻松地克隆开发、测试和生产环境，并整体迁移和扩展应用程序。</p><h1 id="6ee6" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">基础设施作为代码</h1><p id="168a" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ROS是阿里云提供的基础设施即代码(IaC)解决方案，快速实现IaC作为DevOps的关键组件。</p><h1 id="fab3" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">全面管理的自动化服务</h1><p id="a51e" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ROS是一项完全托管的服务，不需要您购买任何资源来使用ROS，这样您就可以专注于资源模板中定义的业务云资源。托管自动化加速了创建对应于多个堆栈的多个项目的过程。</p><h1 id="55ad" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">可重复部署</h1><p id="c87c" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">您可以使用相同的模板为开发、测试和生产环境部署资源。您可以为不同的环境设置不同的参数值。例如，您可以将测试环境中的ECS实例数量设置为2，将生产环境中的ECS实例数量设置为20。您还可以使用相同的模板将资源部署到多个地区。这提高了多区域部署的效率。</p><h1 id="c735" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">标准化部署</h1><p id="1d3d" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">实际上，不同环境中的细微差异通常会导致复杂的管理和高昂的成本，延长故障排除时间，并干扰您的正常业务运营。通过使用ROS进行重复部署，您可以标准化部署环境，最小化不同环境之间的差异，并将环境配置设置到模板中。类似于代码管理的严格管理过程可以确保标准化的部署实践。</p><h1 id="b74e" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">统一的身份验证、安全性和审计</h1><p id="823b" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">与其他同类产品相比，阿里云的原生IaC服务ROS提供了与其他阿里云服务的更好集成。与<a class="ae mu" href="https://www.alibabacloud.com/product/ram?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">资源访问管理</a> (RAM)的集成提供了统一的认证，无需建立单独的用户认证系统。所有云产品上的操作都是通过API调用的。这样，您可以使用ActionTrail来检查所有的&amp; M操作，包括那些在ROS上的操作。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mv"><img src="../Images/9ed62a88387f47bea125bc988d5e1ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BxjOuu49b5Zjh4FL.png"/></div></div></figure><h1 id="e899" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">ROS如何为DingTalk实现向上扩展？</h1><h1 id="908c" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">定义资源模板</h1><p id="a21e" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ROS帮助DingTalk在阿里云快速创建描述所需资源(如ECS实例、数据库实例)的模板，以定义DingTalk的集群架构。ROS提供了一个可视化编辑器，用于通过拖放来创建模板。创建模板后，ROS自动创建和配置模板描述的资源来实现IaC。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mw"><img src="../Images/be709bfdcb93c206f8337585b3e5939e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z4pV-giwcPR3ttS-.png"/></div></div></figure><h1 id="3858" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">解析和运行模板</h1><p id="d3df" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">当收到栈创建请求时，ROS在创建栈之前解析模板。解析包括语法检查、参数验证和依赖性分析。</p><p id="c9ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">依赖性分析旨在出于两个目的分析资源之间的依赖性:</p><ul class=""><li id="6949" class="mx my iq jp b jq jr ju jv jy mz kc na kg nb kk nc nd ne nf bi translated">确保资源创建的正确性。如果资源A依赖于资源B，那么资源B在资源A之前创建。</li><li id="cfe0" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk nc nd ne nf bi translated">提供并行创建功能。没有依赖关系的资源可以并行创建。</li></ul><p id="5daf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模板解析后，ROS根据依赖关系中的角色逐个创建资源，类似于状态机机制。</p><p id="3229" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">资源模板可以快速重复部署，尤其是在多地区和多区域的情况下。这样减少了环境之间的差异，规范了部署过程和结果，减少了环境差异带来的系统问题。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nl"><img src="../Images/48e9524eda883ca58977b2ba9a1508e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vZob60YjK40HaB29.png"/></div></div></figure><h1 id="3d34" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">摘要</h1><p id="c18e" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">阿里云<a class="ae mu" href="https://www.alibabacloud.com/product/ros?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank">资源编排服务</a> (ROS)帮助DingTalk以渐进和快速的方式扩大和部署了10万个ECS实例，效率提高了100倍，创下了阿里云的记录。</p><p id="7e10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前，ROS平均每分钟可以扩展一个集群，每天可以扩展超过一百万个vCPUs。回收和释放数百万资源是一个巨大的工程。ROS提供了一键销毁功能，自动回收集群中的所有资源，避免了麻烦的操作和遗漏。</p><p id="d85e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">弹性是云计算的最大优势，支持提供全民受益的便捷服务。作为阿里云原生的自动编排和部署服务，ROS最大限度地发挥了云计算的弹性，为DingTalk提供了强大的支持，使其成为最受欢迎和最精简的在线交流平台。</p><p id="6094" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">在继续与全球爆发的冠状病毒作战的同时，阿里云将发挥自己的作用，并尽一切努力帮助其他人与冠状病毒作战。点击</em><a class="ae mu" href="https://www.alibabacloud.com/campaign/supports-your-business-anytime?spm=a2c41.14153179.0.0" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://www . Alibaba cloud . com/campaign/supports-your-business-anytime</em></a>了解我们如何支持您的业务连续性</p><h1 id="93f3" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">原始来源:</h1><div class="mc md gp gr me mf"><a href="https://www.alibabacloud.com/blog/595963?spm=a2c41.14153179.0.0" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">在新冠肺炎爆发期间，DingTalk如何使用ROS应对流量高峰？</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">阿里巴巴Clouder 2020年3月11日11,591 DingTalk是阿里巴巴推出的面向企业的即时通讯软件…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">www.alibabacloud.com</p></div></div><div class="mo l"><div class="nm l mq mr ms mo mt kw mf"/></div></div></a></div><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nn no l"/></div></figure></div></div>    
</body>
</html>