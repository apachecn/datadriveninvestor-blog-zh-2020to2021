<html>
<head>
<title>Algo Trading can change your future!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">算法交易可以改变你的未来！</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/algo-trading-can-change-your-future-455e89ddaf7?source=collection_archive---------4-----------------------#2020-02-14">https://medium.datadriveninvestor.com/algo-trading-can-change-your-future-455e89ddaf7?source=collection_archive---------4-----------------------#2020-02-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7020" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数学技术，即ARIMA、频率分解、傅立叶滤波、线性回归&amp;基于特征工程股票市场数据的双向LSTMs。</p><p id="bb46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">“当天气改变时，没人相信物理定律改变了它”</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/47846ee7e934ee18484e98ff3a7a6e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*pmwLFWBQnR1zAyg-xk0new.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://blog.quantinsti.com/why-you-should-be-doing-algorithmic-trading/" rel="noopener ugc nofollow" target="_blank">Image Courtesy</a></figcaption></figure><p id="b0d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果人工智能可以预测未来，那么为什么不能预测股票价格呢？谁不喜欢有钱？但是说起来容易做起来难。市场情绪可能不仅取决于技术因素，还取决于政治局势、产品突破、公司并购甚至最近的新闻字节。<strong class="jp ir">如何客观量化所有这些因素来预测股票供求曲线？</strong>嗯，这听起来可能令人生畏，但这在雄心勃勃的可能范围之内！</p><p id="0f33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们介绍一些数学技术来分析股票市场的时间序列数据并预测未来曲线。如果你是那些对应用机器学习进行交易感到好奇，但不确定从哪里开始的人之一，那么你就来对地方了。</p><div class="kz la gp gr lb lc"><a href="https://www.datadriveninvestor.com/2020/02/19/cognitive-computing-a-skill-set-widely-considered-to-be-the-most-vital-manifestation-of-artificial-intelligence/" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd ir gy z fp lh fr fs li fu fw ip bi translated">认知计算——一套被广泛认为是……</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">作为它的用户，我们已经习惯了科技。这些天几乎没有什么是司空见惯的…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq ks lc"/></div></div></a></div><p id="ad68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有技术和各自数据集的源代码可以在<a class="ae ky" href="https://github.com/AdroitAnandAI/Algo-Trading-Math-Models" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="be35" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">定量交易</h1><p id="099b" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">量化策略遵循数据驱动的方法来挑选股票。这种试图减少人为偏见的方法在概念上介于主动交易和被动交易之间。股票数据是“时间序列”的一个典型例子，其中价格以固定的间隔被采样。</p><h1 id="b783" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">时间序列数据</strong></h1><p id="f871" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">时间序列是按时间顺序索引的一系列数据点<strong class="jp ir">。时间序列的两个属性是:</strong></p><ul class=""><li id="d36c" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated"><strong class="jp ir">周期性</strong>:数据中有重复模式时。</li><li id="2ec2" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><strong class="jp ir">趋势</strong>:当曲线的平均值<strong class="jp ir">随时间增加</strong>时。</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/bafd7118a70509ea12607710d20f9710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*bKN-g5pj4kbNlTbU.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Time Series: Periodic &amp; Trending</figcaption></figure><p id="7e9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">高斯分布是数学家们最喜欢的分布，因为它有明确的特征。同样，<strong class="jp ir">如果时间序列是平稳的，那么就很容易预测。</strong></p><p id="8743" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">平稳时间序列</strong></p><p id="3432" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当<strong class="jp ir">满足三个条件</strong>时，时间序列是平稳的</p><ol class=""><li id="4da4" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk nj na nb nc bi translated"><strong class="jp ir">均值常数:</strong>一个窗口值的平均值随时间是常数。(无上升或下降趋势)</li><li id="c867" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk nj na nb nc bi translated"><strong class="jp ir">方差常数</strong>:窗口中值的方差应该是常数。</li><li id="9108" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk nj na nb nc bi translated"><strong class="jp ir">协方差只是间隙</strong>的函数:值的互变性不应随时间变化，但可以随间隙变化。</li></ol><h1 id="b789" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak"> A .数据准备</strong></h1><p id="6ad1" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">在现实世界中，<strong class="jp ir">时间序列同样包含噪声、趋势和季节性</strong>。趋势会导致均值随时间变化，而季节性会导致方差随时间变化。因此，在数据准备阶段，我们需要在建模之前诱导信号的平稳性和去噪。</p><p id="b7c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> i)诱导平稳性</strong></p><p id="055f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似于将非高斯分布转换为高斯分布的box-cox变换或log变换，有两种方法将非平稳时间序列转换为平稳时间序列<strong class="jp ir">。</strong></p><ol class=""><li id="4935" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk nj na nb nc bi translated"><strong class="jp ir">转换:</strong>如果序列为对数正态，则取对数(值)</li><li id="e88e" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk nj na nb nc bi translated"><strong class="jp ir">求差:</strong>类似于求差，取与前一值的差</li></ol><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/9d740fb64f3890cb80ebcb4064be6445.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*cwxeye3n9rsxfcS42cHceg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">First &amp; Second order differences</figcaption></figure><p id="9344" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">二阶差分比一阶差分更可能是平稳的。</strong>因此，你可以做<strong class="jp ir">四阶差分</strong>来尝试使数值稳定。如您所知，只有对数正态或线性级数等少数分布可以转换为高斯分布。同样，不是所有的时间序列都是平稳的，但四阶差分在实践中效果很好。这里，d是一个超参数。</p><p id="fe85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">如何识别平稳与非平稳TS？</strong></p><p id="d142" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就像我们做<strong class="jp ir"> QQ图</strong>来检查分布是否是高斯分布一样，一个简单的平稳性检查是<strong class="jp ir">目测检查</strong>以上3个条件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/3bd1fdf65e8e4751118a1f60129da614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*kVTh4PxLOLHfwwx-TDFYmw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Second curve is trending down. Hence, not stationary.</figcaption></figure><p id="5463" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似于KS检验或Anderson Darling (AD)检验来<strong class="jp ir">统计检查</strong>一个分布是否为高斯分布，可以做<strong class="jp ir">增广-Dickey Fuller检验(ADF) </strong>来检查时间序列是否平稳。</p><p id="4ecb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> ii)傅立叶滤波</strong></p><p id="5d4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">傅立叶滤波<strong class="jp ir">有助于消除信号</strong>的噪声，以便找出显著的曲线。该技术可以在将预测模型<strong class="jp ir">输入</strong>之前使用<strong class="jp ir">，或者甚至平滑</strong>模型输出。</p><p id="a6b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以绘制信号FFT的<strong class="jp ir">功率，并进行逆FFT </strong>以重构信号。然后移除所有高频，并从信号峰值频率转换回来。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="adac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们对噪音数据运行上述代码，例如从1950年到2015年S &amp; P500指数的<strong class="jp ir">每日价格记录，那么我们可以在去除每日波动后发现显著的价格变化。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/8511ef041d6ef3258d52f89a7000d991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZzBXvFtQIqWy9hixtAJ1w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Blue: S&amp;P500 Daily Price. Orange: Filtered Signal</figcaption></figure><h1 id="05c1" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak"> B .预测模型</strong></h1><p id="ebdb" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">在数据准备步骤之后，我们可以将值输入到预测模型中。这些是时间序列常用的<strong class="jp ir">模型</strong>:</p><ul class=""><li id="e8e3" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated"><strong class="jp ir"> ARIMA </strong>(自回归综合移动平均线)</li><li id="6506" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><strong class="jp ir">频率分解</strong></li><li id="fccc" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><strong class="jp ir">特征工程数据的线性回归</strong></li><li id="5623" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><strong class="jp ir"> LSTM &amp;双向LSTM </strong></li></ul><h1 id="496a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak"> i) ARIMA车型</strong></h1><p id="d108" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">又名。<strong class="jp ir"> Box-Jenkins model </strong>，ARIMA于1976年诞生。它在概念上类似于应用于时间序列数据的线性回归模型。</p><p id="d2c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ARIMA有<strong class="jp ir"> 3个部分:</strong></p><ul class=""><li id="b56f" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated"><strong class="jp ir">自动回归</strong></li><li id="62e4" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><strong class="jp ir">积分(差分)</strong></li><li id="a233" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><strong class="jp ir">移动平均线</strong></li></ul><p id="5365" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">自动回归(AR) </strong></p><p id="3a85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AR (p)类似于序列中先前“p”值的<strong class="jp ir">线性回归模型。我们假设未来的值可以通过<strong class="jp ir">‘p’</strong>以前的值计算出来，就像线性回归中的“几乎一条线”假设一样。这里，p是一个超参数。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nt"><img src="../Images/b0ea41afed4eda25b6205c4c34174c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdYIdMdE7rJOQ5CrZwjIOQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><em class="nu">Linear sum of last ‘p’ values is conceptually similar to LR (</em><a class="ae ky" href="https://www.appliedaicourse.com" rel="noopener ugc nofollow" target="_blank"><em class="nu">Courtesy</em></a><em class="nu">)</em></figcaption></figure><p id="cd32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">移动平均线</strong></p><p id="68ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MA (q)模型是对以前的“q”误差项的线性回归，类似于AR (p)。因此，<strong class="jp ir"> ARMA </strong>模型可以表示如下</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/f77ac36b3ab7da00d00d0d582920e6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*m5G6dET_V0qPkVzHmp_mCw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><strong class="bd lt">ARMA = linear sum of previous ‘p’ values &amp; ‘q’ errors </strong><em class="nu">(</em><a class="ae ky" href="https://www.appliedaicourse.com" rel="noopener ugc nofollow" target="_blank"><em class="nu">Courtesy</em></a><em class="nu">)</em></figcaption></figure><p id="ac5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，“p”先前值和“q”误差项是特征，α和θ是线性回归参数。<strong class="jp ir">积分与上面解释的“差异”概念相同。</strong></p><p id="9520" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之，<strong class="jp ir"> ARIMA (p，q，d) </strong>可以被定义为<strong class="jp ir">在差分‘d’次后对先前‘p’值&amp;‘q’误差的线性回归模型。</strong>这里p，q &amp; d是超参数。</p><h2 id="9801" class="nw ls iq bd lt nx ny dn lx nz oa dp mb jy ob oc mf kc od oe mj kg of og mn oh bi translated"><strong class="ak">自相关</strong></h2><p id="b7f0" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">如果曲线的一组值在k的间隙之后与其自身相关，那么协方差值趋向于1。但是我们怎么知道差距呢？</p><p id="2f3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">自相关因子(ACF)和部分ACF是帮助确定差距的图。</strong>当ACF绘制<strong class="jp ir">相关值与间隙k </strong>的关系时，部分ACF绘制累积相关值与k的关系。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi oi"><img src="../Images/6df1b343fa4c961c47635fcfdd0d1a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GKvncfAJpL15tPqV71Dww.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="noopener ugc nofollow" target="_blank">Courtesy</a></figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi oj"><img src="../Images/cb21349d5a8ea3a72b512822af26e893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzYIPQgg0ngi5vxZsekW3Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">X = k (gap). Y = <em class="nu">Correlation value (outside 95% suggests correlation)</em></figcaption></figure><p id="6d99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">置信区间设置为95%，表明该代码之外的相关值很可能是相关的，而不是统计上的侥幸。</p><p id="5d80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了使绘图更容易阅读，将x轴上的滞后限制为50。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi ok"><img src="../Images/2f31c380dd1c187f9cd50293eab22e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-mn1jp_dZz25pBaSSQjMqQ.png"/></div></div></figure><p id="8657" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上图来看，<em class="kl"> k = 1到10具有可接受的自相关性。</em></p><p id="5d54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">部分自相关<strong class="jp ir">仅绘制增量值</strong>。也就是说，您可以知道多使用一个先前值的好处。</p><p id="0284" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们试着在下面描述的TCS股票数据集上应用ARIMA模型。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi ol"><img src="../Images/ba890f6d8b0a734da0884615529d1a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGr7zKrTUsSKVdxEZAXIAg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">TCS Stock Market Prices</figcaption></figure><p id="6ae9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你运行自动相关时，你会得到下图。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/766789647233a8c82bc9499d20262c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*MMhlO00vihogdwWsFblvmA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">High correlation found on last 5~10 values</figcaption></figure><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/aaf4eda7cb50c67e33972d5cfae6a681.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*UZ8M5SwfMN_T6kRBpNseMw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Predicted values correlate with values in test data.</figcaption></figure><p id="99a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了密切观察，我们只绘制预测值和原始值。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/2df38f618d4b32979033c3d33b142607.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*vIBQ9dvpXsvPzaYjT3zK9Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Predicted vs Original: Zoomed in</figcaption></figure><p id="da15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ARIMA模型扩展到<strong class="jp ir"> SARIMA(季节性自回归综合移动平均)</strong>来支持序列的<strong class="jp ir">季节性成分</strong>。它用于包含趋势和季节性的单变量时间序列。</p><p id="bee8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">带解释变量的自回归综合移动平均(ARIMAX) </strong>模型在有分类或数字格式的附加解释变量(<strong class="jp ir">多元</strong>)时使用。</p><h1 id="d5d1" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">ii)频率分解</h1><p id="9532" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">自相关是计算周期的一种方法。但是一个<strong class="jp ir">更科学的发现周期性的方法是傅立叶变换。</strong>该技术可用于找出历史数据中最显著的周期性变化，从而为未来提供可靠的提示。</p><p id="b207" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们试着画出，</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/79980058320840b7a3df4c48b85ea38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*O81fTx-PFnBolyDjoRFEaw.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/197aaa985f6374434cb1881d2295a83b.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*7NOFtMGkx9rgvuKdS3pY_Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Sine and Cosine Additive</figcaption></figure><p id="593a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">绘制<strong class="jp ir">功率谱密度曲线</strong>并找出显著的峰值。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/ccd164ff7a39c82fc230739617bf2118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*QzVcIVd3vKruppsuvaHw3g.png"/></div></figure><p id="03d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对对应于重要峰值点的频率进行逆FFT。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/8fc63a36c44fa9ef0ee52b68a49b1f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*jB-VfDTx5fwhkyh_4JaRnA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><strong class="bd lt">Top</strong>: Inverse FFT of 1st PSD peak. <strong class="bd lt">Bottom</strong>: Inverse FFT of 2nd PSD peak</figcaption></figure><p id="f1a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是上面描述的进行频率分解的代码。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a07a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你把上面分开的波加起来，你就会把输入波拿回来。这证明了上述两个波代表了输入波的分量。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/e0b03614f3d6e26418e57b2adf2068c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*PqBtqbom_77ZJNP0Hq0CNg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Sum of Inverse FFT curves</figcaption></figure><h1 id="52d5" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak"> iii)线性回归</strong></h1><p id="ec58" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">我们仅使用“p”个先前值和“q”个误差来预测。但是我们可以使用其他功能，如星期几、时间、假期等。这种被称为<strong class="jp ir">特征工程</strong>的技术与其说是科学，不如说是艺术。</p><p id="dda0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们取一个CSV文件，包含从1950年到2015年S &amp; P500指数<strong class="jp ir">价格的每日记录。</strong>让我们尝试预测一天前的反应变量，即收盘价。我们可以使用以下功能:</p><p id="f43a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1) <strong class="jp ir">过去365天的平均价格</strong>。</p><p id="7642" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2) <strong class="jp ir">过去5天的平均价格</strong>与过去365天的平均价格&amp;的比率。</p><p id="dd73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3) <strong class="jp ir">前365天的均值和标准差</strong>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/8143c7af494a4112b6a8c0eb99dd6fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*VUdDdWi4tY-fIT5sEjobKw.png"/></div></figure><pre class="kn ko kp kq gt ov ow ox oy aw oz bi"><span id="6f7c" class="nw ls iq ow b gy pa pb l pc pd">Mean Absolute Error (MAE) = 99.43097824659425<br/>Median Absolute Percentage Error (MAPE) = 6.0%</span></pre><p id="5d74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解决任何时间序列问题的理想方法是首先使用差分或变换使数据更加平稳，然后应用高级回归模型，如GBDT或随机森林。</p><p id="baff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，时间序列数据最流行的模型是深度学习中的rnn。<strong class="jp ir">时间序列的最新模型是LSTMs、GRUs、注意力模型&amp;变压器。因为LSTMs比其他的更强大，所以我们在这里进行更深入的研究。</strong></p><h1 id="cc86" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">iv) LSTM &amp;双向LSTM </h1><p id="d718" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">长短期记忆网络可用于从一系列过去的观察中学习，以预测序列中的下一个值。</p><p id="4f13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个普通的LSTM模型有一个LSTM单位的隐藏层和一个用于进行预测的输出层。这里我们使用的是一个<strong class="jp ir">单变量</strong>系列，所以特性的数量是一个。</p><p id="8bad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们对用于傅立叶滤波的相同标准普尔500数据应用LSTM。首先我们画出<strong class="jp ir">自相关图来估计滞后。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/269abe7db7e1306212200e9744478ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*pt1r3Efh2KuG7RA10YJtxg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Auto Correlation on Closing Price</figcaption></figure><p id="038d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">发现高达500的滞后是正相关的。由于<strong class="jp ir">前100个具有超过80%的相关性</strong>，窗口大小被设置为100，时期被设置为200。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/5032c0b8b5fbd4bf9ebbcebbb0f778f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*Cp9ZljTXnNRrx4-1P8FmJg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">LSTM Prediction of S&amp;P500 curve</figcaption></figure><p id="e864" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如前所述，我们可以使用傅立叶滤波<strong class="jp ir">来平滑输出</strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi pg"><img src="../Images/2518396e1dcebb026ef63043e7bd94cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIC9Ry0FjWdGxMP49K647Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fourier Filtered Prediction Curve of S&amp;P 500</figcaption></figure><p id="b697" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">双向LSTMs </em> </strong></p><p id="ea83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在时序序列预测问题中，允许LSTM模型向前和向后学习输入序列<strong class="jp ir">并连接两种解释可能是有益的。</strong></p><p id="ef09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一元时间序列预测的双向LSTM。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="b2c5" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">如何开始交易？</strong></h1><ul class=""><li id="3e2b" class="mu mv iq jp b jq mp ju mq jy ph kc pi kg pj kk mz na nb nc bi translated">在<a class="ae ky" href="https://zerodha.com/" rel="noopener ugc nofollow" target="_blank"> Zerodha </a>或<a class="ae ky" href="https://upstox.com/" rel="noopener ugc nofollow" target="_blank"> Upstox </a>开立demat账户。</li><li id="79ea" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">进行文档上传和帐户设置(15分钟)</li><li id="4c71" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">安装相应的应用程序并监控市场图表。</li><li id="4074" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">从菜单进入algo labs，熟悉自己。</li><li id="0155" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">要进行algo交易，安装<a class="ae ky" href="https://www.amibroker.com/" rel="noopener ugc nofollow" target="_blank"> Amibroker </a>或<a class="ae ky" href="https://ninjatrader.com/" rel="noopener ugc nofollow" target="_blank"> Ninjatrader </a>。</li><li id="94e0" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">从一些授权的<a class="ae ky" href="https://www.ticanalytics.com/" rel="noopener ugc nofollow" target="_blank">数据供应商</a>购买数据</li><li id="7cf9" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">为上述算法编写代码并进行分析。</li></ul><p id="5b3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对上述数学模型不确定，那么你可以把数据供应商的实时数据输入到第三方解决方案中，比如亚马逊预测。不投入真金白银也可以在<a class="ae ky" href="https://web.sensibull.com" rel="noopener ugc nofollow" target="_blank">纸上交易app</a>上做虚拟交易。</p><h1 id="1916" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">结论</strong></h1><p id="f134" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">在这篇博客中，你已经看到了一些基本的数学技术来模拟按时间顺序索引的数据。它将为你从时间序列数据开始提供足够的技术基础。然而，要打败市场，你可能不得不求助于先进的技术。</p><p id="2d81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们试图使用<strong class="jp ir">监督学习方法模拟股票市场行为，即。线性回归或LSTM </strong>。但是<strong class="jp ir">强化学习</strong>对于<strong class="jp ir"> </strong>考虑到影响股票市场的各种环境因素<strong class="jp ir"> </strong>更加稳健，因为它旨在<strong class="jp ir">在给定的情况下最大化报酬。</strong></p><p id="a6e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">傅立叶分析最适合有规律和可预测的波或小波，这与股票市场相反。因此，研究<strong class="jp ir">光谱分析和信号提取也是有益的。</strong>如果你想了解这些先进的技术，请继续关注即将到来的博客，或者你可以在这里联系到我<a class="ae ky" href="https://www.linkedin.com/in/ananduthaman/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="43f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有讨论过的技术的源代码都可以在<a class="ae ky" href="https://github.com/AdroitAnandAI/Algo-Trading-Math-Models" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/c6a80d2ec05daa43add8ba7bbeaaab44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*JSm_GxEk34ELgFL-yojkYQ.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://blog.quantinsti.com/why-you-should-be-doing-algorithmic-trading/" rel="noopener ugc nofollow" target="_blank">Image Courtesy</a></figcaption></figure><h1 id="1d49" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">参考文献</strong></h1><div class="kz la gp gr lb lc"><a href="http://scipy-lectures.org/intro/scipy/auto_examples/plot_fftpack.html" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd ir gy z fp lh fr fs li fu fw ip bi translated">1.5.12.17.绘制和操作FFT进行滤波</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">画出信号FFT的功率，并反推FFT以重构信号。此示例演示了和。它…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">scipy-lectures.org</p></div></div></div></a></div><div class="kz la gp gr lb lc"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd ir gy z fp lh fr fs li fu fw ip bi translated">如何开发用于时间序列预测的LSTM模型</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">长短期记忆网络，简称LSTMs，可用于时间序列预测。有很多种…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">machinelearningmastery.com</p></div></div><div class="ll l"><div class="pl l ln lo lp ll lq ks lc"/></div></div></a></div><div class="kz la gp gr lb lc"><a href="https://www.appliedaicourse.com/" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd ir gy z fp lh fr fs li fu fw ip bi translated">应用课程</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">我们知道转行是多么具有挑战性。我们的应用人工智能/机器学习课程被设计为整体学习…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">www.appliedaicourse.com</p></div></div><div class="ll l"><div class="pm l ln lo lp ll lq ks lc"/></div></div></a></div><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="pn nn l"/></div></figure></div></div>    
</body>
</html>