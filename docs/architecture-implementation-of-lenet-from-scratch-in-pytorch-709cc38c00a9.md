# Pytorch ä¸­ LeNet çš„æ¶æ„ä¸å®ç°

> åŸæ–‡ï¼š<https://medium.datadriveninvestor.com/architecture-implementation-of-lenet-from-scratch-in-pytorch-709cc38c00a9?source=collection_archive---------1----------------------->

é‡å»ºæœ€å¤è€çš„ç¥ç»ç½‘ç»œæ¶æ„ã€‚

# ä»‹ç»

æˆ‘å°†åœ¨ medium ä¸Šå‘è¡¨ä¸€ç³»åˆ—æ–‡ç« ï¼Œæ¶µç›–å¤§å¤šæ•° CNN æ¶æ„ï¼Œå¹¶åœ¨ PyTorch å’Œ TensorFlow ä¸Šå®ç°ã€‚æˆ‘ç›¸ä¿¡åœ¨æŒæ¡äº†æ ‡å‡†æ¶æ„ä¹‹åï¼Œæˆ‘ä»¬å°†å‡†å¤‡å¥½ä¸ºä»»ä½•ä»»åŠ¡æ„å»ºæˆ‘ä»¬è‡ªå·±çš„å®šåˆ¶ CNN æ¶æ„ã€‚

æ‰€ä»¥æˆ‘ä»æœ€å¤è€çš„ CNN æ¶æ„ LeNet(1998)å¼€å§‹ã€‚å®ƒä¸»è¦æ˜¯ä¸ºè¯†åˆ«æ‰‹å†™å’Œå…¶ä»–å­—ç¬¦è€Œå¼€å‘çš„ã€‚

è¯¥æ¶æ„å…±æœ‰ 7 å±‚ï¼Œç”± 2 ç»„å·ç§¯å±‚å’Œå¹³å‡æ± å±‚ç»„æˆï¼Œå…¶åæ˜¯å¹³å¦å·ç§¯å±‚ã€‚ä¹‹åï¼Œæˆ‘ä»¬æœ‰ 2 ä¸ªå¯†é›†çš„å…¨è¿æ¥å±‚ï¼Œåˆ†åˆ«æœ‰ 84 ä¸ªå’Œ 10 ä¸ªè¾“å‡ºç¥ç»å…ƒã€‚

## LeNet æ¶æ„

![](img/0b7ff59fe5d0a39cd832c683b21bd05d.png)

ä¸Šå›¾æ€»ç»“äº† LeNet çš„æ¶æ„ï¼Œæˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹å„å±‚çš„å‚æ•°ã€‚

è¿™ç§ä½“ç³»ç»“æ„æ˜¯ä¸“é—¨ä¸ºä½åˆ†è¾¨ç‡å›¾åƒè®¾è®¡çš„ï¼Œä¾‹å¦‚å¤§å°ä¸º 32 x 32 ç°åº¦çº§çš„ MNIST å›¾åƒã€‚

![](img/7414923bd26bd61d1f22c28fbba4691d.png)

## è¾“å‡ºé€šé“çš„æ•°é‡å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—:

![](img/8a53f077ad97624f220f82a04a19c3cc.png)

## å­¦ä¹ å‚æ•°çš„æ•°é‡= [i x (f x f) x b] + b

i =å·ç§¯å±‚ä¸­è¾“å…¥é€šé“çš„æ•°é‡
f =æ»¤æ³¢å™¨å°ºå¯¸
b =åç½®æ•°é‡

## æ€»ä½“è®¡ç®—:

è·¨è·å’Œå¡«å……åœ¨æ•´ä¸ªç½‘ç»œä¸­ä¿æŒä¸å˜ï¼Œ
å› æ­¤ **S = 1ï¼ŒP = 0**

1.  **è¾“å…¥å›¾å±‚å½¢çŠ¶= 32Ã—32Ã—1**
2.  **ç”¨ 6 ä¸ªå¤§å°ä¸º(5x5)çš„è¿‡æ»¤å™¨åº”ç”¨ conv2d åï¼Œ**

*   è¾“å‡ºå½¢çŠ¶=((32+0â€“5)/1)+1 = 28
*   å­¦ä¹ å‚æ•°çš„æ•°é‡= ([ 1 x (5 * 5) x 1] + 1) * 6 ä¸ªè¿‡æ»¤å™¨= 156

3.**åº”ç”¨å¹³å‡å¤§å°æ± (2x2)åï¼Œ**

*   è¾“å‡ºå½¢çŠ¶=((28+0â€“2)/2)+1 = 14
*   å­¦ä¹ å‚æ•°æ•°é‡=æ— (0)

4.**åº”ç”¨ conv2d å’Œ 16 ä¸ªå¤§å°ä¸º(5x5)çš„è¿‡æ»¤å™¨åï¼Œ**

*   è¾“å‡ºå½¢çŠ¶=((14+0â€“5)/1)+1 = 10
*   å­¦ä¹ å‚æ•°çš„æ•°é‡= ([ 6 x (5 * 5) x 1] + 1) * 16 ä¸ªè¿‡æ»¤å™¨= 2416

5.**åº”ç”¨å¹³å‡å¤§å°æ± (2x2)åï¼Œ**

*   è¾“å‡ºå½¢çŠ¶=((10+0â€“2)/2)+1 = 5
*   å­¦ä¹ å‚æ•°æ•°é‡=æ— (0)

6.**åº”ç”¨ conv2d å’Œ 150 ä¸ªå¤§å°ä¸º(5x5)çš„è¿‡æ»¤å™¨åï¼Œ**

*   è¾“å‡ºå½¢çŠ¶=((5+0â€“5)/1)+1 = 1
*   å­¦ä¹ å‚æ•°çš„æ•°é‡= ([ 16 x (5 * 5) x 1] + 1) * 120 ä¸ªè¿‡æ»¤å™¨= 48120

7.**åº”ç”¨ 84 ä¸ªç¥ç»å…ƒçš„çº¿æ€§å±‚ï¼Œ**

*   å­¦ä¹ å‚æ•°ä¸ªæ•°= (120 * 84 + 84) = 10164

8.**åº”ç”¨ 10 ä¸ªç¥ç»å…ƒçš„çº¿æ€§å±‚ï¼Œ**

*   å­¦ä¹ å‚æ•°ä¸ªæ•°= (84 * 10 + 10) = 850

[](https://www.datadriveninvestor.com/2020/06/24/disclosure-and-resolution-program-wont-prevent-physicians-from-practicing-defensive-medicine/) [## äººå·¥æ™ºèƒ½ã€æ·±åº¦å­¦ä¹ å’ŒåŒ»ç–—å®è·µ|æ•°æ®é©±åŠ¨çš„æŠ•èµ„è€…

### äººå·¥æ™ºèƒ½å’Œæ·±åº¦ç¥ç»å­¦ä¹ çš„æ•ˆç”¨çœ‹èµ·æ¥å¯èƒ½æ˜¯åˆæ³•å’Œæœ‰å‰é€”çš„ï¼Œç‰¹åˆ«æ˜¯â€¦

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2020/06/24/disclosure-and-resolution-program-wont-prevent-physicians-from-practicing-defensive-medicine/) 

# ç”¨ Pytorch å®ç° LeNet

## å¯¼å…¥åº“

## æ¨¡å‹ç»“æ„

æ­£å¦‚æˆ‘ä»¬çœ‹åˆ°çš„ï¼Œæ¨¡å‹çš„æ€»ç»“ä¸æˆ‘ä»¬çš„è®¡ç®—å®Œå…¨å»åˆã€‚

## MNIST å®æ–½:

ä»å›¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æ¨¡å‹åœ¨è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¸Šè¡¨ç°è‰¯å¥½ã€‚

æŸå¤±å€¼:

![](img/e8755418ee34f3b5e43a77f3de569414.png)![](img/0fd54d608f95824bb27dbf41777de71f.png)

Training and Validation Loss

## æˆ‘ä»¬æ¨¡å‹çš„å‡†ç¡®æ€§:

åœ¨ MNIST æ¨¡å‹ä¸Šï¼Œæˆ‘ä»¬å¾—åˆ°äº† 96.37 çš„è‰¯å¥½è®­ç»ƒç²¾åº¦å’Œ 96.32 çš„éªŒè¯ç²¾åº¦ã€‚

ğŸ“Œ**å®Œæ•´å®ç°å¯åœ¨æ­¤**[**GitHub Gist**](https://gist.github.com/bala-codes/0f79addd101152d9d67f33ff69ab9234)**æˆ–** [**æ‰“å¼€ Colab**](https://colab.research.google.com/gist/bala-codes/0f79addd101152d9d67f33ff69ab9234/architecture-implementation-of-lenet-from-scratch-in-pytorch.ipynb) **ã€‚**

> ***å‚è€ƒæ–‡çŒ®:***

[1] Yann LeCunï¼Œ[åŸºäºæ¢¯åº¦çš„å­¦ä¹ åº”ç”¨äºæ–‡æ¡£è¯†åˆ«](http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf) (1998)ã€‚

æ–‡ç« ä½œè€…:

å·´æ‹‰å…‹é‡Œå¸Œçº³Â·åº“é©¬å°”äº”ä¸–

## è·å¾—ä¸“å®¶è§‚ç‚¹â€” [è®¢é˜… DDI è‹±ç‰¹å°”](https://datadriveninvestor.com/ddi-intel)