<html>
<head>
<title>Have you ever had problems with your credit card?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的信用卡有过问题吗？</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/have-you-ever-had-problems-with-your-credit-card-afe3a65fcd97?source=collection_archive---------10-----------------------#2020-04-19">https://medium.datadriveninvestor.com/have-you-ever-had-problems-with-your-credit-card-afe3a65fcd97?source=collection_archive---------10-----------------------#2020-04-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/9b1502aacd2f36b2c9a8f1c1ba284e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lbC5Ikl4VbKWES54.jpg"/></div></div></figure><div class=""/><blockquote class="jy jz ka"><p id="efe1" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">查看我的Github中的完整分析<a class="ae la" href="https://bit.ly/3cslZJy" rel="noopener ugc nofollow" target="_blank">这里</a>。这个项目来自DSNP课程，你可以在这里查看<a class="ae la" href="https://sigmoidal.ai/curso-online-data-science-na-pratica/" rel="noopener ugc nofollow" target="_blank">。</a></p></blockquote><p id="96d1" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在这个项目中，我们将解决信用卡欺诈问题，这是银行和fintech等金融机构的主要问题之一。</p><p id="b2bf" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">仅在巴西，去年就有大约1210万人遭受了某种形式的金融欺诈。在过去的12个月里，金融诈骗每年造成的损失超过了18亿雷亚尔。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/53c3620d79cb0b17d004303385aa80a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Kong2fMxWJM_93-t.jpg"/></div></div></figure><p id="3843" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">在这些欺诈中，涉及信用卡的欺诈关系重大，因为如果不被发现，消费者和金融机构都会遭受巨大损失。</p><p id="5ab5" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">另一个要考虑的因素是误报的数量，即当你试图购买时，你的卡被预防性地阻止了——这可能会导致压力和尴尬。</p><p id="fd7f" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">出于所有这些原因，通过人工智能进行欺诈检测的投资每年都在增长，这代表着<em class="kd">数据科学</em>的巨大机遇。</p><div class="ip iq gp gr ir li"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd jc gy z fp ln fr fs lo fu fw ja bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw ix li"/></div></div></a></div><p id="3df9" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">有了大量的数据作为历史基础，一个比以前的算法稍微好一点的机器学习算法已经节省了数百万雷亚尔。这就是挑战，不断改进算法的使用，以抑制或防止欺诈性交易。</p><blockquote class="jy jz ka"><p id="849e" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，我们将创建三个机器学习模型来检测这些欺诈行为，并查看它们在这些数据中的表现。</p></blockquote><h1 id="8e22" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">我们数据的快速概览</h1><p id="d227" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">这个项目中使用的数据已经由一些欧洲信用卡公司提供。<em class="kd">数据集</em>代表两天内发生的金融交易，其中492起欺诈被归类为近29万笔交易。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi na"><img src="../Images/095d327b6004e97a9a13311bacab9f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*o_32P8hX-xedTBbl9unUoA.png"/></div></figure><p id="4bd1" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">如你所见，这是一个极其不平衡的数据集，其中欺诈仅占总数的0.17%。</p><p id="cc0e" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">另一个有趣的细节是<em class="kd">的特性</em>都是数字的，并没有被显示出来(由于隐私和安全问题)。因此，列的名称由[V1，V2，V3…，V28]表示。</p><p id="b822" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><a class="ae la" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">在原始数据页</a>上，还报告了变量经历了被称为主成分分析(PCA)的变换。</p><p id="c342" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">PCA允许降低维数，同时保持最大可能的信息量。为了实现这一点，算法找到了一组新的资源——所谓的<strong class="ke jc">组件</strong>。</p><p id="688a" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">这些分量小于或等于原始变量。在这个项目中，通过PCA转换发现的组件是柱子本身[V1，V2，V3…，V28]。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/34ff1630db72ee97861c74aa8f6f236a.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*0UM5SkDX6VcHn_jjkO9ndw.png"/></div></figure><p id="ed58" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">我们还可以看到，在这个数据集中没有好的空值，这意味着不需要进行数据集清理。</p><h1 id="51aa" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">这是我们分析的总结</h1><ul class=""><li id="5294" class="nc nd jb ke b kf mv kj mw lb ne lc nf ld ng kz nh ni nj nk bi translated">虽然我们有超过28.4万个条目，但只有0.17%是欺诈性的，这使得我们的数据集不平衡。</li><li id="cd2d" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><code class="fe nq nr ns nt b">Time</code>和<code class="fe nq nr ns nt b">Amount</code>变量保持其原始值，需要经过<strong class="ke jc">缩放</strong>过程。</li><li id="4cf8" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated">数据集中没有空值或缺失值。</li><li id="7c6c" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated">由于PCA对<strong class="ke jc">缩放</strong>很敏感，因此假设原始特征是标准化的。</li></ul><blockquote class="jy jz ka"><p id="db3b" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">查看我的Github中的完整分析<a class="ae la" href="https://bit.ly/3cslZJy" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></blockquote><h1 id="162c" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">机器学习</h1><p id="52f8" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">在我们对数据进行标准化之后，这意味着我们有相似数量级的所有输入，我们必须定义我们的目标和特征。</p><h2 id="8712" class="nu ly jb bd lz nv nw dn md nx ny dp mh lb nz oa ml lc ob oc mp ld od oe mt of bi translated">目标和功能</h2><p id="cb8e" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">因为我们想发现一笔交易是正常的还是欺诈的，我们的目标变量是T2，我们称之为y。所以所有其他变量都是我们的特征，我们称之为x</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi og"><img src="../Images/590acc258bed1098d5fd7d687517a761.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*BXkmO2nVI1Y047E4nPw6dQ.png"/></div></figure><h2 id="8ba1" class="nu ly jb bd lz nv nw dn md nx ny dp mh lb nz oa ml lc ob oc mp ld od oe mt of bi translated">分割数据集</h2><p id="1174" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">现在，我们将在训练和测试中分割数据集，我们几乎已经完成了…再走几步，我们就要创建我们的机器模型了。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/e8a6ff4a9c0999c001cddd15c0f40ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*d21QZc6Ld20cKQzBkzTVHg.png"/></div></figure><h2 id="b783" class="nu ly jb bd lz nv nw dn md nx ny dp mh lb nz oa ml lc ob oc mp ld od oe mt of bi translated">平衡数据</h2><p id="5994" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">在创建机器学习模型之前，我们必须处理不平衡的数据。有很多方法可以处理。我用了一个简单但有效的方法，效果很好。这项技术在<code class="fe nq nr ns nt b">imblearn</code>库中被称为<code class="fe nq nr ns nt b">under-sampling</code>。</p><p id="2c61" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">这就是我们的数据。流程:</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/f19433d572c66f52fa231bccc1845a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*FWtb2In1VEF4lewfjocOBw.png"/></div></figure><h1 id="755d" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">概括我们迄今为止的步骤…</h1><ul class=""><li id="090e" class="nc nd jb ke b kf mv kj mw lb ne lc nf ld ng kz nh ni nj nk bi translated"><em class="kd">我们了解我们的业务问题，</em></li><li id="d973" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><em class="kd">我们做了一个快速的数据概述，发现了一个不平衡的数据集，</em></li><li id="fa2c" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><em class="kd">将各列标准化为具有相似的量值，</em></li><li id="fd2a" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><em class="kd">我们选择我们的目标变量，也就是类</em></li><li id="5558" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><em class="kd">将数据分为训练和测试，以及</em></li><li id="f61e" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated">平衡我们的数据。</li></ul><h1 id="513e" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">构建我们的模型</h1><p id="99a1" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">最后，我们到了这个过程中有趣的部分，我们将测试一些机器学习模型，以比较它们在这个数据集中的性能。我们将创建3个机器学习模型，看看它们的表现如何。这些是选择的型号:</p><ul class=""><li id="b984" class="nc nd jb ke b kf kg kj kk lb oj lc ok ld ol kz nh ni nj nk bi translated"><strong class="ke jc"> <em class="kd">逻辑回归，</em> </strong></li><li id="7804" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><strong class="ke jc"> <em class="kd"> SVC，和</em> </strong></li><li id="362a" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><strong class="ke jc"> <em class="kd">随机森林。</em>T13】</strong></li></ul><p id="0163" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">最后，我们将看到每一个都在这个数据集中表现得更好。下面是如何使用的过程和每个模型的分数。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/19feb51b5ba21d8fb932621b06a5622f.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*RhVkFwjwTcPRh5j0n6W1IA.png"/></div></figure><p id="e380" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke jc">上面我们可以从我们的平衡训练集中看到我们的分数，其中</strong> <code class="fe nq nr ns nt b"><strong class="ke jc">Logistic Regression</strong></code> <strong class="ke jc">和</strong> <code class="fe nq nr ns nt b"><strong class="ke jc">SVC</strong></code> <strong class="ke jc">模型分别获得大约95%和94%的分数，而</strong> <code class="fe nq nr ns nt b"><strong class="ke jc">Random Forest</strong></code> <strong class="ke jc">获得99%的分数，但是让我们看看预测是如何进行的...</strong></p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi on"><img src="../Images/8682a7f96c543f36e5859f23c6137f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*m2K1zLtYBKQWYxeyxaf6Gw.png"/></div></figure><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/91c9c5acfe8aa4dfccb26ae253c6f889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l43jGscxAXoAv3z_O60GDw.png"/></div></figure><p id="ebf0" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated"><strong class="ke jc">根据测试集进行预测后，这些是ou模型的准确性，SVC模型的性能稍好，下面我们将看到我们的混淆矩阵，以直观显示预测情况。</strong></p><h1 id="d754" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">混淆矩阵</h1><p id="8f21" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">这是我们的3个混淆矩阵，我们注意到结果非常相似，但有一些有趣的分析引起了我的注意:</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi op"><img src="../Images/6278a8cbcf515bb4ab39d6999ebad73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xDeN_z47tokVr_hxx2tgQ.png"/></div></div></figure><ul class=""><li id="82ea" class="nc nd jb ke b kf kg kj kk lb oj lc ok ld ol kz nh ni nj nk bi translated"><em class="kd">SVC模型预测的</em> <code class="fe nq nr ns nt b"><em class="kd">fraud</em></code> <em class="kd">错误次数(883次)比其他模型少，在这种情况下，更少的客户生气，他们的信用卡没有被冻结。</em></li><li id="2197" class="nc nd jb ke b kf nl kj nm lb nn lc no ld np kz nh ni nj nk bi translated"><em class="kd">另一方面，</em> <code class="fe nq nr ns nt b"><em class="kd">normal</em></code> <em class="kd">模型预测出的交易错误次数更多，17次反对，14次来自逻辑回归，12次来自随机森林，比其他模型多，让更多的顾客气愤没有把欺诈性交易检测出来。</em></li></ul><p id="7fe5" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">让我们记住这一点:我们的数据集仅来自一个  <code class="fe nq nr ns nt b"><strong class="ke jc"><em class="kd">TWO-DAY</em></strong></code> <strong class="ke jc"> <em class="kd">时期，在该时期，492起欺诈被归类为近29万笔交易。</em> </strong></p><p id="38e9" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">所以，现在看起来这并不意味着什么，但如果我们开始考虑一周、一月、一年、节假日的所有交易，如黑色星期五、T42圣诞节，在这些节日里，礼品购物广泛增长，受伤害的顾客数量会显著增加。</p><h1 id="43ac" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">应用k倍交叉验证</h1><p id="d2ce" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">为了评估我们的机器学习模型对看不见的数据的技能，我们将使用称为交叉验证的统计模型。下面我们可以看到结果:</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/b09510d484a379ce1a8943e4952c43bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*UwK9a2Lln0NBvCKjyezL0w.png"/></div></figure><h1 id="c870" class="lx ly jb bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">结论</h1><p id="393b" class="pw-post-body-paragraph kb kc jb ke b kf mv kh ki kj mw kl km lb mx kp kq lc my kt ku ld mz kx ky kz ij bi translated">在所有这些步骤之后，我们最终完成了这个项目，并且在应用K-Fold交叉验证之后，我们可以看到，最终，<strong class="ke jc">逻辑回归</strong>模型给了我们更好的结果，具有更好的准确性和更小的标准偏差。</p><p id="42f5" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">为了获得更好的结果，最好是获得更多的数据，并测试我们的模型，看看它的表现如何。我们还可以使用一种叫做网格搜索的技术来改变参数，为我们的模型找到最佳的调整。</p><p id="2f9a" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">这里的想法只是比较模型，看看哪个在这个数据中表现更好。</p><p id="7832" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">谢谢，希望你喜欢。</p><p id="0184" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km lb ko kp kq lc ks kt ku ld kw kx ky kz ij bi translated">通过<a class="ae la" href="https://www.linkedin.com/in/glaucio-drumond-1734a018b/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>联系我或者查看我的<a class="ae la" href="https://bit.ly/3cslZJy" rel="noopener ugc nofollow" target="_blank"> Github </a></p><figure class="le lf lg lh gt is"><div class="bz fp l di"><div class="or os l"/></div></figure></div></div>    
</body>
</html>