<html>
<head>
<title>Animated Chloropleth Maps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动画氯普图</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/animated-chloropleth-maps-502a77dbd6c2?source=collection_archive---------15-----------------------#2020-03-29">https://medium.datadriveninvestor.com/animated-chloropleth-maps-502a77dbd6c2?source=collection_archive---------15-----------------------#2020-03-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div class="gh gi io"><img src="../Images/b65ddc650c67be9c50de21d4f2853541.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*UkmVuWJPZ4tipVovTTodFQ.png"/></div></figure><div class=""/><p id="3f78" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ks">如果一幅画有一千个字，一部动画就有一百万个字！</em></p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="kx ky l"/></div></figure></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="5c1a" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ks"> TL DR: </em> <a class="ae lg" href="https://github.com/David-Woroniuk/Medium-Articles/blob/master/Animated_Chloropleth_Maps.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="ks"> GitHub代码</em> </a> <em class="ks">。</em></p><p id="9496" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae lg" href="https://medium.com/datadriveninvestor/time-series-animation-in-matplotlib-de023655a197" rel="noopener">时间序列动画</a>是展示数据随时间演变的一种有趣而简单的方式，然而，许多数据集包含地理成分。数据的地理要素可能包含更多信息，已被用于情感分析、政治观点分析，以及最近的流行病学数据。</p><div class="ip iq gp gr ir lh"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iy gy z fp lm fr fs ln fu fw iw bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv it lh"/></div></div></a></div><p id="d707" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">本文提供了一个简短的Chloropleth地图动画演示，它让我们可以直观地看到两个世界的精华——我们可以可视化一个本地化的数据集，而动画则让我们可以查看随时间的变化。</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="1731" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，让我们开始吧！我们需要做的第一件事是卡通包装。当我使用Google Colabatory时，我使用了<code class="fe lw lx ly lz b">!apt-get</code>参数，同时也卸载了shapely并重新安装了一个早期版本:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="7336" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我们必须导入一些有助于数据分析、可视化和动画的包:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="5eed" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们已经安装了所有的必备包，我们可以开始考虑数据了。我选择想象2010年至2020年间美国的石油和天然气钻探活动。数据可以在这个<a class="ae lg" href="https://github.com/David-Woroniuk/Medium-Articles/blob/master/O%26G%20Data.csv" rel="noopener ugc nofollow" target="_blank"> Github </a> repo中找到:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="75f0" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们现在定义颜色条中包含的颜色。这些颜色对应于美国各州的每周钻井活动，如<code class="fe lw lx ly lz b">Dataset[‘Value’]</code>栏所示:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="c4ce" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们现在需要导入底图。由于我正在处理美国地图(下48)，我选择了<a class="ae lg" href="https://www.naturalearthdata.com/downloads/110m-cultural-vectors/110m-admin-0-countries/" rel="noopener ugc nofollow" target="_blank">自然地球</a>的<code class="fe lw lx ly lz b">admin_1_states_provinces_lakes</code>形状文件。自然地球提供的shapefiles的完整列表可以在这里<a class="ae lg" href="https://www.naturalearthdata.com/downloads/110m-cultural-vectors/" rel="noopener ugc nofollow" target="_blank">获得。</a></p><p id="62d3" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我选择了1:110的比例，因为我们是在一个相对较小的地理区域内工作。对于全球数据，我鼓励您查看不同的可用选项。最后，我们将面颜色或每个状态的颜色初始化为灰色，状态边界初始化为黑色:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="ecd3" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们已经导入了一个形状文件和数据，我们可以开始看生成一个动画。一般来说，当处理动画时，我们提供一个init或初始化函数，后面跟着一个iterable函数，用于对应每个时间点的每一帧。这里，我们定义了init函数<code class="fe lw lx ly lz b">init_run</code>:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="2edd" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe lw lx ly lz b">init_run function</code>用黑色边界和灰色面颜色初始化shapefile中的所有状态，随后被我们的数据集覆盖。我们还将每个州的几何图形和名称联系起来，使得在<code class="fe lw lx ly lz b">run</code>函数中的使用更加容易:</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="291c" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">差不多了——我们只需要添加一些额外的细节，主要是我们之前定义的颜色条。如果没有颜色条，任何使用颜色作为维度的图表，如氯普图，都很难理解。</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="5634" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了将数据制成动画，我们调用了<code class="fe lw lx ly lz b">matplotlib.animation.FuncAnimation</code>函数，提供了图形的输入参数、<code class="fe lw lx ly lz b">run</code>函数和帧，帧指定了动画函数应该被调用的次数。Interval提供帧之间的延迟，以毫秒为单位。</p><p id="bc26" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">由于我在Google Colab工作，我选择将动画作者定义为<code class="fe lw lx ly lz b">[‘ffmpeg’]</code>，然而，许多IPython shells与ImageMagick配合得很好。</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="ma ky l"/></div></figure><p id="4eaa" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，我们的动画应该保存在第一个代码块中定义的<code class="fe lw lx ly lz b">root_dir</code>中。我们可以将氯普图与<a class="ae lg" href="https://medium.com/datadriveninvestor/time-series-animation-in-matplotlib-de023655a197" rel="noopener">折线图</a>结合起来，调查美国石油价格和钻井活动之间的相互依赖关系，这可能有助于了解盈亏平衡成本最低的州！</p><figure class="kt ku kv kw gt is"><div class="bz fp l di"><div class="mb ky l"/></div></figure></div></div>    
</body>
</html>