<html>
<head>
<title>HTMLAudioElement Can Decode Encoded Strings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HTMLAudioElement可以解码编码字符串</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/htmlaudioelement-can-decode-encoded-strings-b4fe67642c8a?source=collection_archive---------11-----------------------#2020-11-09">https://medium.datadriveninvestor.com/htmlaudioelement-can-decode-encoded-strings-b4fe67642c8a?source=collection_archive---------11-----------------------#2020-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c6f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我正在摆弄Google Cloud的文本到语音API，想通过在Rails后端发出调用，用React前端接收响应并播放声音来测试一下。</p><p id="a07b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会深入讨论如何使用Google Cloud Text to Speech SDK Gem for Rails，但不用说，<a class="ae kl" href="https://cloud.google.com/text-to-speech/docs/libraries" rel="noopener ugc nofollow" target="_blank">文档中给出的示例代码拥有您需要的一切</a>。</p><p id="8b0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，我将详细介绍我是如何调用Google Cloud来获取我发送的文本的“声音”的。</p><p id="0486" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建了一个名为“Du It”的应用程序这是我特别制作的，目的是让说英语的普通话学习者更容易阅读中文小说。</p><p id="5f9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://youtu.be/VHXAkeIC1_0 T2】号</p><p id="1dc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的Rails API中，我有一个名为“Word”的模型当用户在应用程序中查找单词时，就会创建一个新的实例。在实例化时，对Google Cloud Translate的单独请求会获得英语定义，而我找到的一个有用的gem会提供给定单词的发音。</p><p id="6e1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是音频。</p><p id="389b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当用户点击位于定义卡每个底部角落的声音性别字符时，就会发出对Google Cloud文本到语音转换的请求:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/42ffcbd379ebd81568a2f866bcbe1a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1YQBIKyNtAzsIsn4E7U4Ng.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Note that the gender is the Chinese character for male/female respectively, for the diligent learner of Mandarin.</figcaption></figure><p id="258e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击后，将对特定的word对象调用以下实例方法:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/32ad435524ac0b863c14912108c086e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E0GisioVRMnHmJmoFBcJdA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">An instance method of the Word model, which is called by a method in the Words Controller. The value ‘female_response’ is JSON, with a key ‘audioContent’ and value of a base64 encoded string.</figcaption></figure><p id="9b9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从Google Text-to-Speech收到的响应将是一个base64编码的字符串。</p><p id="69db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此之前，我对如何使用编码字符串相当无知，对如何处理编码成一个字符串的音频更是一无所知。甚至<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement" rel="noopener ugc nofollow" target="_blank"> HTMLAudioElement的文档也没有明确指出任何处理它们的能力。</a></p><p id="d8d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，<a class="ae kl" href="https://jsfiddle.net/Sl1v3r/af9av0o4/" rel="noopener ugc nofollow" target="_blank">我偶然发现了Andrey Kogut的一把JS小提琴</a>,它为我澄清了一切，非常壮观:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ld"><img src="../Images/7273bfff7b52287b921fe7dae9731058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dm0dcFyqUrnVKUcx6veD0Q.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Notice the parameters passed into the Audio() constructor: ‘data: audio/ogg; base64, …’</figcaption></figure><p id="3fc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Andrey在这里使用audio/ogg进行格式化，但是我的格式是audio/mpeg(即mp3，您会注意到在实例方法中指定的选项。</p><p id="f5b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，指定“数据:音频/mpeg；base64”和Audio()对象要解码的整个编码字符串；我在React前端的一个方法中实现了它:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/1ca91e3b60415b77f8246ced5a30a6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fL-_jdoIrTNFUsMle85xCA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">I love interpolating strings.</figcaption></figure><p id="7bd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果呢？当用户用普通话阅读小说时，可以听到单词的实际音频。这太不可思议了，我真的很感谢我能够像那样偶然发现安德烈·科古特的JSFiddle。</p><p id="31d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不知道有多少次我试图埋头用我的第二语言阅读，结果却因为我不知道如何读一个字/词而失败。让你的阅读流畅起来，这是阅读乐趣的源泉；培养对用另一种语言阅读的热爱的潜力只会增加阅读的乐趣。</p></div></div>    
</body>
</html>