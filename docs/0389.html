<html>
<head>
<title>Identifying Food in Images Through Convolutional Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过卷积神经网络识别图像中的食物</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/identifying-food-in-images-through-convolutional-neural-networks-a301984ccac3?source=collection_archive---------3-----------------------#2020-01-28">https://medium.datadriveninvestor.com/identifying-food-in-images-through-convolutional-neural-networks-a301984ccac3?source=collection_archive---------3-----------------------#2020-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/211b4ec632f091b93c33eb9a467abc83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BV9KP4hrKGzL1Tbs"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@charlesdeluvio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Charles</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="968f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">渥太华大学发布了一组各种类型食物的图像数据集，目的是创建一个可以识别食物并估计其营养价值的模型。作为概念的证明，我决定创建一个识别食物的模型。</p><div class="lb lc gp gr ld le"><a href="https://www.datadriveninvestor.com/2019/03/22/fixing-photography/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">修复摄影|数据驱动的投资者</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">汤姆·津伯洛夫在转向摄影之前曾在南加州大学学习音乐。作为一个…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div><p id="f547" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lt">食物检测数据集(FooDD) </em>由3000张图片组成，这些图片被组织到20个文件夹中，从苹果到西瓜。这些图像的大部分是由研究人员自己拍摄的。其中19个文件夹被细分为使用的相机类型和背景中的光照量。一类包含从互联网搜索获得的图像。</p><h1 id="fb1a" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">步骤1:准备数据</h1><p id="1c7a" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">这个项目的第一步是为机器学习模型准备数据。为了实现这一点，我首先决定通过导入灰度来简化图像数据，因为灰度图像比RGB图像需要更少的信息来处理。然后，我调整了每个图像的大小，以便运行时间和RAM的使用保持在最低水平。下面是这一步的代码，以及对代码每一部分的简要解释。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="7858" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">步骤2:构建模型</h1><p id="5290" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">现在我们的数据已经准备好了，我们可以开始建立机器学习模型了。我将在这个项目中使用卷积神经网络(CNN)算法。简而言之，CNN拍摄一幅图像，并对图像中不同的物体赋予重要性。该算法进一步缩小图像，以便进一步简化处理。该算法然后处理该图像并编译数据。每当模型通过这种算法时，它在处理数据和正确分类方面变得更有效。我还根据算法运行的次数测试了模型的准确性。一个事件就是一个时代。下面是这一步的代码，其中对代码的每一部分都做了简要的解释。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="7258" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我用140个时期运行了这个模型，结果显示对图像中的食物进行正确分类的准确率为97%。下图说明了历元数和精确度之间的关系。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/93adb8cc9c85689813354c2054617dcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*UrZQMifLw0MMSFz8SY_HdA.png"/></div></figure><h1 id="710c" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">步骤3:对图像进行分类</h1><p id="f63d" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">创建模型后，下一步也是最后一步是创建一个函数，该函数可以获取新图像并对食物进行分类。因为模型是用调整大小的灰度图像训练的，所以每个新图像也必须调整大小并转换成灰度图像。下面是转换新图像并将其归类为19种食物之一的代码，以及代码各部分的简要说明。</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="0d5a" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">结论</h1><p id="31ab" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">我在上面创建的模型似乎能够正确地对food中的食物进行分类。虽然它能够在FooDD中对图像进行分类，但在更普遍的环境中，该模型可能不会那么准确。例如，我测试了这个模型，给它一个未成熟(也就是绿色)的香蕉图像。该模型将这种香蕉归类为黄瓜，大概是因为它又长又瘦，还是绿色的。该模型当然有效，但它可能没有足够的数据将绿香蕉归类为香蕉。该模型的准确性可以通过提供不同类型食物的更多图像数据来提高。</p><p id="835a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的项目<em class="lt">到此结束。</em>要查看这个故事的所有代码，请访问https://github.com/lanzo-siega/FooDD-classification<a class="ae kc" href="https://github.com/lanzo-siega/FooDD-classification" rel="noopener ugc nofollow" target="_blank"/>。为了及时了解我未来的项目，请在Medium上关注我，或者在https://www.linkedin.com/in/lanzo-siega/<a class="ae kc" href="https://www.linkedin.com/in/lanzo-siega/" rel="noopener ugc nofollow" target="_blank">的LinkedIn上关注我。感谢您的阅读！</a></p><h1 id="58d0" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">参考</h1><p id="5be9" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">页（page的缩写）Pouladzadeh、A. Yassine和S. Shirmohammadi，“FooDD:使用食品图像进行卡路里测量的食品检测数据集”，载于<em class="lt">图像分析和处理的新趋势— ICIAP 2015研讨会</em>，V. Murino、E. Puppo、D. Sona、M. Cristani和C. Sansone，《计算机科学讲义》，Springer，第9281卷，2015年，ISBN:978–3–319–23221–8，第441页DOI:<a class="ae kc" href="http://dx.doi.org/10.1007/978-3-319-23222-5_54" rel="noopener ugc nofollow" target="_blank">10.1007/978–3–319–23222–5 _ 54</a></p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="ne nc l"/></div></figure></div></div>    
</body>
</html>