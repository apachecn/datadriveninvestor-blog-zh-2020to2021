<html>
<head>
<title>Machine learning Model Deployment using Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flask的机器学习模型部署</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/deployment-of-machine-learning-project-using-flask-bf6e5a750319?source=collection_archive---------0-----------------------#2020-06-29">https://medium.datadriveninvestor.com/deployment-of-machine-learning-project-using-flask-bf6e5a750319?source=collection_archive---------0-----------------------#2020-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3186" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">生产中的机器学习项目。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3e700c422ee4c72d9c692cb74cba541c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6JpICCrP3Ab6Xo27"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Here it begins</figcaption></figure><p id="3b3a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将主要讨论使用flask API的机器学习模型部署，但是使用flask API的模型构建和部署的代码将在我的<a class="ae lu" href="https://github.com/bharatc9530/Machine-Learning/tree/master/Model-Deployment-Using-Flask" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> GitHub </strong> </a> <strong class="la iu"> </strong>资源库中提供，以便您也可以在自己的项目中尝试。</p><p id="b967" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我假设你在机器学习或深度学习模型构建方面有一些经验，并希望用<strong class="la iu">flask API<strong class="la iu">生产模型</strong>。</strong></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e24d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">烧瓶API简介</strong></h1><p id="f554" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">Flask是一个轻量级的<a class="ae lu" href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> Web服务器网关接口(WSGI) </strong> </a>一个用python编写的微框架。这意味着flask为我们提供了工具、库和技术，允许我们构建web应用程序。这个web应用可以是一些网页，一个博客，或者我们的机器学习模型预测web应用。Flask是连接我们的模型和前端预测网页的中间媒介，如下图中的<strong class="la iu">所示。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/c261ac51450017b7e9b6e25a939fa8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0MLLv0UhYoETR8Y_ZaSmw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">API Data Flow</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d478" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">先决条件</h1><p id="13d4" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我们假设我们所有人都在jupyter笔记本上有关于模型训练的知识。这篇文章旨在提供关于使用Flask API将机器学习模型部署到生产中的见解。</p><p id="96ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">模型部署中需要的库:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="36c9" class="nf md it nb b gy ng nh l ni nj">pip install pickle-mixin<br/>pip install Flask</span></pre><ol class=""><li id="5b94" class="nk nl it la b lb lc le lf lh nm ll nn lp no lt np nq nr ns bi translated"><a class="ae lu" href="https://docs.python.org/3/library/pickle.html#:~:text=%E2%80%9CPickling%E2%80%9D%20is%20the%20process%20whereby,back%20into%20an%20object%20hierarchy." rel="noopener ugc nofollow" target="_blank"> pickle </a>:本地python库，用于将python对象作为文件保存(序列化)和加载(反序列化)到磁盘上。</li><li id="1276" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt np nq nr ns bi translated">烧瓶:一个基于python的简单易用的微型web框架。</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="da7b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">项目结构</h1><p id="b6fd" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">这个项目有四个主要部分:</p><ol class=""><li id="78b2" class="nk nl it la b lb lc le lf lh nm ll nn lp no lt np nq nr ns bi translated">iris.py —它包含我们的机器学习模型的代码，用于根据“iris.data”文件中的训练数据预测Iris Plant(分类)。</li><li id="369f" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt np nq nr ns bi translated">app . py——它包含Flask APIs，通过GUI或API调用接收Iris数据输入，根据我们的模型计算预测值并返回它。</li><li id="e59c" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt np nq nr ns bi translated">iris.pkl —包含训练后获得的预训练模型，将在app.py中用于预测。</li><li id="f654" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt np nq nr ns bi translated">模板-此文件夹包含允许用户输入输入要素并在网页中显示预测输出的HTML模板。</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="7b3d" class="nf md it bd me ny nz dn mi oa ob dp mm lh oc od mo ll oe of mq lp og oh ms oi bi translated">资料组</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/e07878153759d8a1e77cb7a69534fca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*LAZecqozRe7ys3YeV793kA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Pandas DataFrame</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="37a8" class="nf md it bd me ny nz dn mi oa ob dp mm lh oc od mo ll oe of mq lp og oh ms oi bi translated">模特培训</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="36f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们通过CSV文件读取数据，我们有四个输入特征和三个可能输出变量，因此我们对它们进行标记和编码以用于训练。之后，我们使用SVC(支持向量分类)进行模型训练，并使用pickle保存模型(iri.pkl)。对于你的问题可能不同，我们举了一个简单的例子来理解。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="216d" class="nf md it bd me ny nz dn mi oa ob dp mm lh oc od mo ll oe of mq lp og oh ms oi bi translated">烧瓶API</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><ul class=""><li id="63d2" class="nk nl it la b lb lc le lf lh nm ll nn lp no lt om nq nr ns bi translated">这里，我们通过调用flask(__name__)来初始化我们的Flask应用程序，并使用pickle加载模型。</li><li id="336f" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt om nq nr ns bi translated">" @app.route('/')"这里我们初始化了flask应用程序的根目录，并在其中定义了将在该根目录调用自身的函数。</li><li id="1998" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt om nq nr ns bi translated">" @app.route('/predict '，methods=['POST'])"这里我们定义了home函数，我们使用request.form[' ']从前端HTML页面获取数据并预测输出，然后将其发送回HTML页面以进行预测可视化。</li></ul><blockquote class="on"><p id="1f9a" class="oo op it bd oq or os ot ou ov ow lt dk translated">默认情况下，Flask路由响应<strong class="ak"> GET </strong>请求。然而，可以通过向<strong class="ak"> route() </strong> decorator提供方法参数来改变这种偏好。</p><p id="6c45" class="oo op it bd oq or ox oy oz pa pb lt dk translated">为了演示在URL路由中使用<strong class="ak"> POST </strong>方法，首先让我们创建一个HTML表单并使用<strong class="ak"> POST </strong>方法将表单数据发送到一个URL。</p></blockquote><p id="e9e8" class="pw-post-body-paragraph ky kz it la b lb pc ju ld le pd jx lg lh pe lj lk ll pf ln lo lp pg lr ls lt im bi translated">以下脚本在本地主机和默认端口(5000)上启动flask服务器，使<a class="ae lu" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">成为URL: http://127.0.0.1 </a> :5000/</p><blockquote class="ph pi pj"><p id="d49f" class="ky kz pk la b lb lc ju ld le lf jx lg pl li lj lk pm lm ln lo pn lq lr ls lt im bi translated"><em class="it">只需在浏览器上粘贴</em><a class="ae lu" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"><em class="it">http://127 . 0 . 0 . 1:5000/</em></a><em class="it">按回车键即可看到服务器工作。</em></p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="cef2" class="nf md it bd me ny nz dn mi oa ob dp mm lh oc od mo ll oe of mq lp og oh ms oi bi translated">Html模板</h2><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="9141" class="nf md it nb b gy ng nh l ni nj">templates folder<br/> |<br/> +-- home.html<br/> |    <br/> +-- after.html</span></pre><ol class=""><li id="8a23" class="nk nl it la b lb lc le lf lh nm ll nn lp no lt np nq nr ns bi translated">home.html是我们在浏览器中打开链接时打开的默认根页面。它包含一个表单，我们通过这个表单以文本格式提供输入特性(总共四个),点击提交按钮，它调用app.py中的home函数进行预测。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="d4b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.after.html是'/predict '目录中home函数的页面调用，它显示模型的预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="6397" class="nf md it bd me ny nz dn mi oa ob dp mm lh oc od mo ll oe of mq lp og oh ms oi bi translated">在本地系统上托管</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/d7d0e045c3f28c18f1654f3f595057bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hMjqJmwL25wN-kzYItQTGA.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Flask API</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="7ef7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">模型建立和部署流程图</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/f7f3bccc28c21441644a1e974e143ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ejG3RCFsnADEhLtITXxJfQ.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6447" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="e233" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">模型部署是任何机器学习管道的关键部分。</p><p id="e48e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Flask是一个简单的web应用程序框架，很容易构建。使用Flask API托管和共享机器学习模型真的很容易。</p><p id="da89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完整代码:<a class="ae lu" href="https://github.com/bharatc9530/Machine-Learning/tree/master/Model-Deployment-Using-Flask" rel="noopener ugc nofollow" target="_blank"><strong class="la iu"><em class="pk">Github</em></strong></a></p><p id="d78e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想了解更多关于模型部署的知识，我想在youtube上用flask和docker调出这个<a class="ae lu" href="https://www.youtube.com/watch?v=hTacGMfL8lc&amp;list=PLZoTAELRMXVNKtpy0U_Mx9N26w8n0hIbs" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">优秀播放列表</strong> </a>由<a class="ae lu" href="https://www.youtube.com/channel/UCNU_lfiiWBdtULKOw6X0Dig" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">克里斯纳伊克</strong> </a>制作。这是对我帮助最大的一个。一定要去看看。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4229" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参考</h1><ol class=""><li id="446f" class="nk nl it la b lb mu le mv lh pq ll pr lp ps lt np nq nr ns bi translated"><a class="ae lu" href="https://www.tutorialspoint.com/flask/flask_http_methods.htm" rel="noopener ugc nofollow" target="_blank">https://www.tutorialspoint.com/flask/flask_http_methods.htm</a></li><li id="43cf" class="nk nl it la b lb nt le nu lh nv ll nw lp nx lt np nq nr ns bi translated"><a class="ae lu" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank">https://flask.palletsprojects.com/en/1.1.x/</a></li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="8347" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">谢谢你的阅读。我也希望在未来写更多初学者友好的帖子，顺便说一下，这是我在<strong class="la iu">媒体</strong>上的第一个帖子。</p><div class="pt pu gp gr pv pw"><a href="https://www.datadriveninvestor.com/2020/02/19/five-data-science-and-machine-learning-trends-that-will-define-job-prospects-in-2020/" rel="noopener  ugc nofollow" target="_blank"><div class="px ab fo"><div class="py ab pz cl cj qa"><h2 class="bd iu gy z fp qb fr fs qc fu fw is bi translated">将定义2020年就业前景的五大数据科学和机器学习趋势|数据驱动…</h2><div class="qd l"><h3 class="bd b gy z fp qb fr fs qc fu fw dk translated">数据科学和ML是2019年最受关注的趋势之一，毫无疑问，它们将继续发展…</h3></div><div class="qe l"><p class="bd b dl z fp qb fr fs qc fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="qf l"><div class="qg l qh qi qj qf qk ks pw"/></div></div></a></div><p id="e5f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae lu" href="https://medium.com/@bharatchoudhary817" rel="noopener"> <strong class="la iu">中</strong> </a>跟我上来。一如既往，我欢迎反馈和建设性的批评，可以通过<a class="ae lu" href="http://www.linkedin.com/in/bharat-choudhary-9530" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> Linkedin </strong> </a>联系。</p><p id="994d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">访问专家视图— </strong> <a class="ae lu" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>