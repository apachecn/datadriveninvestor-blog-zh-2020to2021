<html>
<head>
<title>How a walk up Mt Maunganui leads to creating a map of New Zealand</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何登上Maunganui山，从而创建一幅新西兰地图</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/map-of-nz-using-geo-markers-de87c4e537f8?source=collection_archive---------42-----------------------#2020-12-28">https://medium.datadriveninvestor.com/map-of-nz-using-geo-markers-de87c4e537f8?source=collection_archive---------42-----------------------#2020-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="126c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个项目的灵感始于本月初。我在Maunganui山度过了一个小型的家庭假期。在众多的活动中，我们开始攀登毛奥山。</p><p id="0058" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在峰顶，欢迎你的不仅是海滨城镇的迷人景色，还有一个高大的不合适的建筑，被称为<em class="km">大地标记</em>，更具体地说是一个三角站。</p><p id="4053" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是位于Mauao顶部的确切trig站的牌匾:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/339b0fe2d6a3b4d9b62d169f17917245.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vLxrqDOYO2emv8s-.jpg"/></div></div></figure><p id="2c59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这启发了我这个项目。有了这些标记的完整数据库，它们的位置和高度，我们能绘制它们的地图并根据高度给它们上色吗？</p><p id="3b13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我们计划在接下来的项目中要做的。</p><p id="4df4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/ShivanS93/MapOfNZ" rel="noopener ugc nofollow" target="_blank">这里是代码</a>到Github的链接。</p><h2 id="f91d" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">学习要点</h2><p id="3e64" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">在我们开始之前，我们先来看看一些学习点，这是这篇文章提供的。</p><ul class=""><li id="ef26" class="lx ly iq jp b jq jr ju jv jy lz kc ma kg mb kk mc md me mf bi translated">如何使用<code class="fe mg mh mi mj b">pandas</code>加载<code class="fe mg mh mi mj b">.csv</code>数据</li><li id="1f75" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk mc md me mf bi translated">使用<code class="fe mg mh mi mj b">matplotlib</code>及其功能</li><li id="9d48" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk mc md me mf bi translated"><code class="fe mg mh mi mj b">pandas</code> groupby方法和聚合</li><li id="7de0" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk mc md me mf bi translated">使用<code class="fe mg mh mi mj b">seaborn</code>作为结合<code class="fe mg mh mi mj b">matplotlib</code>绘图的方法</li></ul><h2 id="c590" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">如何访问数据</h2><p id="0f4b" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated"><a class="ae kl" href="https://koordinates.com/" rel="noopener ugc nofollow" target="_blank"> Koordinates网站</a>拥有新西兰大部分的地理空间数据。我们将需要创建一个帐户来访问这个项目的数据。谢天谢地，这不用花一分钱。</p><p id="a873" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以搜索<a class="ae kl" href="https://koordinates.com/from/data.linz.govt.nz/layer/50784/" rel="noopener ugc nofollow" target="_blank"> NZ大地垂直标志</a>。这些数据是由新西兰土地信息网站成员策划的。选择<em class="km">垂直标记</em>以特定格式显示高度。</p><p id="db97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">说到高度，简单的测量并不那么简单。</p><p id="0800" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不涉及太多细节，垂直基准类似于所谓的<em class="km">正常正高</em>。这就是我们最熟悉的海拔高度。正常正高实际上是海平面的平均高度(因为海平面会随着潮汐而变化)。</p><p id="3897" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这与<em class="km">椭球高</em>相反，后者将地球近似为椭球形，并以此作为参考点。</p><p id="5154" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.linz.govt.nz/data/geodetic-system/datums-projections-and-heights/vertical-datums" rel="noopener ugc nofollow" target="_blank">林茨网站对此有更详细的介绍</a>。</p><h2 id="ff51" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">导入库并加载数据</h2><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="de18" class="kz la iq mj b gy mt mu l mv mw">import pandas as pd<br/>import numpy as np<br/><br/>#import random as r<br/><br/>import matplotlib.pyplot as plt<br/>from matplotlib.colors import ListedColormap<br/>import matplotlib.colors as colors<br/>import matplotlib.cm as cmx<br/>from matplotlib.lines import Line2D<br/><br/>import seaborn as sns<br/><br/>%matplotlib inline</span></pre><p id="6e4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们可以使用<code class="fe mg mh mi mj b">!</code>来唤起一个神奇的功能。在下面的例子中，我们使用linux命令<code class="fe mg mh mi mj b">ls</code>来列出目录<code class="fe mg mh mi mj b">./files</code>中的文件。</p><p id="52c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用<code class="fe mg mh mi mj b">.csv</code>文件并将其加载到熊猫数据帧中。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="7719" class="kz la iq mj b gy mt mu l mv mw"># find the name of the .csv file containing the data<br/>!ls ./files</span><span id="28dd" class="kz la iq mj b gy mx mu l mv mw">nz-geodetic-vertical-marks.csv	 nz-geodetic-vertical-marks.txt<br/>nz-geodetic-vertical-marks.csvt  nz-geodetic-vertical-marks.vrt<br/>nz-geodetic-vertical-marks.prj	 nz-geodetic-vertical-marks.xml</span><span id="bde5" class="kz la iq mj b gy mx mu l mv mw"># load into dataframe<br/>geomarks = pd.read_csv('files/nz-geodetic-vertical-marks.csv')<br/>geomarks</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/3b52ee1a78de68733f9d100bec6ce0bd.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ynzt1vfHbSZu7LWtFf9tug.png"/></div></figure><p id="446b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们将数据加载到熊猫数据框架中。让我们进一步探究这些数据。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="2269" class="kz la iq mj b gy mt mu l mv mw"># explore the data more<br/>geomarks.info()</span><span id="e864" class="kz la iq mj b gy mx mu l mv mw">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 105583 entries, 0 to 105582<br/>Data columns (total 15 columns):<br/> #   Column                     Non-Null Count   Dtype  <br/>---  ------                     --------------   -----  <br/> 0   WKT                        105583 non-null  object <br/> 1   id                         105583 non-null  int64  <br/> 2   nod_id                     105583 non-null  int64  <br/> 3   geodetic_code              105583 non-null  object <br/> 4   current_mark_name          105583 non-null  object <br/> 5   description                73350 non-null   object <br/> 6   mark_type                  105583 non-null  object <br/> 7   beacon_type                93424 non-null   object <br/> 8   mark_condition             87315 non-null   object <br/> 9   order                      105583 non-null  object <br/> 10  land_district              105295 non-null  object <br/> 11  normal_orthometric_height  105583 non-null  float64<br/> 12  coordinate_system          105583 non-null  object <br/> 13  shape_X                    105583 non-null  float64<br/> 14  shape_Y                    105583 non-null  float64<br/>dtypes: float64(3), int64(2), object(10)<br/>memory usage: 12.1+ MB</span></pre><h2 id="1abe" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">探索数据</h2><p id="fd1c" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">我们可以看到总共有105，582个条目。</p><p id="1354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重要的特征(输入变量)是<code class="fe mg mh mi mj b">shape_X</code>、<code class="fe mg mh mi mj b">shape_Y</code>，类似于经度和纬度，以及<code class="fe mg mh mi mj b">normal_orthometric_height</code>，是高度。这些都考虑到了，没有遗漏值。</p><p id="95c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe mg mh mi mj b">shape_X</code>和<code class="fe mg mh mi mj b">shape_Y</code>，我们实际上可以画出这个来表示地理空间。这可能以前已经做过无数次了，但是当我在Aurélien Géron的书<em class="km"> Hands On Machine Learning，第二版</em>中发现这一点时，它让我大吃一惊！</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="5322" class="kz la iq mj b gy mt mu l mv mw">mapNZ = geomarks.plot(kind='scatter', x='shape_X', y='shape_Y',  figsize=(10,10))<br/>ax = plt.axis('off')</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/70a04c42248cf1fbc5c9c66d0e6f0eb9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dlFSbF1YUZNUXwIWnVLm0g.png"/></div></figure><p id="e87a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">眼熟吗？</p><p id="ce64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是新西兰！</p><p id="d33c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">标记太多了，准确的说是105582个。所以，让我们减小标记的大小。我们可以改变参数:</p><ul class=""><li id="bfbf" class="lx ly iq jp b jq jr ju jv jy lz kc ma kg mb kk mc md me mf bi translated"><code class="fe mg mh mi mj b">alpha</code> -这是标记的不透明度</li><li id="9481" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk mc md me mf bi translated"><code class="fe mg mh mi mj b">s</code> -标记的大小</li></ul><p id="5882" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将使我们更容易看到单个的标记。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="72a3" class="kz la iq mj b gy mt mu l mv mw">mapNZ = geomarks.plot(kind='scatter', x='shape_X', y='shape_Y', <br/>                       figsize=(10,10), alpha=0.8, s=0.2)<br/>ax = plt.axis('off')</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/17c33199f090cd18a49ba51909cab9b4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*rlX3KKhsWTy6fHzgn3u35A.png"/></div></figure><p id="fcdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以根据垂直高度应用颜色。</p><p id="5b24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些重要的参数是:</p><ul class=""><li id="fd4f" class="lx ly iq jp b jq jr ju jv jy lz kc ma kg mb kk mc md me mf bi translated"><code class="fe mg mh mi mj b">c</code> -这是点数的颜色</li><li id="5d0b" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk mc md me mf bi translated"><code class="fe mg mh mi mj b">cmap</code> -这提供了配色方案；我们将使用<code class="fe mg mh mi mj b">jet</code></li></ul><p id="44fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">利用这些参数将为我们的图表创建另一个维度。</p><p id="7f33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还根据高度改变了标记的大小，以强调这一属性。我们除以100，以便进行明显的缩放。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="0f35" class="kz la iq mj b gy mt mu l mv mw">mapNZ = geomarks.plot(kind='scatter', x='shape_X', y='shape_Y', <br/>                            figsize=(10,8), s=geomarks['normal_orthometric_height']/100,<br/>                            c='normal_orthometric_height', cmap=plt.get_cmap('jet'), colorbar=True)<br/><br/>ax = plt.axis('off')</span><span id="a598" class="kz la iq mj b gy mx mu l mv mw">/home/shivan/miniconda3/envs/shivan_env/lib/python3.7/site-packages/matplotlib/collections.py:922: RuntimeWarning: invalid value encountered in sqrt<br/>  scale = np.sqrt(self._sizes) * dpi / 72.0 * self._factor</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/d7e817cb4e96a452c5772eb5642b55b7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7kT0zeIzVKnmr-KGl-b1dQ.png"/></div></figure><p id="671b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能会注意到，尽管垂直高度改变了标记的大小，但较低的点淹没了较高的点。</p><p id="84c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们更详细地探索垂直高度时，我们可以看到大多数都在较低的一端。a图显示的数据是<em class="km">尾重</em>。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="7625" class="kz la iq mj b gy mt mu l mv mw">heights = geomarks['normal_orthometric_height']<br/>heights.describe()</span><span id="567f" class="kz la iq mj b gy mx mu l mv mw">count    105583.000000<br/>mean        176.935780<br/>std         280.401109<br/>min         -34.179500<br/>25%          17.300748<br/>50%          56.743200<br/>75%         223.130634<br/>max        3029.710448<br/>Name: normal_orthometric_height, dtype: float64</span><span id="90ee" class="kz la iq mj b gy mx mu l mv mw">height_graphs = heights.plot(kind='hist', bins=50, figsize=(15,5), title='Histogram of Heights')</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/f69c0cec9b44be93e1aaef642a2cd5ec.png" data-original-src="https://miro.medium.com/v2/format:webp/1*9kU4nqe_fbD0OYn7C9DyVA.png"/></div></figure><p id="764a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过cmap改变α。我们采用cmap并改变α，与较高高度的暖色相比，较冷的颜色与较低的垂直高度相关联，也具有较低的α。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="15bd" class="kz la iq mj b gy mt mu l mv mw">x = geomarks['shape_X']<br/>y = geomarks['shape_Y']<br/>c = geomarks['normal_orthometric_height']<br/>s = geomarks['normal_orthometric_height']/100<br/><br/>cmap = plt.cm.jet<br/>my_cmap = cmap(np.arange(cmap.N))<br/>my_cmap[:, -1] = np.linspace(0, 1, cmap.N)<br/><br/>my_cmap = ListedColormap(my_cmap)<br/><br/>plt.figure(figsize=(10,8))<br/>plt.scatter(x, y, c=c, s=s, cmap=my_cmap)<br/>plt.title("Map of New Zealand")<br/>ax = plt.axis('off')<br/>cbar = plt.colorbar()</span><span id="a118" class="kz la iq mj b gy mx mu l mv mw">/home/shivan/miniconda3/envs/shivan_env/lib/python3.7/site-packages/matplotlib/collections.py:922: RuntimeWarning: invalid value encountered in sqrt<br/>  scale = np.sqrt(self._sizes) * dpi / 72.0 * self._factor</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/2a39126e726301377787e1f24abaec25.png" data-original-src="https://miro.medium.com/v2/format:webp/1*kXB4h3vQa215tyYvsy-pyw.png"/></div></figure><p id="481b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们打算制作的地图。</p><p id="cac5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们不要就此打住！让我们看看其他方面的数据。</p><div class="mz na gp gr nb nc"><a href="https://www.datadriveninvestor.com/2020/12/07/name-matching-techniques-with-python/" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">使用Python |数据驱动投资者的名称匹配技术</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">我们确实面临很多情况，我们必须匹配一个有很多变体的单词。这可能是因为错别字…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq kx nc"/></div></div></a></div><p id="f5fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以看到暗红色的点是所有标记中最高的。这是<a class="ae kl" href="https://en.wikipedia.org/wiki/Mount_Aspiring_/_Tititea" rel="noopener ugc nofollow" target="_blank">Mt aspirating</a>，不是新西兰最高的山峰，是奥拉基或库克山。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="c397" class="kz la iq mj b gy mt mu l mv mw"># Top highest geodetic markers in New Zealand<br/>geomarks.sort_values(by='normal_orthometric_height', ascending=False).head()</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/e4d39eb68d868124954f1a1ec8f8a9ce.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Ux0Rwa-SH3yZqxkokr4v0g.png"/></div></figure><h2 id="4f0c" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">进一步的数据探索</h2><p id="394f" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">让我们看看每个地区的标记。然后，我们可以将这些数据绘制成柱状图。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="0ece" class="kz la iq mj b gy mt mu l mv mw">geomarks['land_district'] = geomarks['land_district'].astype('str')<br/>by_district = geomarks['land_district'].value_counts()<br/>by_district</span><span id="88f0" class="kz la iq mj b gy mx mu l mv mw">North Auckland    24125<br/>South Auckland    15496<br/>Wellington        12595<br/>Canterbury        11741<br/>Nelson             9129<br/>Otago              8326<br/>Gisborne           5765<br/>Southland          4847<br/>Hawkes Bay         4427<br/>Taranaki           3092<br/>Marlborough        2884<br/>Westland           2868<br/>nan                 288<br/>Name: land_district, dtype: int64</span></pre><p id="d1ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到实际上有一些隐藏的<code class="fe mg mh mi mj b">nan</code>。<a class="ae kl" href="https://en.wikipedia.org/wiki/NaN" rel="noopener ugc nofollow" target="_blank">南代表‘不是一个数’</a>。它表示空数据。</p><p id="64de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过将列类型转换为字符串来揭示这些<code class="fe mg mh mi mj b">nan</code>。我们需要丢弃这些以便进行后续处理。</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="523b" class="kz la iq mj b gy mt mu l mv mw">geomarks = geomarks[geomarks['land_district']!='nan']<br/>by_district = geomarks['land_district'].value_counts()<br/>by_district</span><span id="2907" class="kz la iq mj b gy mx mu l mv mw">North Auckland    24125<br/>South Auckland    15496<br/>Wellington        12595<br/>Canterbury        11741<br/>Nelson             9129<br/>Otago              8326<br/>Gisborne           5765<br/>Southland          4847<br/>Hawkes Bay         4427<br/>Taranaki           3092<br/>Marlborough        2884<br/>Westland           2868<br/>Name: land_district, dtype: int64</span></pre><p id="540d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，<code class="fe mg mh mi mj b">nan</code>已经被移走了</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="ba16" class="kz la iq mj b gy mt mu l mv mw">by_district.plot(kind='bar', title='Number of Marks by district')<br/>plt.show()</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/bc534ca9db7e70d86b78f639d1d83a20.png" data-original-src="https://miro.medium.com/v2/format:webp/1*D0mV3kz9rNHkUFfHjLg0eQ.png"/></div></figure><p id="2c11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来我们来看看各区的平均高度。我们使用<code class="fe mg mh mi mj b">groupby</code>和<code class="fe mg mh mi mj b">agg</code>或聚合来实现这一点。我们还将删除额外的列以提高可读性</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="9acc" class="kz la iq mj b gy mt mu l mv mw">district_group = geomarks.groupby('land_district') # groups data by district<br/>district_means = district_group.agg(['mean', 'sem']) # 'sem' means standard error, sem = std / n ** (1/2)<br/>district_means = district_means.drop(['id', 'nod_id', 'shape_X', 'shape_Y'], axis=1) # dropping extra columns for readability<br/>district_means = district_means.sort_values(by=('normal_orthometric_height', 'mean'), ascending=False)<br/>district_means</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/532531138e914ec356f0ee58f4afd676.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TtdVO_fhocXOcmVSm5JU9g.png"/></div></figure><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="4f7d" class="kz la iq mj b gy mt mu l mv mw">x = district_means[('normal_orthometric_height', 'mean')]<br/>err = district_means[('normal_orthometric_height', 'sem')]<br/><br/># notice how we call the tuple for a hierarchical column<br/><br/>plt.figure(figsize=(10,5))<br/><br/>plt.barh(y=x.index, width=x.values, xerr=err, capsize=5)<br/><br/>plt.title('Mean Heights per District')<br/>plt.xlabel('Mean of Height')<br/>plt.ylabel('District')<br/>plt.show()</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/0a20a551749536be96ad68e8c8adf70e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*leugJx38NwLC6iFdJWm78Q.png"/></div></figure><p id="b64e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到奥塔哥平均得分最高。</p><p id="aecd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们回到新西兰地图。我们要做的不同的是，我们要绘制点，但使用分类颜色。颜色将基于地区。颜色将根据该地区的平均高度进行排名。</p><p id="7604" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用<code class="fe mg mh mi mj b">seaborn</code>调色板来创建颜色标签，它将是间隔均匀的RGB值。</p><p id="3164" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还必须使用<code class="fe mg mh mi mj b">Lin2D</code>创建一个自定义图例</p><pre class="ko kp kq kr gt mp mj mq mr aw ms bi"><span id="2ed2" class="kz la iq mj b gy mt mu l mv mw">x = geomarks['shape_X']<br/>y = geomarks['shape_Y']<br/>s = geomarks['normal_orthometric_height'] / 500<br/><br/>plt.figure(figsize=(10,10))<br/><br/>colour_labels = list(district_means.index) # turns districts into a list<br/>rgb_values = sns.color_palette('coolwarm_r', len(colour_labels)) # use seaborn to create colours, <br/>                                                                 # the number is based on the number of districts<br/>colour_map = dict(zip(colour_labels, rgb_values)) # create a dict of district as keys and colours as values<br/><br/>legend_elements = [Line2D([0], [0], marker='o', color='w', markersize=8,<br/>                          markerfacecolor=colour_map[label]) for label in colour_map] # creating a legend<br/><br/>NZ_d_map = plt.scatter(x, y, alpha=0.5, s=s, c=geomarks['land_district'].map(colour_map))<br/>leg_ = plt.legend(legend_elements, colour_labels)<br/>ax = plt.axis('off')<br/>title_ = plt.title('Plot of Geodetic Markers coloured by district')</span><span id="1d12" class="kz la iq mj b gy mx mu l mv mw">/home/shivan/miniconda3/envs/shivan_env/lib/python3.7/site-packages/matplotlib/collections.py:922: RuntimeWarning: invalid value encountered in sqrt<br/>  scale = np.sqrt(self._sizes) * dpi / 72.0 * self._factor</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/f1ce633fc75e8ed5942ea61791e2b912.png" data-original-src="https://miro.medium.com/v2/format:webp/1*jdN6CQUMrgPno7TaicXnXQ.png"/></div></figure><p id="1709" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了一张新西兰的地图，它是基于陆地区域的颜色编码的，按照标记的平均高度来排列。</p><h2 id="93e9" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">结论</h2><p id="f076" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">散步和假期对创造想法很有帮助。在这里，一次简单的登山激发了一个想法，那就是根据新西兰周围的大地测量标志的高度来制作一幅地图。</p><p id="cdf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用了各种技术——多亏了Python库、<code class="fe mg mh mi mj b">pandas</code>、<code class="fe mg mh mi mj b">numpy</code>、<code class="fe mg mh mi mj b">matplotlib</code>和<code class="fe mg mh mi mj b">seaborn</code>—来处理来自<a class="ae kl" href="https://koordinates.com/" rel="noopener ugc nofollow" target="_blank"> Koordinates </a>和<a class="ae kl" href="https://www.linz.govt.nz/" rel="noopener ugc nofollow" target="_blank">Land Information New Zealand(LINZ)</a>的数据。</p><p id="5456" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用这些数据创建了一幅新西兰地图，根据大地测量标志的正常正高进行了颜色编码。除此之外，我们创建了另一个基于陆地区域的地图，这是根据每个区域的平均高度排列的。</p><p id="b265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望这能对你有所帮助，我很想知道这些数据还能做些什么。请与你认为会对此感兴趣的人分享。</p><h2 id="4a60" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">参考</h2><ol class=""><li id="7438" class="lx ly iq jp b jq ls ju lt jy nr kc ns kg nt kk nu md me mf bi translated">芒恩古奈山—可看可做的事情—北岛|新西兰。(未注明)。<a class="ae kl" href="http://Www.Newzealand.com." rel="noopener ugc nofollow" target="_blank">Www.Newzealand.com。https://www.newzealand.com/int/mount-maunganui/</a>T2</li><li id="dbe0" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">芒恩古奈山。(2020年11月20日)。维基百科。<a class="ae kl" href="https://en.wikipedia.org/wiki/Mount_Maunganui_(mountain)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Mount _ Maunganui _(mountain)</a></li><li id="e68d" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">地球的数据平台。(未注明)。Koordinates.com。<a class="ae kl" href="https://koordinates.com/" rel="noopener ugc nofollow" target="_blank">https://koordinates.com/</a></li><li id="e1dd" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">新西兰大地垂直标记。(未注明)。Koordinates.com。检索于2020年12月11日，来自<a class="ae kl" href="https://koordinates.com/from/data.linz.govt.nz/layer/50784/" rel="noopener ugc nofollow" target="_blank">https://koordinates.com/from/data.linz.govt.nz/layer/50784/</a></li><li id="2535" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">新西兰土地信息局。(未注明)。新西兰土地信息局。<a class="ae kl" href="https://www.linz.govt.nz/" rel="noopener ugc nofollow" target="_blank">https://www.linz.govt.nz/</a></li><li id="5244" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">垂直基准。(未注明)。新西兰土地信息局。2020年12月11日检索，来自<a class="ae kl" href="https://www.linz.govt.nz/data/geodetic-system/datums-projections-and-heights/vertical-datums" rel="noopener ugc nofollow" target="_blank">https://www . Linz . govt . NZ/data/geodetic-system/datums-projections-and-heights/vertical-datums</a></li><li id="5ae9" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">(2019).第二章:端到端机器学习项目【第二章:端到端机器学习项目回顾】。《机器学习实践》(第35-84页)。奥雷利。</li><li id="84a4" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">Python R. Plot With Pandas:面向初学者的Python数据可视化——真正的Python。realpython.com。2020年12月11日接入。<a class="ae kl" href="https://realpython.com/pandas-plot-python/" rel="noopener ugc nofollow" target="_blank">https://realpython.com/pandas-plot-python/</a></li><li id="dfe9" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">如何规范熊猫数据框列？CodeSpeedy。2020年2月19日发布。2020年12月11日接入。<a class="ae kl" href="https://www.codespeedy.com/normalize-a-pandas-dataframe-column/" rel="noopener ugc nofollow" target="_blank">https://www . code speedy . com/normalize-a-pandas-data frame-column/</a></li><li id="1208" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">阿卜迪沙库尔。(2020年4月29日)。如何用Python制作按Alpha值的地图？检索自Medium网站:<a class="ae kl" href="https://towardsdatascience.com/how-to-make-value-by-alpha-maps-in-python-484722160490" rel="noopener" target="_blank">https://towardsdatascience . com/how-to-make-value-by-alpha-maps-in-python-484722160490</a></li><li id="fec9" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">Python数据分析库— pandas: Python数据分析库。Pydata.org。2018年发布。<a class="ae kl" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/</a></li><li id="92b6" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">Python熊猫-group by-Tutorialspoint。【www.tutorialspoint.com】T2。2020年12月14日接入。<a class="ae kl" href="https://www.tutorialspoint.com/python_pandas/python_pandas_groupby.htm" rel="noopener ugc nofollow" target="_blank">https://www . tutorialspoint . com/python _ pandas/python _ pandas _ group by . htm</a></li><li id="0c85" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">Python中Matplotlib按类别散点图颜色。卡诺基。2020年8月30日发布。2020年12月15日接入。<a class="ae kl" href="https://kanoki.org/2020/08/30/matplotlib-scatter-plot-color-by-category-in-python/" rel="noopener ugc nofollow" target="_blank">https://Kano ki . org/2020/08/30/matplotlib-scatter-plot-color-by-category-in-python/</a></li><li id="a80d" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">编写自定义图例— Matplotlib 3.2.1文档。matplotlib.org。2020年12月24日访问。<a class="ae kl" href="https://matplotlib.org/3.2.1/gallery/text_labels_and_annotations/custom_legends.html" rel="noopener ugc nofollow" target="_blank">https://matplotlib . org/3 . 2 . 1/gallery/text _ labels _ and _ annotations/custom _ legends . html</a></li><li id="26c6" class="lx ly iq jp b jq mk ju ml jy mm kc mn kg mo kk nu md me mf bi translated">mount aspirating/titi tea。维基百科。2020年8月12日出版。2020年12月24日访问。<a class="ae kl" href="https://en.wikipedia.org/wiki/Mount_Aspiring_/_Tititea" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Mount_Aspiring_/_Tititea</a></li></ol><h2 id="0414" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">访问专家视图— <a class="ae kl" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank">订阅DDI英特尔</a></h2></div></div>    
</body>
</html>