<html>
<head>
<title>Cloud-based Mining Botnet Trends in 2019: Mining Trojans Spreading as Worms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2019年基于云的挖矿僵尸网络趋势:挖矿木马作为蠕虫传播</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/cloud-based-mining-botnet-trends-in-2019-mining-trojans-spreading-as-worms-96eb9cf5481?source=collection_archive---------10-----------------------#2020-02-17">https://medium.datadriveninvestor.com/cloud-based-mining-botnet-trends-in-2019-mining-trojans-spreading-as-worms-96eb9cf5481?source=collection_archive---------10-----------------------#2020-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="94e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挖矿木马(mining trojan)是一种利用漏洞入侵计算机并植入挖矿软件以挖掘加密数字货币获利的木马。受影响的计算机可能会经历CPU使用率增加、系统延迟和业务服务失败。为了长时间保留在服务器上，挖矿木马使用各种方法来危害服务器安全，例如修改计划任务、防火墙配置和系统动态链接库，这可能会导致目标服务器上的服务中断。</p><div class="kl km gp gr kn ko"><a href="https://www.datadriveninvestor.com/2018/09/22/infographic-journey-to-the-clouds/" rel="noopener  ugc nofollow" target="_blank"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">信息图:云之旅|数据驱动的投资者</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">聪明的企业领导者了解利用云的价值。随着数据存储需求的增长，他们已经…</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><p id="3930" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挖矿木马最早出现在2012年。自2017年以来，加密数字货币的价格飙升，由于Monero等匿名硬币的出现，服务器的计算资源可以得到更好的利用，这些硬币无法追踪，并且不受ASIC矿商的影响。自2018年以来，挖矿木马一直是互联网上的一大安全威胁。阿里云安全团队长期跟踪研究挖矿木马。2019年，我们检测到多起挖矿木马的爆发，其中一些木马呈现出新的发展趋势。本文根据我们的长期监测数据，分析总结了2019年观察到的挖矿木马趋势。</p><h1 id="4ca2" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">现状</h1><ul class=""><li id="936d" class="mc md iq jp b jq me ju mf jy mg kc mh kg mi kk mj mk ml mm bi translated">2019年共检测出80个带有挖矿僵尸网络的主要网络犯罪集团，以Linux服务器为主要攻击目标。</li><li id="b539" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">目前木马以蠕虫的形式传播。攻击通常是通过利用多个漏洞发起的。</li><li id="9824" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">非法加密货币矿工通过暴力攻击传播木马。弱密码仍然是互联网上的主要威胁。</li><li id="7476" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">非web基础框架和组件的安全配置不当，为挖矿木马的传播提供了新的机会。</li><li id="5eb3" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">网络犯罪集团经常利用常见的N日漏洞来传播采矿僵尸网络。这缩短了用户必须修复N天漏洞的时间。</li><li id="feac" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">企业必须开发更专业的安全突发事件响应能力，以应对使用日益复杂的方法来危害安全和争夺资源的挖矿木马。</li></ul><h1 id="dedf" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">大局</h1><p id="d25f" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">2019年共检测到80个传播采矿木马的主要网络犯罪集团。下图和表分别显示了前10个最活跃的特洛伊木马家族及其概况，其中特洛伊木马的活跃性通过其受害者总数来衡量。在被入侵的主机中，69%使用Linux操作系统，31%使用Windows。十大最活跃的特洛伊木马家族主要针对Linux操作系统。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/215e42dbda05551a72ba76d3fa89efd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4sfPshs9XcYI1GXt.png"/></div></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1d2d829c12f23feb1db740e16bbb3ca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*rQ2Hunm0NspFHtxCdKKlgA.png"/></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/30390c8e3f5ff4d1c7d2c78c80f9b0d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Nfa0kfWT7IUfyGUnXtmehA.png"/></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/e4dc72ffec7ced7f7fb27e6cc96b639f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*BdH4kwCcPp7Jk2eRO2C0sQ.png"/></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/d8cb655db03465cd2981f2ac31871abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*obC4I1mZ2GzLfpP8.png"/></div></div></figure><h1 id="998c" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">攻击趋势</h1><p id="3d44" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">1.目前，挖矿木马作为蠕虫传播，通常通过利用多个漏洞进行攻击。2019年暴露了大量RCE漏洞。一个N天的漏洞在暴露后很难在短时间内修复，可能很快被黑客利用来传播挖矿木马和僵尸网络。2019年，我们发现了一些常见漏洞被非法加密货币矿工利用的事件。下图显示了一些漏洞从暴露到被利用的时间表。大多数漏洞被非法加密货币矿工在几天到十几天的时间内利用。这对云平台和用户的快速响应能力提出了严峻的挑战。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nj"><img src="../Images/6b79736cc32863adcbe919778e5c5907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tYjg7rAs9pJWMLVO.png"/></div></div></figure><p id="656c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.目前，特洛伊木马以蠕虫的形式传播，通常通过利用多个漏洞来发起攻击。前10名最活跃的挖矿木马以蠕虫形式传播(8220 Miner除外)，并利用两个以上的漏洞(CryptoSink除外)。这意味着挖矿木马的传播方式更加有效和广泛。如果企业的信息系统包含易于被任意利用的漏洞，那么在安全边界被打破之后，企业的内部网络可能很快就会受到危害。企业必须开发全面的漏洞防御能力，以应对单点防御失败时出现的漏桶效应。</p><p id="49c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.非法加密货币矿工通过暴力攻击传播木马。弱密码仍然是互联网上的主要威胁。下图显示了不同应用程序因加密货币挖掘而受损的百分比。Redis、SSH、SQL Server和RDP仍然是主要目标。由于O&amp;M工程师的安全意识不足，弱密码在互联网上被广泛使用。暴力攻击容易发动，已经成为挖矿木马传播的重要手段。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/5b1e576b20f8ba66db280cd4264514a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lyCjZjclfWTnYI1L.png"/></div></div></figure><p id="6958" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.非web基础框架和组件的安全配置不当，为挖矿木马的传播提供了新的机会。近年来，大数据和容器等新技术得到了广泛应用，企业开始在云迁移后将开发和测试环境部署在云上。这使得服务配置面临安全威胁，因为企业缺乏专业的安全工程师，技术工程师缺乏安全意识。例如，服务暴露在互联网上，接口缺乏认证并使用弱密码，N天漏洞被暴露。易受攻击的应用程序通常是企业的非核心业务，因此在安全强化和漏洞修复方面没有web应用程序得到的投资多。易受攻击的应用程序通常是通过非标准端口或使用非HTTP协议提供的，并且不能受到本地安全策略的完全保护。2018年以来，挖矿木马通过大数据和容器组件传播。自2019年以来，容器编排和供应链框架和组件一直是挖掘木马攻击的目标。下表列出了已被挖矿木马利用的非web基础框架和组件的漏洞。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nk"><img src="../Images/9efa81f6b5404f44640a17b1c7b27efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*bKwqpi8BfKA3Y4YJ69cTIA.png"/></div></div></figure><h1 id="aeb7" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">攻击方法的趋势</h1><p id="c3d7" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">成功入侵后，挖掘木马可能会使用多种方法来危害安全，并阻止安全系统检测和删除它。这使得木马可以稳定、长期地挖掘虚拟货币。挖矿木马不得不用多种方法争夺资源。我们观察到2019年挖矿木马使用越来越复杂的安全妥协和资源争用方法。下面列出了挖掘僵尸网络使用的主要方法。</p><h1 id="62dc" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">1.安全妥协</h1><ul class=""><li id="8943" class="mc md iq jp b jq me ju mf jy mg kc mh kg mi kk mj mk ml mm bi translated">无文件攻击</li></ul><p id="a19a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无文件攻击是在没有将恶意软件植入磁盘的情况下发起的，因此它可以绕过防病毒软件的静态扫描。因此，防病毒软件很难检测和防御无文件攻击。在挖掘僵尸网络中，通过调用各种工具(如Windows上的WMI命令行工具wmic.exe)或脚本语言(如PowerShell)提供的API来访问Windows Management Instrumentation(WMI)，从而发起无文件攻击。黑客利用wmic.exe通过以下代码发起无文件攻击:</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/fce385458df897883cc4cc18744abd42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cb6muIrHcUjyh-bi.png"/></div></div></figure><ul class=""><li id="3e83" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">Rootkit</li></ul><p id="09d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挖矿木马通过长期驻留在目标服务器上获取利润。Rootkit是恶意驻留技术的总称。恶意长期居留最常见的手法就是写预定任务。2019年预装的动态链接库rootkits被挖矿木马广泛使用。挖矿木马通过动态链接库的预加载机制，挂接常用函数，如libc中的readdir。当使用ps和top等shell命令从/proc/目录中读取进程信息时，恶意进程是隐藏的。下图显示了8220 Miner如何通过ProcessHider隐藏rootkits。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/a4fd49b7d61c69311685b11777573b97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-URqdb-C68eambt9.png"/></div></div></figure><ul class=""><li id="569e" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">中央控制</li></ul><p id="72b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在中央控制攻击中，黑客在受损主机上运行后门，后门定期与黑客操纵的中央控制服务器通信，允许黑客向受损主机发送命令并从中窃取数据。在恶意加密货币挖掘过程中，不需要对机器人进行强有力的控制。所以大部分挖矿木马都没有完整的中控模块。相反，黑客经常使用配置文件和计划任务来修改bot配置和升级bot版本。然而，自2019年以来，越来越多的采矿僵尸网络求助于中央控制，以在资源争夺中获得更大的优势。下图是h2Miner的一些中控模块。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/9d90f1c42f388d77262d61d6f4b8c0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ApAV_1cjrTlRhJSR.png"/></div></div></figure><ul class=""><li id="42f3" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">黑暗之网</li></ul><p id="fab2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挖矿僵尸网络将其服务器放在暗网和洋葱路由器(Tor)上，使得追踪挖矿木马和僵尸网络更加困难。暗网自2019年以来被挖矿僵尸网络广泛利用。下图显示了2019年5月爆发的名为徐璐的非法加密货币矿工的攻击过程，该矿工将其控制服务器隐藏在TOR上。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/3801d1c83ffabac722fae62e1d2fa715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-vbAGi2ZGJqsojbf.png"/></div></div></figure><h1 id="e649" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">2.资源竞争</h1><ul class=""><li id="0c1d" class="mc md iq jp b jq me ju mf jy mg kc mh kg mi kk mj mk ml mm bi translated">扼杀竞争进程</li></ul><p id="2cee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个挖矿僵尸网络根据进程指纹库检测其他挖矿进程，或者直接杀死CPU使用率高的进程。下图是h2Miner使用的一些指纹库，使用了460多个进程指纹。这也是2019年12月h2Miner突然崛起的原因之一。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/09572f4d1694e511e7fe186dd840f220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EKOZTjUyI2ahwOC9.png"/></div></div></figure><ul class=""><li id="c09d" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">修改防火墙配置</li></ul><p id="5d6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挖矿机器人会修改防火墙的iptables，并禁用易受攻击的服务端口，以阻止其他挖矿木马。或者，挖矿机器人禁用常见的挖矿池端口，以阻止竞争对手的加密货币挖矿。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/652c0e2ce0574ec705fe05bc71d15e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fR0noYDCGjlv9GYK.png"/></div></div></figure><ul class=""><li id="acdc" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">天坑</li></ul><p id="cc67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Sinkhole是安全工程师用来将恶意域名解析为无效IP地址的一种方法。挖矿僵尸网络利用Sinkhole进行资源争夺，通过修改/etc/hosts将竞争对手和常用挖矿池的域名解析为无效IP地址。这就阻断了竞争对手的加密货币挖掘。以下恶意代码允许采矿僵尸网络通过Sinkhole将竞争对手的域名解析为无效的IP地址。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/5da5e3d55c27979b495d08bb2139e5bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ditaQAIpwVoUAJ_l.png"/></div></div></figure><h1 id="ee9c" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">典型僵尸网络的示例</h1><p id="f551" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">2019年出现了一批利用挖矿木马的主要网络犯罪集团。他们以前所未有的方式发动了大规模的攻击。</p><ul class=""><li id="391e" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">watchdog(2月出现):这种蠕虫经常升级，并不断向其武器库中添加最新的漏洞。它通过2019年2月Nexus Repository Manager的最新RCE漏洞和2019年11月初Solr Velocity模板注入的最新远程命令执行漏洞进行传播。</li><li id="241f" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">miner guard(4月出现):该木马使用多种复杂的攻击方式，并提供全面的进程保护模块。</li><li id="4c4f" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">Kerberos(4月出现):该木马通过Confluence的RCE漏洞进行传播，并使用了多种基于持久性的攻击方法。</li><li id="d641" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">H2 miner(12月出现):该木马通过Redis 4.x的RCE漏洞广泛传播，并因其强大的竞争进程指纹库所衍生的资源争夺的巨大优势而成为2019年底最活跃的挖矿木马。</li></ul><p id="58c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2019年，许多长期存在的非法加密货币矿工不断升级他们的攻击方法，并广泛传播采矿木马。</p><ul class=""><li id="c689" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">DDGS:这个僵尸网络在一月份升级了中央控制的通信模块，然后在11月份又升级了一次。它从中央控制结构升级到非中央P2P结构，以完全隐藏其黑客操纵的中央控制服务器。</li><li id="5c68" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">Bulehero:这种蠕虫在2019年频繁升级，为其武器库中添加了最新的攻击方法。它在10月初通过PHPStudy最新的后门漏洞进行传播，并升级了其文件命名方式，以增强其资源竞争力。</li></ul><h1 id="7610" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">1.h2Miner</h1><p id="8d05" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">h2Miner是一个以Linux为目标的挖掘僵尸网络，它通过Redis破解入侵，并利用多个web服务漏洞。我们早在12月5日就检测到了h2Miner，并以恶意shell脚本h2.sh命名。它的活跃度一直很低，直到12月18日才爆发，并在短短五天内成为互联网上最活跃的采矿僵尸网络，超过了DDGS和MinerGuard。</p><p id="c42b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">h2Miner的爆发是由于其Redis入侵的新方法。Redis破解后，h2Miner通过利用Redis 4.x的RCE漏洞而不是编写调度任务(这是常用的方法)来启动权限提升。这使得h2Miner可以绕过Redis的安全配置。帕维尔·托波尔科夫(Pavel Toporkov)在2018年国际网络安全大会ZeroNights上阐述了h2Miner的新攻击方式。Redis在Redis 4.x以后的版本中增加了一个新的模块特性，允许您加载由C语言编译的so文件来运行特定的Redis命令。下图是h2Miner爆发前后的活动趋势。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/381a1f42b9eb9f7ddec296dbb6b08770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*trVasYpcl0xy-M4I.png"/></div></div></figure><p id="c7d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图是h2Miner的攻击过程。攻击者通过利用Redis 4.x的RCE漏洞加载red2.so恶意文件，以运行恶意命令来下载和运行恶意脚本。此脚本用于下载名为kinsing的恶意二进制文件，以接收来自中央控制服务器的黑客命令。这有助于发动攻击和传播蠕虫。下载的恶意脚本也删除了大量的竞争对手。所使用的指纹库包含460个竞争过程的指纹。这助长了h2Miner的快速爆发。如上图所示，12月18日h2Miner大规模爆发时，DDGS和MinerGuard的活跃度大幅下降。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/e72cf9d62ca6bd24a340f6447fd584aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sC8_eybmFvGu-QR5.png"/></div></div></figure><h1 id="2d76" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">2.DDGS</h1><p id="81cb" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">DDGS矿业僵尸网络于2017年10月首次曝光。它早期利用OrientDB的漏洞，现在又借助Redis的未授权访问漏洞和SSH的弱口令漏洞进行入侵。下图显示了DDGS的攻击过程。入侵主机后，DDGS下载i.sh恶意脚本和DDGS程序。然后，DDGS运行disable.sh脚本删除其他挖矿程序，在与黑客操纵的中央控制服务器通信后启动其挖矿程序，入侵其他主机。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/01bd412686d9b2d2f343889487f320ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G9YWK4_fHvC_6pod.png"/></div></div></figure><p id="8434" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">DDGS从2019年开始频繁升级，从301X升级到4008。它最近利用Nexus的RCE漏洞作为一种次要的攻击方法。DDGS在2019年两次更新了其中央控制协议，从中央控制结构到完全的P2P结构。</p><p id="80d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在DDGS 3014和早期版本中，中央控制服务器的IP地址被硬编码在恶意文件中，这使得安全工程师很容易跟踪。</p><p id="5ae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在2019年1月发布的DDGS 3015中，被攻破的主机使用Memberlist协议框架构建P2P网络，其中隐藏了真正的中控服务器。被入侵的主机需要使用该协议穿越P2P网络成员来定位真正的中央控制服务器。但是，与中央控制服务器的通信仍然是集中式的。安全工程师可以模拟被入侵的主机来获取中央控制服务器的真实IP地址。</p><p id="7f43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">DDGS于2019年11月升级到4008版本。在这个版本中，DDGS监听被入侵主机的随机端口，并通过网络将通信数据包转发给P2P网络成员。戈朗的烟斗()。这意味着被入侵的主机和中央控制服务器之间不存在直接通信。通信包可以通过其他被入侵的主机被路由到真正的中央控制服务器。中控服务器的IP地址隐藏在类似TOR的匿名结构中。下图显示了不同DDGS版本的中央控制结构。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/ef242f663cdd7835b780fb071c80b984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mBhdAqwR1CMRezkX.png"/></div></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/6f231a419dc6d3446ec319937d7532fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_EuBIp8w_J-Mwwg4.png"/></div></div></figure><h1 id="d936" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">3.矿工卫队</h1><p id="e827" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">MinerGuard是一个针对Windows和Linux的挖掘僵尸网络，利用Redis的未授权访问漏洞、SSH的弱密码漏洞和多个web服务漏洞。2019年4月爆发。MinerGuard在不同平台上使用相同的程序逻辑，并在受损主机上运行sysguard、networkservice和sysupdate恶意文件。</p><p id="1f90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">networkservice文件是MinerGuard的攻击模块，它利用了多个web服务漏洞。sysupdate模块是一个开源的Monero挖掘程序，它从config.json加载miner参数。sysguard模块更新中央控制服务器的IP地址，并确保病毒永久驻留在服务器上。sysguard模块启动后，将创建四个线程，分别用于更新中央控制服务器的IP地址、保护启动项目、启动守护进程和升级版本。sysguard模块提供了全面的保护，使MinerGuard在矿业僵尸网络中排名第三。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/959b1b6843a558ccc93bd5a2d6a3d813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Gaj_hE9C3HmEEgCg.png"/></div></div></figure><h1 id="8847" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">4.布勒赫罗</h1><p id="97d7" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">Bulehero矿虫出现于2018年初，2018年8月首次曝光。它的名称源自该蠕虫最初使用的域名bulehero.in。Bulehero以Windows服务器为目标，通过植入恶意挖矿软件获利。Bulehero通过使用多种复杂的攻击方式进行传播。自出现以来，它一直在频繁升级，并不断向其武库中添加新的攻击方法。</p><p id="7bc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2019年9月20日PHPStudy后门漏洞曝光后，Bulehero在十几天左右就被利用这个漏洞进行了传播。下图是Bulehero的攻击过程。攻击有效负载下载download.exe文件，该文件用于下载用于蠕虫传播和恶意挖掘的攻击模块、扫描模块和挖掘模块。三个模块的恶意文件在最近一次升级前通过将文件名伪装成系统文件名来隐藏。现在它们被改为随机文件名。随机文件名使O&amp;M工程师能够轻松识别和清除恶意文件，但防止竞争对手创建进程指纹。这让Bulehero在资源争夺上有了优势。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/fa7675436b94701752a016db4550e014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eIqoVyGeuMFeXgKw.png"/></div></div></figure><h1 id="3acb" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">5.工人们</h1><p id="773c" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">Kworkerds是一个针对Windows和Linux的挖掘僵尸网络，它利用了Redis的未授权访问漏洞、SSH的弱密码漏洞以及多个web服务漏洞，如WebLogic RCE漏洞。2018年9月爆发。Kworkerds非常活跃。它的恶意文件URL经常改变，但它的代码结构没有明显改变。Kworkerds可以利用漏洞下载并运行mr.sh/2mr.sh恶意脚本和植入挖掘程序。Kworkerds通过劫持动态链接库植入rootkit后门。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/2a7f672b5e614d53639d25335926e55c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zw7mZVDP3d_VuyQL.png"/></div></div></figure><h1 id="132e" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">6.克伯罗兹</h1><p id="a636" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">Kerberods是一种针对Linux的挖矿蠕虫。2019年4月利用合流的RCE漏洞(CVE-2019–3396)进行了广泛传播。下图显示了它的传播过程。Kerberods提供了一个持久化模块，使用三种持久化方法:(1)编写/etc/init.d/netdns文件启动恶意守护进程；(2)编写/usr/local/lib/libpamcd.so来挂接所有系统函数；(3)将用于下载恶意程序的命令写入cron文件进行调度执行。恶意文件的逆向工程表明，Kerberods使用的技术、程序结构和基础结构与Watchdog使用的类似，Watchdog利用Redis漏洞。因此，Kerberods和Watchdog可能是由同一个人创建的。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/5c8aa67c38282c81948c30f69e00c4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eR59WRfg5-BPbLFH.png"/></div></div></figure><h1 id="dd11" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">7.8220矿工</h1><p id="8442" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">8220 Miner于2018年8月首次曝光，并且不变地使用8220端口。这是第一个利用Hadoop YARN的未授权访问漏洞的挖掘木马，它还利用了多个web服务漏洞。</p><p id="2bae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图是8220 Miner的攻击过程，入侵后运行mr.sh脚本执行挖矿程序。8220 Miner通过使用一组固定的IP地址，而不是通过传播蠕虫来发起网络范围的攻击。我们长期跟踪8220 Miner，发现其IP地址大部分位于东南亚。8220 Miner是2018年最活跃的采矿木马，但截至2019年下半年，几乎没有新活动的迹象。我们推测8220 Miner在资源争夺中失败是因为它不传播蠕虫，而是使用简单的恶意文件。我们预计8220矿工将逐渐消失，如果没有更多的重大升级。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/2d11217f2084b8325c72f3fdb487d7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tjAAUGU929dcC5j0.png"/></div></div></figure><h1 id="5610" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">8.看门狗</h1><p id="03de" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">Watchdog是一种针对Linux的挖掘蠕虫，于2019年2月爆发，利用了Nexus Repository Manager的RCE漏洞。下图是看门狗的攻击过程。看门狗自出现以来就频繁升级。2019年7月，它增加了多种攻击方法来利用web服务漏洞。在此次升级中，Watchdog还获得了针对Windows RDP的RCE漏洞(CVE-2019–0708)的内置扫描模块。如果在扫描的主机上检测到此漏洞，主机地址将以RC4加密模式返回到中央控制服务器。攻击者可能会利用该僵尸网络来检测互联网上易受攻击的主机，为攻击Windows操作系统做准备。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/dfff837db7eee9b2c78fc40736d2f6e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g7k6Ove4KRAewiuV.png"/></div></div></figure><h1 id="3510" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">安全建议</h1><p id="8dd3" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">2020年1月我们准备这份报告的时候，虚拟货币经历了新一轮的升值。这可能会吸引更多黑客通过恶意挖矿获利，预计2020年恶意挖矿将会泛滥成灾。</p><p id="4c41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据我们的估计，阿里云安全团队为云用户提供了以下安全建议:</p><ul class=""><li id="6e08" class="mc md iq jp b jq jr ju jv jy nl kc nm kg nn kk mj mk ml mm bi translated">超过一半的挖矿木马利用弱密码漏洞。这些漏洞的存在是由于安全意识不足。企业的首要措施应该是加强安全意识教育和安全管理。</li><li id="3d9b" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">非法加密货币矿工可能会在漏洞暴露到修复这段时间内利用零天或N天漏洞。这要求企业提高其应急响应效率，实时监控产品安全建议，并及时进行升级。企业还可以购买托管安全服务来提高安全性。</li><li id="eef1" class="mc md iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">企业倾向于专注于核心业务，并相应地进行安全投资。例如，企业可能会部署web应用防火墙(WAF)和防DDoS Pro来保护其核心web服务，但会将互联网上可用的非Web网络应用暴露于安全威胁。安全O&amp;M工程师必须注意非web应用程序的安全威胁，或者购买具有入侵防御系统(IPS)功能的防火墙来防御零时差漏洞。</li></ul><h1 id="e939" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">原始来源:</h1><div class="kl km gp gr kn ko"><a href="https://www.alibabacloud.com/blog/cloud-based-mining-botnet-trends-in-2019-mining-trojans-spreading-as-worms_595839?spm=a2c41.14003924.0.0" rel="noopener  ugc nofollow" target="_blank"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">2019年基于云的挖矿僵尸网络趋势:挖矿木马作为蠕虫传播</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">阿里云安全2020年2月17日17由桑多特别感谢苍坡和吴梵一矿木马是一种…</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">www.alibabacloud.com</p></div></div><div class="kx l"><div class="no l kz la lb kx lc ld ko"/></div></div></a></div><figure class="mw mx my mz gt na"><div class="bz fp l di"><div class="np nq l"/></div></figure></div></div>    
</body>
</html>