<html>
<head>
<title>Implementing kNN Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实现kNN分类器</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/implementing-knn-classifier-fb07eff18302?source=collection_archive---------3-----------------------#2020-06-21">https://medium.datadriveninvestor.com/implementing-knn-classifier-fb07eff18302?source=collection_archive---------3-----------------------#2020-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="08ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我解释了如何在虹膜数据集上实现k近邻分类器。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/de271a01b2f184ca1dc80d6a5f339ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9-nHw0jtLXG_VtQH9tClBw.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Image by author</figcaption></figure><pre class="km kn ko kp gt lb lc ld le aw lf bi"><span id="28de" class="lg lh iq lc b gy li lj l lk ll">from sklearn.datasets import load_iris<br/>iris = load_iris()<br/># Storing the data and labels into "X" and "y" varaibles<br/>X = iris.data<br/>y = iris.target</span></pre><p id="d5d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我使用了从SciKit learn导入的虹膜数据集。IRIS数据集是由R.A.Fisher(现代统计学之父)提出的一种多元数据集，用于展示线性判别分析。这可以说是特征选择文献中最著名的数据集。</p><p id="5674" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据集包含3类，每类50个实例，其中每类涉及一种鸢尾植物。一个类与另一个类是线性可分的；后者彼此不是线性可分的。</p><div class="lm ln gp gr lo lp"><a href="https://www.datadriveninvestor.com/2019/07/02/best-resources-to-learn-machine-learning-and-apply-it-to-finance-books-courses-and-youtube-2019/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd ir gy z fp lu fr fs lv fu fw ip bi translated">学习机器学习并将其应用于金融的最佳资源:书籍、课程和YouTube…</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">在当今科技发达的世界，我们开始求助于我们创造的机器来帮助我们。算法…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md kv lp"/></div></div></a></div><p id="d4a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Iris数据集由150个数据实例组成。有3类(杂色鸢尾、刚毛鸢尾和海滨鸢尾)各有50个实例。</p><p id="0e7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于每朵花，我们有以下数据属性</p><ul class=""><li id="7494" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">萼片长度，单位为厘米</li><li id="c284" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">萼片宽度，单位为厘米</li><li id="7707" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">花瓣长度(厘米)</li><li id="df8b" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">花瓣宽度(厘米)</li></ul><p id="7a4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了使我们的实验简单，我们用数字重命名这些类:</p><ul class=""><li id="c6cf" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">“0”:setosa</li><li id="24d9" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">【1】:云芝</li><li id="7187" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">“2”:海滨</li></ul><p id="bd1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据加载后，我使用Scikit learn中的train_test_split将数据分为训练集和测试集。</p><pre class="km kn ko kp gt lb lc ld le aw lf bi"><span id="0aea" class="lg lh iq lc b gy li lj l lk ll">from sklearn.model_selection import train_test_split#<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</span></pre><p id="e6f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，数据被分割，我们现在可以训练kNN分类器，并使用它进行相应的预测:</p><pre class="km kn ko kp gt lb lc ld le aw lf bi"><span id="18a3" class="lg lh iq lc b gy li lj l lk ll">from sklearn.neighbors import KNeighborsClassifier</span></pre><p id="d32d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">kNN分类器:</p><p id="a1b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能是最简单的机器学习算法。如上所述，由于其eﬀectiveness.，它仍然被广泛使用k-NN算法之所以得名，是因为它使用关于一个实例的最近邻居的信息来对其进行分类。我们识别训练数据中相似性“最接近”的k个记录。未标记的测试实例被分配给大多数k个最近邻居的类。</p><pre class="km kn ko kp gt lb lc ld le aw lf bi"><span id="9989" class="lg lh iq lc b gy li lj l lk ll"># We “assumed” k(the number of neighbors i.e. n_neighbors)  = 3. It can also be 5, 7 … 10<br/>model = KNeighborsClassifier(n_neighbors=3)<br/># Training or fitting the model with the train data<br/>model.fit(X_train,y_train)</span></pre><p id="8c1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们已经用训练数据训练并拟合了模型，我们可以开始使用它进行预测了:</p><pre class="km kn ko kp gt lb lc ld le aw lf bi"><span id="465b" class="lg lh iq lc b gy li lj l lk ll">model.predict(X_test)</span></pre><p id="3aab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这会给你一个相关预测的输出，就像这样:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/1c3e3937a53152bbedaaad0a06cc8876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9zL2o8XXRbZo9sD5nW4OVQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Image by author</figcaption></figure><p id="381f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还可以检查给定测试数据和标签的平均准确度:</p><pre class="km kn ko kp gt lb lc ld le aw lf bi"><span id="a7c1" class="lg lh iq lc b gy li lj l lk ll">model.score(X_test,y_test)</span></pre><p id="b5b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我得了0.98分。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/552774644f70bb3c71b72ee6f1e606ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*_cFIMlYPZ_pejeFfXkeFgQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Image by Author</figcaption></figure><p id="fdde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于数据是公开的，您可以进一步利用它。您可以尝试更改训练数据与测试数据的比率，或者更改k值，看看会发生什么。您应该始终确保不要让模型过度适应您的数据。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="42ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">进入专家视角— </strong> <a class="ae nb" href="https://datadriveninvestor.com/ddi-intel" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">订阅DDI英特尔</strong> </a></p></div></div>    
</body>
</html>