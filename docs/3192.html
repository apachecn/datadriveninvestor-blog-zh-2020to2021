<html>
<head>
<title>Recommendation Engines: A to Z (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐引擎:A到Z(第3部分)</h1>
<blockquote>原文：<a href="https://medium.datadriveninvestor.com/recommendation-engines-a-to-z-part-3-b3991f98fb15?source=collection_archive---------7-----------------------#2020-06-05">https://medium.datadriveninvestor.com/recommendation-engines-a-to-z-part-3-b3991f98fb15?source=collection_archive---------7-----------------------#2020-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d1e7" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">内部人工智能</h2><div class=""/><p id="1336" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在推荐系统系列的这一部分中，我们将讨论基于模型的协同过滤推荐方法。</p><p id="ca39" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在基于邻居的方法中，我们已经使用了一些技术来测量用户的相似性。但是现在我们将在这里谈一些关于矩阵分解的见解。</p><p id="aa89" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">本博客系列的前一部分:</p><div class="ku kv gp gr kw kx"><a href="https://medium.com/datadriveninvestor/recommendation-engines-a-to-z-part-2-a099ca021121" rel="noopener follow" target="_blank"><div class="ky ab fo"><div class="kz ab la cl cj lb"><h2 class="bd ja gy z fp lc fr fs ld fu fw iz bi translated">推荐引擎:A到Z(第2部分)</h2><div class="le l"><h3 class="bd b gy z fp lc fr fs ld fu fw dk translated">这是推荐引擎博客系列的第2部分。这个博客系列将涵盖来自…的推荐引擎</h3></div><div class="lf l"><p class="bd b dl z fp lc fr fs ld fu fw dk translated">medium.com</p></div></div><div class="lg l"><div class="lh l li lj lk lg ll lm kx"/></div></div></a></div><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/70e4154258ba942f46803b1973d04b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*SdnQUsXBIL9vBl1chklRGA.png"/></div></figure><h1 id="848a" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">基于模型的方法(矩阵分解)</h1><p id="40a2" class="pw-post-body-paragraph jw jx iq jy b jz ms kb kc kd mt kf kg kh mu kj kk kl mv kn ko kp mw kr ks kt ij bi translated">基于模型的方法假设一个潜在的“生成”模型，该模型解释用户-项目交互并试图发现它以便做出新的预测。在学习矩阵分解时，我们需要了解一些术语。</p><blockquote class="mx"><p id="d2aa" class="my mz iq bd na nb nc nd ne nf ng kt dk translated">什么是用户-项目交互？</p></blockquote><p id="57ca" class="pw-post-body-paragraph jw jx iq jy b jz nh kb kc kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt ij bi translated">说明:这里有一个电影推荐的例子。用户给电影打分。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/16d5956af6416727ab2f808c5958c923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQSIdqQmXWJiIPMqSOLpWg.png"/></div></div></figure><p id="6640" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我想现在你已经明白是什么了。现在让我们找出潜在的因素。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><blockquote class="mx"><p id="f40e" class="my mz iq bd na nb nc nd ne nf ng kt dk translated">什么是潜在因素？</p></blockquote><p id="1388" class="pw-post-body-paragraph jw jx iq jy b jz nh kb kc kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt ij bi translated">在我们的数据中无法直接观察到的值，但在观察观察到的数据值之间存在的关系和趋势时可能会识别出来。例如，对于用户电影矩阵，潜在因素可以是电影的类型、对整个电影的情感等。</p><p id="d531" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">虽然我们的数据集中没有直接给出它，但是我们可以通过单值分解(SVD)来生成它。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><blockquote class="mx"><p id="3482" class="my mz iq bd na nb nc nd ne nf ng kt dk translated">什么是SVD？</p></blockquote><p id="f808" class="pw-post-body-paragraph jw jx iq jy b jz nh kb kc kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt ij bi translated">基于线性代数，任何实矩阵R(用户-电影)都可以分解为3个矩阵U、σ和V。继续使用电影示例，U是n × r用户-潜在特征矩阵，V是m × r电影-潜在特征矩阵。σ是一个r × r对角矩阵，包含原始矩阵的奇异值，简单表示某个特定特征对预测用户偏好有多重要。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi ny"><img src="../Images/57616a1a8e58391422ec3fb918fa1538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EpbPnLAELzx29vrvPjOkg.png"/></div></div></figure><p id="b442" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在现实生活中，奇异值分解在数据上并不奏效。为什么？</p><p id="9de0" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">因为SVD可以在非稀疏数据上获得非常好的结果，我指的是没有丢失值的数据。但是我们中有多少人在每部电影或购买结束时给出分数呢？嗯，不多。</p><p id="432b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">事实上，推荐引擎的真实数据集可能非常稀疏，您可以找到超过95% NaN值的用户项目矩阵。这就是Funk SVD的用武之地。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><blockquote class="mx"><p id="c2aa" class="my mz iq bd na nb nc nd ne nf ng kt dk translated">什么是Funk SVD？</p></blockquote><p id="21cb" class="pw-post-body-paragraph jw jx iq jy b jz nh kb kc kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt ij bi translated">Funk SVD将忽略这些缺失值，并找到一种仅使用已知值计算潜在因子的方法。要使用Funk SVD实现这种矩阵分解方法，需要遵循以下步骤:</p><p id="0438" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi nz translated"><span class="l oa ob oc bm od oe of og oh di"> 1 </span>建立两个矩阵u和V^T，分别是根据选择的潜在因素的数量的用户矩阵和根据项目的这些相同潜在因素的矩阵，并用随机数填充这些矩阵。</p><p id="ebb8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在这一步，我们有两个矩阵:</p><p id="e612" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">用户-项目矩阵:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi oi"><img src="../Images/cd354a5e8246aa0d7de41bfd94033e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0lL0URScxqsSFfMq.png"/></div></div></figure><p id="7082" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">U矩阵(用户用随机值填充潜在因子):</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi oi"><img src="../Images/11a07f9d36ebf7361e73f5d00e6d61ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vnxYoPIlK3a8-Tdc.png"/></div></div></figure><p id="d5c5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">V^T矩阵(用随机值填充的项目的潜在因素):</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi oj"><img src="../Images/dabb0ccf23e9b7ae89d09a7f2a9e3c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qxtOw6sWqfNkeoHV.png"/></div></div></figure><p id="5191" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi nz translated"><span class="l oa ob oc bm od oe of og oh di"> 2 </span>在用户-商品矩阵中搜索一个用户-商品对的现有价格。找到的第一个评级是由用户1对项目3给出的<strong class="jy ja"> 9 </strong>。所以<strong class="jy ja"> 9是我们的实际值</strong>，真实值。</p><p id="7ea7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi nz translated">在U矩阵中，我们取与用户1(行)相关的所有随机值。我们为这个用户准备了[0.8，1.2，-0.2]</p><p id="4956" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">请记住，9是用户1给项目3的。在V^T矩阵中，我们也取与第3项相关的所有随机值。这个项目我们有[-0.2，0.1，0.14]^T</p><p id="cecd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi nz translated"><span class="l oa ob oc bm od oe of og oh di"> 4 </span>我们计算找到的行和列之间的点积，以便进行预测。(0.8 x-0.2)+(1.2 x 0.1)+(-0.2 x 0.14)=-0.07</p><p id="32d6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这时我们有<strong class="jy ja">实际=9 </strong>和<strong class="jy ja">预测=-0.07。</strong></p><p id="3440" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">所以<strong class="jy ja">误差</strong>为(9+0.07) = <strong class="jy ja"> 82.26 </strong></p><p id="3202" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi nz translated"><span class="l oa ob oc bm od oe of og oh di"> 5 </span>使用梯度下降最小化误差。<br/>公式:<strong class="jy ja"> U(i)或V(i) + ⍺ 2(实际-预测)x V(i)或U(i) </strong>其中U(i)是来自u矩阵的随机值，V(i)是V^T矩阵中关联的随机值，⍺是学习率。</p><p id="764c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们回顾一下，这是U和V的值，并进行预测:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi ok"><img src="../Images/81d42a22576bb59b59c73b5d4bc76ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*asM-Kg0OdepkoqRM.png"/></div></div></figure><p id="4682" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">使用梯度下降和⍺=0.1:更新0.8</p><p id="5198" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">新值= 0.8+0.1 x 2(9+0.07)x-0.2 =<strong class="jy ja">0.44</strong></p><p id="c0c6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">通过更新U的所有值，我们得到<strong class="jy ja"> 0.44，1.38，0.053。</strong>所以现在我们有了:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi oi"><img src="../Images/ae1242ef2d38d21af5917664db115334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gxVILMHgM8eBO_y9.png"/></div></div></figure><p id="9715" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">然后，我们可以更新v中的值。注意，U中新更新的值已经影响了我们将从v中计算的值。</p><p id="3bec" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">最后，用同样的公式我们得到:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi oi"><img src="../Images/c556d24c2eb5b1e318043970af47b9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5QBML3i8HArorg7i.png"/></div></div></figure><p id="27e8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi nz translated"><span class="l oa ob oc bm od oe of og oh di"> 6 </span>替换u和V^T矩阵中的更新值，<br/>并对剩余行进行相同的迭代。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi oj"><img src="../Images/61c20867eef92eddb233e626e6c00756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KNf0K9XYAK9bfod2.png"/></div></div></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi ol"><img src="../Images/72d9d661aec5280756cfc996460d8b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EVszwQIr4RcWUXmK.png"/></div></div></figure><blockquote class="om on oo"><p id="aba3" class="jw jx op jy b jz ka kb kc kd ke kf kg oq ki kj kk or km kn ko os kq kr ks kt ij bi translated">附加内容:Funk SVD的历史——2006年因制作最佳协同过滤算法而获得Netflix奖竞赛的西蒙·芬克(Simon Funk)。[来源:<a class="ae ot" href="https://sifter.org/~simon/journal/20061211.html" rel="noopener ugc nofollow" target="_blank">https://sifter.org/~simon/journal/20061211.html</a></p></blockquote><p id="1ba1" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">通过这种矩阵分解的方法，我们可以基于每个用户-项目对来推荐项目。</p><blockquote class="mx"><p id="a10a" class="my mz iq bd na nb nc nd ne nf ng kt dk translated">但是如果用户/电影是新的呢？我们能预测这两个也一样吗？</p></blockquote><p id="79d8" class="pw-post-body-paragraph jw jx iq jy b jz nh kb kc kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt ij bi translated">没有；这就是所谓的<strong class="jy ja">冷启动问题</strong>。</p><p id="817e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">冷启动问题</strong>是一个平台的新用户和新物品没有任何评分的问题。因为这些用户和物品没有任何评分，所以无法使用协同过滤的方法进行推荐。</p><p id="7db6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">因此，像基于排名和基于内容的推荐这样的方法是开始为这些个人进行推荐的唯一方法。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/2153cc6581e1c2445f96f28cb322b724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*xnf9A-m2vr1O8_hWWBEmZw.png"/></div></figure><p id="a68a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">您可以访问本博客附带的代码。</p><div class="ku kv gp gr kw kx"><a href="https://github.com/prashantjadiya/Recommendation-engines/tree/master/Collaborative%20filtering" rel="noopener  ugc nofollow" target="_blank"><div class="ky ab fo"><div class="kz ab la cl cj lb"><h2 class="bd ja gy z fp lc fr fs ld fu fw iz bi translated">prashantjadiya/推荐-发动机</h2><div class="lf l"><p class="bd b dl z fp lc fr fs ld fu fw dk translated">github.com</p></div></div><div class="lg l"><div class="ov l li lj lk lg ll lm kx"/></div></div></a></div><blockquote class="mx"><p id="343b" class="my mz iq bd na nb ow ox oy oz pa kt dk translated">感谢您阅读本博客！如果您有任何建议/疑问，请在回复部分发表评论。</p></blockquote></div></div>    
</body>
</html>