# 干净的代码:原因和结果

> 原文：<https://medium.datadriveninvestor.com/clean-code-cause-effect-40a8129e1c60?source=collection_archive---------17----------------------->

![](img/37072db772f9742cb38bf24dc24d44ee.png)

多少程序员，那么多定义，什么是干净代码。通常，在面试时，我们会听到好的代码是易于阅读的。我们同意，但根据我们的个人经验，这只是冰山一角。

告诉我们代码不再干净的第一个信号是新功能开发时间的增加，以及系统中最微小变化的回归尺度的增加。这是技术债务累积的结果，系统中的组件关系非常密切，并且没有自动测试。其原因可能是:

*   外部因素——例如来自企业的压力以及企业希望更快获得新功能的愿望。
*   内部——开发过程和团队内部的相互作用不完善，缺乏控制和开发标准，或者缺乏能力。

你不应该推迟代码质量和架构方面的工作。在 sprint 期间，能够将具有直接业务价值的任务(具有新功能的任务)和对业务只有间接影响的技术任务分开是很重要的。分割的比例取决于项目的当前状态、时间框架和空闲手的数量。

事实证明，要说代码是干净的，系统设计是正确的，代码的易读性是不够的。它应该具有其他品质:

*   代码很容易修改。有了正确的设计和架构，扩展您的代码不需要太多的时间和费用。代码的实体不应该彼此紧密相关；代码应该有点抽象和自给自足。我们在开发过程中操作的每个实体应该只负责它自己的功能部分。
*   代码必须稳定、可预测、安全和可靠。不管代码读起来有多简单，都应该被测试覆盖。好的代码和测试总是存在的。此外，不仅测试的数量很重要，测试的质量也很重要。有了这段代码，在运行和调试时就没有问题了，它不会引起环境的变化。
*   受保护的代码。在编写任何代码时，都不能忘记产品的整体安全性。我们建议您熟悉安全的基本原则，并遵守这些原则。如果我们讨论的是 web 项目，我们推荐 OWASP。
*   好的代码是不存在的代码。这并不意味着所有的代码都要写在一行上，你绝对应该为精妙的方法感到自豪。这意味着代码不应该重复，一些常见的东西应该留在抽象层次。理论上，简化你的代码会导致更少的缺陷。
*   阅读代码本身也很重要。每个开发者都有自己的写作风格，阅读水平取决于我们的经验。我们都想写出简单、漂亮、简洁的代码。

为了摆脱对代码质量的主观评估，自 1961 年以来，术语“代码有味道”或“有味道的代码”被引入。这是一组规则和指导方针，清楚地定义了是否到了重构的时候了。异味导致代码腐烂，开发人员应该一直努力消除它。重构的需求直接来自于代码气味的存在，通过预防这一原因，我们可以避免后果。关于是时候重构的关键标志的更多信息，你可以在 Martin Fowler 的书《重构:改进现有代码的设计》中找到。

绝对值得！但是过分关注清洁并不总是值得的。

不要忘记代码的可行性和生命周期。例如，如果您面临开发一个概念的任务— PoC(概念证明)，并且您证明了所选择的技术堆栈完成了该任务，那么您的代码将在一两周内变得无关紧要。你不应该把精力浪费在改进这个功能上。

有一种观点认为，没有必要对即将被替换的代码或系统部分的质量进行监控。这是不正确的，原因有几个。高质量的工艺将使与新零件的过渡或集成更加容易、顺畅和快速。在必须同时支持几个版本的代码的情况下，这肯定会使事情变得更容易。干净代码的回归错误数量会少几倍。此外，不要忘记，没有什么比暂时更永久的了。也许改进这部分代码的任务将会积压几个月。

大多数程序员都梦想着尽可能快、尽可能漂亮地编写代码，这样第一次就能完美运行。但并不是每个人都能成功地让代码不仅可行，而且易于理解。如何成功写出干净的代码？有两种方式——自组织和团队合作。

让我们来看看几种提高代码质量的可能方法。这些指南适用于任何级别的开发人员。

**1。仪器**

注意使用的工具，尤其是主要的工具——开发环境。方便的工具是成功的一半。IDE(集成开发环境)不仅可以动态地补充代码，还可以建议嗅出需要整理的地方。通过用必要的插件扩展 IDE，你得到了一把瑞士军刀。您在这个工具中完成了大部分工作——让它尽可能的方便和灵活。

不要错过购买你喜欢的产品的机会。拼牌照会节省你一些时间，官方支持永远不会是多余的。

**2。参与开源项目。**

在团队合作中，使用他人代码的能力很重要。理解、阅读和坚持一种风格并不总是容易的。使用别人的代码工作，通常有可能了解到解决重要问题的新方法。阅读和研究代码！

**3。严格的框架**

开始开发一个解决特定问题的小项目。自己设计架构并实现。这样做，你可以给自己设定技术限制。比如只使用 OOP 的开发，方法的圈复杂度不超过 10，遵从给定语言的所有开发建议，有意识的使用设计模式等。

养成有限度工作的习惯。毕竟，不会总有人在旁边监督你的工作质量。

**4。抽象思维的发展**

阅读和使用编程模式。它们不依赖于特定的语言，有助于更有效地解决问题。你会和其他开发者一样理解解决问题的设计。您将更好地理解第三方工具和库是如何工作的。

解决编程难题。这是提高编程技能和学习所选语言复杂性的好方法。

**5。决策分析**

不要急于正面解决问题。问资深开发者和自己的问题。理解某些决策的因果关系总是很重要的。好好理解问题，就能有效解决问题。

好的开发人员不是写代码的工匠，而是在工作中结合应用研究、规划、设计的工程师。

**6。阅读文档**

能够阅读文档和阅读代码一样重要。下一步是学习如何编写文档。

**7。练习！**

有经验总比没有经验好。

让我们来看看几种提高代码质量的可能方法。这些指南适用于任何级别的开发人员。

**1。代码审查**

这是一个需要理解和遵循的简单原则。至少有两个人，包括代码的作者，评审代码。

*   审查代码时，有几件事要记住:
*   一个是检查代码是否违反了编码约定的规则。这是一个可以并且应该在 CI(持续集成)中使用静态分析器实现自动化的过程。
*   其他的是不能自动检查的代码可维护性和错误处理。
*   最后但同样重要的是，应该检查代码的完整性。这段代码片段是否包含了预期的整个函数范围？

**2。持续集成**

持续集成的本质在于，它允许您快速获得关于代码当前状态的大量反馈。

当您遵循两个简单的规则时，持续集成会起作用:

产品组装速度快。避免缓慢的构建。持续集成通过提供快速反馈来提高代码质量。如果测试失败，构建也会失败，您会立即得到通知。

您将静态分析器添加到您的构建脚本中，以检查编码约定、提高代码质量和检查安全性。

**3。编码惯例**

拥有一个编码约定列表是很重要的。但是在你开始列清单之前，团队中的每个人都必须理解这个协议的重要性。不要指望第一次就能通过这样的协议，会有很多讨论。

列出一个编码约定的列表，在其中定义变量应该如何声明、命名约定等等。您可以添加到此列表中的规则数量是无限的，并且可能会有所不同。做对你和你的团队有用的事情。如果团队满意，可以随意在协议列表中添加新的规则。从列表中删除协议也是如此。

一旦你有了你的编码惯例列表，坚持它们是必要的。首选的方法是用静态分析器和持续集成来检查编码约定，因为它不需要任何手动步骤。

好的代码可以加速长期的软件开发。它是可重用的，开发人员不必浪费时间修复旧的错误。这也使得新人更容易加入项目。

**4。测试**

代码中的错误越少，质量就越高。严格的测试会过滤掉关键错误，并确保代码按预期运行。

当涉及到提高代码质量时，有一个清晰的测试策略是很重要的。至少，你的代码应该是模块化的。如果你想用其他方法，比如集成或者回归测试，那就更好了。

一个软件项目中最大数量的测试应该是单元测试。它们又便宜又快。有许多不同的工具可以帮助您创建单元测试和代码覆盖率报告。运行测试套件和生成代码覆盖报告可以通过持续集成自动完成。如果代码覆盖率没有达到要求的百分比，构建甚至可能会失败。

**5。误差分析**

代码中出现错误可能是不可避免的。因此，分析和处理这些错误是非常重要的。如果你想提高你的技能，从错误中学习是很重要的。

出现错误时，用几个问题来分析它:

这是低优先级还是高优先级的 bug？如果有，应该马上改正。如果 bug 很小，并且允许产品在没有大问题的情况下完成任务，那么这个 bug 可能会在未来的迭代中被修复。

*   出了什么问题？
*   为什么我们没有检查这个(对不对)？
*   这种情况还会发生在哪里？
*   最重要的是，我们如何防止这种情况在未来发生？

当然，有工具可以帮助您跟踪错误。你可以选择市面上适合你需求的追踪器。

**6。收集度量标准**有几个度量标准可以用来量化代码的质量。SonarQube 可以轻松应对这项任务。它将轻松帮助您收集您需要的所有重要指标:

*   **潜在错误**

缺陷的数量及其严重性是整体质量的重要指标。发现错误可以而且应该是自动化的，但只是部分自动化。代码审查仍然有效，可以识别代码逻辑本身中更深层次的错误。

*   **代码段的重复**

每一个知识都应该在系统内有一个单一的、一致的、权威的表示 DRY 原则(不要重复自己)。

*   **复杂性指标**

复杂性通常用圈复杂性度量来衡量。这是程序代码中线性独立路径数量的指示器。圈复杂度的数量和缺陷率之间存在相关性。理论上，简化你的代码会导致更少的缺陷。

*   **所需注释的可用性**

仅仅几行间距适当的注释，一个模块、类或方法的注释就足以使代码更加清晰。

*   **测试覆盖率**

测试软件时使用。它显示了测试过程中执行的程序源代码的百分比。设置测试百分比不低于的标准。

代码中的错误类似于碳足迹。这是绝对不可能避免的，额外的废气本身不会杀死人类或周围的自然。然而，今天减少你在这个星球上的负面影响似乎是一种自然的需要。同样，编写干净的代码是每个开发人员的责任。不管你选择哪一条路，你都应该努力写出有用的和可理解的代码。

考虑到我们代码的生命周期和进一步改进的可行性，如果我们设法不把纯粹变成一种盲目崇拜，这是很好的。要记住的主要事情是人:即使是我们开发的系统的一小部分突然出现故障也会让用户失望，以及必须支持这个系统的工程师。

你可以在我们的[天才博客](https://geniusee.com/blog)上找到更多文章

*原载于 2020 年 8 月 4 日 https://geniusee.com*[](https://geniusee.com/single-blog/clean-code-cause-and-effect)**。**